# AuthService and Better-Auth | kriegcloud/beep-effect | DeepWiki

_Source: https://deepwiki.com/kriegcloud/beep-effect/4.3.1-authservice-and-better-auth_

Relevant source files
*   [docker-compose.yml](https://github.com/kriegcloud/beep-effect/blob/b64126f6/docker-compose.yml)
*   [packages/common/constants/src/paths/asset-paths.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/constants/src/paths/asset-paths.ts)
*   [packages/common/constants/src/paths/generated/asset-paths.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/constants/src/paths/generated/asset-paths.ts)
*   [packages/files/domain/src/utils/bytes-to-size.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/files/domain/src/utils/bytes-to-size.ts)
*   [packages/files/domain/src/utils/compress-file-name.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/files/domain/src/utils/compress-file-name.ts)
*   [packages/iam/infra/src/adapters/better-auth/Auth.service.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts)
*   [packages/iam/infra/src/adapters/better-auth/plugins/one-tap/one-tap.plugin.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/plugins/one-tap/one-tap.plugin.ts)
*   [packages/iam/infra/src/adapters/better-auth/plugins/organization/organization.plugin.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/plugins/organization/organization.plugin.ts)
*   [packages/iam/sdk/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/sdk/package.json)
*   [packages/iam/sdk/src/clients/sign-in/sign-in.client.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/sdk/src/clients/sign-in/sign-in.client.ts)
*   [packages/iam/sdk/src/index.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/sdk/src/index.ts)
*   [packages/iam/ui/src/sign-up/sign-up.view.tsx](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/ui/src/sign-up/sign-up.view.tsx)
*   [packages/runtime/client/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/runtime/client/package.json)
*   [packages/runtime/client/src/services/runtime/live-layer.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/runtime/client/src/services/runtime/live-layer.ts)
*   [packages/runtime/server/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/runtime/server/package.json)
*   [packages/runtime/server/src/server-runtime.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/runtime/server/src/server-runtime.ts)
*   [packages/ui/src/theme/with-settings/update-core.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/ui/src/theme/with-settings/update-core.ts)

Purpose and Scope
-----------------

This document details the `AuthService` implementation, which provides authentication functionality for the beep-effect repository using the better-auth library. The service handles user authentication, session management, database integration, and social OAuth provider configuration. It operates as an Effect Service within the server runtime and manages database hooks for automatic resource provisioning.

For information about better-auth plugins (organization and one-tap), see [Better-Auth Plugins](https://deepwiki.com/kriegcloud/beep-effect/4.3.2-better-auth-plugins). For the authorization system using policies and permissions, see [Policy Authorization System](https://deepwiki.com/kriegcloud/beep-effect/4.3.3-policy-authorization-system). For the overall runtime configuration, see [Server Runtime](https://deepwiki.com/kriegcloud/beep-effect/4.2.2-server-runtime).

* * *

Architecture Overview
---------------------

The `AuthService` sits at the intersection of the IAM domain infrastructure and the server runtime, orchestrating authentication flows and managing database state through better-auth.

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 1-250](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L1-L250)[packages/runtime/server/src/server-runtime.ts 85-102](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/runtime/server/src/server-runtime.ts#L85-L102)

* * *

Effect Service Pattern
----------------------

The `AuthService` follows the Effect Service pattern, providing type-safe dependency injection and lifecycle management.

### Service Definition

The service is declared using `Effect.Service` with accessors enabled, allowing direct property access to service methods:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 241-249](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L241-L249)

**Key Properties:**

*   **Service Tag**: `"AuthService"` - unique identifier in the dependency graph
*   **Accessors**: `true` - enables `AuthService.auth` direct access pattern
*   **Dependencies**: Requires `AuthEmailService` and `IamDb.IamDb` layers
*   **Effect**: Constructs the better-auth instance from `AuthOptions`

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 241-249](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L241-L249)

* * *

Configuration Structure
-----------------------

The `AuthOptions` Effect generator assembles the complete better-auth configuration from multiple sources.

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 27-237](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L27-L237)

* * *

Database Integration
--------------------

### Drizzle Adapter Configuration

The service uses better-auth's Drizzle adapter to integrate with the PostgreSQL database through Drizzle ORM:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 40-46](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L40-L46)

**Configuration Parameters:**

| Parameter | Value | Purpose |
| --- | --- | --- |
| `debugLogs` | `isDebug` | Enables SQL query logging in debug mode |
| `provider` | `"pg"` | PostgreSQL database provider |
| `usePlural` | `false` | Uses singular table names |
| `schema` | `IamDbSchema` | Drizzle schema with all IAM tables |
| `camelCase` | `true` | Converts snake_case columns to camelCase |

The adapter automatically maps better-auth's internal schema to the custom IAM tables defined in `IamDbSchema`:

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 40-46](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L40-L46)[packages/iam/tables/src/index.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/tables/src/index.ts)

### Additional Fields Pattern

The service extends better-auth's base schema with custom fields using the `additionalFields` pattern:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 58-65](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L58-L65)[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 220-229](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L220-L229)

**Common Extra Fields:**

*   `createdBy`: User ID who created the record
*   `createdAt`: Timestamp of creation
*   `updatedAt`: Timestamp of last update
*   `source`: String indicating creation source (e.g., "auto_created", "user_created")

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 58-65](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L58-L65)[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 220-229](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L220-L229)[packages/iam/infra/src/adapters/better-auth/internal.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/internal.ts)

* * *

Database Hooks
--------------

The `AuthService` implements two critical database hooks that automatically provision resources during authentication flows.

### User Creation Hook

When a new user is created, the hook automatically provisions a personal organization:

**Implementation Details:**

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 120-159](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L120-L159)

**Personal Organization Fields:**

| Field | Value | Description |
| --- | --- | --- |
| `id` | `SharedEntityIds.OrganizationId.create()` | Generated organization ID |
| `name` | `"${user.name}'s Organization"` | Personalized name |
| `slug` | `"${username-normalized}-${user.id-suffix}"` | URL-safe identifier |
| `type` | `"individual"` | Organization type |
| `ownerUserId` | `user.id` | User who owns this org |
| `isPersonal` | `true` | Marks as personal workspace |
| `subscriptionTier` | `"free"` | Default subscription level |
| `subscriptionStatus` | `"active"` | Active subscription |
| `source` | `"auto_created"` | Creation origin tracking |

**Member Record Fields:**

| Field | Value | Description |
| --- | --- | --- |
| `id` | `IamEntityIds.MemberId.create()` | Generated member ID |
| `userId` | `user.id` | Reference to user |
| `organizationId` | `personalOrgId` | Reference to personal org |
| `role` | `"owner"` | Grants owner permissions |
| `status` | `"active"` | Active membership status |
| `joinedAt` | `new Date()` | Membership start time |

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 120-159](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L120-L159)

### Session Creation Hook

Before a session is created, the hook loads the user's organization memberships and sets the active organization context:

**Implementation Details:**

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 161-217](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L161-L217)

**Query Details:**

*   **Joins**: `member` INNER JOIN `organization`
*   **Filters**: `userId = session.userId AND status = 'active'`
*   **Ordering**: Personal organizations first (`ORDER BY isPersonal DESC`)

**Session Context Structure:**

The `organizationContext` is stored as a JSON string mapping organization IDs to their metadata:

```
{
  [orgId: string]: {
    name: string;
    type: OrganizationType;
    role: MemberRole;
    isPersonal: boolean;
    subscriptionTier: SubscriptionTier;
  }
}
```

**Modified Session Fields:**

| Field | Type | Description |
| --- | --- | --- |
| `activeOrganizationId` | `string` | Currently active organization (usually personal org) |
| `organizationContext` | `string` | JSON map of all user's organization memberships |

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 161-217](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L161-L217)

* * *

Session Management
------------------

### Session Configuration

The session system uses cookie-based persistence with configurable expiration:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 66-75](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L66-L75)

**Session Parameters:**

| Parameter | Value | Description |
| --- | --- | --- |
| `modelName` | `SharedEntityIds.UserId.tableName` | Uses user table as model |
| `additionalFields` | `commonExtraFields` | Tracking fields (createdBy, etc.) |
| `cookieCache.enabled` | `true` | Enables client-side cookie caching |
| `cookieCache.maxAge` | `2592000` (30 days) | Cookie cache lifetime in seconds |
| `expiresIn` | `2592000` (30 days) | Session expiration time |
| `updateAge` | `86400` (1 day) | Minimum time between session updates |

### Session Lifecycle

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 66-75](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L66-L75)

* * *

Email Authentication
--------------------

### Email and Password

The service supports email/password authentication with optional email verification:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 91-105](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L91-L105)

**Configuration:**

| Parameter | Value | Purpose |
| --- | --- | --- |
| `enabled` | `true` | Enables email/password auth |
| `requireEmailVerification` | `false` | Allows login without verification |
| `sendResetPassword` | `async function` | Sends password reset emails |

**Password Reset Flow:**

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 94-104](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L94-L104)

The reset password handler:

1.   Receives user and reset URL from better-auth
2.   Decodes parameters into `SendResetPasswordEmailPayload` schema
3.   Delegates to `AuthEmailService.sendResetPassword`
4.   Wraps in observability span for tracing

### Email Verification

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 76-90](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L76-L90)

**Configuration:**

| Parameter | Value | Purpose |
| --- | --- | --- |
| `sendOnSignUp` | `true` | Automatically sends verification on registration |
| `sendVerificationEmail` | `async function` | Email sending handler |

**Verification Flow:**

The verification email handler:

1.   Constructs verification URL: `${clientUrl}/auth/verification/email/verify/${token}`
2.   Decodes into `SendVerificationEmailPayload` schema
3.   Delegates to `AuthEmailService.sendVerification`
4.   Uses Effect spans for observability

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 76-105](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L76-L105)

* * *

### Provider Discovery

The service dynamically configures OAuth providers based on environment variables:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 106-117](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L106-L117)

**Configuration Logic:**

**Provider Validation:**

For each provider in `serverEnv.oauth.authProviderNames`:

1.   Checks if `providerParams.clientSecret` is `Option.Some`
2.   Checks if `providerParams.clientId` is `Option.Some`
3.   If both exist, includes `{ [provider]: providerParams }` in config
4.   If either is missing, excludes the provider (returns empty object)

**Supported Providers:**

*   Google
*   GitHub
*   Discord
*   (Any provider supported by better-auth, configured via environment)

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 106-117](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L106-L117)[packages/core/env/server/src/env.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/core/env/server/src/env.ts)

* * *

Account Linking Configuration
-----------------------------

### Multi-Provider Account Linking

The service enables users to link multiple authentication providers to a single account:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 57-65](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L57-L65)

**Account Linking Parameters:**

| Parameter | Value | Description |
| --- | --- | --- |
| `enabled` | `true` | Enables account linking feature |
| `allowDifferentEmails` | `true` | Permits linking accounts with different email addresses |
| `trustedProviders` | `serverEnv.oauth.authProviderNames` | Only configured providers can link |
| `encryptOAuthTokens` | `true` | Encrypts OAuth tokens in database |

### Account Linking Flow

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 57-65](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L57-L65)

* * *

Rate Limiting
-------------

The service implements rate limiting to protect against abuse:

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 52-56](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L52-L56)

**Rate Limit Configuration:**

| Parameter | Value | Description |
| --- | --- | --- |
| `enabled` | `true` | Activates rate limiting |
| `window` | `10` seconds | Time window for counting requests |
| `max` | `100` requests | Maximum requests per window |

This configuration allows 100 authentication requests per 10-second window per client.

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 52-56](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L52-L56)

* * *

Security Configuration
----------------------

### Base Security Settings

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 47-51](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L47-L51)

**Security Parameters:**

| Parameter | Value | Source |
| --- | --- | --- |
| `baseURL` | Auth service URL | `serverEnv.app.authUrl` |
| `basePath` | `/api/auth` | Fixed auth endpoint path |
| `appName` | Application name | `serverEnv.app.name` |
| `secret` | Redacted secret | `serverEnv.auth.secret` |
| `trustedOrigins` | Array of origins | `serverEnv.security.trustedOrigins` |

**Trusted Origins:**

The `trustedOrigins` array defines which domains can make cross-origin authentication requests. This prevents CSRF attacks and unauthorized authentication attempts from untrusted domains.

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 47-51](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L47-L51)

* * *

Advanced Configuration
----------------------

### ID Generation

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 231-235](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L231-L235)

**Setting:**

```
advanced: {
  database: {
    generateId: false
  }
}
```

This disables better-auth's internal ID generation, delegating ID creation to the application's `EntityId.create()` pattern. This ensures consistent ID formats across all entities (PublicId/PrivateId pattern).

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 231-235](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L231-L235)[Schema System: EntityId Pattern](https://deepwiki.com/kriegcloud/beep-effect/6.1.1-entityid-pattern)

* * *

Telemetry and Debugging
-----------------------

### Debug Configuration

[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 31-39](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L31-L39)

The service dynamically enables debug telemetry based on the log level:

```
const isDebug = P.or(
  Equal.equals(LogLevel.Debug),
  Equal.equals(LogLevel.All)
)(serverEnv.app.logLevel);

telemetry: {
  debug: isDebug
}
```

When debug mode is enabled:

*   SQL queries are logged by the Drizzle adapter
*   Better-auth internal operations are logged
*   Enhanced error details are included in responses

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 31-39](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L31-L39)

* * *

Runtime Integration
-------------------

### Server Runtime Composition

The `AuthService` is integrated into the server runtime through a layered dependency chain:

**Layer Definitions:**

[packages/runtime/server/src/server-runtime.ts 85-102](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/runtime/server/src/server-runtime.ts#L85-L102)

**Composition Order:**

1.   **DatabaseInfrastructureLive**: Provides `Db.Live`, `IamDb.IamDb.Live`, `FilesDb.FilesDb.Live`
2.   **RepositoriesLive**: Provides repository layers (IamRepos, FilesRepos)
3.   **AuthEmailLive**: Provides `AuthEmailService` backed by `ResendService`
4.   **CoreServicesLive**: Merges repositories and email service
5.   **AuthLive**: Provides `AuthService.DefaultWithoutDependencies` with `CoreServicesLive`
6.   **AppLive**: Merges `AuthLive` with `LoggerLive`
7.   **serverRuntime**: Final runtime with observability

**Sources:**[packages/runtime/server/src/server-runtime.ts 85-102](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/runtime/server/src/server-runtime.ts#L85-L102)

* * *

Client-Side Integration
-----------------------

### Better-Auth Client

Client-side authentication uses the better-auth client library configured to communicate with the `AuthService`:

[packages/iam/sdk/src/adapters/index.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/sdk/src/adapters/index.ts)

The client provides type-safe methods for:

*   `client.signIn.email()`
*   `client.signIn.social()`
*   `client.signIn.passkey()`
*   `client.signUp.email()`
*   `client.signOut()`
*   `client.oneTap()`

### Client Usage Example

[packages/iam/ui/src/sign-up/sign-up.view.tsx 105-119](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/ui/src/sign-up/sign-up.view.tsx#L105-L119)

**Pattern:**

1.   Obtain runtime via `useRuntime()` hook
2.   Create bound runner: `makeRunClientPromise(runtime, spanName)`
3.   Execute Effect wrapped in client call
4.   Handle success/failure with callbacks

**Sources:**[packages/iam/ui/src/sign-up/sign-up.view.tsx 1-132](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/ui/src/sign-up/sign-up.view.tsx#L1-L132)[packages/iam/sdk/src/clients/sign-in/sign-in.client.ts 1-103](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/sdk/src/clients/sign-in/sign-in.client.ts#L1-L103)

* * *

Configuration Summary
---------------------

### Complete Configuration Matrix

| Category | Key | Value | Source |
| --- | --- | --- | --- |
| **Telemetry** | debug | Dynamic (based on log level) | `serverEnv.app.logLevel` |
| **Database** | adapter | drizzleAdapter | `IamDb.drizzle` |
| **Database** | provider | "pg" | Fixed |
| **Database** | schema | IamDbSchema | `@beep/iam-tables` |
| **Base** | baseURL | Auth service URL | `serverEnv.app.authUrl` |
| **Base** | basePath | "/api/auth" | Fixed |
| **Base** | secret | Redacted | `serverEnv.auth.secret` |
| **Rate Limit** | window | 10 seconds | Fixed |
| **Rate Limit** | max | 100 requests | Fixed |
| **Account** | accountLinking | enabled | Fixed |
| **Account** | allowDifferentEmails | true | Fixed |
| **Account** | encryptOAuthTokens | true | Fixed |
| **Session** | expiresIn | 30 days | Fixed |
| **Session** | updateAge | 1 day | Fixed |
| **Session** | cookieCache.maxAge | 30 days | Fixed |
| **Email** | requireEmailVerification | false | Fixed |
| **Email** | sendOnSignUp | true | Fixed |
| **Advanced** | generateId | false | Fixed |

**Sources:**[packages/iam/infra/src/adapters/better-auth/Auth.service.ts 27-237](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/iam/infra/src/adapters/better-auth/Auth.service.ts#L27-L237)
