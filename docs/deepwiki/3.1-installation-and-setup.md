# Installation and Setup | kriegcloud/beep-effect | DeepWiki

_Source: https://deepwiki.com/kriegcloud/beep-effect/3.1-installation-and-setup_

Relevant source files
*   [apps/web/next.config.ts](https://github.com/kriegcloud/beep-effect/blob/b64126f6/apps/web/next.config.ts)
*   [apps/web/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/apps/web/package.json)
*   [apps/web/tsconfig.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/apps/web/tsconfig.json)
*   [apps/web/tsconfig.test.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/apps/web/tsconfig.test.json)
*   [package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json)
*   [packages/common/invariant/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/invariant/package.json)
*   [packages/common/schema/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/schema/package.json)
*   [packages/common/types/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/types/package.json)
*   [packages/common/utils/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/utils/package.json)
*   [packages/ui/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/ui/package.json)
*   [pnpm-lock.yaml](https://github.com/kriegcloud/beep-effect/blob/b64126f6/pnpm-lock.yaml)
*   [tooling/repo-config/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tooling/repo-config/package.json)
*   [tooling/repo-scripts/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tooling/repo-scripts/package.json)
*   [tooling/testkit/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tooling/testkit/package.json)
*   [tooling/utils/package.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tooling/utils/package.json)
*   [tsconfig.base.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.base.json)
*   [tsconfig.build.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.build.json)
*   [tsconfig.json](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.json)

This document provides step-by-step instructions for cloning the beep-effect repository, installing dependencies, understanding the monorepo workspace structure, and running common development scripts. For environment variable configuration, see [Environment Configuration](https://deepwiki.com/kriegcloud/beep-effect/3.2-environment-configuration). For database setup instructions, see [Database Setup](https://deepwiki.com/kriegcloud/beep-effect/3.3-database-setup).

Prerequisites
-------------

Before installing the beep-effect repository, ensure the following tools are installed on your system:

| Tool | Required Version | Purpose |
| --- | --- | --- |
| **Node.js** | 18.x or higher | Runtime environment for TypeScript and JavaScript |
| **pnpm** | 10.18.0 (exact) | Package manager for monorepo dependency management |
| **Git** | Latest stable | Version control for cloning the repository |

The repository enforces pnpm version `10.18.0` through the `engines` field and `packageManager` field in [package.json 5-8](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L5-L8) Using a different version may cause installation or build failures.

**Sources:**[package.json 5-8](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L5-L8)[pnpm-lock.yaml 1](https://github.com/kriegcloud/beep-effect/blob/b64126f6/pnpm-lock.yaml#L1-L1)

Installation Steps
------------------

### 1. Clone the Repository

```
git clone git@github.com:kriegcloud/beep-effect.git
cd beep-effect
```

**Sources:**[package.json 14-19](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L14-L19)

### 2. Install Dependencies

The repository uses pnpm workspaces to manage dependencies across all packages and applications. Install all dependencies from the repository root:

`pnpm install`
This command:

*   Installs dependencies for all workspace packages in `apps/*`, `packages/**`, and `tooling/*`
*   Creates a unified `node_modules` structure using pnpm's content-addressable storage
*   Links workspace packages to each other using `workspace:^` protocol
*   Applies dependency overrides from the `pnpm.overrides` section in [package.json 85-289](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L85-L289)

**Sources:**[package.json 9-13](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L9-L13)[pnpm-lock.yaml 3-5](https://github.com/kriegcloud/beep-effect/blob/b64126f6/pnpm-lock.yaml#L3-L5)

### 3. Verify Installation

After installation completes, verify the setup by checking TypeScript compilation:

`pnpm check`
This runs `tsc --noEmit` across all workspace packages using Turbo to verify type correctness without generating output files.

**Sources:**[package.json 27](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L27-L27)

Workspace Structure
-------------------

The repository follows a domain-driven monorepo architecture organized into three primary directories:

### Workspace Directory Mapping

| Directory Pattern | Purpose | Example Packages |
| --- | --- | --- |
| `apps/*` | Executable applications | `web`, `server`, `mcp` |
| `packages/iam/*` | Identity & Access Management domain | `iam-domain`, `iam-tables`, `iam-infra`, `iam-sdk`, `iam-ui` |
| `packages/files/*` | File management domain | `files-domain`, `files-tables`, `files-infra`, `files-sdk`, `files-ui` |
| `packages/shared/*` | Shared domain logic | `shared-domain`, `shared-tables` |
| `packages/core/*` | Core infrastructure services | `core-db`, `core-env`, `core-email` |
| `packages/common/*` | Common utilities and helpers | `schema`, `utils`, `constants`, `errors`, `rules`, `logos` |
| `packages/ui` | Shared UI component library | `@beep/ui` |
| `tooling/*` | Build tools and scripts | `repo-scripts`, `utils`, `testkit` |

Each package is a standalone npm package with its own `package.json` and can be independently versioned and built. The workspace configuration is defined in [package.json 9-13](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L9-L13)

**Sources:**[package.json 9-13](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L9-L13)[tsconfig.json 12-118](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.json#L12-L118)[tsconfig.base.json 49-341](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.base.json#L49-L341)

Package Manager Configuration
-----------------------------

The monorepo uses pnpm with specific configuration for dependency management:

### Key Configuration Options

*   **Auto-install peers**: The `autoInstallPeers: true` setting in [pnpm-lock.yaml 4](https://github.com/kriegcloud/beep-effect/blob/b64126f6/pnpm-lock.yaml#L4-L4) automatically installs peer dependencies without requiring explicit installation.
*   **Dependency overrides**: The `pnpm.overrides` section in [package.json 85-289](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L85-L289) enforces specific versions across all packages to ensure consistency.
*   **Only built dependencies**: The `onlyBuiltDependencies` section in [package.json 290-302](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L290-L302) lists native modules that must be built during installation.

**Sources:**[pnpm-lock.yaml 3-10](https://github.com/kriegcloud/beep-effect/blob/b64126f6/pnpm-lock.yaml#L3-L10)[package.json 84-302](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L84-L302)

Common Development Scripts
--------------------------

The root `package.json` provides scripts for common development tasks. These scripts use Turbo for parallel execution across workspace packages:

### Core Development Scripts

| Script | Command | Description |
| --- | --- | --- |
| `dev` | `pnpm dotenvx turbo run dev --concurrency=36` | Start all applications in development mode with hot reload |
| `build` | `pnpm dotenvx turbo run build` | Build all packages and applications for production |
| `check` | `turbo run check` | Run TypeScript type checking across all packages |
| `test` | `turbo run test` | Run test suites using Vitest across all packages |
| `lint` | `pnpm lint:deps && turbo run lint lint:circular` | Run Biome linter and check for circular dependencies |

### Database Scripts

| Script | Command | Description |
| --- | --- | --- |
| `db:generate` | `turbo run db:generate` | Generate TypeScript types from Drizzle schemas |
| `db:migrate` | `pnpm dotenvx turbo run db:migrate` | Run database migrations using Drizzle Kit |
| `db:push` | `pnpm dotenvx turbo run db:push` | Push schema changes to database without migrations |
| `db:studio` | `pnpm dotenvx turbo run db:studio` | Open Drizzle Studio for database visualization |

### Utility Scripts

| Script | Command | Description |
| --- | --- | --- |
| `clean` | `git clean -xdf node_modules .turbo` | Remove root node_modules and Turbo cache |
| `clean:workspaces` | `turbo run clean` | Clean all workspace package build artifacts |
| `bootstrap` | `tsx ./tooling/repo-scripts/src/bootstrap.ts` | Initialize repository with generated files |
| `gen:secrets` | `pnpm dotenvx tsx ./tooling/repo-scripts/src/generate-env-secrets.ts` | Generate secret keys for `.env` files |

**Note:** Scripts prefixed with `pnpm dotenvx` use the `@dotenvx/dotenvx` tool to load environment variables from `.env` files before execution.

**Sources:**[package.json 21-52](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L21-L52)

Build Pipeline Overview
-----------------------

The repository uses a multi-stage build pipeline orchestrated by Turbo:

### Build Process Details

Each package in the monorepo follows a consistent build pattern defined in their respective `package.json` files:

1.   **TypeScript Compilation**: `tsc -b tsconfig.build.json` compiles TypeScript to ESM format in `build/esm/`
2.   **CJS Generation**: Babel transforms ESM output to CommonJS in `build/cjs/` using the `@babel/transform-modules-commonjs` plugin
3.   **Pure Call Annotation**: Babel annotates pure function calls with `/*@__PURE__*/` comments for better tree-shaking

This pattern is visible in [packages/common/schema/package.json 22-26](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/schema/package.json#L22-L26)[packages/common/utils/package.json 22-26](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/utils/package.json#L22-L26) and other workspace packages.

**Sources:**[packages/common/schema/package.json 22-26](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/schema/package.json#L22-L26)[packages/common/utils/package.json 22-26](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/utils/package.json#L22-L26)[package.json 58-82](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L58-L82)

TypeScript Project References
-----------------------------

The repository uses TypeScript project references for incremental compilation and type checking:

The `tsconfig.base.json` defines shared compiler options and path mappings for all packages. Each package references its dependencies using the `references` field, enabling incremental builds and proper dependency ordering.

**Sources:**[tsconfig.base.json 1-343](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.base.json#L1-L343)[tsconfig.json 1-119](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.json#L1-L119)[tsconfig.build.json 1-111](https://github.com/kriegcloud/beep-effect/blob/b64126f6/tsconfig.build.json#L1-L111)[apps/web/tsconfig.json 107-188](https://github.com/kriegcloud/beep-effect/blob/b64126f6/apps/web/tsconfig.json#L107-L188)

Development Workflow
--------------------

### Starting the Development Environment

To start all applications in development mode:

`pnpm dev`
This command:

1.   Loads environment variables from `.env` using `dotenvx`
2.   Runs `turbo run dev --concurrency=36` to start all applications in parallel
3.   Enables hot module reloading for Next.js (web app)
4.   Watches TypeScript files for changes in all packages

Individual applications can be started separately:

```
# Start only the web application
cd apps/web
pnpm dev

# Start only the server application
cd apps/server
pnpm dev
```

**Sources:**[package.json 41](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L41-L41)[apps/web/package.json 9](https://github.com/kriegcloud/beep-effect/blob/b64126f6/apps/web/package.json#L9-L9)

### Running Tests

Execute the test suite across all packages:

`pnpm test`
For coverage reports:

`pnpm coverage`
Tests use Vitest as the test runner, configured with `@effect/vitest` for Effect-specific testing utilities.

**Sources:**[package.json 38-39](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L38-L39)

### Type Checking

Verify TypeScript types without emitting files:

`pnpm check`
This runs `tsc --noEmit` across all workspace packages using Turbo's task orchestration.

**Sources:**[package.json 27](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L27-L27)

Dependency Management
---------------------

### Updating Dependencies

The repository uses `syncpack` to maintain consistent dependency versions across workspace packages:

```
# Check for version mismatches
pnpm lint:deps

# Fix version mismatches
pnpm lint:deps:fix

# Update all dependencies to latest versions
pnpm deps:update
```

The `syncpack` configuration enforces version consistency for dependencies in the `pnpm.overrides` section, excluding specific packages like `@tanstack/react-form` and `@effect/platform-node`.

**Sources:**[package.json 46-48](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L46-L48)

### Adding New Dependencies

When adding dependencies to a workspace package:

1.   Navigate to the package directory: `cd packages/common/schema`
2.   Add the dependency: `pnpm add effect`
3.   Return to root and update lockfile: `pnpm install`

For workspace dependencies, use the `workspace:^` protocol:

```
{
  "dependencies": {
    "@beep/schema": "workspace:^"
  }
}
```

**Sources:**[packages/common/schema/package.json 36-51](https://github.com/kriegcloud/beep-effect/blob/b64126f6/packages/common/schema/package.json#L36-L51)[apps/web/package.json 23-169](https://github.com/kriegcloud/beep-effect/blob/b64126f6/apps/web/package.json#L23-L169)

Verification Checklist
----------------------

After installation, verify the setup by completing the following checks:

*   `pnpm --version` outputs `10.18.0`
*   `pnpm install` completes without errors
*   `pnpm check` shows no TypeScript errors
*   `pnpm lint` runs successfully
*    Environment variables are configured (see [Environment Configuration](https://deepwiki.com/kriegcloud/beep-effect/3.2-environment-configuration))
*    Database is set up and migrations are applied (see [Database Setup](https://deepwiki.com/kriegcloud/beep-effect/3.3-database-setup))

Next Steps
----------

With the repository installed and dependencies resolved, proceed to:

1.   **[Environment Configuration](https://deepwiki.com/kriegcloud/beep-effect/3.2-environment-configuration)**: Configure environment variables for client and server applications
2.   **[Database Setup](https://deepwiki.com/kriegcloud/beep-effect/3.3-database-setup)**: Set up PostgreSQL, run migrations, and initialize the database schema

**Sources:**[package.json 1-312](https://github.com/kriegcloud/beep-effect/blob/b64126f6/package.json#L1-L312)[pnpm-lock.yaml 1-10](https://github.com/kriegcloud/beep-effect/blob/b64126f6/pnpm-lock.yaml#L1-L10)
