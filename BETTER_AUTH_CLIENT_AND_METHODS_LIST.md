# codex resume 0199fa89-06bc-7693-82a8-40ee3d6c504b
> > **SDK status update**  
> `@beep/iam-sdk` now exposes Effect contracts + `*.implementations.ts` wrappers via `@beep/contract` utilities. The former `AuthHandler.make` helpers and `iam` facade are gone. Every “Implementation” task below should be satisfied by wiring the corresponding `Contract.make(...).implement(Effect.fn(...))` handler (for example `SignInImplementations.SignInEmailContract`) through runtime runners and UI surfaces.

## How to use this checklist

Follow the [`BETTER_AUTH_CLIENT_METHOD_PROCESS.md`](BETTER_AUTH_CLIENT_METHOD_PROCESS.md) SOP for the full workflow. For each unchecked method below:

1. **Load documentation context**
   - `context7__resolve-library-id {"libraryName":"better-auth"}`
   - `context7__get-library-docs {"context7CompatibleLibraryID":"/better-auth/better-auth","topic":"<relevant topic>","tokens":800}`
   - `jetbrains__search_in_files_by_text {"projectPath":"/home/elpresidank/YeeBois/projects/beep-effect2","searchText":"\"/<api path>\"","fileMask":"better-auth-api-spec.json","maxUsageCount":3,"timeout":120000}` (returns a focused snippet from the large OpenAPI JSON—no custom scripts needed)
2. **Open the matching domain model** (must precede contract edits)
   - `jetbrains__get_file_text_by_path {"projectPath":"/home/elpresidank/YeeBois/projects/beep-effect2","pathInProject":"packages/iam/domain/src/entities/<Entity>/<Entity>.model.ts"}` or  
     `jetbrains__get_file_text_by_path {"projectPath":"/home/elpresidank/YeeBois/projects/beep-effect2","pathInProject":"packages/shared/domain/src/entities/<Entity>/<Entity>.model.ts"}`
   - Confirm which selectors (`Model.select/insert/update`) power the payloads and note any missing fields that require orchestrator follow-up.
3. **Author / update contracts** using `S.Class` schemas and register them with the appropriate `ContractKit`.
4. **Implement handlers** by calling `ContractName.implement(Effect.fn(function* (payload, { continuation }) { ... }))`, invoke Better Auth through `continuation.run`, and decode results via the same contract schema. Remember to `client.$store.notify("$sessionSignal")` when sessions mutate.
5. **Export everything** via the feature `index.ts`, encode/decode payloads with the same contract schema that the domain model defined, and run `PATH="$HOME/.bun/bin:$PATH" bun run build --filter=@beep/iam-sdk` (plus targeted lint/tests when appropriate). `ParseError` handlers must call `Effect.fail(IamError.match(...))` instead of `Effect.dieMessage`.
6. **Mark progress** by checking off the corresponding items in this file once code, model alignment, and verification are complete.

Implementation work must reuse the helper utilities exported from `@beep/iam-sdk/clients/_internal`—`withFetchOptions`, `addFetchOptions`, `requireData`, and `compact`—together with `Contract.encodePayload` / `Contract.decodeUnknownSuccess` so fetch plumbing, null guards, and schema decoding stay consistent across clusters.

Each method entry below lists canonical references: Better Auth docs, local contract/implementation files, runtime/UI consumers, and expected payload semantics. Add more granular notes inline if a method requires additional guards or cross-slice updates.

### Domain alignment tracker

| Base / Verify | ⬜ | ⬜ | Align with `packages/shared/domain/src/entities/User/User.model.ts` and `packages/iam/domain/src/entities/Verification/Verification.model.ts` before adding new flows. |
| Admin | ⬜ | ⬜ | Use `packages/shared/domain/src/entities/User/User.model.ts`, `packages/iam/domain/src/entities/Member/Member.model.ts`, and log mismatches in `ADMIN_CLIENT_WORKING_NOTES.md`. |
| Api Key | ✅ `packages/iam/domain/src/entities/ApiKey/ApiKey.model.ts` | ✅ Contracts/handlers mirror `ApiKey.Model.select/insert/update` (canonical example—mirror this pattern) | Treat this slice as the reference implementation for future clusters. |
| Anonymous | ⬜ | ⬜ | Confirm guest session fields against `packages/shared/domain/src/entities/User/User.model.ts` and the anonymous session adapters. |
| Device Authorization | ⬜ | ⬜ | Ensure payloads reuse `packages/iam/domain/src/entities/DeviceCode/DeviceCode.model.ts` selectors. |
| OIDC Provider | ⬜ | ⬜ | Derive schemas from `packages/iam/domain/src/entities/OAuthApplication/OAuthApplication.model.ts` and related models. |
| Multi-Session | ⬜ | ⬜ | Reference `packages/iam/domain/src/entities/Session/Session.model.ts` and `DeviceCode` where applicable. |
| Passkey | ✅ | ✅ | Reuse `packages/iam/domain/src/entities/Passkey/Passkey.model.ts` for view/payload fields. |
| Phone Number | ⬜ | ⬜ | Pull phone metadata from `packages/shared/domain/src/entities/User/User.model.ts` and `packages/iam/domain/src/entities/Verification/Verification.model.ts`. |
| Organization (core) | ⬜ | ⬜ | Start from `packages/shared/domain/src/entities/Organization/Organization.model.ts` plus `Member` and `OrganizationRole` models. |
| Organization (teams) | ⬜ | ⬜ | Derive from `packages/iam/domain/src/entities/TeamMember/TeamMember.model.ts` and related organization models. |

Every contract must be derived from the relevant `Model.select/insert/update` selectors under `packages/iam/domain` or
`packages/shared/domain`. Treat the ApiKey slice (`packages/iam/sdk/src/clients/api-key/*`) as the canonical reference:
payload schemas spread `ApiKey.Model.*.fields`, and implementations encode/decode via `ApiKeyContract.*` helpers before
calling Better Auth.

## base
- [x] [`auth.signIn.email`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/basic-usage.mdx) — Email/password sign-in, supports per-call fetch hooks and optional redirect semantics. **Returns:** `BetterFetchResponse` with `data: { redirect: boolean; url?: string; token: string; user: { id; email; name; image?; emailVerified; createdAt; updatedAt } }` on success. **Errors:** `error` is a `BetterFetchError` (`status`, `statusText`, `message`) whose payload carries Better Auth codes like `EMAIL_VERIFICATION_REQUIRED` or `INVALID_CREDENTIALS`.
  - [x] Contract: harden `packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts` so `SignInEmailContract` mirrors redirect + token semantics in https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/basic-usage.mdx and encodes the error codes as tagged unions. References: packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: ensure `packages/iam/ui/src/sign-in/sign-in-email.form.tsx` submits via the runtime client (`packages/runtime/client/src/services/runtime/live-layer.ts`) and updates the `apps/web/src/app/auth/sign-in/page.tsx` flow with success/error handling matching Better Auth. References: packages/iam/ui/src/sign-in/sign-in-email.form.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/basic-usage.mdx.

- [x] [`auth.signUp.email`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/basic-usage.mdx) — Registers a user via email/password and optional callback routing. **Returns:** `BetterFetchResponse` with `data: { token: string | null; user: { id; email; name; image?; emailVerified; createdAt; updatedAt } }`. **Errors:** `error` is `BetterFetchError` with optional `error.code` (for example duplicate email or password policy violations).
  - [x] Contract: complete `packages/iam/sdk/src/clients/sign-up/sign-up.contracts.ts` so `SignUpValue` encodes callback routing, captcha, and optional token semantics from https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/basic-usage.mdx while reusing `SharedEntities.User` schema pieces. References: packages/iam/sdk/src/clients/sign-up/sign-up.contracts.ts, packages/iam/sdk/src/clients/sign-up/sign-up.implementations.ts.
  - [x] Implementation: pipe the contract through `packages/iam/ui/src/sign-up/sign-up-email.form.tsx` and surface success redirects in `apps/web/src/app/auth/sign-up/page.tsx` via the runtime live layer. References: packages/iam/ui/src/sign-up/sign-up-email.form.tsx, apps/web/src/app/auth/sign-up/page.tsx, packages/runtime/client/src/services/runtime/live-layer.ts.

- [x] [`auth.signOut`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/basic-usage.mdx) — Invalidates the active session and propagates store notifications. **Returns:** `BetterFetchResponse` with `data: { success: boolean }`. **Errors:** `error` is `BetterFetchError` (unauthorized session, already signed out) carrying `status`, `statusText`, and `message`.
  - [x] Contract: tighten `packages/iam/sdk/src/clients/sign-out/sign-out.contracts.ts` so the schema captures the success boolean and hooks the Better Auth error codes from https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/basic-usage.mdx. References: packages/iam/sdk/src/clients/sign-out/sign-out.contracts.ts, packages/iam/sdk/src/clients/sign-out/sign-out.implementations.ts.
  - [x] Implementation: route the client through `packages/ui/src/layouts/components/sign-out-button.tsx` (via `useAuthAdapterProvider`) and refresh the dashboard shell in `apps/web/src/app/dashboard/layout.tsx` using the runtime live layer. References: packages/ui/src/layouts/components/sign-out-button.tsx, apps/web/src/app/dashboard/layout.tsx, packages/runtime/client/src/services/runtime/live-layer.ts.

- [x] [`auth.recover.resetPassword`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/authentication/email-password.mdx) — Submits a reset token and new password gathered from the reset form. **Returns:** `BetterFetchResponse` with `data: { status: boolean }`. **Errors:** `error` is `BetterFetchError`; server codes flag expired or invalid tokens and rate limiting.
  - [x] Contract: confirm `ResetPasswordContract` in `packages/iam/sdk/src/clients/recover/recover.contracts.ts` enforces token + new password validation exactly as in https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/authentication/email-password.mdx and exports encoded types for error handling. References: packages/iam/sdk/src/clients/recover/recover.contracts.ts, packages/iam/sdk/src/clients/recover/recover.implementations.ts.
  - [x] Implementation: update `packages/iam/ui/src/recover/reset-password.form.tsx` to submit via the runtime layer and surface toast/navigation from `apps/web/src/app/auth/reset-password/page.tsx`. References: packages/iam/ui/src/recover/reset-password.form.tsx, apps/web/src/app/auth/reset-password/page.tsx, packages/runtime/client/src/services/runtime/live-layer.ts.

- [x] [`auth.recover.requestPasswordReset`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/authentication/email-password.mdx) — Issues a reset link email for an account. **Returns:** `BetterFetchResponse` with `data: { status: boolean; message: string }`. **Errors:** `error` is `BetterFetchError` with payload codes for unknown email, disabled reset, or excessive requests.
  - [x] Contract: update `RequestResetPasswordContract` within `packages/iam/sdk/src/clients/recover/recover.contracts.ts` to cover redirect targets and rate-limit codes described in https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/authentication/email-password.mdx. References: packages/iam/sdk/src/clients/recover/recover.contracts.ts, packages/iam/sdk/src/clients/recover/recover.implementations.ts.
  - [x] Implementation: connect `packages/iam/ui/src/recover/request-reset-password.form.tsx` to the SDK client through `packages/runtime/client/src/services/runtime/live-layer.ts`, returning flash messaging in `apps/web/src/app/auth/request-reset-password/page.tsx`. References: packages/iam/ui/src/recover/request-reset-password.form.tsx, apps/web/src/app/auth/request-reset-password/page.tsx, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/authentication/email-password.mdx.

- [x] [`auth.verify.email.sendVerificationEmail`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/concepts/email.mdx) — Triggers a manual verification email (used on demand or resend flows). **Returns:** `BetterFetchResponse` with `data: { status: boolean }`. **Errors:** `error` is `BetterFetchError` with codes such as email already verified or feature disabled.
  - [x] Contract: extend `SendEmailVerificationContract` inside `packages/iam/sdk/src/clients/verify/verify.contracts.ts` to surface Better Auth status booleans and error codes documented at https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/concepts/email.mdx. References: packages/iam/sdk/src/clients/verify/verify.contracts.ts, packages/iam/sdk/src/clients/verify/verify.implementations.ts.
  - [x] Implementation: add a resend verification handler in `packages/iam/ui/src/verify/components/email-verification-sent.tsx` (or sibling UI) that invokes `VerifyImplementations.SendEmailVerificationContract` via the runtime live layer. References: packages/iam/ui/src/verify/components/email-verification-sent.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/concepts/email.mdx.

- [x] [`auth.verify.email.verifyEmail`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/concepts/email.mdx) — Confirms a verification token gathered from the query string. **Returns:** `BetterFetchResponse` with `data: { status: boolean; user: { id; email; name; image?; emailVerified; createdAt; updatedAt } | null }` (null when auto sign-in is off). **Errors:** `error` is `BetterFetchError` highlighting problems like `INVALID_TOKEN` or `TOKEN_EXPIRED`.
  - [x] Contract: finalize `VerifyEmailContract` in `packages/iam/sdk/src/clients/verify/verify.contracts.ts` so token inputs and nullable user payloads match https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/concepts/email.mdx. References: packages/iam/sdk/src/clients/verify/verify.contracts.ts, packages/iam/sdk/src/clients/verify/verify.implementations.ts.
  - [x] Implementation: build a client-side verifier in `packages/iam/ui/src/verify/components/email-verification-sent.tsx` (or sibling UI) that invokes `VerifyImplementations.VerifyEmailContract` via the runtime live layer. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/verify/index.ts, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/concepts/email.mdx.


## admin
- [x] [`auth.admin.setRole`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-set-role) — Assigns one or more roles to a target account using the access-control rules configured on the admin plugin. **Returns:** `BetterFetchResponse<{ user: { id; email; name; image?; emailVerified; createdAt; updatedAt; role?: string; banned?: boolean | null; banReason?: string | null; banExpires?: Date | null } }>` bringing back the updated profile. **Errors:** `BetterFetchError` with `status 403` (`error.code: "YOU_ARE_NOT_ALLOWED_TO_CHANGE_USERS_ROLE"`) when the caller lacks permission, and `status 404` (`error.code: "USER_NOT_FOUND"`) if the target record is missing.
  - [x] Contract: model role updates in `packages/iam/sdk/src/clients/admin/admin.contracts.ts` (new `AdminSetRoleContract`) with enums for allowed roles per https://www.better-auth.com/docs/plugins/admin#api-method-admin-set-role and reuse shared user schemas. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/clients/admin/admin.implementations.ts.
  - [x] Implementation: build a dashboard form (for example `packages/iam/ui/src/admin/users-set-role.form.tsx`) that invokes the runtime via `makeRunClientPromise` similar to `packages/iam/ui/src/sign-in/sign-in.view.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-set-role.

- [x] [`auth.admin.getUser`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-get-user) — Fetches a single user by identifier, enforcing admin access checks. **Returns:** `BetterFetchResponse<{ user: { id; email; emailVerified; name; image?; createdAt; updatedAt; role?: string; banned?: boolean | null; banReason?: string | null; banExpires?: Date | null } }>` with the enriched user payload. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_GET_USER"`) or `status 404` with `error.code: "USER_NOT_FOUND"`.
  - [x] Contract: define `AdminGetUserContract` (request id + response typing) in `packages/iam/sdk/src/clients/admin/admin.contracts.ts` following https://www.better-auth.com/docs/plugins/admin#api-method-admin-get-user and the `BetterFetchResponse` user shape. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/shared/domain/src/entities.ts.
  - [x] Implementation: expose a runtime-powered fetcher for the admin user detail view (e.g. `apps/web/src/app/dashboard/admin/users/[userId]/page.tsx`) using a hook in `packages/iam/ui/src/admin/use-admin-user.ts`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-get-user.

- [x] [`auth.admin.createUser`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-create-user) — Creates a credentialed user plus optional additional fields, hashing the supplied password and provisioning the credential account. **Returns:** `BetterFetchResponse<{ user: { id; email; name; emailVerified; createdAt; updatedAt; role?: string } }>` containing the inserted record. **Errors:** `status 401` when called without an authenticated session, `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_CREATE_USERS"`), `status 400` (`"USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL"`), and `status 500` (`"FAILED_TO_CREATE_USER"`).
  - [x] Contract: capture admin create-user payload (password + optional role metadata) in `packages/iam/sdk/src/clients/admin/admin.contracts.ts`, reusing `SignUpValue` transforms where possible per https://www.better-auth.com/docs/plugins/admin#api-method-admin-create-user. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/clients/sign-up/sign-up.contracts.ts.
  - [x] Implementation: provide an admin-only creation form (e.g. `packages/iam/ui/src/admin/create-user.form.tsx`) using the runtime hook pattern from `packages/iam/ui/src/sign-up/sign-up.view.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-up/sign-up.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-create-user.

- [x] [`auth.admin.updateUser`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-update-user) — Applies partial updates to a user (including role reassignment) respecting schema guards. **Returns:** `BetterFetchResponse<{ user: { id; email; name; image?; emailVerified; createdAt; updatedAt; role?: string; banned?: boolean | null; banReason?: string | null; banExpires?: Date | null } }>` echoing the persisted changes. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_UPDATE_USERS"`), `status 400` (`"NO_DATA_TO_UPDATE"`), plus adapter-level errors for invalid payload.
  - [x] Contract: add a partial-update schema (`AdminUpdateUserContract`) under `packages/iam/sdk/src/clients/admin/admin.contracts.ts` that enforces at least one field and respects Better Auth enum guards. References: https://www.better-auth.com/docs/plugins/admin#api-method-admin-update-user, packages/iam/sdk/src/clients/admin/admin.contracts.ts.
  - [x] Implementation: embed the contract into an edit form (e.g. `packages/iam/ui/src/admin/update-user.form.tsx`) powering a dashboard route such as `apps/web/src/app/dashboard/admin/users/[userId]/edit/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-update-user.

- [x] [`auth.admin.listUsers`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-list-users) — Paginates users with filtering, search, and sort controls. **Returns:** `BetterFetchResponse<{ users: Array<{ id; email; name; role?: string; banned?: boolean | null; createdAt; updatedAt }>; total: number; limit?: number; offset?: number }>`; empty arrays are returned when the adapter throws. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_LIST_USERS"`).
  - [x] Contract: describe filter/search params and collection payloads within `packages/iam/sdk/src/clients/admin/admin.contracts.ts` so we can parse pagination metadata from https://www.better-auth.com/docs/plugins/admin#api-method-admin-list-users. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: create an admin users table hook (e.g. `packages/iam/ui/src/admin/use-admin-users.ts`) that queries via runtime and drives a view like `apps/web/src/app/dashboard/admin/users/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-list-users.

- [x] [`auth.admin.listUserSessions`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-list-user-sessions) — Lists active sessions for a user id to support revocation UX. **Returns:** `BetterFetchResponse<{ sessions: Array<{ id; token; userId; createdAt; updatedAt; expiresAt; impersonatedBy?: string | null }> }>` from the session adapter. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_LIST_USERS_SESSIONS"`).
  - [x] Contract: encode the userId input and session result array in `packages/iam/sdk/src/clients/admin/admin.contracts.ts` per https://www.better-auth.com/docs/plugins/admin#api-method-admin-list-user-sessions. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/tables/src/_check.ts.
  - [x] Implementation: surface a panel component (e.g. `packages/iam/ui/src/admin/user-sessions.panel.tsx`) that renders session data and plugs into the runtime fetcher for an admin profile route. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-list-user-sessions.

- [x] [`auth.admin.unbanUser`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-unban-user) — Clears ban metadata and re-enables the user. **Returns:** `BetterFetchResponse<{ user: { id; email; name; image?; emailVerified; createdAt; updatedAt; role?: string; banned: false; banReason: null; banExpires: null } }>` reflecting the unban. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_BAN_USERS"`).
  - [x] Contract: add `AdminUnbanUserContract` (user id + optimistic payload) to `packages/iam/sdk/src/clients/admin/admin.contracts.ts`, aligning field optionality with https://www.better-auth.com/docs/plugins/admin#api-method-admin-unban-user. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: wire an "Unban" action in `packages/iam/ui/src/admin/user-actions.tsx` (new) that calls the runtime and invalidates cached `getUser` responses. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-unban-user.

- [x] [`auth.admin.banUser`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-ban-user) — Marks the user as banned, optionally setting a reason and expiry, and purges their sessions. **Returns:** `BetterFetchResponse<{ user: { id; email; name; image?; emailVerified; createdAt; updatedAt; role?: string; banned: true; banReason?: string | null; banExpires?: Date | null } }>` post-update. **Errors:** `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_BAN_USERS"`), `status 404` (`"USER_NOT_FOUND"`), and `status 400` (`"YOU_CANNOT_BAN_YOURSELF"`).
  - [x] Contract: capture ban reason + expiry inputs in `packages/iam/sdk/src/clients/admin/admin.contracts.ts`, ensuring schema guards forbid self-ban as described at https://www.better-auth.com/docs/plugins/admin#api-method-admin-ban-user. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/clients/admin/admin.implementations.ts.
  - [x] Implementation: implement a ban dialog (e.g. `packages/iam/ui/src/admin/ban-user.dialog.tsx`) that collects inputs and runs the runtime mutation, invalidating list + detail queries. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-ban-user.

- [x] [`auth.admin.impersonateUser`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-impersonate-user) — Starts an impersonation session for a target user, minting a short-lived session and swapping auth cookies. **Returns:** `BetterFetchResponse<{ session: { id; token; userId; createdAt; updatedAt; expiresAt; impersonatedBy?: string }; user: { id; email; name; role?: string } }>` enabling the admin UI to transition to the impersonated context. **Errors:** `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_IMPERSONATE_USERS"`), `status 404` (`"USER_NOT_FOUND"`), and `status 500` (`"FAILED_TO_CREATE_USER"`) when the session cannot be created.
  - [x] Contract: author `AdminImpersonateUserContract` in `packages/iam/sdk/src/clients/admin/admin.contracts.ts` defining the target user id and response tuple per https://www.better-auth.com/docs/plugins/admin#api-method-admin-impersonate-user. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: add an impersonation handler (e.g. `packages/iam/ui/src/admin/impersonate-user.button.tsx`) that applies the runtime mutation and refreshes router/session context. References: packages/runtime/client/src/services/runtime/live-layer.ts, apps/web/src/app/dashboard/layout.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-impersonate-user.

- [x] [`auth.admin.stopImpersonating`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-stop-impersonating) — Restores the original admin session using the stored `admin_session` cookie. **Returns:** `BetterFetchResponse<{ session: { id; token; userId; createdAt; updatedAt; expiresAt; impersonatedBy?: string | null }; user: { id; email; name; role?: string } }>` representing the reinstated admin session bundle. **Errors:** `status 401` when no active session, `status 400` when not impersonating, and `status 500` for missing admin session artifacts.
  - [x] Contract: define `AdminStopImpersonatingContract` in `packages/iam/sdk/src/clients/admin/admin.contracts.ts` capturing the session bundle from https://www.better-auth.com/docs/plugins/admin#api-method-admin-stop-impersonating. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/clients/admin/admin.implementations.ts.
  - [x] Implementation: add a "Return to admin" control (e.g. `packages/iam/ui/src/admin/stop-impersonating.button.tsx`) that calls the runtime and refreshes router/session contexts in `apps/web/src/app/dashboard/layout.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, apps/web/src/app/dashboard/layout.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-stop-impersonating.

- [x] [`auth.admin.revokeUserSession`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-session) — Deletes a single session token for housekeeping. **Returns:** `BetterFetchResponse<{ success: true }>` on completion. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS"`).
  - [x] Contract: add a revoke-single-session schema to `packages/iam/sdk/src/clients/admin/admin.contracts.ts` capturing `userId` + `sessionId` arguments per https://www.better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-session. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/clients/admin/admin.implementations.ts.
  - [x] Implementation: integrate a row action into `packages/iam/ui/src/admin/user-sessions.panel.tsx` that calls the runtime mutation and invalidates `listUserSessions`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-session.

- [x] [`auth.admin.revokeUserSessions`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-sessions) — Bulk deletes all sessions for a user id. **Returns:** `BetterFetchResponse<{ success: true }>` once the adapter removes the sessions. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS"`).
  - [x] Contract: describe the bulk revoke payload in `packages/iam/sdk/src/clients/admin/admin.contracts.ts` (user id + audit metadata) per https://www.better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-sessions. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: provide a destructive action in `packages/iam/ui/src/admin/user-sessions.panel.tsx` for "Revoke all" that routes through runtime and refreshes session list queries. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-sessions.

- [x] [`auth.admin.removeUser`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-remove-user) — Permanently deletes a user and cascading state. **Returns:** `BetterFetchResponse<{ success: true }>` to confirm deletion. **Errors:** `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_DELETE_USERS"`), `status 400` (`"YOU_CANNOT_REMOVE_YOURSELF"`), and `status 404` when the user record does not exist.
  - [x] Contract: create `AdminRemoveUserContract` in `packages/iam/sdk/src/clients/admin/admin.contracts.ts`, guarding against self-deletion and mapping success boolean from https://www.better-auth.com/docs/plugins/admin#api-method-admin-remove-user. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: add a destructive confirmation flow (e.g. `packages/iam/ui/src/admin/remove-user.dialog.tsx`) tied into runtime and invalidating admin lists after success. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-remove-user.

- [x] [`auth.admin.setUserPassword`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-set-user-password) — Replaces a user’s credential password by hashing the new secret and updating the adapter. **Returns:** `BetterFetchResponse<{ status: true }>` on success. **Errors:** `BetterFetchError` with `status 403` (`"YOU_ARE_NOT_ALLOWED_TO_SET_USERS_PASSWORD"`).
  - [x] Contract: specify the new password + confirmation schema inside `packages/iam/sdk/src/clients/admin/admin.contracts.ts`, mirroring the password constraints in https://www.better-auth.com/docs/plugins/admin#api-method-admin-set-user-password. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/iam/sdk/src/clients/recover/recover.contracts.ts.
  - [x] Implementation: create a password reset form (e.g. `packages/iam/ui/src/admin/reset-user-password.form.tsx`) that applies the runtime mutation and reports success via toast/UI. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/recover/reset-password.form.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-set-user-password.

- [x] [`auth.admin.hasPermission`](https://www.better-auth.com/docs/plugins/admin#api-method-admin-has-permission) — Evaluates whether a given user or role satisfies a permission set, supporting both single and multi-resource checks. **Returns:** `BetterFetchResponse<{ success: boolean; error: string | null }>` communicating the check result. **Errors:** `status 400` for missing permissions payload or when the subject cannot be resolved, `status 401` for unauthenticated calls without explicit subject, plus plugin `error.code` values inherited from `ADMIN_ERROR_CODES`.
  - [x] Contract: encode permission sets, subjects, and optional context in `packages/iam/sdk/src/clients/admin/admin.contracts.ts` according to https://www.better-auth.com/docs/plugins/admin#api-method-admin-has-permission. References: packages/iam/sdk/src/clients/admin/admin.contracts.ts, packages/ui/src/providers/AuthAdapterProvider.tsx.
  - [x] Implementation: wrap the runtime call in a reusable hook (e.g. `packages/iam/ui/src/admin/use-admin-permission.ts`) for guarding dashboard UI, similar to `makeRunClientPromise` usage in `packages/iam/ui/src/sign-in/sign-in.view.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/admin#api-method-admin-has-permission.


## anonymous
- [x] [`auth.signIn.anonymous`](https://www.better-auth.com/docs/plugins/anonymous) — Creates a temporary guest user and session, optionally running `onLinkAccount` before promotion. **Returns:** `BetterFetchResponse<{ token: string; user: { id; email; emailVerified; name; createdAt; updatedAt } } | null>`; `null` indicates an after-hook prevented linking. **Errors:** `BetterFetchError` with plugin codes such as `FAILED_TO_CREATE_USER`, `COULD_NOT_CREATE_SESSION`, or `ANONYMOUS_USERS_CANNOT_SIGN_IN_AGAIN_ANONYMOUSLY`.
  - [x] Contract: implement `AnonymousSignInContract` in `packages/iam/sdk/src/clients/anonymous/anonymous.contracts.ts` mirroring token+user/null semantics from https://www.better-auth.com/docs/plugins/anonymous. References: packages/iam/sdk/src/clients/anonymous/anonymous.contracts.ts, packages/iam/sdk/src/clients/anonymous/anonymous.implementations.ts.
  - [x] Implementation: add a guest sign-in CTA (e.g. `packages/iam/ui/src/sign-in/sign-in-anonymous.button.tsx`) that calls the runtime similar to other flows in `packages/iam/ui/src/sign-in/sign-in.view.tsx`. References: packages/iam/ui/src/sign-in/sign-in.view.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://www.better-auth.com/docs/plugins/anonymous.


## api-key
- This slice is fully aligned with `ApiKey.Model.select/insert/update` (see `packages/iam/sdk/src/clients/api-key/*`). Treat it as the canonical reference when wiring new contracts or handlers—mirror the schema spreads, JSON permission handling, and `Effect.catchTags` patterns.
- [x] [`auth.apiKey.create`](https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-create) — Mints a personal API key with optional metadata, permissions, expiry, and refill rules. **Returns:** `BetterFetchResponse<{ key: string; id: string; name: string | null; prefix: string | null; start: string | null; userId: string; enabled: boolean; rateLimitEnabled: boolean; rateLimitTimeWindow: number | null; rateLimitMax: number | null; refillAmount: number | null; refillInterval: number | null; requestCount: number; remaining: number | null; lastRequest: Date | null; lastRefillAt: Date | null; expiresAt: Date | null; metadata: Record<string, any> | null; permissions: Record<string, string[]> | null; createdAt: Date; updatedAt: Date }>` (the plain-text `key` is only present here). **Errors:** `BetterFetchError` with codes like `INVALID_METADATA_TYPE`, `INVALID_PREFIX_LENGTH`, `NAME_REQUIRED`, or `USER_BANNED`.
  - [x] Contract: craft an `ApiKeyCreateContract` in `packages/iam/sdk/src/clients/api-key/api-key.contracts.ts` covering metadata, rate-limit, and permission options per https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-create. References: packages/iam/sdk/src/clients/api-key/api-key.contracts.ts, packages/iam/sdk/src/clients/api-key/api-key.implementations.ts.
  - [x] Implementation: prepare a creation form in `packages/iam/ui/src/api-key/api-key-create.form.tsx` that uses the runtime mutation and displays the plaintext key safely in `apps/web/src/app/dashboard/api-keys/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-create.

- [x] [`auth.apiKey.get`](https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-get) — Retrieves an API key the current user owns, omitting the secret value. **Returns:** `BetterFetchResponse<{ id: string; name: string | null; prefix: string | null; start: string | null; userId: string; enabled: boolean; rateLimitEnabled: boolean; rateLimitTimeWindow: number | null; rateLimitMax: number | null; refillAmount: number | null; refillInterval: number | null; requestCount: number; remaining: number | null; lastRequest: Date | null; lastRefillAt: Date | null; expiresAt: Date | null; metadata: Record<string, any> | null; permissions: Record<string, string[]> | null; createdAt: Date; updatedAt: Date }>` for audit UI. **Errors:** `BetterFetchError` carrying codes such as `KEY_NOT_FOUND`, `UNAUTHORIZED_SESSION`, or `KEY_DISABLED`.
  - [x] Contract: add `ApiKeyGetContract` to `packages/iam/sdk/src/clients/api-key/api-key.contracts.ts` defining identifier input and response typing per https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-get. References: packages/iam/sdk/src/clients/api-key/api-key.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: expose a detail hook (e.g. `packages/iam/ui/src/api-key/use-api-key.ts`) that queries via runtime for dashboards like `apps/web/src/app/dashboard/api-keys/[id]/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-get.

- [x] [`auth.apiKey.update`](https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-update) — Patches an API key’s metadata, rate limits, or enablement flags. **Returns:** `BetterFetchResponse<{ id: string; name: string | null; prefix: string | null; start: string | null; userId: string; enabled: boolean; rateLimitEnabled: boolean; rateLimitTimeWindow: number | null; rateLimitMax: number | null; refillAmount: number | null; refillInterval: number | null; requestCount: number; remaining: number | null; lastRequest: Date | null; lastRefillAt: Date | null; expiresAt: Date | null; metadata: Record<string, any> | null; permissions: Record<string, string[]> | null; createdAt: Date; updatedAt: Date }>` reflecting persisted values. **Errors:** `BetterFetchError` with codes like `KEY_NOT_FOUND`, `NO_VALUES_TO_UPDATE`, `INVALID_METADATA_TYPE`, or `RATE_LIMIT_EXCEEDED`.
  - [x] Contract: represent partial update fields (including toggles) in `packages/iam/sdk/src/clients/api-key/api-key.contracts.ts` per https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-update. References: packages/iam/sdk/src/clients/api-key/api-key.contracts.ts, packages/iam/sdk/src/clients/api-key/api-key.implementations.ts.
  - [x] Implementation: add an edit drawer (`packages/iam/ui/src/api-key/api-key-update.form.tsx`) that diffs form state and submits through runtime, invalidating `list`/`get` queries. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-update.

- [x] [`auth.apiKey.delete`](https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-delete) — Deletes an API key by identifier. **Returns:** `BetterFetchResponse<{ success: boolean }>` confirming removal. **Errors:** `BetterFetchError` with codes such as `KEY_NOT_FOUND` or `UNAUTHORIZED_SESSION`.
  - [x] Contract: create `ApiKeyDeleteContract` in `packages/iam/sdk/src/clients/api-key/api-key.contracts.ts` with `id` validation and success boolean per https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-delete. References: packages/iam/sdk/src/clients/api-key/api-key.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: surface delete affordances in `packages/iam/ui/src/api-key/api-key-row-actions.tsx` that call the runtime and optimistically update `list`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-delete.

- [x] [`auth.apiKey.list`](https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-list) — Lists all API keys for the authenticated user together with usage telemetry. **Returns:** `BetterFetchResponse<Array<{ id: string; name: string | null; prefix: string | null; start: string | null; userId: string; enabled: boolean; rateLimitEnabled: boolean; rateLimitTimeWindow: number | null; rateLimitMax: number | null; refillAmount: number | null; refillInterval: number | null; requestCount: number; remaining: number | null; lastRequest: Date | null; lastRefillAt: Date | null; expiresAt: Date | null; metadata: Record<string, any> | null; permissions: Record<string, string[]> | null; createdAt: Date; updatedAt: Date }>>`. **Errors:** `BetterFetchError` surfacing codes like `UNAUTHORIZED_SESSION`, `USER_BANNED`, or `KEY_DISABLED`.
  - [x] Contract: encode pagination/filter options (if any) and list response structure in `packages/iam/sdk/src/clients/api-key/api-key.contracts.ts` based on https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-list. References: packages/iam/sdk/src/clients/api-key/api-key.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: build a TanStack Query hook (e.g. `packages/iam/ui/src/api-key/use-api-keys.ts`) that powers an API key table in `apps/web/src/app/dashboard/api-keys/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/api-key#api-method-api-key-list.

## device-authorization
- [x] [`auth.device.code`](https://www.better-auth.com/docs/plugins/device-authorization) — Starts the OAuth 2.0 device flow by minting device/user codes alongside verification URLs. **Returns:** `BetterFetchResponse<{ device_code: string; user_code: string; verification_uri: string; verification_uri_complete: string; expires_in: number; interval: number }>` for the polling client. **Errors:** `BetterFetchError` with OAuth errors like `invalid_request` or `invalid_client`, plus plugin codes such as `AUTHENTICATION_REQUIRED`.
  - [x] Contract: encode device authorization start parameters + response timers within `packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts` per https://www.better-auth.com/docs/plugins/device-authorization. References: packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts, packages/iam/sdk/src/clients/device-authorization/device-authorization.implementations.ts.
  - [x] Implementation: implement a "Start device flow" UI (e.g. `packages/iam/ui/src/device/device-code.form.tsx`) that surfaces codes inside an `apps/web/src/app/auth/device/start/page.tsx` screen using the runtime hook. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/device-authorization.

- [x] [`auth.device.token`](https://www.better-auth.com/docs/plugins/device-authorization) — Polling client exchanges an approved device code for session-backed tokens. **Returns:** `BetterFetchResponse<{ access_token: string; token_type: string; expires_in: number; scope: string; refresh_token?: string | null; id_token?: string | null }>`; refresh/token fields reflect plugin configuration. **Errors:** `BetterFetchError` emitting OAuth errors (`authorization_pending`, `slow_down`, `expired_token`, `access_denied`, `invalid_grant`).
  - [x] Contract: represent polling payload and success tokens inside `packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts` with error union types from https://www.better-auth.com/docs/plugins/device-authorization. References: packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: create a polling hook `packages/iam/ui/src/device/use-device-token.ts` that integrates with runtime and updates session state in `apps/web/src/app/auth/device/poll/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/ui/src/providers/AuthAdapterProvider.tsx, https://www.better-auth.com/docs/plugins/device-authorization.

- [x] [`auth.device`](https://www.better-auth.com/docs/plugins/device-authorization) — Checks the status of a device authorization using the short `user_code`. **Returns:** `BetterFetchResponse<{ user_code: string; status: string }>` describing whether the request is pending, approved, or denied. **Errors:** `BetterFetchError` with validation failures like `invalid_request` or `INVALID_USER_CODE`.
  - [x] Contract: bake status polling schema (`DeviceStatusContract`) into `packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts` leveraging enums for statuses from https://www.better-auth.com/docs/plugins/device-authorization. References: packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts, packages/iam/sdk/src/clients/device-authorization/device-authorization.implementations.ts.
  - [x] Implementation: feed status checks into a verification UI (e.g. `packages/iam/ui/src/device/device-status.card.tsx`) that updates the `apps/web/src/app/auth/device/verify/page.tsx` experience. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/device-authorization.

- [x] [`auth.device.approve`](https://www.better-auth.com/docs/plugins/device-authorization) — Approves the device request while the user is on the verification page and links it to their session. **Returns:** `BetterFetchResponse<{ success: boolean }>` signalling the authorization finished. **Errors:** `BetterFetchError` carrying codes such as `INVALID_DEVICE_CODE`, `DEVICE_CODE_ALREADY_PROCESSED`, or `EXPIRED_DEVICE_CODE`.
  - [x] Contract: add `DeviceApproveContract` in `packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts` encapsulating approval tokens and success boolean outlined at https://www.better-auth.com/docs/plugins/device-authorization. References: packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: supply an approval form `packages/iam/ui/src/device/device-approve.form.tsx` for the verification page that calls runtime and handles optimistic states. References: packages/runtime/client/src/services/runtime/live-layer.ts, apps/web/src/app/auth/device/verify/page.tsx, https://www.better-auth.com/docs/plugins/device-authorization.

- [x] [`auth.device.deny`](https://www.better-auth.com/docs/plugins/device-authorization) — Rejects a device authorization attempt for the supplied `userCode`. **Returns:** `BetterFetchResponse<{ success: boolean }>` acknowledging the denial. **Errors:** `BetterFetchError` with codes like `INVALID_DEVICE_CODE` or `EXPIRED_DEVICE_CODE`.
  - [x] Contract: create `DeviceDenyContract` in `packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts` mirroring the denial payload from https://www.better-auth.com/docs/plugins/device-authorization. References: packages/iam/sdk/src/clients/device-authorization/device-authorization.contracts.ts, packages/iam/sdk/src/clients/device-authorization/device-authorization.implementations.ts.
  - [x] Implementation: add a denial control to the verification UI (e.g. `packages/iam/ui/src/device/device-deny.button.tsx`) that routes through runtime and reflects denial state. References: packages/runtime/client/src/services/runtime-live-layer.ts, apps/web/src/app/auth/device/verify/page.tsx, https://www.better-auth.com/docs/plugins/device-authorization.


## generic-oauth
- [ ] [`auth.signIn.oauth2`](https://www.better-auth.com/docs/plugins/generic-oauth#api-method-sign-in-oauth2) — Initiates the configured OAuth2/OIDC authorization-code flow, returning a provider redirect URL and persisting state for the callback. **Returns:** `BetterFetchResponse<{ url: string; redirect: boolean }>` where `redirect` toggles whether the caller should navigate immediately. **Errors:** `BetterFetchError` (typically `status: 400`) carrying `error.code` values such as `INVALID_OAUTH_CONFIGURATION` or messages like `No config found for provider <id>`; upstream discovery failures surface the provider HTTP status and message.
  - [ ] Contract: add `OAuthSignInContract` to `packages/iam/sdk/src/clients/oauth/oauth.contracts.ts` capturing provider ids and redirect flags from https://www.better-auth.com/docs/plugins/generic-oauth#api-method-sign-in-oauth2. References: packages/iam/sdk/src/clients/oauth/oauth.contracts.ts, packages/iam/sdk/src/clients/oauth/oauth.implementations.ts.
  - [ ] Implementation: extend `packages/iam/ui/src/sign-in/sign-in-social.tsx` to call the runtime handler and route to `url`, coordinating with `packages/runtime/client/src/services/runtime/live-layer.ts`. References: packages/iam/ui/src/sign-in/sign-in.view.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://www.better-auth.com/docs/plugins/generic-oauth#api-method-sign-in-oauth2.

- [ ] [`auth.oauth2.link`](https://www.better-auth.com/docs/plugins/generic-oauth#api-method-oauth2-link) — Generates an OAuth2 authorization URL to attach an external account to the active session, encoding callback targets and returning the redirect directive. **Returns:** `BetterFetchResponse<{ url: string; redirect: true }>`; the client should follow `url` to complete linking. **Errors:** `BetterFetchError` with `status` codes such as `401` (no session via `sessionMiddleware`), `404` with payload `PROVIDER_NOT_FOUND`, or `400` for `INVALID_OAUTH_CONFIGURATION`; discovery fetch failures bubble up provider HTTP statuses.
  - [ ] Contract: model account-link payloads inside `packages/iam/sdk/src/clients/oauth/oauth.contracts.ts` (provider id + return url) following https://www.better-auth.com/docs/plugins/generic-oauth#api-method-oauth2-link. References: packages/iam/sdk/src/clients/oauth/oauth.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [ ] Implementation: expose a "Link provider" action in settings (e.g. `packages/iam/ui/src/account/social-link.button.tsx`) that triggers the runtime call and redirects to `url`. References: packages/ui/src/layouts/components/account-drawer.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://www.better-auth.com/docs/plugins/generic-oauth#api-method-oauth2-link.


## multi-session
- [x] [`auth.multiSession.listDeviceSessions`](https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-list-device-sessions) — Returns every device session tied to the signed-in user for session management dashboards. **Returns:** `BetterFetchResponse<Array<{ session: { id; token; userId; createdAt; updatedAt; expiresAt; ipAddress?: string | null; userAgent?: string | null }; user: { id; email; emailVerified; name; image?; createdAt; updatedAt } }>>`. **Errors:** `BetterFetchError` with `status 401/403` when the caller lacks a session (plugin code `INVALID_SESSION_TOKEN` when the cookie token fails validation).
  - [x] Contract: implement `MultiSessionListContract` inside `packages/iam/sdk/src/clients/multi-session/multi-session.contracts.ts` mirroring the array payload from https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-list-device-sessions. References: packages/iam/sdk/src/clients/multi-session/multi-session.contracts.ts, packages/iam/sdk/src/clients/multi-session/multi-session.implementations.ts.
  - [x] Implementation: build an account security table (`packages/iam/ui/src/account/device-sessions.table.tsx`) that fetches via runtime and renders in `apps/web/src/app/dashboard/page.tsx` or settings. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-list-device-sessions.

- [x] [`auth.multiSession.setActive`](https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-set-active) — Switches the active session token to the provided device session, refreshing cookies. **Returns:** `BetterFetchResponse<{ session: { id; token; userId; createdAt; updatedAt; expiresAt; ipAddress?: string | null; userAgent?: string | null }; user: { id; email; emailVerified; name; image?; createdAt; updatedAt } }>` representing the newly active session. **Errors:** `BetterFetchError` with `status 400` (`error.code: "INVALID_SESSION_TOKEN"`) when the token is unknown, plus 401 on unauthenticated requests.
  - [x] Contract: encode the switch payload + response tuple inside `packages/iam/sdk/src/clients/multi-session/multi-session.contracts.ts` per https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-set-active. References: packages/iam/sdk/src/clients/multi-session/multi-session.contracts.ts, packages/iam/sdk/src/clients/multi-session/multi-session.implementations.ts.
  - [x] Implementation: add a "Make active" action to `packages/iam/ui/src/account/device-sessions.table.tsx` that invokes runtime and refreshes session context via `packages/ui/src/providers/AuthAdapterProvider.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/ui/src/providers/AuthAdapterProvider.tsx, https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-set-active.

- [x] [`auth.multiSession.revoke`](https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-revoke) — Revokes a specific device session, typically from profile security settings. **Returns:** `BetterFetchResponse<{ status: boolean }>` indicating revocation success. **Errors:** `BetterFetchError` with `status 400` (`"INVALID_SESSION_TOKEN"`) for unknown tokens and 401/403 for unauthorized callers.
  - [x] Contract: create `MultiSessionRevokeContract` within `packages/iam/sdk/src/clients/multi-session/multi-session.contracts.ts` specifying the session token and success flag from https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-revoke. References: packages/iam/sdk/src/clients/multi-session/multi-session.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: add a revoke action in `packages/iam/ui/src/account/device-sessions.table.tsx` that calls runtime and prunes the list optimistically. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/multi-session#api-method-multi-session-revoke.

## oidc-provider
- [x] [`auth.oauth2.authorize`](https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-authorize) — Handles the authorization request and returns either a redirect response or `{ redirect: boolean; url: string }` for manual navigation. **Returns:** `BetterFetchResponse<Response | { redirect: boolean; url: string }>` depending on environment. **Errors:** `BetterFetchError` with OAuth codes like `invalid_request`, `unauthorized_client`, or `access_denied`.
  - [x] Contract: formalize request query + redirect payload in `packages/iam/sdk/src/clients/oidc/oidc.contracts.ts` per https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-authorize. References: packages/iam/sdk/src/clients/oidc/oidc.contracts.ts, packages/iam/sdk/src/clients/oidc/oidc.implementations.ts.
  - [x] Implementation: add an API route or server handler in `apps/server/src/server.ts` that delegates to the runtime authorize call and responds with Next.js/Effect `Response`. References: packages/runtime/server/src/server-runtime.ts, apps/web/src/app/api/oauth2/authorize/route.ts, https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-authorize.

- [x] [`auth.oauth2.consent`](https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-consent) — Submits the user’s consent decision for the pending authorization code flow. **Returns:** `BetterFetchResponse<{ redirectURI: string }>` to resume the OAuth redirect. **Errors:** `BetterFetchError` featuring codes such as `CONSENT_SESSION_NOT_FOUND` or `CONSENT_ALREADY_PROCESSED`, alongside 401/403 for missing sessions.
  - [x] Contract: encode consent decision + optional scope selections in `packages/iam/sdk/src/clients/oidc/oidc.contracts.ts` per https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-consent. References: packages/iam/sdk/src/clients/oidc/oidc.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: build a consent UI (`packages/iam/ui/src/oidc/consent.form.tsx`) rendered from `apps/web/src/app/oauth2/consent/page.tsx` that posts to the runtime and redirects to `redirectURI`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-consent.

- [x] [`auth.oauth2.token`](https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-token) — Exchanges an authorization code or refresh token for Better Auth tokens. **Returns:** `BetterFetchResponse<{ access_token: string; token_type: string; expires_in: number; refresh_token?: string | null; scope: string; id_token?: string | null }>` depending on grant type. **Errors:** `BetterFetchError` with standard OAuth error payloads (`invalid_grant`, `invalid_client`, `unsupported_grant_type`, `invalid_scope`, `unauthorized_client`).
  - [x] Contract: define `OidcTokenContract` (grant_type-specific payloads + response) in `packages/iam/sdk/src/clients/oidc/oidc.contracts.ts` using enums from https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-token. References: packages/iam/sdk/src/clients/oidc/oidc.contracts.ts, packages/iam/sdk/src/clients/oidc/oidc.implementations.ts.
  - [x] Implementation: wire a server mutation in `apps/web/src/app/api/oauth2/token/route.ts` that calls the runtime layer and returns proper OAuth responses. References: packages/runtime/server/src/server-runtime.ts, apps/server/src/server.ts, https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-token.

- [x] [`auth.oauth2.userinfo`](https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-userinfo) — Returns OpenID Connect user claims for the supplied bearer token. **Returns:** `BetterFetchResponse<{ sub: string; email?: string; email_verified?: boolean; name?: string; picture?: string | null; given_name?: string; family_name?: string }>` filtered by granted scopes. **Errors:** `BetterFetchError` with `status 401` (`WWW-Authenticate` header set) for invalid or missing access tokens.
  - [x] Contract: map the claims payload inside `packages/iam/sdk/src/clients/oidc/oidc.contracts.ts` aligning with scope filtering in https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-userinfo. References: packages/iam/sdk/src/clients/oidc/oidc.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: expose a protected API handler `apps/web/src/app/api/oauth2/userinfo/route.ts` that validates bearer tokens via runtime and returns JSON per spec. References: packages/runtime/server/src/server-runtime.ts, apps/server/src/server.ts, https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-userinfo.

- [x] [`auth.oauth2.register`](https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-register) — Implements dynamic client registration. **Returns:** `BetterFetchResponse<{ client_id: string; client_secret?: string; client_id_issued_at: number; client_secret_expires_at: number; redirect_uris: string[]; grant_types: string[]; response_types: string[]; client_name?: string; client_uri?: string; logo_uri?: string; scope?: string; contacts?: string[]; tos_uri?: string; policy_uri?: string; jwks_uri?: string; jwks?: Record<string, any>; metadata?: Record<string, any> }>` representing the registered client. **Errors:** `BetterFetchError` describing validation failures (invalid redirect URI, unsupported grant type, registration disabled) with HTTP 400 details.
  - [x] Contract: extend `packages/iam/sdk/src/clients/oidc/oidc.contracts.ts` with `OidcDynamicRegistrationContract` covering incoming metadata + response fields from https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-register. References: packages/iam/sdk/src/clients/oidc/oidc.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [x] Implementation: publish a POST handler at `apps/web/src/app/api/oauth2/register/route.ts` that validates request bodies with the contract and invokes the runtime. References: packages/runtime/server/src/server-runtime.ts, apps/server/src/server.ts, https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-register.

- [x] [`auth.oauth2.client`](https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-client) — Fetches a registered client’s public metadata (used by management UI). **Returns:** `BetterFetchResponse<{ clientId: string; name: string; icon: string | null }>` drawn from the plugin store. **Errors:** `BetterFetchError` with `status 404` for unknown clients and `status 403` when the caller lacks a session.
  - [x] Contract: add `OidcClientRetrieveContract` to `packages/iam/sdk/src/clients/oidc/oidc.contracts.ts` capturing client identifiers and public metadata. References: https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-client, packages/iam/sdk/src/clients/oidc/oidc.contracts.ts.
  - [x] Implementation: create a management UI hook (`packages/iam/ui/src/oidc/use-oidc-client.ts`) for admin dashboards (e.g. `apps/web/src/app/dashboard/admin/oidc/[clientId]/page.tsx`) via runtime fetch. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/oidc-provider#api-method-oauth2-client.


## one-tap
- [x] [`auth.signIn.oneTap`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/one-tap.mdx) — Invokes Google One Tap prompt via the client plugin. **Returns:** `Promise<void>` (success handled through supplied callbacks). **Errors:** the promise rejects with `BetterFetchError` when the token exchange fails; prompt dismissals surface via notification handlers rather than the error channel.
  - [x] Contract: introduce a lightweight `SignInOneTapContract` in `packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts` capturing callback hooks and error channel expectations from https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/one-tap.mdx. References: packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts, packages/iam/sdk/src/clients/sign-in/sign-in.implementations.ts.
  - [x] Implementation: add a One Tap component (e.g. `packages/iam/ui/src/sign-in/sign-in-one-tap.tsx`) that loads the Google script, calls the runtime handler, and integrates with `packages/iam/ui/src/sign-in/sign-in.view.tsx`. References: packages/iam/ui/src/sign-in/sign-in.view.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/one-tap.mdx.


## one-time-token
- [ ] [`auth.oneTimeToken.generate`](https://www.better-auth.com/docs/plugins/one-time-token#api-method-one-time-token-generate) — Creates a one-time-use token tied to the active session, useful for magic-link handoffs. **Returns:** `BetterFetchResponse<{ token: string }>` with the plain token value. **Errors:** `BetterFetchError` with `status 401/403` for unauthenticated callers.
  - [x] Contract: scaffold `packages/iam/sdk/src/clients/one-time-token/one-time-token.contracts.ts` with `OneTimeTokenGenerateContract` reflecting the response from https://www.better-auth.com/docs/plugins/one-time-token#api-method-one-time-token-generate. References: packages/iam/sdk/src/adapters/better-auth/client.ts, packages/iam/sdk/src/clients/index.ts.
  - [ ] Implementation: add a generator button (e.g. `packages/iam/ui/src/account/one-time-token.button.tsx`) that calls runtime and reveals the plaintext token to copy/share. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/ui/src/layouts/components/account-drawer.tsx, https://www.better-auth.com/docs/plugins/one-time-token#api-method-one-time-token-generate.

- [ ] [`auth.oneTimeToken.verify`](https://www.better-auth.com/docs/plugins/one-time-token#api-method-one-time-token-verify) — Redeems a one-time token and returns the associated session payload. **Returns:** `BetterFetchResponse<{ session: { id; token; userId; createdAt; updatedAt; expiresAt }; user: { id; email; emailVerified; name; image?; createdAt; updatedAt } }>` enabling the client to restore auth state. **Errors:** `BetterFetchError` with codes such as `INVALID_TOKEN`, `TOKEN_EXPIRED`, or `TOKEN_ALREADY_USED`, plus 401 when no session is created.
  - [x] Contract: add `OneTimeTokenVerifyContract` to `packages/iam/sdk/src/clients/one-time-token/one-time-token.contracts.ts` that validates token strings and response session metadata per https://www.better-auth.com/docs/plugins/one-time-token#api-method-one-time-token-verify. References: packages/iam/sdk/src/adapters/better-auth/client.ts, packages/iam/sdk/src/clients/one-time-token/one-time-token.implementations.ts.
  - [ ] Implementation: power a verification route `apps/web/src/app/auth/one-time-token/verify/page.tsx` backed by a form/hook in `packages/iam/ui/src/one-time-token/verify.form.tsx` that updates auth state on success. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/ui/src/providers/AuthAdapterProvider.tsx, https://www.better-auth.com/docs/plugins/one-time-token#api-method-one-time-token-verify.

  
## organization
- [x] [`auth.organization.create`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Creates a new organization (spec: `better-auth-api-spec.json#/paths/~1organization~1create`). **Returns:** `BetterFetchResponse<SharedEntities.Organization.Model.select.Type>`; Better Auth also establishes an owner member. **Errors:** `BetterFetchError` with `status 403` when creation limits or permissions block the request.
  - [x] Contract: add `OrganizationCreateContract` in `packages/iam/sdk/src/clients/organization/organization.contracts.ts`, reusing `SharedEntities.Organization` schemas and tagging optional administrative fields (`userId`, `keepCurrentActiveOrganization`). References: packages/iam/sdk/src/clients/organization/organization.contracts.ts, packages/shared/domain/src/entities/Organization/Organization.model.ts.
  - [x] Implementation: extend `packages/iam/sdk/src/clients/organization/organization.implementations.ts` with a handler that calls `client.organization.create` via the contract’s `implement` helper (encode payload, `continuation.run`, `continuation.raiseResult`, `requireData`, `OrganizationCreateContract.decodeUnknownSuccess`), then surface a create form hook under `packages/iam/ui/src/organization/use-create-organization.ts` for dashboard onboarding. References: packages/runtime/client/src/services/runtime/live-layer.ts, better-auth-api-spec.json#/paths/~1organization~1create.
- [x] [`auth.organization.checkSlug`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Validates whether a slug is available (spec: `better-auth-api-spec.json#/paths/~1organization~1check-slug`). **Returns:** `BetterFetchResponse<{ available: boolean }>`; errors surface when validation fails or the user lacks access.
  - [x] Contract: introduce `OrganizationCheckSlugContract` capturing `{ slug: string }` in `packages/iam/sdk/src/clients/organization/organization.contracts.ts`, modelling the success payload above. References: better-auth-api-spec.json#/paths/~1organization~1check-slug.
  - [x] Implementation: add a handler in `packages/iam/sdk/src/clients/organization/organization.implementations.ts` that calls `client.organization.checkSlug`, then expose a debounced UI helper (for example `packages/iam/ui/src/organization/use-check-slug.ts`) to power slug pickers in onboarding flows. References: packages/runtime/client/src/services/runtime-live-layer.ts.
- [x] [`auth.organization.list`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists organizations the user can access (`better-auth-api-spec.json#/paths/~1organization~1list`). **Returns:** `BetterFetchResponse<{ organizations: SharedEntities.Organization.Model.select.Type[] }>` with paging metadata when provided.
  - [x] Contract: ensure `OrganizationListContract` in `packages/iam/sdk/src/clients/organization/organization.contracts.ts` models paging inputs (`limit`, `cursor`, etc.) and the returned array. References: packages/iam/sdk/src/clients/organization/organization.contracts.ts.
  - [x] Implementation: add a query handler in `packages/iam/sdk/src/clients/organization/organization.implementations.ts` driving a TanStack Query hook (`packages/iam/ui/src/organization/use-organizations.ts`) for dashboard selectors. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.setActive`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Switches the active organization for the session (`better-auth-api-spec.json#/paths/~1organization~1set-active`). **Returns:** `BetterFetchResponse<{ organizationId: string }>` confirming the new context.
  - [x] Contract: add `OrganizationSetActiveContract` (payload `{ organizationId: SharedEntityIds.OrganizationId.Type }`) to `organization.contracts.ts`. References: better-auth-api-spec.json#/paths/~1organization~1set-active.
  - [x] Implementation: implement a mutation handler that runs `client.organization.setActive` and emits `$sessionSignal` so UI reacts to org changes; expose a helper (e.g. `packages/iam/ui/src/organization/use-set-active-organization.ts`). References: packages/runtime/client/src/services/runtime/live-layer.ts, SharedEntityIds.OrganizationId.
- [x] [`auth.organization.getFullOrganization`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Fetches the full organization record, including metadata (`better-auth-api-spec.json#/paths/~1organization~1get-full-organization`). **Returns:** `BetterFetchResponse<SharedEntities.Organization.Model.select.Type>`.
  - [x] Contract: create `OrganizationGetFullContract` in `organization.contracts.ts` with optional `{ organizationId?: SharedEntityIds.OrganizationId.Type }` parameter. References: packages/shared/domain/src/entities/Organization, better-auth-api-spec.json#/paths/~1organization~1get-full-organization.
  - [x] Implementation: add a handler and hook for detail views (e.g. `packages/iam/ui/src/organization/use-organization.ts`) that invalidates caches when mutations run. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.update`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Applies partial updates to org metadata (`better-auth-api-spec.json#/paths/~1organization~1update`). **Returns:** `BetterFetchResponse<SharedEntities.Organization.Model.select.Type>` reflecting new fields.
  - [x] Contract: add `OrganizationUpdateContract` supporting partial fields (name, slug, metadata, etc.) and requiring at least one change; reuse `BS.partialRecord` utilities. References: packages/iam/sdk/src/clients/organization/organization.contracts.ts.
  - [x] Implementation: wire `client.organization.update` through the same `Contract.implement` + `continuation` pattern and create a form hook (e.g. `packages/iam/ui/src/organization/update-organization.form.tsx`). References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.delete`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Deletes an organization (`better-auth-api-spec.json#/paths/~1organization~1delete`). **Returns:** `BetterFetchResponse<{ success: boolean }>`; errors include `status 403` when deletion is disabled.
  - [x] Contract: add `OrganizationDeleteContract` (payload `{ organizationId?: SharedEntityIds.OrganizationId.Type }`) to `organization.contracts.ts`. References: better-auth-api-spec.json#/paths/~1organization~1delete.
  - [x] Implementation: expose a destructive mutation (e.g. `packages/iam/ui/src/organization/remove-organization.dialog.tsx`) that forces confirm flows before calling the contract. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.inviteMember`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Sends an invitation email with an optional team assignment (`better-auth-api-spec.json#/paths/~1organization~1invite-member`). **Returns:** `BetterFetchResponse<{ invitation: { id: string; organizationId: string; email: string; role: string | string[]; teamId: string | null; status: string; expiresAt: string } }>` per spec.
  - [x] Contract: extend `organization.contracts.ts` with `OrganizationInviteMemberContract` capturing `{ email: BS.Email; role: string | string[]; organizationId?: SharedEntityIds.OrganizationId.Type; teamId?: string | null }` and decoding the response struct above. References: better-auth-api-spec.json#/paths/~1organization~1invite-member.
  - [x] Implementation: create a handler in `organization.implementations.ts` that calls `client.organization.inviteMember`, plus a form/hook (e.g. `packages/iam/ui/src/organization/invite-member.form.tsx`). References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.getInvitation`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Fetches a pending invitation by token or id (`better-auth-api-spec.json#/paths/~1organization~1get-invitation`). **Returns:** `BetterFetchResponse<{ invitation: { id: string; organizationId: string; email: string; role: string | string[]; status: string; expiresAt: string; inviterId: string | null } } | null>`.
  - [x] Contract: add `OrganizationGetInvitationContract` covering query parameters (`invitationId` or `token`) and decoding the invitation shape. References: packages/iam/sdk/src/clients/organization/organization.contracts.ts.
  - [x] Implementation: expose a read handler for accept/preview flows (`packages/iam/ui/src/organization/accept-invitation/use-invitation.ts`). References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.cancelInvitation`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Cancels an invitation before it is accepted (`better-auth-api-spec.json#/paths/~1organization~1cancel-invitation`). **Returns:** `BetterFetchResponse<{ success: boolean }>` on success.
  - [x] Contract: scaffold `OrganizationCancelInvitationContract` (payload `{ invitationId: string; organizationId?: SharedEntityIds.OrganizationId.Type }`). References: better-auth-api-spec.json#/paths/~1organization~1cancel-invitation.
  - [x] Implementation: add mutation + UI action in invitation management tables (`packages/iam/ui/src/organization/invitations.table.tsx`). References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.rejectInvitation`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Rejects an invitation from the invitee side (`better-auth-api-spec.json#/paths/~1organization~1reject-invitation`). **Returns:** `BetterFetchResponse<{ success: boolean }>`; errors include `status 404` when invitation missing.
  - [x] Contract: define `OrganizationRejectInvitationContract` capturing `{ invitationId?: string; token?: string }`. References: organization.contracts.ts.
  - [x] Implementation: reuse the accept invitation UX to surface a reject CTA that calls the contract and redirects to an appropriate screen. References: packages/iam/ui/src/organization/accept-invitation.
- [x] [`auth.organization.listInvitations`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists pending invitations for an organization (`better-auth-api-spec.json#/paths/~1organization~1list-invitations`). **Returns:** `BetterFetchResponse<{ invitations: Array<{ id: string; organizationId: string; email: string; role: string | string[]; status: string; expiresAt: string; inviterId: string | null }> }>` plus pagination metadata.
  - [x] Contract: add `OrganizationListInvitationsContract` with pagination params. References: organization.contracts.ts.
  - [x] Implementation: expose a hook/table combo in `packages/iam/ui/src/organization/invitations.table.tsx` that supports revoke/resend actions. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.listUserInvitations`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists invitations sent to the current user (`better-auth-api-spec.json#/paths/~1organization~1list-user-invitations`). **Returns:** `BetterFetchResponse<{ invitations: Array<{ id: string; organizationId: string; email: string; role: string | string[]; status: string; expiresAt: string }> }>`; used for inbox surfaces.
  - [x] Contract: implement `OrganizationListUserInvitationsContract` with pagination. References: organization.contracts.ts.
  - [x] Implementation: add a hook for notification drawers (`packages/iam/ui/src/organization/use-user-invitations.ts`). References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.listMembers`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists members with pagination and filters (`better-auth-api-spec.json#/paths/~1organization~1list-members`). **Returns:** `BetterFetchResponse<{ members: Array<{ id: string; organizationId: string; userId: string | null; role: string | string[]; invitedBy: string | null; createdAt: string }>; total: number }>` per spec.
  - [x] Contract: add `OrganizationListMembersContract` capturing paging/filter inputs and defining the member struct inline (id, userId, role, createdAt) to avoid ad-hoc types. References: organization.contracts.ts.
  - [x] Implementation: build a TanStack Query hook powering `packages/iam/ui/src/organization/members.table.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.removeMember`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Removes a member by id or email (`better-auth-api-spec.json#/paths/~1organization~1remove-member`). **Returns:** `BetterFetchResponse<{ success: boolean }>`; forbidden when removing owners.
  - [x] Contract: add `OrganizationRemoveMemberContract` with `{ memberIdOrEmail: string; organizationId?: SharedEntityIds.OrganizationId.Type }`. References: organization.contracts.ts.
  - [x] Implementation: add action handler used in member tables to drop users and invalidate related queries. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.updateMemberRole`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Updates role assignments for a member (`better-auth-api-spec.json#/paths/~1organization~1update-member-role`). **Returns:** empty 200; errors include `status 403` without permission.
  - [x] Contract: add `OrganizationUpdateMemberRoleContract` capturing `{ memberId; role; organizationId? }`. References: organization.contracts.ts.
  - [x] Implementation: create role edit forms in `packages/iam/ui/src/organization/member-role.dialog.tsx` hooking to the contract; refresh member list caches on success. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.getActiveMember`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Retrieves the member record representing the current user (`better-auth-api-spec.json#/paths/~1organization~1get-active-member`). **Returns:** `BetterFetchResponse<{ member: { id: string; organizationId: string; userId: string | null; role: string | string[]; createdAt: string } | null }>` depending on active org.
  - [x] Contract: add `OrganizationGetActiveMemberContract` in `organization.contracts.ts`. References: organization.contracts.ts.
  - [x] Implementation: expose a hook `use-active-member` that feeds dashboards and gating components. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.getActiveMemberRole`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Returns the active member’s role(s) (`better-auth-api-spec.json#/paths/~1organization~1get-active-member-role`). **Returns:** `BetterFetchResponse<{ role: string | string[] }>` per doc.
  - [x] Contract: add `OrganizationGetActiveMemberRoleContract` capturing optional `organizationId`. References: organization.contracts.ts.
  - [x] Implementation: produce a lightweight hook (e.g. `packages/iam/ui/src/organization/use-active-role.ts`) to drive permission-aware components. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.leave`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Allows the current member to leave the org (`better-auth-api-spec.json#/paths/~1organization~1leave`). **Returns:** `BetterFetchResponse<{ success: boolean }>` and clears active org context.
  - [x] Contract: create `OrganizationLeaveContract` with optional `organizationId`. References: organization.contracts.ts.
  - [x] Implementation: add UI flows to `packages/iam/ui/src/organization/leave-organization.dialog.tsx` that warn about losing access and refresh caches afterward. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.createRole`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Creates a custom role when dynamic access control is enabled (`better-auth-api-spec.json#/paths/~1organization~1create-role`). **Returns:** `BetterFetchResponse<{ id: string; organizationId: string; role: string; permission: Record<string, string[]>; createdAt: string; updatedAt: string }>` per Better Auth.
  - [x] Contract: add `OrganizationCreateRoleContract` to `organization.contracts.ts` (fields: `name`, `permissions`, `description?`). References: better-auth-api-spec.json#/paths/~1organization~1create-role.
  - [x] Implementation: implement mutation + form (`packages/iam/ui/src/organization/roles/role-create.form.tsx`) and invalidate role listings on success. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.deleteRole`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Deletes a custom role (`better-auth-api-spec.json#/paths/~1organization~1delete-role`). **Returns:** `BetterFetchResponse<{ success: boolean }>`; stops owners from deleting protected roles.
  - [x] Contract: introduce `OrganizationDeleteRoleContract` with `{ roleId: string; organizationId?: SharedEntityIds.OrganizationId.Type }`. References: organization.contracts.ts.
  - [x] Implementation: add action to role tables to remove roles and refresh caches. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.listRoles`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists available roles (`better-auth-api-spec.json#/paths/~1organization~1list-roles`). **Returns:** `BetterFetchResponse<{ roles: Array<{ id: string; role: string; permission: Record<string, string[]>; organizationId: string; createdAt: string; updatedAt: string }> }>` with pagination.
  - [x] Contract: add `OrganizationListRolesContract` capturing pagination/filtering. References: organization.contracts.ts.
  - [x] Implementation: build `packages/iam/ui/src/organization/roles/roles.table.tsx` to surface roles and their permissions. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.getRole`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Fetches a single custom role (`better-auth-api-spec.json#/paths/~1organization~1get-role`). **Returns:** `BetterFetchResponse<{ role: { id: string; role: string; permission: Record<string, string[]>; organizationId: string; createdAt: string; updatedAt: string } } | null>`.
  - [x] Contract: create `OrganizationGetRoleContract` with `{ roleId: string; organizationId?: SharedEntityIds.OrganizationId.Type }`. References: organization.contracts.ts.
  - [x] Implementation: expose a hook for editing role detail views. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.updateRole`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Updates an existing role’s name/permissions (`better-auth-api-spec.json#/paths/~1organization~1update-role`). **Returns:** `BetterFetchResponse<{ role: { id: string; role: string; permission: Record<string, string[]>; organizationId: string; createdAt: string; updatedAt: string } }>` reflecting changes.
  - [x] Contract: add `OrganizationUpdateRoleContract` supporting partial updates. References: organization.contracts.ts.
  - [x] Implementation: integrate with role edit form hooking to mutation and invalidating caches. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [x] [`auth.organization.acceptInvitation`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Accepts an organization invitation after login. **Returns:** `BetterFetchResponse<{ invitation: { id: string; status: string; organizationId: string; email: string; role: string | string[]; expiresAt: string }; member: { id: string; organizationId: string; userId: string; role: string | string[]; createdAt: string } } | null>`. **Errors:** `BetterFetchError` exposing codes for missing invitations, expired links, or email verification requirements.
  - [x] Contract: ensure `AcceptInvitationContract` in `packages/iam/sdk/src/clients/organization/organization.contracts.ts` mirrors Better Auth invitation/member payloads and encodes nullable responses. References: packages/iam/sdk/src/clients/organization/organization.contracts.ts.
  - [x] Implementation: finish the accept-invitation view (`packages/iam/ui/src/organization/accept-invitation/accept-invitation.view.tsx`) to call the runtime via `apps/web/src/app/auth/accept-invitation/[token]/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/organization/accept-invitation/index.ts.

## team
- [ ] [`auth.organization.createTeam`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Creates a team when team support is enabled (`better-auth-api-spec.json#/paths/~1organization~1create-team`). **Returns:** `BetterFetchResponse<{ team: { id: string; organizationId: string; name: string; slug: string | null; metadata: Record<string, unknown> | null; createdAt: string; updatedAt: string } }>` per spec.
  - [ ] Contract: add `TeamCreateContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts`, reusing shared organization/team schemas. References: packages/iam/sdk/src/clients/team/team.contracts.ts, better-auth-api-spec.json#/paths/~1organization~1create-team.
  - [ ] Implementation: add handler to `packages/iam/sdk/src/clients/team/team.implementations.ts` via `TeamContract.implement(Effect.fn(...))` (encode payload, `continuation.run`, decode success), then hook up `packages/iam/ui/src/organization/teams/team-create.form.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.listTeams`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists teams (`better-auth-api-spec.json#/paths/~1organization~1list-teams`). **Returns:** `BetterFetchResponse<{ teams: Array<{ id: string; organizationId: string; name: string; slug: string | null; metadata: Record<string, unknown> | null; createdAt: string; updatedAt: string }> }>` with pagination.
  - [ ] Contract: add `TeamListContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` covering pagination/filter inputs and the typed response. References: better-auth-api-spec.json#/paths/~1organization~1list-teams.
  - [ ] Implementation: build a query hook (`packages/iam/ui/src/organization/teams/use-teams.ts`) that invokes `TeamImplementations.TeamList` via runtime. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.updateTeam`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Updates team name/metadata (`better-auth-api-spec.json#/paths/~1organization~1update-team`). **Returns:** `BetterFetchResponse<{ team: { id: string; organizationId: string; name: string; slug: string | null; metadata: Record<string, unknown> | null; createdAt: string; updatedAt: string } }>` per spec.
  - [ ] Contract: add `TeamUpdateContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` supporting partial updates with validation to prevent empty payloads. References: better-auth-api-spec.json#/paths/~1organization~1update-team.
  - [ ] Implementation: create edit drawer logic in `packages/iam/ui/src/organization/teams/team-update.form.tsx` and invalidate team caches on success. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.removeTeam`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Removes a team (`better-auth-api-spec.json#/paths/~1organization~1remove-team`). **Returns:** `BetterFetchResponse<{ message: string }>` acknowledging removal.
  - [ ] Contract: add `TeamRemoveContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` with `{ teamId: string; organizationId?: SharedEntityIds.OrganizationId.Type }`. References: better-auth-api-spec.json#/paths/~1organization~1remove-team.
  - [ ] Implementation: add remover action via `packages/iam/sdk/src/clients/team/team.implementations.ts` and ensure caches clear. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.setActiveTeam`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Switches the active team for the current member (`better-auth-api-spec.json#/paths/~1organization~1set-active-team`). **Returns:** `BetterFetchResponse<{ teamId: string }>` indicating new context.
  - [ ] Contract: create `TeamSetActiveContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` mapping `{ teamId: string; organizationId?: SharedEntityIds.OrganizationId.Type }`. References: better-auth-api-spec.json#/paths/~1organization~1set-active-team.
  - [ ] Implementation: add mutation helper (`packages/iam/ui/src/organization/teams/use-set-active-team.ts`) that triggers the contract and emits `$sessionSignal`. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.listUserTeams`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists teams the user belongs to (`better-auth-api-spec.json#/paths/~1organization~1list-user-teams`). **Returns:** `BetterFetchResponse<{ teams: Array<{ id: string; organizationId: string; name: string; slug: string | null; metadata: Record<string, unknown> | null; createdAt: string; updatedAt: string }> }>` per spec.
  - [ ] Contract: add `TeamListUserTeamsContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` with pagination inputs. References: better-auth-api-spec.json#/paths/~1organization~1list-user-teams.
  - [ ] Implementation: expose navigation helper `packages/iam/ui/src/organization/teams/use-user-teams.ts` tied to the new contract. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.listTeamMembers`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Lists members of a given team (`better-auth-api-spec.json#/paths/~1organization~1list-team-members`). **Returns:** `BetterFetchResponse<{ members: Array<{ id: string; teamId: string; userId: string; role: string | string[]; createdAt: string }> }>` per spec.
  - [ ] Contract: create `TeamListMembersContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` with paging options. References: better-auth-api-spec.json#/paths/~1organization~1list-team-members.
  - [ ] Implementation: add team-specific member table hooking into the contract (`packages/iam/ui/src/organization/teams/team-members.table.tsx`). References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.addTeamMember`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Adds a user to a team (`better-auth-api-spec.json#/paths/~1organization~1add-team-member`). **Returns:** `BetterFetchResponse<{ message: string }>` on success.
  - [ ] Contract: add `TeamAddMemberContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` covering `{ teamId: string; userId: string }`. References: better-auth-api-spec.json#/paths/~1organization~1add-team-member.
  - [ ] Implementation: integrate add-member action into team membership UI, invalidating related caches. References: packages/runtime/client/src/services/runtime/live-layer.ts.
- [ ] [`auth.organization.removeTeamMember`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/organization.mdx) — Removes a user from a team (`better-auth-api-spec.json#/paths/~1organization~1remove-team-member`). **Returns:** `BetterFetchResponse<{ message: string }>`; errors when removing last owner.
  - [ ] Contract: add `TeamRemoveMemberContract` in `packages/iam/sdk/src/clients/team/team.contracts.ts` with `{ teamId: string; userId: string }`. References: better-auth-api-spec.json#/paths/~1organization~1remove-team-member.
  - [ ] Implementation: add action to team member table to offboard users and refresh caches. References: packages/runtime/client/src/services/runtime/live-layer.ts.


## passkey
- [x] [`auth.signIn.passkey`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/passkey.mdx) — Runs WebAuthn passkey authentication, honoring autofill and fetch hooks. **Returns:** `BetterFetchResponse` with `data: { session; user: { id; email; name; image?; emailVerified; createdAt; updatedAt } }` on success. **Errors:** `error` is either a `BetterFetchError` or a structured passkey failure (`error.code` such as `user_cancelled` or `registration_required`).
  - [x] Contract: verify `SignInPasskeyContract` in `packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts` encapsulates callbacks and result typing from https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/passkey.mdx. References: packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts, packages/iam/sdk/src/clients/sign-in/sign-in.implementations.ts.
  - [x] Implementation: ensure `packages/iam/ui/src/sign-in/sign-in-passkey.tsx` interacts with `makeRunClientPromise` to handle success navigation and fallback errors. References: packages/iam/ui/src/sign-in/sign-in.view.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/passkey.mdx.
- [x] [`auth.passkey.addPasskey`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/passkey.mdx) — Registers a new FIDO2 credential by orchestrating `/passkey/generate-register-options` and `/passkey/verify-registration` (see `better-auth-api-spec.json#/paths/~1passkey~1generate-register-options` and `better-auth-api-spec.json#/paths/~1passkey~1verify-registration`). **Returns:** `BetterFetchResponse<{ message: string; passkey?: { id: string; name: string; createdAt: string; lastUsedAt: string | null } }>` confirming enrollment. **Errors:** `BetterFetchError` with validation codes when WebAuthn attestation fails or `status 401` for missing session.
  - [x] Contract: scaffold `PasskeyAddContract` in `packages/iam/sdk/src/clients/passkey/passkey.contracts.ts` to encode optional `name`, `authenticatorAttachment`, and the success payload above using shared passkey schemas. References: packages/iam/sdk/src/clients/passkey/passkey.contracts.ts, better-auth-api-spec.json#/paths/~1passkey~1generate-register-options.
  - [x] Implementation: extend `packages/iam/sdk/src/clients/passkey/passkey.implementations.ts` so `PasskeyImplementations.PasskeyAdd` calls `client.passkey.addPasskey` using the contract continuation pattern (encode payload, `continuation.run`, raise result, decode success), then integrate the handler into `packages/iam/ui/src/account-management/components/privacy-protection/Passkey.tsx` via the runtime layer (`packages/runtime/client/src/services/runtime/live-layer.ts`).
- [x] [`auth.passkey.listUserPasskeys`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/passkey.mdx) — Lists passkeys for the active user (spec: `better-auth-api-spec.json#/paths/~1passkey~1list-user-passkeys`). **Returns:** `BetterFetchResponse<{ passkeys: Array<{ id: string; name: string; createdAt: string; lastUsedAt: string | null }> }>` or a plain array depending on server configuration. **Errors:** `BetterFetchError` with `status 401/403` when the caller lacks an authenticated session.
  - [x] Contract: define `PasskeyListContract` in `packages/iam/sdk/src/clients/passkey/passkey.contracts.ts`, ensuring the response schema mirrors the list payload and reuses shared passkey entities. References: packages/iam/sdk/src/clients/passkey/passkey.contracts.ts, better-auth-api-spec.json#/paths/~1passkey~1list-user-passkeys.
  - [x] Implementation: add a list handler in `packages/iam/sdk/src/clients/passkey/passkey.implementations.ts` that calls `client.passkey.listUserPasskeys` and decodes the response, then expose a runtime-powered hook consumed by `packages/iam/ui/src/account-management/components/privacy-protection/Passkey.tsx` to render and refresh the list. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/account-management/components/privacy-protection/Passkey.tsx.
- [x] [`auth.passkey.deletePasskey`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/passkey.mdx) — Deletes a stored credential by ID (`better-auth-api-spec.json#/paths/~1passkey~1delete-passkey`). **Returns:** `BetterFetchResponse<null>` acknowledging removal. **Errors:** `BetterFetchError` with `status 404` when the credential is missing or `status 403` if policy blocks deletion.
  - [x] Contract: add `PasskeyRemoveContract` in `packages/iam/sdk/src/clients/passkey/passkey.contracts.ts` capturing the `id` payload and success message. References: packages/iam/sdk/src/clients/passkey/passkey.contracts.ts, better-auth-api-spec.json#/paths/~1passkey~1delete-passkey.
  - [x] Implementation: implement the deleter in `packages/iam/sdk/src/clients/passkey/passkey.implementations.ts` using `client.passkey.deletePasskey`, then wire it to destructive actions in `packages/iam/ui/src/account-management/components/privacy-protection/Passkey.tsx` with optimistic list invalidation. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/account-management/components/privacy-protection/Passkey.tsx.
- [x] [`auth.passkey.updatePasskey`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/passkey.mdx) — Renames an existing credential (`better-auth-api-spec.json#/paths/~1passkey~1update-passkey`). **Returns:** `BetterFetchResponse<{ passkey: Passkey }>` describing the updated passkey. **Errors:** `BetterFetchError` with `status 400` for missing fields or `status 404` when the credential no longer exists.
  - [x] Contract: create `PasskeyUpdateContract` in `packages/iam/sdk/src/clients/passkey/passkey.contracts.ts` enforcing `{ id: string; name: string }` inputs and the success payload. References: packages/iam/sdk/src/clients/passkey/passkey.contracts.ts, better-auth-api-spec.json#/paths/~1passkey~1update-passkey.
  - [x] Implementation: add a rename handler in `packages/iam/sdk/src/clients/passkey/passkey.implementations.ts` to call `client.passkey.updatePasskey`, then expose rename UX in `packages/iam/ui/src/account-management/components/privacy-protection/Passkey.tsx` (or a dedicated modal) with store refreshes. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/account-management/components/privacy-protection/Passkey.tsx.


## phone-number
- [ ] [`auth.phoneNumber.sendOtp`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/phone-number.mdx) — Sends an OTP to the supplied phone so the user can complete verification or password-reset flows. **Returns:** `BetterFetchResponse<{ message: string }>` (see `better-auth-api-spec.json#/paths/~1phone-number~1send-otp`). **Errors:** `BetterFetchError` with `status 400` for malformed payloads and `status 401` when the request lacks a session.
  - [ ] Contract: add `SendPhoneOtpContract` in `packages/iam/sdk/src/clients/verify/verify.contracts.ts` describing `{ phoneNumber: BS.Phone }` and reuse the existing `IamError` failure channel. References: packages/iam/sdk/src/clients/verify/verify.contracts.ts, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/phone-number.mdx.
  - [ ] Implementation: extend `packages/iam/sdk/src/clients/verify/verify.implementations.ts` with a handler that calls `client.phoneNumber.sendOtp` through `VerifySendPhoneContract.implement(Effect.fn(...))` (encode payload, `continuation.run`, raise result, decode success), then wire a runtime hook (for example `packages/iam/ui/src/verify/verify-phone-send-otp.tsx`) to trigger the contract from the phone update UI. References: packages/runtime/client/src/services/runtime/live-layer.ts, apps/web/src/app/auth/verify-phone/page.tsx, better-auth-api-spec.json#/paths/~1phone-number~1send-otp.
- [ ] [`auth.verify.phone`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/phone-number.mdx) — Verifies a phone OTP and can update the active session’s phone metadata. **Returns:** `BetterFetchResponse` with `data: { status: boolean; token: string | null; user: { id; email; phoneNumber: { e164: string; countryCode: string } | null } }`. **Errors:** `error` is `BetterFetchError`; typical payload includes `status: 400` (invalid code) or `status: 403` with message "Too many attempts".
  - [ ] Contract: confirm `SendVerifyPhoneContract` in `packages/iam/sdk/src/clients/verify/verify.contracts.ts` covers OTP, token, and phone metadata from https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/phone-number.mdx. References: packages/iam/sdk/src/clients/verify/verify.contracts.ts, packages/iam/sdk/src/clients/verify/verify.implementations.ts.
  - [ ] Implementation: connect `packages/iam/ui/src/verify/verify-phone.form.tsx` to runtime and update UI states (success/too many attempts) within `apps/web/src/app/auth/verify-phone/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/verify/verify-phone.view.tsx, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/phone-number.mdx.


## siwe
- [ ] [`auth.siwe.nonce`](https://www.better-auth.com/docs/plugins/siwe#api-method-siwe-nonce) — Generates a nonce that the wallet signs as part of the SIWE flow. **Returns:** `BetterFetchResponse<{ nonce: string }>` and optionally stores anti-replay metadata. **Errors:** `BetterFetchError` when the wallet address is invalid or nonce generation fails (HTTP 400/500).
  - [ ] Contract: create `SiweNonceContract` under `packages/iam/sdk/src/clients/siwe/siwe.contracts.ts` capturing address inputs and nonce response rules from https://www.better-auth.com/docs/plugins/siwe#api-method-siwe-nonce. References: packages/iam/sdk/src/adapters/better-auth/client.ts, packages/iam/sdk/src/clients/index.ts.
  - [ ] Implementation: integrate a wallet connect button (`packages/iam/ui/src/siwe/siwe-connect.button.tsx`) that fetches the nonce via runtime before prompting signature. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/ui/src/layouts/components/account-popover.tsx, https://www.better-auth.com/docs/plugins/siwe#api-method-siwe-nonce.

- [ ] [`auth.siwe.verify`](https://www.better-auth.com/docs/plugins/siwe#api-method-siwe-verify) — Verifies the signed SIWE message and establishes a Better Auth session (optionally provisioning a user). **Returns:** `BetterFetchResponse<{ token: string; success: boolean; user: { id: string; walletAddress: string; chainId: number } }>` with new session token. **Errors:** `BetterFetchError` carrying codes like `INVALID_SIGNATURE`, `NONCE_MISMATCH`, `ADDRESS_MISMATCH`, or 429 for replay attempts.
  - [ ] Contract: specify signature payload (message, signature, address) in `packages/iam/sdk/src/clients/siwe/siwe.contracts.ts` along with typed response from https://www.better-auth.com/docs/plugins/siwe#api-method-siwe-verify. References: packages/iam/sdk/src/clients/siwe/siwe.contracts.ts, packages/iam/sdk/src/clients/siwe/siwe.implementations.ts.
  - [ ] Implementation: build a verification hook (`packages/iam/ui/src/siwe/use-siwe-sign-in.ts`) that submits the signed message through runtime and updates session context. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/ui/src/providers/AuthAdapterProvider.tsx, https://www.better-auth.com/docs/plugins/siwe#api-method-siwe-verify.


## sso
- [ ] [`auth.sso.register`](https://www.better-auth.com/docs/plugins/sso#api-method-sso-register) — Registers an OIDC identity provider for SSO, creating internal configuration and returning the redirect URI. **Returns:** `BetterFetchResponse<{ oidcConfig: { issuer: string; clientId: string; clientSecret: string; authorizationEndpoint: string; tokenEndpoint: string; userInfoEndpoint: string; jwksEndpoint?: string | null; scopes?: string[] }; redirectURI: string }>` reflecting stored metadata. **Errors:** `BetterFetchError` with `status 400` (`error.code` values like `INVALID_DISCOVERY_DOCUMENT`), `status 409` when the provider already exists, or `status 403` when the caller lacks organization admin rights.
  - [ ] Contract: introduce `SsoRegisterContract` in `packages/iam/sdk/src/clients/sso/sso.contracts.ts` covering provider metadata and redirect URI from https://www.better-auth.com/docs/plugins/sso#api-method-sso-register. References: packages/iam/sdk/src/adapters/better-auth/client.ts, packages/iam/sdk/src/clients/index.ts.
  - [ ] Implementation: design an SSO registration form (`packages/iam/ui/src/admin/sso/sso-register.form.tsx`) for organization admins via runtime. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/sso#api-method-sso-register.

- [ ] [`auth.sso.list`](https://www.better-auth.com/docs/plugins/sso#api-method-sso-list) — Lists configured SSO providers for the tenant. **Returns:** `BetterFetchResponse<Array<{ id: string; providerId: string; domain: string; organizationId?: string | null; createdAt: Date; updatedAt: Date }>>`. **Errors:** `BetterFetchError` with `status 403` for insufficient privileges.
  - [ ] Contract: add `SsoListContract` to `packages/iam/sdk/src/clients/sso/sso.contracts.ts` describing filters (if any) and the provider array payload. References: packages/iam/sdk/src/clients/sso/sso.contracts.ts, https://www.better-auth.com/docs/plugins/sso#api-method-sso-list.
  - [ ] Implementation: implement a management table `packages/iam/ui/src/admin/sso/sso-list.table.tsx` with TanStack Query hitting the runtime. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/sso#api-method-sso-list.

- [ ] [`auth.sso.delete`](https://www.better-auth.com/docs/plugins/sso#api-method-sso-delete) — Deletes a configured SSO provider by ID. **Returns:** `BetterFetchResponse<{ success: boolean }>` once removed. **Errors:** `BetterFetchError` with `status 404` (`error.code: "SSO_PROVIDER_NOT_FOUND"`) or `status 403` for unauthorized attempts.
  - [ ] Contract: define `SsoDeleteContract` in `packages/iam/sdk/src/clients/sso/sso.contracts.ts` validating provider IDs and success booleans. References: packages/iam/sdk/src/clients/sso/sso.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [ ] Implementation: add delete actions to `packages/iam/ui/src/admin/sso/sso-list.table.tsx` that call runtime and optimistically update the list. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/sso#api-method-sso-delete.


## stripe
- [ ] [`auth.stripe.portal`](https://www.better-auth.com/docs/plugins/stripe#api-method-stripe-portal) — Begins a Stripe Billing Portal session for the authenticated user. **Returns:** `BetterFetchResponse<{ url: string }>` to redirect into Stripe. **Errors:** `BetterFetchError` with `status 400` (`error.code: "STRIPE_CUSTOMER_NOT_FOUND"`) or `status 500` wrapping Stripe API errors.
  - [ ] Contract: create `StripePortalContract` in `packages/iam/sdk/src/clients/stripe/stripe.contracts.ts` modeling the redirect URL and error codes from https://www.better-auth.com/docs/plugins/stripe#api-method-stripe-portal. References: packages/iam/sdk/src/clients/stripe/stripe.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [ ] Implementation: add a billing portal button (`packages/iam/ui/src/billing/stripe-portal.button.tsx`) that calls runtime and performs `router.push(url)` within `apps/web/src/app/dashboard/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, apps/web/src/app/dashboard/layout.tsx, https://www.better-auth.com/docs/plugins/stripe#api-method-stripe-portal.

- [ ] [`auth.stripe.subscribe`](https://www.better-auth.com/docs/plugins/stripe#api-method-stripe-subscribe) — Creates a checkout session for the configured subscription products. **Returns:** `BetterFetchResponse<{ url: string; sessionId: string }>` for redirect-based flows. **Errors:** `BetterFetchError` with `status 400` for invalid price IDs and `status 500` for Stripe API failures.
  - [ ] Contract: add `StripeSubscribeContract` to `packages/iam/sdk/src/clients/stripe/stripe.contracts.ts` covering price ids, success/cancel URLs, and returned session info per https://www.better-auth.com/docs/plugins/stripe#api-method-stripe-subscribe. References: packages/iam/sdk/src/clients/stripe/stripe.contracts.ts, packages/iam/sdk/src/clients/stripe/stripe.implementations.ts.
  - [ ] Implementation: implement a subscription CTA (`packages/iam/ui/src/billing/stripe-subscribe.button.tsx`) that triggers runtime mutation and redirects to Stripe checkout. References: packages/runtime/client/src/services/runtime/live-layer.ts, apps/web/src/app/dashboard/page.tsx, https://www.better-auth.com/docs/plugins/stripe#api-method-stripe-subscribe.


## two-factor
- [ ] [`auth.twoFactor.sendOtp`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx) — Sends a second-factor OTP and optionally trusts the device. **Returns:** `BetterFetchResponse` with `data: { status: boolean }`. **Errors:** `error` is `BetterFetchError` (rate limits, 2FA not enabled) with plugin-specific metadata in `error.error`.
  - [ ] Contract: model OTP delivery + trust flags in `packages/iam/sdk/src/clients/two-factor/two-factor.contracts.ts` based on https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx. References: packages/iam/sdk/src/clients/two-factor/two-factor.contracts.ts, packages/iam/sdk/src/clients/two-factor/two-factor.implementations.ts.
  - [ ] Implementation: implement a send-OTP form `packages/iam/ui/src/two-factor/send-otp.form.tsx` for login flows, hooking into runtime from `apps/web/src/app/auth/sign-in/page.tsx`. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx.

- [ ] [`auth.twoFactor.verifyOtp`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx) — Confirms an OTP during 2FA flows. **Returns:** `BetterFetchResponse` with `data: { token: string; user: { id; email; emailVerified; name; image?; createdAt; updatedAt } }`. **Errors:** `error` is `BetterFetchError` carrying codes for invalid or expired OTPs and untrusted devices.
  - [ ] Contract: add `TwoFactorVerifyOtpContract` to `packages/iam/sdk/src/clients/two-factor/two-factor.contracts.ts` including trust-device toggles and typed responses per https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx. References: packages/iam/sdk/src/clients/two-factor/two-factor.contracts.ts, packages/iam/sdk/src/clients/two-factor/two-factor.implementations.ts.
  - [ ] Implementation: create a verification form `packages/iam/ui/src/two-factor/verify-otp.form.tsx` used within the sign-in modal flow leveraging runtime to finalize login. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx.

- [ ] [`auth.twoFactor.verifyTotp`](https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx) — Verifies a TOTP code for authenticator-app flows. **Returns:** `BetterFetchResponse` with `data: { token: string; user: { id; email; emailVerified; name; image?; createdAt; updatedAt } }`. **Errors:** `error` is `BetterFetchError` (bad TOTP, clock skew, throttling) with plugin code metadata.
  - [ ] Contract: register `TwoFactorVerifyTotpContract` in `packages/iam/sdk/src/clients/two-factor/two-factor.contracts.ts` covering 6-digit codes and error surfaces described at https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx. References: packages/iam/sdk/src/clients/two-factor/two-factor.contracts.ts, packages/iam/sdk/src/adapters/better-auth/client.ts.
  - [ ] Implementation: build a TOTP verifier `packages/iam/ui/src/two-factor/verify-totp.form.tsx` for authenticator flows and integrate it with the runtime invocation path. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://github.com/better-auth/better-auth/blob/canary/docs/content/docs/plugins/2fa.mdx.


## username
- [ ] [`auth.signIn.username`](https://www.better-auth.com/docs/plugins/username#api-method-username-sign-in) — Authenticates using username + password instead of email. **Returns:** `BetterFetchResponse<{ token: string; user: { id; username: string; email?: string | null; name?: string | null; image?: string | null; emailVerified: boolean; createdAt: Date; updatedAt: Date } }>` on success. **Errors:** `BetterFetchError` with codes like `INVALID_CREDENTIALS`, `USERNAME_NOT_FOUND`, or `EMAIL_VERIFICATION_REQUIRED`.
  - [ ] Contract: finalize `SignInUsernameContract` in `packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts` ensuring username schema + rememberMe fields align with https://www.better-auth.com/docs/plugins/username#api-method-username-sign-in. References: packages/iam/sdk/src/clients/sign-in/sign-in.contracts.ts, packages/iam/sdk/src/clients/sign-in/sign-in.implementations.ts.
  - [ ] Implementation: introduce a username form (`packages/iam/ui/src/sign-in/sign-in-username.form.tsx`) integrated into `packages/iam/ui/src/sign-in/sign-in.view.tsx` via runtime invocation. References: packages/runtime/client/src/services/runtime/live-layer.ts, packages/iam/ui/src/sign-in/sign-in.view.tsx, https://www.better-auth.com/docs/plugins/username#api-method-username-sign-in.

- [ ] [`auth.signUp.username`](https://www.better-auth.com/docs/plugins/username#api-method-username-sign-up) — Registers a new user with username credentials. **Returns:** `BetterFetchResponse<{ token: string | null; user: { id; username: string; email?: string | null; name?: string | null; image?: string | null; emailVerified: boolean; createdAt: Date; updatedAt: Date } }>` depending on auto-login settings. **Errors:** `BetterFetchError` with `status 400` for duplicate usernames or policy violations.
  - [ ] Contract: extend `packages/iam/sdk/src/clients/sign-up/sign-up.contracts.ts` with username-aware schema (e.g. `SignUpUsernameContract`) per https://www.better-auth.com/docs/plugins/username#api-method-username-sign-up. References: packages/iam/sdk/src/clients/sign-up/sign-up.contracts.ts, packages/iam/sdk/src/clients/sign-up/sign-up.implementations.ts.
  - [ ] Implementation: provide a username registration form `packages/iam/ui/src/sign-up/sign-up-username.form.tsx` that mirrors the email flow and hooks into runtime. References: packages/iam/ui/src/sign-up/sign-up.view.tsx, packages/runtime/client/src/services/runtime/live-layer.ts, https://www.better-auth.com/docs/plugins/username#api-method-username-sign-up.
