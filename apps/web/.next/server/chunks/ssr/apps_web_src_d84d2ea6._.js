module.exports=[18155,a=>{"use strict";let b=(0,a.i(241664).registerClientReference)(function(){throw Error("Attempted to call View() from the server but View is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/features/upload/view.tsx <module evaluation>","View");a.s(["View",0,b])},302208,a=>{"use strict";let b=(0,a.i(241664).registerClientReference)(function(){throw Error("Attempted to call View() from the server but View is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/features/upload/view.tsx","View");a.s(["View",0,b])},936415,a=>{"use strict";a.i(18155);var b=a.i(302208);a.n(b)},678829,a=>{"use strict";let b;var c=a.i(434777),d=a.i(116257);class e extends d.TaggedError("ValidationError"){}class f extends d.TaggedError("DetectionError"){}class g extends d.TaggedError("ExifParseError"){}var h=a.i(162358),i=a.i(141859),j=a.i(194869),k=j;a.i(61782);var k=j,l=a.i(399121),m=a.i(735789);m.MetricBoundariesTypeId,m.isMetricBoundaries;let n=m.fromIterable;m.linear,m.exponential;let o={filesProcessedTotal:l.counter("upload.files_processed_total"),filesFailedTotal:l.counter("upload.files_failed_total"),detectionFailedTotal:l.counter("upload.detection_failed_total"),exifParsedTotal:l.counter("upload.exif_parsed_total"),exifFailedTotal:l.counter("upload.exif_failed_total"),processFileDurationMs:l.histogram("upload.process_file_duration_ms",n([1,5,10,25,50,100,250,500,1e3,2e3,5e3,1e4]))},p=(a,b)=>({service:"upload",fileName:a.name,fileType:a.type,fileSize:a.size,...b}),q=(a,b)=>i.logWarning(a).pipe(i.annotateLogs(b??{})),r=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],s=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],t=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],u=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],v=(a,b,c)=>"string"==typeof b||Array.isArray(b)?a.toLocaleString(b,c):!0===b||void 0!==c?a.toLocaleString(void 0,c):String(a),w=a=>{if("number"==typeof a)return Math.log10(a);let b=a.toString(10);return b.length+Math.log10(Number.parseFloat(`0.${b.slice(0,15)}`))};function x(a,b){var c;let d;if("bigint"!=typeof a&&!Number.isFinite(a))throw TypeError(`Expected a finite number, got ${typeof a}: ${a}`);let e={bits:!1,binary:!1,space:!0,...b},f=e.bits?e.binary?u:t:e.binary?s:r,g=e.space?" ":"";if(e.signed&&("number"==typeof a?0===a:0n===a))return` 0${g}${f[0]}`;let h=a<0,i=h?"-":e.signed?"+":"";if(h&&(a=-a),void 0!==e.minimumFractionDigits&&(d={minimumFractionDigits:e.minimumFractionDigits}),void 0!==e.maximumFractionDigits&&(d={maximumFractionDigits:e.maximumFractionDigits,...d}),"number"==typeof a?a<1:a<1n)return i+v("number"==typeof a?a:Number(a),e.locale,d)+g+f[0];let j=e.binary?1024:1e3,k=Math.min(Math.floor(e.binary?("number"==typeof(c=a)?Math.log(c):w(c)*Math.log(10))/Math.log(1024):w(a)/3),f.length-1),l=((a,b)=>{if("number"==typeof a)return a/b;let c=a/BigInt(b),d=a%BigInt(b);return Number(c)+Number(d)/b})(a,j**k);if(!d){let a=Math.max(3,Number.parseInt(String(l),10).toString().length);l=Number(l.toPrecision(a))}return i+v(Number(l),e.locale,d)+g+f[k]}var y=d;class z extends y.TaggedError("ExifParseError"){}class A extends y.TaggedError("FileReadError"){}let B=i.fn("readFileArrayBuffer")(function*(a){return yield*i.tryPromise({try:()=>a.arrayBuffer(),catch:b=>new A({message:"Array buffer could not be read",cause:b,fileName:a.name,fileType:a.type,fileSize:a.size,phase:"read"})})});var C=a.i(817237),D=a.i(938966),E=a.i(285332);class F{constructor(a){if(function(a){return"object"!=typeof a||void 0===a.length||void 0===a.readUInt8||void 0===a.readUInt16LE||void 0===a.readUInt16BE||void 0===a.readUInt32LE||void 0===a.readUInt32BE||void 0===a.readInt32LE||void 0===a.readInt32BE}(a))throw Error("DataView: Passed buffer type is unsupported.");this.buffer=a,this.byteLength=this.buffer.length}getUint8(a){return this.buffer.readUInt8(a)}getUint16(a,b){return b?this.buffer.readUInt16LE(a):this.buffer.readUInt16BE(a)}getUint32(a,b){return b?this.buffer.readUInt32LE(a):this.buffer.readUInt32BE(a)}getInt32(a,b){return b?this.buffer.readInt32LE(a):this.buffer.readInt32BE(a)}}function G(a,b,c){try{return new DataView(a,b,c)}catch(d){return new F(a,b,c)}}function H(a,b,c){let d=[];for(let e=0;e<c&&b+e<a.byteLength;e++)d.push(a.getUint8(b+e));return K(d)}function I(a,b){let c=[],d=0;for(;b+d<a.byteLength;){let e=a.getUint8(b+d);if(0===e)break;c.push(e),d++}return K(c)}function J(a,b){let c=a.getUint8(b),d=H(a,b+1,c);return[c,d]}function K(a){return a.map(a=>String.fromCharCode(a)).join("")}function L(){for(let a=1;a<arguments.length;a++)for(let b in arguments[a])arguments[0][b]=arguments[a][b];return arguments[0]}function M(a,b,c){let d=!1;Object.defineProperty(a,b,{get:()=>(d||(d=!0,Object.defineProperty(a,b,{configurable:!0,enumerable:!0,value:c.apply(a),writable:!0})),a[b]),configurable:!0,enumerable:!0})}function N(a){return"undefined"!=typeof btoa?"string"==typeof a?btoa(a):btoa(Array.prototype.reduce.call(new Uint8Array(a),(a,b)=>a+String.fromCharCode(b),"")):"undefined"!=typeof Buffer?void 0!==Buffer.from?Buffer.from(a).toString("base64"):new Buffer(a).toString("base64"):void 0}function O(a,b){return Array(b+1).join(a)}function P(a,b,c,d="string"){if(0===b&&"function"==typeof DecompressionStream){let b=new DecompressionStream("deflate"),e=new Blob([a]).stream().pipeThrough(b);return"dataview"===d?new Response(e).arrayBuffer().then(a=>new DataView(a)):new Response(e).arrayBuffer().then(a=>new TextDecoder(c).decode(a))}return void 0!==b?Promise.reject(`Unknown compression method ${b}.`):a}function Q(a){return a.map(a=>String.fromCharCode(a)).join("")}function R(a){if(a.length>=8){let b=Q(a.slice(0,8));if("ASCII\0\0\0"===b)return Q(a.slice(8));if("JIS\0\0\0\0\0"===b)return"[JIS encoded text]";if("UNICODE\0"===b)return"[Unicode encoded text]";else if("\0\0\0\0\0\0\0\0"===b)return"[Undefined encoding]"}return"Undefined"}function S(a){return a[0][0]/a[0][1]+a[1][0]/a[1][1]/60+a[2][0]/a[2][1]/3600}let T=function(a,b){if(18761===a.getUint16(b))return 18761;if(19789===a.getUint16(b))return 19789;throw Error("Illegal byte order value. Faulty image.")},U=function(a){var b;let c;return!!a&&a.byteLength>=4&&(c=18761===(b=a).getUint16(0),42===b.getUint16(2,c))},V=function(a){let b,c,d,e,f,g,h,i,j,k=2;for(;k+4+5<=a.byteLength;){var l,m,n,o,p,q;if(l=a,m=k,65472!==l.getUint16(m)){if(n=a,o=k,65474!==n.getUint16(o))if(function(a,b){let c=$.length;return 65504===a.getUint16(b)&&H(a,b+4,c)===$&&0===a.getUint8(b+4+c)}(a,k))b=a.getUint16(k+2),e=k+2;else if(function(a,b){let c=_.length;return 65505===a.getUint16(b)&&H(a,b+4,c)===_&&0===a.getUint8(b+4+c)}(a,k))b=a.getUint16(k+2),f=k+10;else if(function(a,b){return 65505===a.getUint16(b)&&H(a,b+4,aa.length)===aa}(a,k))h||(h=[]),b=a.getUint16(k+2),h.push({dataOffset:k+33,length:b-31});else if(function(a,b){return 65505===a.getUint16(b)&&H(a,b+4,ab.length)===ab}(a,k))h||(h=[]),b=a.getUint16(k+2),h.push({dataOffset:k+79,length:b-77});else if(function(a,b){let c=ac.length;return 65517===a.getUint16(b)&&H(a,b+4,c)===ac&&0===a.getUint8(b+4+c)}(a,k))b=a.getUint16(k+2),g=k+18;else if(function(a,b){let c=W.length;return 65506===a.getUint16(b)&&H(a,b+4,c)===W}(a,k)){b=a.getUint16(k+2);let c=k+18,d=b-16,e=a.getUint8(k+X),f=a.getUint8(k+Y);i||(i=[]),i.push({offset:c,length:d,chunkNumber:e,chunksTotal:f})}else if(function(a,b){let c=Z.length;return 65506===a.getUint16(b)&&H(a,b+4,c)===Z}(a,k))b=a.getUint16(k+2),j=k+8;else if(function(a,b){let c=a.getUint16(b);return c>=65504&&c<=65519||65534===c||65472===c||65474===c||65476===c||65499===c||65501===c||65498===c}(a,k))b=a.getUint16(k+2);else{if(p=a,q=k,65535===p.getUint16(q)){k++;continue}else break}else b=a.getUint16(k+2),d=k+2}else b=a.getUint16(k+2),c=k+2;k+=2+b}return{hasAppMarkers:k>2,fileDataOffset:c||d,jfifDataOffset:e,tiffHeaderOffset:f,iptcDataOffset:g,xmpChunks:h,iccChunks:i,mpfDataOffset:j}},W="ICC_PROFILE\0",X=4+W.length,Y=X+1,Z="MPF\0",$="JFIF",_="Exif",aa="http://ns.adobe.com/xap/1.0/\0",ab="http://ns.adobe.com/xmp/extension/\0",ac="Photoshop 3.0",ad=function(a,b){let c={hasAppMarkers:!1},d=ae.length;for(;d+4+4<=a.byteLength;){if("IHDR"!==H(a,d+4,4)){var e,f;if(H(e=a,(f=d)+4,4)!==ai||H(e,f+af,ag.length)!==ag)if(function(a,b,c){let d=H(a,b+4,4);return d===ah||d===ai||d===aj&&c}(a,d,b)){c.hasAppMarkers=!0;let b=H(a,d+4,4);c.pngTextChunks||(c.pngTextChunks=[]),c.pngTextChunks.push({length:a.getUint32(d+0),type:b,offset:d+af})}else if("eXIf"===H(a,d+4,4))c.hasAppMarkers=!0,c.tiffHeaderOffset=d+af;else if(b&&"iCCP"===H(a,d+4,4)){c.hasAppMarkers=!0;let b=a.getUint32(d+0),e=d+af,{profileName:f,compressionMethod:g,compressedProfileOffset:h}=function(a,b){let c=I(a,b);return b+=c.length+1,{profileName:c,compressionMethod:a.getUint8(b),compressedProfileOffset:b+=1}}(a,e);c.iccChunks||(c.iccChunks=[]),c.iccChunks.push({offset:h,length:b-(h-e),chunkNumber:1,chunksTotal:1,profileName:f,compressionMethod:g})}else[ak,al].includes(H(a,d+4,4))&&(c.hasAppMarkers=!0,c.pngChunkOffsets||(c.pngChunkOffsets=[]),c.pngChunkOffsets.push(d+0));else{let b=function(a,b){b+=af+ag.length+1+1;let c=0;for(;c<2&&b<a.byteLength;)0===a.getUint8(b)&&c++,b++;if(!(c<2))return b}(a,d);void 0!==b&&(c.hasAppMarkers=!0,c.xmpChunks=[{dataOffset:b,length:a.getUint32(d+0)-(b-(d+af))}])}}else c.hasAppMarkers=!0,c.pngHeaderOffset=d+af;d+=a.getUint32(d+0)+4+4+4}return c},ae="Â‰PNG\r\n\x1a\n",af=8,ag="XML:com.adobe.xmp\0",ah="tEXt",ai="iTXt",aj="zTXt",ak="pHYs",al="tIME";function am(a,b,c){if(4===c)return a.getUint32(b);if(8===c)return console.warn("This file uses an 8-bit offset which is currently not supported by ExifReader. Contact the maintainer to get it fixed."),a.getUint32(b+4);return 0}function an(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;let D,E,{length:F,contentOffset:G}=(c=a,d=b,0===(D=c.getUint32(d))?{length:c.byteLength-d,contentOffset:d+4+4}:1===D&&(e=c,f=d,0===e.getUint32(f+8))?{length:c.getUint32(d+12),contentOffset:d+4+4+8}:{length:D,contentOffset:d+4+4});if(F<8)return;let J=a.getUint32(b+4);if(0x66747970===J){return g=a,h=G,i=F,{type:"ftyp",majorBrand:H(g,h,4),length:i}}if(0x69707270===J){return j=a,k=b,{type:"iprp",subBoxes:aq(j,l=G,(m=F)-(l-k)),length:m}}if(0x6970636f===J){return n=a,o=b,{type:"ipco",properties:aq(n,p=G,(q=F)-(p-o)),length:q}}if(0x636f6c72===J){return r=a,s=G,t=F,{type:"colr",icc:function(a,b){let c=H(a,b,4);if("prof"===c||"rICC"===c)return{offset:b+4,length:a.getUint32(b+4),chunkNumber:1,chunksTotal:1}}(r,s),length:t}}let K=a.getUint8(G);return 0x6d657461===J?(u=a,v=b,{type:"meta",subBoxes:aq(u,(w=G+1)+3,(x=F)-(w+3-v)),length:x}):0x696c6f63===J?function(a,b,c,d){var e,f,g,h,i;let j,k,{offsets:l,sizes:m}=(e=b,f=c+3,j={item:{dataReferenceIndex:2,extentCount:2,extent:{}}},e<2?(j.itemCount=2,j.item.itemId=2):2===e&&(j.itemCount=4,j.item.itemId=4),1===e||2===e?j.item.constructionMethod=2:j.item.constructionMethod=0,(k={offsetSize:f,lengthSize:f,baseOffsetSize:f+1,indexSize:f+1}).itemCount=f+2,k.items=k.itemCount+j.itemCount,k.item={itemId:0},k.item.constructionMethod=k.item.itemId+j.item.itemId,k.item.dataReferenceIndex=k.item.constructionMethod+j.item.constructionMethod,{offsets:k,sizes:j}),n=a.getUint8(l.offsetSize)>>4;m.item.extent.extentOffset=n;let o=15&a.getUint8(l.lengthSize);m.item.extent.extentLength=o;let p=a.getUint8(l.baseOffsetSize)>>4;m.item.baseOffset=p;let q=function(a,b,c){if(1===c||2===c)return 15&a.getUint8(b)}(a,l.indexSize,b);m.item.extent.extentIndex=void 0!==q?q:0;let r=(g=a,h=l.itemCount,(i=b)<2?g.getUint16(h):2===i?g.getUint32(h):void 0);return{type:"iloc",items:function(a,b,c,d,e,f,g,h){if(void 0===h)return[];let i=[],j=c.items;for(let c=0;c<h;c++){var k,l,m;let c={extents:[]};k=a,l=j,c.itemId=(m=b)<2?k.getUint16(l):2===m?k.getUint32(l):void 0,j+=d.item.itemId,c.constructionMethod=1===b||2===b?15&a.getUint16(j):void 0,j+=d.item.constructionMethod,c.dataReferenceIndex=a.getUint16(j),c.baseOffset=am(a,j+=d.item.dataReferenceIndex,d.item.baseOffset),j+=d.item.baseOffset,c.extentCount=a.getUint16(j),j+=d.item.extentCount;for(let h=0;h<c.extentCount;h++){let h={};h.extentIndex=function(a,b,c,d){if((1===b||2===b)&&d>0)return am(a,c,d)}(a,b,j,g),h.extentOffset=am(a,j+=d.item.extent.extentIndex,e),h.extentLength=am(a,j+=d.item.extent.extentOffset,f),j+=d.item.extent.extentLength,c.extents.push(h)}i.push(c)}return i}(a,b,l,m,n,o,q,r),length:d}}(a,K,G+1,F):0x69696e66===J?function(a,b,c,d,e){var f;let g,h,{offsets:i}=(f=c,g={entryCount:d+3},h={},0===f?h.entryCount=2:h.entryCount=4,g.itemInfos=g.entryCount+h.entryCount,{offsets:g});return{type:"iinf",itemInfos:aq(a,i.itemInfos,e-(i.itemInfos-b)),length:e}}(a,b,K,G+1,F):0x696e6665===J?(y=a,z=b,A=K,B=G+1,B+=3,E={type:"infe",length:C=F},(0===A||1===A)&&(E.itemId=y.getUint16(B),B+=2,E.itemProtectionIndex=y.getUint16(B),E.itemName=I(y,B+=2),B+=E.itemName.length+1),A>=2&&(2===A?(E.itemId=y.getUint16(B),B+=2):3===A&&(E.itemId=y.getUint32(B),B+=4),E.itemProtectionIndex=y.getUint16(B),B+=2,E.itemType=y.getUint32(B),E.itemName=I(y,B+=4),B+=E.itemName.length+1,0x6d696d65===E.itemType?(E.contentType=I(y,B),z+C>(B+=E.contentType.length+1)&&(E.contentEncoding=I(y,B),B+=E.contentEncoding.length+1)):0x75726920===E.itemType&&(E.itemUri=I(y,B),B+=E.itemUri.length+1)),E):{type:void 0,length:F}}function ao(a){1;{let b={},c=function(a){let b=0;for(;b+4+4<=a.byteLength;){let c=an(a,b);if(void 0===c)break;if("meta"===c.type)return c;b+=c.length}}(a);return c?(b.tiffHeaderOffset=function(a,b){try{var c,d;let e=b.subBoxes.find(a=>"iinf"===a.type).itemInfos.find(a=>0x45786966===a.itemType).itemId,f=ap(b,e),g=f.baseOffset+f.extents[0].extentOffset;return c=a,(d=g)+4+c.getUint32(d)}catch(a){return}}(a,c),b.xmpChunks=function(a){try{let b=a.subBoxes.find(a=>"iinf"===a.type).itemInfos.find(a=>0x6d696d65===a.itemType&&"application/rdf+xml"===a.contentType).itemId,c=ap(a,b),d=ap(a,b).extents[0];return[{dataOffset:c.baseOffset+d.extentOffset,length:d.extentLength}]}catch(a){return}}(c),b.iccChunks=function(a){try{let b=a.subBoxes.find(a=>"iprp"===a.type).subBoxes.find(a=>"ipco"===a.type).properties.find(a=>"colr"===a.type).icc;if(b)return[b]}catch(a){}}(c),b.hasAppMarkers=void 0!==b.tiffHeaderOffset||void 0!==b.xmpChunks||void 0!==b.iccChunks,b):{hasAppMarkers:!1}}}function ap(a,b){return a.subBoxes.find(a=>"iloc"===a.type).items.find(a=>a.itemId===b)}function aq(a,b,c){let d=[0x45786966,0x6d696d65],e=[],f=b;for(;f<b+c;){let b=an(a,f);if(void 0===b)break;void 0!==b.type&&(void 0===b.itemType||-1!==d.indexOf(b.itemType))&&e.push(b),f+=b.length}return e}let ar=function(a){if(!a)return!1;try{let b=an(a,0);return b&&-1!==["heic","heix","hevc","hevx","heim","heis","hevm","hevs","mif1"].indexOf(b.majorBrand)}catch(a){return!1}},as=function(a){if(!a)return!1;try{let b=an(a,0);return b&&"avif"===b.majorBrand}catch(a){return!1}},at=function(a){let b="RIFF",c="WEBP";return!!a&&H(a,0,b.length)===b&&H(a,8,c.length)===c},au=function(a){let b,c,d,e,f="Exif\0\0",g=12,h=!1;for(;g+8<a.byteLength;){let i=H(a,g,4),j=a.getUint32(g+4,!0);"EXIF"===i?(h=!0,b=H(a,g+8,f.length)===f?g+8+f.length:g+8):"XMP "===i?(h=!0,c=[{dataOffset:g+8,length:j}]):"ICCP"===i?(h=!0,d=[{offset:g+8,length:j,chunkNumber:1,chunksTotal:1}]):"VP8X"===i&&(h=!0,e=g+8),g+=8+(j%2==0?j:j+1)}return{hasAppMarkers:h,tiffHeaderOffset:b,xmpChunks:c,iccChunks:d,vp8xChunkOffset:e}},av=["GIF87a","GIF89a"],aw=function(a){let b=[];return b.push({dataOffset:0,length:a.byteLength}),{xmpChunks:b}},ax="<?xpacket begin",ay=function(a,b){var c,d,e,f;if(U(a))return az({hasAppMarkers:!0,tiffHeaderOffset:0},"tiff","TIFF");if((c=a)&&c.byteLength>=2&&65496===c.getUint16(0))return az(V(a),"jpeg","JPEG");if((d=a)&&H(d,0,ae.length)===ae)return az(ad(a,b),"png","PNG");if(ar(a))return az(ao(a),"heic","HEIC");if(as(a))return az(ao(a),"avif","AVIF");if(at(a))return az(au(a),"webp","WebP");if((e=a)&&av.includes(H(e,0,6)))return az({gifHeaderOffset:0},"gif","GIF");if((f=a)&&H(f,0,ax.length)===ax)return az(aw(a),"xml","XML");throw Error("Invalid image format")};function az(a,b,c){return L({},a,{fileType:{value:b,description:c}})}let aA={ApertureValue:a=>Math.pow(Math.sqrt(2),a[0]/a[1]).toFixed(2),ColorSpace:a=>1===a?"sRGB":65535===a?"Uncalibrated":"Unknown",ComponentsConfiguration:a=>a.map(a=>{if(49===a)return"Y";if(50===a)return"Cb";if(51===a)return"Cr";if(52===a)return"R";if(53===a)return"G";else if(54===a)return"B"}).join(""),Contrast:a=>0===a?"Normal":1===a?"Soft":2===a?"Hard":"Unknown",CustomRendered:a=>0===a?"Normal process":1===a?"Custom process":"Unknown",ExposureMode:a=>0===a?"Auto exposure":1===a?"Manual exposure":2===a?"Auto bracket":"Unknown",ExposureProgram(a){if(0===a)return"Undefined";if(1===a)return"Manual";if(2===a)return"Normal program";if(3===a)return"Aperture priority";if(4===a)return"Shutter priority";else if(5===a)return"Creative program";else if(6===a)return"Action program";else if(7===a)return"Portrait mode";else if(8===a)return"Landscape mode";else if(9===a)return"Bulb";return"Unknown"},ExposureTime(a){if(a[0]/a[1]>.25){let b=a[0]/a[1];return Number.isInteger(b)?""+b:b.toFixed(1)}return 0!==a[0]?`1/${Math.round(a[1]/a[0])}`:`0/${a[1]}`},FNumber:a=>`f/${Number(a[0]/a[1]).toFixed(1)}`,FocalLength:a=>a[0]/a[1]+" mm",FocalPlaneResolutionUnit:a=>2===a?"inches":3===a?"centimeters":4===a?"millimeters":"Unknown",LightSource:a=>{if(1===a)return"Daylight";if(2===a)return"Fluorescent";if(3===a)return"Tungsten (incandescent light)";if(4===a)return"Flash";if(9===a)return"Fine weather";else if(10===a)return"Cloudy weather";else if(11===a)return"Shade";else if(12===a)return"Daylight fluorescent (D 5700 â€“ 7100K)";else if(13===a)return"Day white fluorescent (N 4600 â€“ 5400K)";else if(14===a)return"Cool white fluorescent (W 3900 â€“ 4500K)";else if(15===a)return"White fluorescent (WW 3200 â€“ 3700K)";else if(17===a)return"Standard light A";else if(18===a)return"Standard light B";else if(19===a)return"Standard light C";else if(20===a)return"D55";else if(21===a)return"D65";else if(22===a)return"D75";else if(23===a)return"D50";else if(24===a)return"ISO studio tungsten";else if(255===a)return"Other light source";return"Unknown"},MeteringMode(a){if(1===a)return"Average";if(2===a)return"CenterWeightedAverage";if(3===a)return"Spot";if(4===a)return"MultiSpot";if(5===a)return"Pattern";else if(6===a)return"Partial";else if(255===a)return"Other";return"Unknown"},ResolutionUnit:a=>2===a?"inches":3===a?"centimeters":"Unknown",Saturation:a=>0===a?"Normal":1===a?"Low saturation":2===a?"High saturation":"Unknown",FocalLengthIn35mmFilm:a=>0===a?"Unknown":a+" mm",SceneCaptureType:a=>0===a?"Standard":1===a?"Landscape":2===a?"Portrait":3===a?"Night scene":"Unknown",Sharpness:a=>0===a?"Normal":1===a?"Soft":2===a?"Hard":"Unknown",ShutterSpeedValue(a){let b=Math.pow(2,a[0]/a[1]);return b<=1?`${Math.round(1/b)}`:`1/${Math.round(b)}`},WhiteBalance:a=>0===a?"Auto white balance":1===a?"Manual white balance":"Unknown",XResolution:a=>""+Math.round(a[0]/a[1]),YResolution:a=>""+Math.round(a[0]/a[1])},aB={11:"ProcessingSoftware",254:{name:"SubfileType",description:a=>({0:"Full-resolution image",1:"Reduced-resolution image",2:"Single page of multi-page image",3:"Single page of multi-page reduced-resolution image",4:"Transparency mask",5:"Transparency mask of reduced-resolution image",6:"Transparency mask of multi-page image",7:"Transparency mask of reduced-resolution multi-page image",65537:"Alternate reduced-resolution image",0xffffffff:"Invalid"})[a]||"Unknown"},255:{name:"OldSubfileType",description:a=>({0:"Full-resolution image",1:"Reduced-resolution image",2:"Single page of multi-page image"})[a]||"Unknown"},256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:{name:"Thresholding",description:a=>({1:"No dithering or halftoning",2:"Ordered dither or halfton",3:"Randomized dither"})[a]||"Unknown"},264:"CellWidth",265:"CellLength",266:{name:"FillOrder",description:a=>({1:"Normal",2:"Reversed"})[a]||"Unknown"},269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:{name:"Orientation",description:a=>1===a?"top-left":2===a?"top-right":3===a?"bottom-right":4===a?"bottom-left":5===a?"left-top":6===a?"right-top":7===a?"right-bottom":8===a?"left-bottom":"Undefined"},277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:{name:"XResolution",description:aA.XResolution},283:{name:"YResolution",description:aA.YResolution},284:"PlanarConfiguration",285:"PageName",286:{name:"XPosition",description:a=>""+Math.round(a[0]/a[1])},287:{name:"YPosition",description:a=>""+Math.round(a[0]/a[1])},290:{name:"GrayResponseUnit",description:a=>({1:"0.1",2:"0.001",3:"0.0001",4:"1e-05",5:"1e-06"})[a]||"Unknown"},296:{name:"ResolutionUnit",description:aA.ResolutionUnit},297:"PageNumber",301:"TransferFunction",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",317:"Predictor",318:{name:"WhitePoint",description:a=>a.map(a=>`${a[0]}/${a[1]}`).join(", ")},319:{name:"PrimaryChromaticities",description:a=>a.map(a=>`${a[0]}/${a[1]}`).join(", ")},321:"HalftoneHints",322:"TileWidth",323:"TileLength",330:"A100DataOffset",332:{name:"InkSet",description:a=>({1:"CMYK",2:"Not CMYK"})[a]||"Unknown"},337:"TargetPrinter",338:{name:"ExtraSamples",description:a=>({0:"Unspecified",1:"Associated Alpha",2:"Unassociated Alpha"})[a]||"Unknown"},339:{name:"SampleFormat",description:a=>{let b={1:"Unsigned",2:"Signed",3:"Float",4:"Undefined",5:"Complex int",6:"Complex float"};return Array.isArray(a)?a.map(a=>b[a]||"Unknown").join(", "):"Unknown"}},513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",529:{name:"YCbCrCoefficients",description:a=>a.map(a=>""+a[0]/a[1]).join("/")},530:"YCbCrSubSampling",531:{name:"YCbCrPositioning",description:a=>1===a?"centered":2===a?"co-sited":"undefined "+a},532:{name:"ReferenceBlackWhite",description:a=>a.map(a=>""+a[0]/a[1]).join(", ")},700:"ApplicationNotes",18246:"Rating",18249:"RatingPercent",33432:{name:"Copyright",description:a=>a.join("; ")},33550:"PixelScale",33723:"IPTC-NAA",33920:"IntergraphMatrix",33922:"ModelTiePoint",34118:"SEMInfo",34264:"ModelTransform",34377:"PhotoshopSettings",34665:"Exif IFD Pointer",34675:"ICC_Profile",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34853:"GPS Info IFD Pointer",40091:{name:"XPTitle",description:aC},40092:{name:"XPComment",description:aC},40093:{name:"XPAuthor",description:aC},40094:{name:"XPKeywords",description:aC},40095:{name:"XPSubject",description:aC},42112:"GDALMetadata",42113:"GDALNoData",50341:"PrintIM",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50739:"ShadowScale",50741:{name:"MakerNoteSafety",description:a=>({0:"Unsafe",1:"Safe"})[a]||"Unknown"},50778:{name:"CalibrationIlluminant1",description:aA.LightSource},50779:{name:"CalibrationIlluminant2",description:aA.LightSource},50781:"RawDataUniqueID",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50885:"SRawType",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:{name:"ProfileEmbedPolicy",description:a=>({0:"Allow Copying",1:"Embed if Used",2:"Never Embed",3:"No Restrictions"})[a]||"Unknown"},50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:{name:"PreviewColorSpace",description:a=>({1:"Gray Gamma 2.2",2:"sRGB",3:"Adobe RGB",4:"ProPhoto RGB"})[a]||"Unknown"},50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:{name:"ProfileHueSatMapEncoding",description:a=>({0:"Linear",1:"sRGB"})[a]||"Unknown"},51108:{name:"ProfileLookTableEncoding",description:a=>({0:"Linear",1:"sRGB"})[a]||"Unknown"},51109:"BaselineExposureOffset",51110:{name:"DefaultBlackRender",description:a=>({0:"Auto",1:"None"})[a]||"Unknown"},51111:"NewRawImageDigest",51112:"RawToPreviewGain"};function aC(a){return new TextDecoder("utf-16").decode(new Uint8Array(a)).replace(/\u0000+$/,"")}let aD=L({},aB,{33434:{name:"ExposureTime",description:aA.ExposureTime},33437:{name:"FNumber",description:aA.FNumber},34850:{name:"ExposureProgram",description:aA.ExposureProgram},34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:{name:"OECF",description:()=>"[Raw OECF table data]"},34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:{name:"SensitivityType",description:a=>({1:"Standard Output Sensitivity",2:"Recommended Exposure Index",3:"ISO Speed",4:"Standard Output Sensitivity and Recommended Exposure Index",5:"Standard Output Sensitivity and ISO Speed",6:"Recommended Exposure Index and ISO Speed",7:"Standard Output Sensitivity, Recommended Exposure Index and ISO Speed"})[a]||"Unknown"},34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:{name:"ExifVersion",description:a=>Q(a)},36867:"DateTimeOriginal",36868:"DateTimeDigitized",36873:"GooglePlusUploadCode",36880:"OffsetTime",36881:"OffsetTimeOriginal",36882:"OffsetTimeDigitized",37121:{name:"ComponentsConfiguration",description:aA.ComponentsConfiguration},37122:"CompressedBitsPerPixel",37377:{name:"ShutterSpeedValue",description:aA.ShutterSpeedValue},37378:{name:"ApertureValue",description:aA.ApertureValue},37379:"BrightnessValue",37380:"ExposureBiasValue",37381:{name:"MaxApertureValue",description:a=>Math.pow(Math.sqrt(2),a[0]/a[1]).toFixed(2)},37382:{name:"SubjectDistance",description:a=>a[0]/a[1]+" m"},37383:{name:"MeteringMode",description:aA.MeteringMode},37384:{name:"LightSource",description:aA.LightSource},37385:{name:"Flash",description:a=>{if(0===a)return"Flash did not fire";if(1===a)return"Flash fired";if(5===a)return"Strobe return light not detected";if(7===a)return"Strobe return light detected";if(9===a)return"Flash fired, compulsory flash mode";else if(13===a)return"Flash fired, compulsory flash mode, return light not detected";else if(15===a)return"Flash fired, compulsory flash mode, return light detected";else if(16===a)return"Flash did not fire, compulsory flash mode";else if(24===a)return"Flash did not fire, auto mode";else if(25===a)return"Flash fired, auto mode";else if(29===a)return"Flash fired, auto mode, return light not detected";else if(31===a)return"Flash fired, auto mode, return light detected";else if(32===a)return"No flash function";else if(65===a)return"Flash fired, red-eye reduction mode";else if(69===a)return"Flash fired, red-eye reduction mode, return light not detected";else if(71===a)return"Flash fired, red-eye reduction mode, return light detected";else if(73===a)return"Flash fired, compulsory flash mode, red-eye reduction mode";else if(77===a)return"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected";else if(79===a)return"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected";else if(89===a)return"Flash fired, auto mode, red-eye reduction mode";else if(93===a)return"Flash fired, auto mode, return light not detected, red-eye reduction mode";else if(95===a)return"Flash fired, auto mode, return light detected, red-eye reduction mode";return"Unknown"}},37386:{name:"FocalLength",description:aA.FocalLength},37393:"ImageNumber",37394:{name:"SecurityClassification",description:a=>({C:"Confidential",R:"Restricted",S:"Secret",T:"Top Secret",U:"Unclassified"})[a]||"Unknown"},37395:"ImageHistory",37396:{name:"SubjectArea",description:a=>2===a.length?`Location; X: ${a[0]}, Y: ${a[1]}`:3===a.length?`Circle; X: ${a[0]}, Y: ${a[1]}, diameter: ${a[2]}`:4===a.length?`Rectangle; X: ${a[0]}, Y: ${a[1]}, width: ${a[2]}, height: ${a[3]}`:"Unknown"},37500:{name:"MakerNote",description:()=>"[Raw maker note data]"},37510:{name:"UserComment",description:R},37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37724:"ImageSourceData",37888:{name:"AmbientTemperature",description:a=>a[0]/a[1]+" Â°C"},37889:{name:"Humidity",description:a=>a[0]/a[1]+" %"},37890:{name:"Pressure",description:a=>a[0]/a[1]+" hPa"},37891:{name:"WaterDepth",description:a=>a[0]/a[1]+" m"},37892:{name:"Acceleration",description:a=>a[0]/a[1]+" mGal"},37893:{name:"CameraElevationAngle",description:a=>a[0]/a[1]+" Â°"},40960:{name:"FlashpixVersion",description:a=>a.map(a=>String.fromCharCode(a)).join("")},40961:{name:"ColorSpace",description:aA.ColorSpace},40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",40965:"Interoperability IFD Pointer",41483:"FlashEnergy",41484:{name:"SpatialFrequencyResponse",description:()=>"[Raw SFR table data]"},41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:{name:"FocalPlaneResolutionUnit",description:aA.FocalPlaneResolutionUnit},41492:{name:"SubjectLocation",description:([a,b])=>`X: ${a}, Y: ${b}`},41493:"ExposureIndex",41495:{name:"SensingMethod",description:a=>{if(1===a)return"Undefined";if(2===a)return"One-chip color area sensor";if(3===a)return"Two-chip color area sensor";if(4===a)return"Three-chip color area sensor";if(5===a)return"Color sequential area sensor";else if(7===a)return"Trilinear sensor";else if(8===a)return"Color sequential linear sensor";return"Unknown"}},41728:{name:"FileSource",description:a=>3===a?"DSC":"Unknown"},41729:{name:"SceneType",description:a=>1===a?"A directly photographed image":"Unknown"},41730:{name:"CFAPattern",description:()=>"[Raw CFA pattern table data]"},41985:{name:"CustomRendered",description:aA.CustomRendered},41986:{name:"ExposureMode",description:aA.ExposureMode},41987:{name:"WhiteBalance",description:aA.WhiteBalance},41988:{name:"DigitalZoomRatio",description:a=>0===a[0]?"Digital zoom was not used":""+a[0]/a[1]},41989:{name:"FocalLengthIn35mmFilm",description:aA.FocalLengthIn35mmFilm},41990:{name:"SceneCaptureType",description:aA.SceneCaptureType},41991:{name:"GainControl",description:a=>{if(0===a)return"None";if(1===a)return"Low gain up";if(2===a)return"High gain up";if(3===a)return"Low gain down";if(4===a)return"High gain down";return"Unknown"}},41992:{name:"Contrast",description:aA.Contrast},41993:{name:"Saturation",description:aA.Saturation},41994:{name:"Sharpness",description:aA.Sharpness},41995:{name:"DeviceSettingDescription",description:()=>"[Raw device settings table data]"},41996:{name:"SubjectDistanceRange",description:a=>1===a?"Macro":2===a?"Close view":3===a?"Distant view":"Unknown"},42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:{name:"LensSpecification",description:a=>{let b=parseFloat((a[0][0]/a[0][1]).toFixed(5)),c=parseFloat((a[1][0]/a[1][1]).toFixed(5)),d=`${b}-${c} mm`;if(0===a[3][1])return`${d} f/?`;let e=1/(a[2][1]/a[2][1]/(a[3][0]/a[3][1]));return`${d} f/${parseFloat(e.toFixed(5))}`}},42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42080:{name:"CompositeImage",description:a=>({1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"})[a]||"Unknown"},42081:"SourceImageNumberOfCompositeImage",42082:"SourceExposureTimesOfCompositeImage",42240:"Gamma",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"}),aE="exif",aF="interoperability",aG="canon",aH="pentax",aI={"0th":aD,"1st":aB,[aE]:aD,gps:{0:{name:"GPSVersionID",description:a=>2===a[0]&&2===a[1]&&0===a[2]&&0===a[3]?"Version 2.2":"Unknown"},1:{name:"GPSLatitudeRef",description:a=>{let b=a.join("");return"N"===b?"North latitude":"S"===b?"South latitude":"Unknown"}},2:{name:"GPSLatitude",description:S},3:{name:"GPSLongitudeRef",description:a=>{let b=a.join("");return"E"===b?"East longitude":"W"===b?"West longitude":"Unknown"}},4:{name:"GPSLongitude",description:S},5:{name:"GPSAltitudeRef",description:a=>0===a?"Sea level":1===a?"Sea level reference (negative value)":"Unknown"},6:{name:"GPSAltitude",description:a=>a[0]/a[1]+" m"},7:{name:"GPSTimeStamp",description:a=>a.map(([a,b])=>{let c=a/b;return/^\d(\.|$)/.test(`${c}`)?`0${c}`:c}).join(":")},8:"GPSSatellites",9:{name:"GPSStatus",description:a=>{let b=a.join("");return"A"===b?"Measurement in progress":"V"===b?"Measurement Interoperability":"Unknown"}},10:{name:"GPSMeasureMode",description:a=>{let b=a.join("");return"2"===b?"2-dimensional measurement":"3"===b?"3-dimensional measurement":"Unknown"}},11:"GPSDOP",12:{name:"GPSSpeedRef",description:a=>{let b=a.join("");return"K"===b?"Kilometers per hour":"M"===b?"Miles per hour":"N"===b?"Knots":"Unknown"}},13:"GPSSpeed",14:{name:"GPSTrackRef",description:a=>{let b=a.join("");return"T"===b?"True direction":"M"===b?"Magnetic direction":"Unknown"}},15:"GPSTrack",16:{name:"GPSImgDirectionRef",description:a=>{let b=a.join("");return"T"===b?"True direction":"M"===b?"Magnetic direction":"Unknown"}},17:"GPSImgDirection",18:"GPSMapDatum",19:{name:"GPSDestLatitudeRef",description:a=>{let b=a.join("");return"N"===b?"North latitude":"S"===b?"South latitude":"Unknown"}},20:{name:"GPSDestLatitude",description:a=>a[0][0]/a[0][1]+a[1][0]/a[1][1]/60+a[2][0]/a[2][1]/3600},21:{name:"GPSDestLongitudeRef",description:a=>{let b=a.join("");return"E"===b?"East longitude":"W"===b?"West longitude":"Unknown"}},22:{name:"GPSDestLongitude",description:a=>a[0][0]/a[0][1]+a[1][0]/a[1][1]/60+a[2][0]/a[2][1]/3600},23:{name:"GPSDestBearingRef",description:a=>{let b=a.join("");return"T"===b?"True direction":"M"===b?"Magnetic direction":"Unknown"}},24:"GPSDestBearing",25:{name:"GPSDestDistanceRef",description:a=>{let b=a.join("");return"K"===b?"Kilometers":"M"===b?"Miles":"N"===b?"Knots":"Unknown"}},26:"GPSDestDistance",27:{name:"GPSProcessingMethod",description:R},28:{name:"GPSAreaInformation",description:R},29:"GPSDateStamp",30:{name:"GPSDifferential",description:a=>0===a?"Measurement without differential correction":1===a?"Differential correction applied":"Unknown"},31:"GPSHPositioningError"},[aF]:{1:"InteroperabilityIndex",2:{name:"InteroperabilityVersion",description:a=>Q(a)},4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight"},mpf:{45056:{name:"MPFVersion",description:a=>Q(a)},45057:"NumberOfImages",45058:"MPEntry",45059:"ImageUIDList",45060:"TotalFrames"},[aG]:{4:{name:"ShotInfo",description:a=>a}},[aH]:{0:{name:"PentaxVersion",description:a=>a.join(".")},5:"PentaxModelID",555:"LevelInfo"}},aJ={1:1,2:1,3:2,4:4,5:8,7:1,9:4,10:8,13:4},aK={BYTE:1,ASCII:2,SHORT:3,LONG:4,RATIONAL:5,UNDEFINED:7,SLONG:9,SRATIONAL:10,IFD:13},aL=aP,aM=function(a,b,c){return a.getUint16(b,18761===c)},aN=aQ,aO=function(a){if(void 0===aK[a])throw Error("No such type found.");return aJ[aK[a]]};function aP(a,b){return a.getUint8(b)}function aQ(a,b,c){return a.getUint32(b,18761===c)}function aR(a,b,c){return a.getInt32(b,18761===c)}let aS={1:aL,2:function(a,b){return a.getUint8(b)},3:aM,4:aN,5:function(a,b,c){return[aQ(a,b,c),aQ(a,b+4,c)]},7:function(a,b){return aP(a,b)},9:aR,10:function(a,b,c){return[aR(a,b,c),aR(a,b+4,c)]},13:function(a,b,c){return aQ(a,b,c)}};function aT(a,b,c,d,e,f){var g,h,i;let j=aO("SHORT"),k={},l=(g=a,h=d,i=e,h+aO("SHORT")<=g.byteLength?aM(g,h,i):0);d+=j;for(let g=0;g<l&&!(d+12>a.byteLength);g++){let g=function(a,b,c,d,e,f){var g,h,i,j,k,l,m;let n,o,p=aO("SHORT"),q=p+aO("SHORT"),r=q+aO("LONG"),s=aM(a,d,e),t=aM(a,d+p,e),u=aN(a,d+q,e);if(void 0===aJ[t]||!f&&void 0===aI[b][s])return;(g=t,h=u,aJ[g]*h<=aO("LONG"))?n=aU(a,o=d+r,t,u,e):(o=aN(a,d+r,e),i=a,j=c,k=o,l=t,m=u,n=j+k+aJ[l]*m<=i.byteLength?aU(a,c+o,t,u,e,33723===s):"<faulty value>"),t===aK.ASCII&&(n=function(a){try{return a.map(a=>decodeURIComponent(escape(a)))}catch(b){return a}}(n=function(a){let b=[],c=0;for(let d=0;d<a.length;d++){if("\0"===a[d]){c++;continue}void 0===b[c]&&(b[c]=""),b[c]+=a[d]}return b}(n)));let v=`undefined-${s}`,w=n;if(void 0!==aI[b][s])if(void 0!==aI[b][s].name&&void 0!==aI[b][s].description){v=aI[b][s].name;try{w=aI[b][s].description(n)}catch(a){w=aV(n)}}else t===aK.RATIONAL||t===aK.SRATIONAL?(v=aI[b][s],w=""+n[0]/n[1]):(v=aI[b][s],w=aV(n));return{id:s,name:v,value:n,description:w,__offset:o}}(a,b,c,d,e,f);void 0!==g&&(k[g.name]={id:g.id,value:g.value,description:g.description},("MakerNote"===g.name||b===aH&&"LevelInfo"===g.name)&&(k[g.name].__offset=g.__offset)),d+=12}if(d<a.byteLength-aO("LONG")){let g=aN(a,d,e);0!==g&&"0th"===b&&(k.Thumbnail=aT(a,"1st",c,c+g,e,f))}return k}function aU(a,b,c,d,e,f=!1){let g=[];f&&(d*=aJ[c],c=aK.BYTE);for(let f=0;f<d;f++)g.push(aS[c](a,b,e)),b+=aJ[c];return c===aK.ASCII?g=g.map(a=>String.fromCharCode(a)):1===g.length&&(g=g[0]),g}function aV(a){return a instanceof Array?a.join(", "):a}let aW="Exif IFD Pointer",aX="GPS Info IFD Pointer",aY="Interoperability IFD Pointer",aZ=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;let s=T(a,b),t=function(a,b,c,d){return aT(a,"0th",b,b+aN(a,b+4,c),c,d)}(a,b,s,c);return{tags:(n=(i=(d=t,e=a,f=b,g=s,h=c,t=void 0!==d[aW]?L(d,aT(e,aE,f,f+d[aW].value,g,h)):d),j=a,k=b,l=s,m=c,t=void 0!==i[aX]?L(i,aT(j,"gps",k,k+i[aX].value,l,m)):i),o=a,p=b,q=s,r=c,t=void 0!==n[aY]?L(n,aT(o,aF,p,p+n[aY].value,q,r)):n),byteOrder:s}},a$=function(a,b,c){let d=T(a,b),e=aT(a,"mpf",b,b+aN(a,b+4,d),d,c);return function(a,b,c,d){if(!c.MPEntry)return c;let e=[];for(let f=0;f<Math.ceil(c.MPEntry.value.length/16);f++){e[f]={};let g=a_(c.MPEntry.value,16*f,aO("LONG"),d);e[f].ImageFlags=function(a){let b=[a>>31&1,a>>30&1,a>>29&1],c=[];return b[0]&&c.push("Dependent Parent Image"),b[1]&&c.push("Dependent Child Image"),b[2]&&c.push("Representative Image"),{value:b,description:c.join(", ")||"None"}}(g),e[f].ImageFormat=function(a){let b=a>>24&7;return{value:b,description:0===b?"JPEG":"Unknown"}}(g),e[f].ImageType=function(a){let b=0xffffff&a;return{value:b,description:({196608:"Baseline MP Primary Image",65537:"Large Thumbnail (VGA equivalent)",65538:"Large Thumbnail (Full HD equivalent)",131073:"Multi-Frame Image (Panorama)",131074:"Multi-Frame Image (Disparity)",131075:"Multi-Frame Image (Multi-Angle)",0:"Undefined"})[b]||"Unknown"}}(g);let h=a_(c.MPEntry.value,16*f+4,aO("LONG"),d);e[f].ImageSize={value:h,description:""+h};let i=function(a,b,c,d){return 0===a?0:a_(b.value,16*a+8,aO("LONG"),c)+d}(f,c.MPEntry,d,b);e[f].ImageOffset={value:i,description:""+i};let j=a_(c.MPEntry.value,16*f+12,aO("SHORT"),d);e[f].DependentImage1EntryNumber={value:j,description:""+j};let k=a_(c.MPEntry.value,16*f+14,aO("SHORT"),d);e[f].DependentImage2EntryNumber={value:k,description:""+k},e[f].image=a.buffer.slice(i,i+h),M(e[f],"base64",function(){return N(this.image)})}return c.Images=e,c}(a,b,e,d)};function a_(a,b,c,d){if(18761===d){let d=0;for(let e=0;e<c;e++)d+=a[b+e]<<8*e;return d}let e=0;for(let d=0;d<c;d++)e+=a[b+d]<<8*(c-1-d);return e}let a0=function(a,b){let c=aM(a,b),d=function(a,b,c){if(8>c)return;let d=aL(a,b+7);return{value:d,description:""+d}}(a,b,c);return{"Bits Per Sample":function(a,b,c){if(3>c)return;let d=aL(a,b+2);return{value:d,description:""+d}}(a,b,c),"Image Height":function(a,b,c){if(5>c)return;let d=aM(a,b+3);return{value:d,description:`${d}px`}}(a,b,c),"Image Width":function(a,b,c){if(7>c)return;let d=aM(a,b+5);return{value:d,description:`${d}px`}}(a,b,c),"Color Components":d,Subsampling:d&&function(a,b,c,d){var e;let f,g;if(8+3*c>d)return;let h=[];for(let d=0;d<c;d++){let c=b+8+3*d;h.push([aL(a,c),aL(a,c+1),aL(a,c+2)])}return{value:h,description:h.length>1?(f={1:"Y",2:"Cb",3:"Cr",4:"I",5:"Q"},h.map(a=>f[a[0]]).join("")+(g={17:"4:4:4 (1 1)",18:"4:4:0 (1 2)",20:"4:4:1 (1 4)",33:"4:2:2 (2 1)",34:"4:2:0 (2 2)",36:"4:2:1 (2 4)",65:"4:1:1 (4 1)",66:"4:1:0 (4 2)"},0===(e=h).length||void 0===e[0][1]||void 0===g[e[0][1]]?"":g[e[0][1]])):""}}(a,b,d.value,c)}},a1=function(a,b){let c=aM(a,b),d=function(a,b,c){if(15>c)return;let d=aL(a,b+14);return{value:d,description:`${d}px`}}(a,b,c),e=function(a,b,c){if(16>c)return;let d=aL(a,b+15);return{value:d,description:`${d}px`}}(a,b,c),f={"JFIF Version":function(a,b,c){if(9>c)return;let d=aL(a,b+7),e=aL(a,b+7+1);return{value:256*d+e,description:d+"."+e}}(a,b,c),"Resolution Unit":function(a,b,c){var d;if(10>c)return;let e=aL(a,b+9);return{value:e,description:0===(d=e)?"None":1===d?"inches":2===d?"cm":"Unknown"}}(a,b,c),XResolution:function(a,b,c){if(12>c)return;let d=aM(a,b+10);return{value:d,description:""+d}}(a,b,c),YResolution:function(a,b,c){if(14>c)return;let d=aM(a,b+12);return{value:d,description:""+d}}(a,b,c),"JFIF Thumbnail Width":d,"JFIF Thumbnail Height":e};if(void 0!==d&&void 0!==e){let g=function(a,b,c,d){if(0!==c&&!(16+c>d))return{value:a.buffer.slice(b+16,b+16+c),description:"<24-bit RGB pixel data>"}}(a,b,3*d.value*e.value,c);g&&(f["JFIF Thumbnail"]=g)}for(let a in f)void 0===f[a]&&delete f[a];return f},a2={256:{name:"Model Version",description:a=>((a[0]<<8)+a[1]).toString()},261:{name:"Destination",repeatable:!0},276:{name:"File Format",description:a=>((a[0]<<8)+a[1]).toString()},278:{name:"File Format Version",description:a=>((a[0]<<8)+a[1]).toString()},286:"Service Identifier",296:"Envelope Number",306:"Product ID",316:"Envelope Priority",326:{name:"Date Sent",description:a3},336:{name:"Time Sent",description:a4},346:{name:"Coded Character Set",description:a5,encoding_name:a5},356:"UNO",376:{name:"ARM Identifier",description:a=>((a[0]<<8)+a[1]).toString()},378:{name:"ARM Version",description:a=>((a[0]<<8)+a[1]).toString()},512:{name:"Record Version",description:a=>((a[0]<<8)+a[1]).toString()},515:"Object Type Reference",516:"Object Attribute Reference",517:"Object Name",519:"Edit Status",520:{name:"Editorial Update",description:a=>"01"===Q(a)?"Additional Language":"Unknown"},522:"Urgency",524:{name:"Subject Reference",repeatable:!0,description:a=>{let b=Q(a).split(":");return b[2]+(b[3]?"/"+b[3]:"")+(b[4]?"/"+b[4]:"")}},527:"Category",532:{name:"Supplemental Category",repeatable:!0},534:"Fixture Identifier",537:{name:"Keywords",repeatable:!0},538:{name:"Content Location Code",repeatable:!0},539:{name:"Content Location Name",repeatable:!0},542:"Release Date",547:"Release Time",549:"Expiration Date",550:"Expiration Time",552:"Special Instructions",554:{name:"Action Advised",description:a=>{let b=Q(a);return"01"===b?"Object Kill":"02"===b?"Object Replace":"03"===b?"Object Append":"04"===b?"Object Reference":"Unknown"}},557:{name:"Reference Service",repeatable:!0},559:{name:"Reference Date",repeatable:!0},562:{name:"Reference Number",repeatable:!0},567:{name:"Date Created",description:a3},572:{name:"Time Created",description:a4},574:{name:"Digital Creation Date",description:a3},575:{name:"Digital Creation Time",description:a4},577:"Originating Program",582:"Program Version",587:{name:"Object Cycle",description:a=>{let b=Q(a);return"a"===b?"morning":"p"===b?"evening":"b"===b?"both":"Unknown"}},592:{name:"By-line",repeatable:!0},597:{name:"By-line Title",repeatable:!0},602:"City",604:"Sub-location",607:"Province/State",612:"Country/Primary Location Code",613:"Country/Primary Location Name",615:"Original Transmission Reference",617:"Headline",622:"Credit",627:"Source",628:"Copyright Notice",630:{name:"Contact",repeatable:!0},632:"Caption/Abstract",634:{name:"Writer/Editor",repeatable:!0},637:{name:"Rasterized Caption",description:a=>a},642:"Image Type",643:{name:"Image Orientation",description:a=>{let b=Q(a);return"P"===b?"Portrait":"L"===b?"Landscape":"S"===b?"Square":"Unknown"}},647:"Language Identifier",662:{name:"Audio Type",description:a=>{let b=Q(a),c=b.charAt(0),d=b.charAt(1),e="";return("1"===c?e+="Mono":"2"===c&&(e+="Stereo"),"A"===d?e+=", actuality":"C"===d?e+=", question and answer session":"M"===d?e+=", music, transmitted by itself":"Q"===d?e+=", response to a question":"R"===d?e+=", raw sound":"S"===d?e+=", scener":"V"===d?e+=", voicer":"W"===d&&(e+=", wrap"),""!==e)?e:b}},663:{name:"Audio Sampling Rate",description:a=>parseInt(Q(a),10)+" Hz"},664:{name:"Audio Sampling Resolution",description:a=>{let b=parseInt(Q(a),10);return b+(1===b?" bit":" bits")}},665:{name:"Audio Duration",description:a=>{let b=Q(a);return b.length>=6?b.substr(0,2)+":"+b.substr(2,2)+":"+b.substr(4,2):b}},666:"Audio Outcue",698:"Short Document ID",699:"Unique Document ID",700:"Owner ID",712:{name:a=>2===a.length?"ObjectData Preview File Format":"Record 2 destination",description:a=>{if(2===a.length){let b=(a[0]<<8)+a[1];if(0===b)return"No ObjectData";if(1===b)return"IPTC-NAA Digital Newsphoto Parameter Record";if(2===b)return"IPTC7901 Recommended Message Format";else if(3===b)return"Tagged Image File Format (Adobe/Aldus Image data)";else if(4===b)return"Illustrator (Adobe Graphics data)";else if(5===b)return"AppleSingle (Apple Computer Inc)";else if(6===b)return"NAA 89-3 (ANPA 1312)";else if(7===b)return"MacBinary II";else if(8===b)return"IPTC Unstructured Character Oriented File Format (UCOFF)";else if(9===b)return"United Press International ANPA 1312 variant";else if(10===b)return"United Press International Down-Load Message";else if(11===b)return"JPEG File Interchange (JFIF)";else if(12===b)return"Photo-CD Image-Pac (Eastman Kodak)";else if(13===b)return"Microsoft Bit Mapped Graphics File [*.BMP]";else if(14===b)return"Digital Audio File [*.WAV] (Microsoft & Creative Labs)";else if(15===b)return"Audio plus Moving Video [*.AVI] (Microsoft)";else if(16===b)return"PC DOS/Windows Executable Files [*.COM][*.EXE]";else if(17===b)return"Compressed Binary File [*.ZIP] (PKWare Inc)";else if(18===b)return"Audio Interchange File Format AIFF (Apple Computer Inc)";else if(19===b)return"RIFF Wave (Microsoft Corporation)";else if(20===b)return"Freehand (Macromedia/Aldus)";else if(21===b)return'Hypertext Markup Language "HTML" (The Internet Society)';else if(22===b)return"MPEG 2 Audio Layer 2 (Musicom), ISO/IEC";else if(23===b)return"MPEG 2 Audio Layer 3, ISO/IEC";else if(24===b)return"Portable Document File (*.PDF) Adobe";else if(25===b)return"News Industry Text Format (NITF)";else if(26===b)return"Tape Archive (*.TAR)";else if(27===b)return"Tidningarnas TelegrambyrÃ¥ NITF version (TTNITF DTD)";else if(28===b)return"Ritzaus Bureau NITF version (RBNITF DTD)";else if(29===b)return"Corel Draw [*.CDR]";return`Unknown format ${b}`}return Q(a)}},713:{name:"ObjectData Preview File Format Version",description:(a,b)=>{let c={"00":{"00":"1"},"01":{"01":"1","02":"2","03":"3","04":"4"},"02":{"04":"4"},"03":{"01":"5.0","02":"6.0"},"04":{"01":"1.40"},"05":{"01":"2"},"06":{"01":"1"},11:{"01":"1.02"},20:{"01":"3.1","02":"4.0","03":"5.0","04":"5.5"},21:{"02":"2.0"}},d=Q(a);if(b["ObjectData Preview File Format"]){let a=Q(b["ObjectData Preview File Format"].value);if(c[a]&&c[a][d])return c[a][d]}return d}},714:"ObjectData Preview Data",1802:{name:"Size Mode",description:a=>a[0].toString()},1812:{name:"Max Subfile Size",description:a=>{let b=0;for(let c=0;c<a.length;c++)b=(b<<8)+a[c];return b.toString()}},1882:{name:"ObjectData Size Announced",description:a=>{let b=0;for(let c=0;c<a.length;c++)b=(b<<8)+a[c];return b.toString()}},1887:{name:"Maximum ObjectData Size",description:a=>{let b=0;for(let c=0;c<a.length;c++)b=(b<<8)+a[c];return b.toString()}}};function a3(a){let b=Q(a);return b.length>=8?b.substr(0,4)+"-"+b.substr(4,2)+"-"+b.substr(6,2):b}function a4(a){let b=Q(a),c=b;return b.length>=6&&(c=b.substr(0,2)+":"+b.substr(2,2)+":"+b.substr(4,2),11===b.length&&(c+=b.substr(6,1)+b.substr(7,2)+":"+b.substr(9,2))),c}function a5(a){let b=Q(a);if("\x1b%G"===b)return"UTF-8";if("\x1b%5"===b)return"Windows-1252";if("\x1b%/G"===b)return"UTF-8 Level 1";if("\x1b%/H"===b)return"UTF-8 Level 2";if("\x1b%/I"===b)return"UTF-8 Level 3";else if("\x1b/A"===b)return"ISO-8859-1";else if("\x1b/B"===b)return"ISO-8859-2";else if("\x1b/C"===b)return"ISO-8859-3";else if("\x1b/D"===b)return"ISO-8859-4";else if("\x1b/@"===b)return"ISO-8859-5";else if("\x1b/G"===b)return"ISO-8859-6";else if("\x1b/F"===b)return"ISO-8859-7";else if("\x1b/H"===b)return"ISO-8859-8";return"Unknown"}let a6=function(){if("undefined"!=typeof TextDecoder)return TextDecoder},a7=function(a,b){let c=a6();if(void 0!==c&&void 0!==a)try{return new c(a).decode(b instanceof DataView?b.buffer:Uint8Array.from(b))}catch(a){}var d=b.map(a=>String.fromCharCode(a)).join("");try{return decodeURIComponent(escape(d))}catch(a){return d}},a8=function(a,b,c){try{if(Array.isArray(a))return a9(new DataView(Uint8Array.from(a).buffer),{size:a.length},0,c);let{naaBlock:d,dataOffset:e}=function(a,b){for(;b+12<=a.byteLength;){var c,d;let e=function(a,b){if(0x3842494d!==a.getUint32(b,!1))throw Error("Not an IPTC resource block.");let c=a.getUint8(b+4+2),d=(c%2==0?c+1:c)+1;return{headerSize:6+d+4,type:a.getUint16(b+4),size:a.getUint32(b+4+2+d)}}(a,b);if(c=e,1028===c.type)return{naaBlock:e,dataOffset:b+e.headerSize};b+=e.headerSize+e.size+(d=e,+(d.size%2!=0))}throw Error("No IPTC NAA resource block.")}(a,b);return a9(a,d,e,c)}catch(a){return{}}};function a9(a,b,c,d){let e,f={},g=c+b.size;for(;c<g&&c<a.byteLength;){let{tag:b,tagSize:g}=function(a,b,c,d,e){var f,g,h,i;if(f=a,g=b,28!==f.getUint8(g))return{tag:null,tagSize:0};let j=a.getUint16(b+1),k=a.getUint16(b+3);if(!e&&!a2[j])return{tag:void 0,tagSize:k};let l=function(a,b,c){let d=[];for(let e=0;e<c;e++)d.push(a.getUint8(b+e));return d}(a,b+5,k),m={id:j,name:function(a,b,c){return a?"string"==typeof a?a:"function"==typeof a.name?a.name(c):a.name:`undefined-${b}`}(a2[j],j,l),value:l,description:function(a,b,c,d){var e,f,g;if((e=a)&&void 0!==e.description)try{return a.description(b,c)}catch(a){}return(f=a,g=b,f&&g instanceof Array)?a7(d,b):b}(a2[j],l,c,d)};return a2[h=j]&&a2[h].repeatable&&(m.repeatable=!0),a2[i=j]&&void 0!==a2[i].encoding_name&&(m.encoding=a2[j].encoding_name(l)),{tag:m,tagSize:k}}(a,c,f,e,d);if(null===b)break;b&&("encoding"in b&&(e=b.encoding),void 0===f[b.name]||void 0===b.repeatable?f[b.name]={id:b.id,value:b.value,description:b.description}:(f[b.name]instanceof Array||(f[b.name]=[{id:f[b.name].id,value:f[b.name].value,description:f[b.name].description}]),f[b.name].push({id:b.id,value:b.value,description:b.description}))),c+=5+g}return f}let ba={"tiff:Orientation":a=>"1"===a?"Horizontal (normal)":"2"===a?"Mirror horizontal":"3"===a?"Rotate 180":"4"===a?"Mirror vertical":"5"===a?"Mirror horizontal and rotate 270 CW":"6"===a?"Rotate 90 CW":"7"===a?"Mirror horizontal and rotate 90 CW":"8"===a?"Rotate 270 CW":a,"tiff:ResolutionUnit":a=>aA.ResolutionUnit(parseInt(a,10)),"tiff:XResolution":a=>bb(aA.XResolution,a),"tiff:YResolution":a=>bb(aA.YResolution,a),"exif:ApertureValue":a=>bb(aA.ApertureValue,a),"exif:GPSLatitude":bd,"exif:GPSLongitude":bd,"exif:FNumber":a=>bb(aA.FNumber,a),"exif:FocalLength":a=>bb(aA.FocalLength,a),"exif:FocalPlaneResolutionUnit":a=>aA.FocalPlaneResolutionUnit(parseInt(a,10)),"exif:ColorSpace":a=>{var b;return aA.ColorSpace("0x"===(b=a).substring(0,2)?parseInt(b.substring(2),16):parseInt(b,10))},"exif:ComponentsConfiguration"(a,b){if(/^\d, \d, \d, \d$/.test(b)){let a=b.split(", ").map(a=>a.charCodeAt(0));return aA.ComponentsConfiguration(a)}return b},"exif:Contrast":a=>aA.Contrast(parseInt(a,10)),"exif:CustomRendered":a=>aA.CustomRendered(parseInt(a,10)),"exif:ExposureMode":a=>aA.ExposureMode(parseInt(a,10)),"exif:ExposureProgram":a=>aA.ExposureProgram(parseInt(a,10)),"exif:ExposureTime":a=>bc(a)?aA.ExposureTime(a.split("/").map(a=>parseInt(a,10))):a,"exif:MeteringMode":a=>aA.MeteringMode(parseInt(a,10)),"exif:Saturation":a=>aA.Saturation(parseInt(a,10)),"exif:SceneCaptureType":a=>aA.SceneCaptureType(parseInt(a,10)),"exif:Sharpness":a=>aA.Sharpness(parseInt(a,10)),"exif:ShutterSpeedValue":a=>bb(aA.ShutterSpeedValue,a),"exif:WhiteBalance":a=>aA.WhiteBalance(parseInt(a,10))};function bb(a,b){return bc(b)?a(b.split("/")):b}function bc(a){return/^-?\d+\/-?\d+$/.test(a)}function bd(a){let[b,c]=a.split(",");if(void 0!==b&&void 0!==c){let a=parseFloat(b),d=parseFloat(c),e=c.charAt(c.length-1);if(!Number.isNaN(a)&&!Number.isNaN(d))return""+(a+d/60)+e}return a}let be=function(a){if(a)return a;if("undefined"!=typeof DOMParser)return new DOMParser;try{let{DOMParser:a,onErrorStopParsing:b}=__non_webpack_require__("@xmldom/xmldom");return new a({onError:b})}catch(a){return}},bf={xmp:"http://ns.adobe.com/xap/1.0/",tiff:"http://ns.adobe.com/tiff/1.0/",exif:"http://ns.adobe.com/exif/1.0/",dc:"http://purl.org/dc/elements/1.1/",xmpMM:"http://ns.adobe.com/xap/1.0/mm/",stEvt:"http://ns.adobe.com/xap/1.0/sType/ResourceEvent#",stRef:"http://ns.adobe.com/xap/1.0/sType/ResourceRef#",photoshop:"http://ns.adobe.com/photoshop/1.0/"},bg=function(a,b,c){let d={};if("string"==typeof a)return bj(d,a,c),d;let[e,f]=function(a,b){if(0===b.length)return[];let c=[bi(a,b.slice(0,1))];return b.length>1&&c.push(bi(a,b.slice(1))),c}(a,b),g=bj(d,e,c);if(f){let e=bj(d,f,c);g||e||(delete d._raw,bj(d,bi(a,b),c))}return d};class bh extends Error{constructor(a){super(a),this.name="ParseError"}}function bi(a,b){let c=new Uint8Array(b.reduce((a,b)=>a+b.length,0)),d=0;for(let e=0;e<b.length;e++){let f=b[e],g=a.buffer.slice(f.dataOffset,f.dataOffset+f.length);c.set(new Uint8Array(g),d),d+=f.length}return new DataView(c.buffer)}function bj(a,b,c){try{let{doc:d,raw:e}=function(a,b){let c=be(b);if(!c)throw console.warn("Warning: DOMParser is not available. It is needed to be able to parse XMP tags."),Error();let d="string"==typeof a?a:H(a,0,a.byteLength);return{doc:function a(b,c,d=!1){try{let a=b.parseFromString(c,"application/xml"),d=a.getElementsByTagName("parsererror");if(d.length>0)throw new bh(d[0].textContent);return a}catch(e){if("ParseError"===e.name&&function(a){let b=["prefix is non-null and namespace is null","prefix not bound to a namespace","prefix inte bundet till en namnrymd",/Namespace prefix .+ is not defined/];for(let c=0;c<b.length;c++)if(new RegExp(b[c]).test(a.message))return!0;return!1}(e)&&!d)return a(b,function(a){var b,c,d;let e,f=a.match(/<([A-Za-z_][A-Za-z0-9._-]*)([^>]*)>/);if(!f)return a;let g=f[1],h=function(a){let b,c=[],d=/xmlns:([\w-]+)=["'][^"']+["']/g;for(;null!==(b=d.exec(a));)-1===c.indexOf(b[1])&&c.push(b[1]);return c}(a),i=(function(a){let b,c=[],d=/\b([A-Za-z_][A-Za-z0-9._-]*):[A-Za-z_][A-Za-z0-9._-]*\b/g;for(;null!==(b=d.exec(a));){let a=b[1];"xmlns"!==a&&"xml"!==a&&-1===c.indexOf(a)&&c.push(a)}return c})(a).filter(a=>-1===h.indexOf(a));return 0===i.length?a:(b=a,c=g,d=function(a){let b=[];for(let c=0;c<a.length;c++){let d=a[c],e=bf[d]||"http://fallback.namespace/"+d;b.push(" xmlns:"+d+'="'+e+'"')}return b.join("")}(i),e=RegExp("<"+c+"([^>]*)>"),b.replace(e,"<"+c+"$1"+d+">"))}(c),!0);throw e}}(c,d.replace(/^.+(<\?xpacket begin)/,"$1").replace(/(<\?xpacket end=".*"\?>).+$/,"$1")),raw:d}}(b,c);a._raw=(a._raw||"")+e;let f=function a(b){for(let c=0;c<b.childNodes.length;c++){if("x:xmpmeta"===b.childNodes[c].tagName)return a(b.childNodes[c]);if("rdf:RDF"===b.childNodes[c].tagName)return b.childNodes[c]}throw Error()}(d);return L(a,bk(function a(b,c=!1){var d;let e,f=function(a){let b=[];for(let c=0;c<a.childNodes.length;c++)b.push(a.childNodes[c]);return b}(b);if(1===(d=f).length&&"#text"===d[0].nodeName)return c?{}:f[0].nodeValue;return e={},f.forEach(b=>{var c,d;if((c=b).nodeName&&"#text"!==c.nodeName){let c={attributes:function(a){let b={};for(let c=0;c<a.attributes.length;c++)b[a.attributes[c].nodeName]=decodeURIComponent(escape(a.attributes[c].value));return b}(d=b),value:a(d)};void 0!==e[b.nodeName]?(Array.isArray(e[b.nodeName])||(e[b.nodeName]=[e[b.nodeName]]),e[b.nodeName].push(c)):e[b.nodeName]=c}}),e}(f,!0))),!0}catch(a){return!1}}function bk(a){let b={};if("string"==typeof a)return a;for(let c in a){let d=a[c];Array.isArray(d)||(d=[d]),d.forEach(a=>{L(b,bl(a.attributes)),"object"==typeof a.value&&L(b,bp(a.value))})}return b}function bl(a){let b={};for(let d in a)try{var c;c=d,"rdf:parseType"===c||bm(c)||(b[bn(d)]={value:a[d],attributes:{},description:bo(a[d],d)})}catch(a){}return b}function bm(a){return"xmlns"===a.split(":")[0]}function bn(a){return/^MicrosoftPhoto(_\d+_)?:Rating$/i.test(a)?"RatingPercent":a.split(":")[1]}function bo(a,b){if(Array.isArray(a)){let c=a.map(a=>void 0!==a.value?bo(a.value):bo(a)).join(", ");return b&&"function"==typeof ba[b]?ba[b](a,c):c}if("object"==typeof a){var c,d=a;let b=[];for(let a in d){b.push(`${"CiAdrCity"===(c=a)?"CreatorCity":"CiAdrCtry"===c?"CreatorCountry":"CiAdrExtadr"===c?"CreatorAddress":"CiAdrPcode"===c?"CreatorPostalCode":"CiAdrRegion"===c?"CreatorRegion":"CiEmailWork"===c?"CreatorWorkEmail":"CiTelWork"===c?"CreatorWorkPhone":"CiUrlWork"===c?"CreatorWorkUrl":c}: ${bo(d[a].value)}`)}return b.join("; ")}try{if(b&&"function"==typeof ba[b])return ba[b](a);return decodeURIComponent(escape(a))}catch(b){return a}}function bp(a){let b={};for(let c in a)try{bm(c)||(b[bn(c)]=function(a,b){var c,d,e,f,g;return(c=a,Array.isArray(c))?(d=a,e=b,by(d[d.length-1],e)):(f=a,"Resource"===f.attributes["rdf:parseType"]&&"string"==typeof f.value&&""===f.value.trim())?{value:"",attributes:{},description:""}:bq(a)?br(a,b):bt(a)?bu(a,b):bv(a)?bw(a,b):(g=a,void 0!==bx(g.value))?function(a,b){let c=bx(a.value).value["rdf:li"],d=bs(a),e=[];return void 0===c?c=[]:Array.isArray(c)||(c=[c]),c.forEach(a=>{var b;e.push((b=a,bq(b)?br(b):bt(b)?bu(b).value:bv(b)?bw(b).value:by(b)))}),{value:e,attributes:d,description:bo(e,b)}}(a,b):by(a,b)}(a[c],c))}catch(a){}return b}function bq(a){return"Resource"===a.attributes["rdf:parseType"]&&void 0!==a.value["rdf:value"]||void 0!==a.value["rdf:Description"]&&void 0!==a.value["rdf:Description"].value["rdf:value"]}function br(a,b){var c;let d=bs(a);void 0!==a.value["rdf:Description"]&&(a=a.value["rdf:Description"]),L(d,bs(a),function(a){let b={};for(let c in a.value)"rdf:value"===c||bm(c)||(b[bn(c)]=a.value[c].value);return b}(a));let e=bz((c=a).value["rdf:value"])||c.value["rdf:value"].value;return{value:e,attributes:d,description:bo(e,b)}}function bs(a){let b={};for(let c in a.attributes)"rdf:parseType"===c||"rdf:resource"===c||bm(c)||(b[bn(c)]=a.attributes[c]);return b}function bt(a){return"Resource"===a.attributes["rdf:parseType"]||void 0!==a.value["rdf:Description"]&&void 0===a.value["rdf:Description"].value["rdf:value"]}function bu(a,b){let c={value:{},attributes:{}};return void 0!==a.value["rdf:Description"]&&(L(c.value,bl(a.value["rdf:Description"].attributes)),L(c.attributes,bs(a)),a=a.value["rdf:Description"]),L(c.value,bp(a.value)),c.description=bo(c.value,b),c}function bv(a){return 0===Object.keys(a.value).length&&void 0===a.attributes["xml:lang"]&&void 0===a.attributes["rdf:resource"]}function bw(a,b){let c=bl(a.attributes);return{value:c,attributes:{},description:bo(c,b)}}function bx(a){return a["rdf:Bag"]||a["rdf:Seq"]||a["rdf:Alt"]}function by(a,b){let c=bz(a)||bk(a.value);return{value:c,attributes:bs(a),description:bo(c,b)}}function bz(a){return a.attributes&&a.attributes["rdf:resource"]}let bA={2e3:{name:"PathInformation",description:function(a){let b={},c=[];for(let d=0;d<a.byteLength;d+=26){let e=aM(a,d);bB[e]&&(b[e]||(b[e]=bB[e].description),c.push({type:e,path:bB[e].path(a,d+2)}))}return JSON.stringify({types:b,paths:c})}},2999:{name:"ClippingPathName",description(a){let[,b]=J(a,0);return b}}},bB={0:{description:"Closed subpath length",path:(a,b)=>[aM(a,b)]},1:{description:"Closed subpath Bezier knot, linked",path:bC},2:{description:"Closed subpath Bezier knot, unlinked",path:bC},3:{description:"Open subpath length",path:(a,b)=>[aM(a,b)]},4:{description:"Open subpath Bezier knot, linked",path:bC},5:{description:"Open subpath Bezier knot, unlinked",path:bC},6:{description:"Path fill rule",path:()=>[]},8:{description:"Initial fill rule",path:(a,b)=>[aM(a,b)]},7:{description:"Clipboard",path:function(a,b){return[[bD(a,b,8),bD(a,b+4,8),bD(a,b+8,8),bD(a,b+12,8)],bD(a,b+16,8)]}}};function bC(a,b){let c=[];for(let d=0;d<24;d+=8)c.push(function(a,b){let c=bD(a,b,8);return[bD(a,b+4,8),c]}(a,b+d));return c}function bD(a,b,c){var d,e;let f=aN(a,b),g=f&parseInt(O("1",32-c),2);return(f>>>31==0?1:-1)*(e=((0x7f000000&f)>>>32-c).toString(2)+"."+(d=g.toString(2),O("0",32-c-d.length)+d),parseInt(e.replace(".",""),2)/Math.pow(2,(e.split(".")[1]||"").length))}let bE=function(a,b){let c=G(new Uint8Array(a).buffer),d={},e=0;for(;e<a.length;){let a=H(c,e,bG),f=aM(c,e+=bG),{tagName:g,tagNameSize:h}=function(a,b){let[c,d]=J(a,b);return{tagName:d,tagNameSize:1+c+ +(c%2==0)}}(c,e+=2),i=aN(c,e+=h);if(e+=4,a===bF){let a=G(c.buffer,e,i),h={id:f,value:H(a,0,i)};if(bA[f]){try{h.description=bA[f].description(a)}catch(a){h.description="<no description formatter>"}d[g||bA[f].name]=h}else b&&(d[`undefined-${f}`]=h)}e+=i+i%2}return d},bF="8BIM",bG=bF.length,bH={desc:{name:"ICC Description"},cprt:{name:"ICC Copyright"},dmdd:{name:"ICC Device Model Description"},vued:{name:"ICC Viewing Conditions Description"},dmnd:{name:"ICC Device Manufacturer for Display"},tech:{name:"Technology"}},bI={4:{name:"Preferred CMM type",value:(a,b)=>H(a,b,4),description:a=>null!==a?bJ(a):""},8:{name:"Profile Version",value:(a,b)=>a.getUint8(b).toString(10)+"."+(a.getUint8(b+1)>>4).toString(10)+"."+(a.getUint8(b+1)%16).toString(10)},12:{name:"Profile/Device class",value:(a,b)=>H(a,b,4),description:a=>{switch(a.toLowerCase()){case"scnr":return"Input Device profile";case"mntr":return"Display Device profile";case"prtr":return"Output Device profile";case"link":return"DeviceLink profile";case"abst":return"Abstract profile";case"spac":return"ColorSpace profile";case"nmcl":return"NamedColor profile";case"cenc":return"ColorEncodingSpace profile";case"mid ":return"MultiplexIdentification profile";case"mlnk":return"MultiplexLink profile";case"mvis":return"MultiplexVisualization profile";default:return a}}},16:{name:"Color Space",value:(a,b)=>H(a,b,4)},20:{name:"Connection Space",value:(a,b)=>H(a,b,4)},24:{name:"ICC Profile Date",value:(a,b)=>{var c,d;return(c=a,d=b,new Date(Date.UTC(c.getUint16(d),c.getUint16(d+2)-1,c.getUint16(d+4),c.getUint16(d+6),c.getUint16(d+8),c.getUint16(d+10)))).toISOString()}},36:{name:"ICC Signature",value:(a,b)=>{var c;return c=a.buffer.slice(b,b+4),String.fromCharCode.apply(null,new Uint8Array(c))}},40:{name:"Primary Platform",value:(a,b)=>H(a,b,4),description:a=>bJ(a)},48:{name:"Device Manufacturer",value:(a,b)=>H(a,b,4),description:a=>bJ(a)},52:{name:"Device Model Number",value:(a,b)=>H(a,b,4)},64:{name:"Rendering Intent",value:(a,b)=>a.getUint32(b),description:a=>{switch(a){case 0:return"Perceptual";case 1:return"Relative Colorimetric";case 2:return"Saturation";case 3:return"Absolute Colorimetric";default:return a}}},80:{name:"Profile Creator",value:(a,b)=>H(a,b,4)}};function bJ(a){switch(a.toLowerCase()){case"appl":return"Apple";case"adbe":return"Adobe";case"msft":return"Microsoft";case"sunw":return"Sun Microsystems";case"sgi":return"Silicon Graphics";case"tgnt":return"Taligent";default:return a}}let bK=function(a,c,d){var e,f;return d&&c[0].compressionMethod!==b?(e=a,0!==(f=c)[0].compressionMethod?{}:P(new DataView(e.buffer.slice(f[0].offset,f[0].offset+f[0].length)),f[0].compressionMethod,"utf-8","dataview").then(bL).catch(()=>({}))):function(a,b){try{var c;let d=b.reduce((a,b)=>a+b.length,0),e=new Uint8Array(d),f=0,g=(c=a,Array.isArray(c)?new DataView(Uint8Array.from(c).buffer).buffer:c.buffer);for(let a=1;a<=b.length;a++){let c=b.find(b=>b.chunkNumber===a);if(!c)throw Error(`ICC chunk ${a} not found`);let d=g.slice(c.offset,c.offset+c.length),h=new Uint8Array(d);e.set(h,f),f+=h.length}return bL(new DataView(e.buffer))}catch(a){return{}}}(a,c)};function bL(a){let b=a.buffer,c=a.getUint32();if(a.byteLength!==c)throw Error("ICC profile length not matching");if(a.byteLength<84)throw Error("ICC profile too short");let d={},e=Object.keys(bI);for(let b=0;b<e.length;b++){let c=e[b],f=bI[c],g=f.value(a,parseInt(c,10)),h=g;f.description&&(h=f.description(g)),d[f.name]={value:g,description:h}}if("acsp"!==bM(b.slice(36,40)))throw Error("ICC profile: missing signature");if(b.length<132)return d;let f=a.getUint32(128),g=132;for(let c=0;c<f;c++){var h;if(h=g,b.length<h+12)break;let c=H(a,g,4),e=a.getUint32(g+4),f=a.getUint32(g+8);if(e>b.length)break;let i=H(a,e,4);if("desc"===i){let g=a.getUint32(e+8);if(g>f)return d;bN(d,c,bM(b.slice(e+12,e+g+11)))}else if("mluc"===i){let b=a.getUint32(e+8),f=a.getUint32(e+12),g=e+16,h=[];for(let c=0;c<b;c++){let b=H(a,g+0,2),c=H(a,g+2,2),d=a.getUint32(g+4),i=a.getUint32(g+8),j=function(a,b,c){let d=[];for(let e=0;e<c&&b+e<a.byteLength;e+=2)d.push(a.getUint16(b+e));return 0===d[d.length-1]&&d.pop(),K(d)}(a,e+i,d);h.push({languageCode:b,countryCode:c,text:j}),g+=f}if(1===b)bN(d,c,h[0].text);else{let a={};for(let b=0;b<h.length;b++)a[`${h[b].languageCode}-${h[b].countryCode}`]=h[b].text;bN(d,c,a)}}else"text"===i?bN(d,c,bM(b.slice(e+8,e+f-7))):"sig "===i&&bN(d,c,bM(b.slice(e+8,e+12)));g+=12}return d}function bM(a){return String.fromCharCode.apply(null,new Uint8Array(a))}function bN(a,b,c){bH[b]?a[bH[b].name]={value:c,description:c}:a[b]={value:c,description:c}}let bO=function(a,b,c,d,e){var f,g;let h,i=aT(a,aG,b,b+c,d,e);return i.ShotInfo&&(i=L({},i,(f=i.ShotInfo.value,h={},void 0!==f[27]&&(h.AutoRotate={value:f[27],description:0===(g=f[27])?"None":1===g?"Rotate 90 CW":2===g?"Rotate 180":3===g?"Rotate 270 CW":"Unknown"}),h)),delete i.ShotInfo),i},bP=78420,bQ=1,bR=3,bS=5,bT=function(a,b,c,d){var e;let f=T(a,b+c+8),g=b+c,h=aT(a,aH,g,g+10,f,d,!0);return(e=h).PentaxModelID&&e.PentaxModelID.value===bP&&e.LevelInfo&&(h=L({},h,function(a,b,c){var d;let e={};if(b+7>a.byteLength)return e;let f=a.getInt8(b+bQ);e.CameraOrientation={value:f,description:0===(d=f)?"Horizontal (normal)":1===d?"Rotate 270 CW":2===d?"Rotate 180":3===d?"Rotate 90 CW":4===d?"Upwards":5===d?"Downwards":"Unknown"};let g=a.getInt16(b+bR,18761===c);e.RollAngle={value:g,description:""+-.5*g};let h=a.getInt16(b+bS,18761===c);return e.PitchAngle={value:h,description:""+-.5*h},e}(a,g+h.LevelInfo.__offset,f)),delete h.LevelInfo),h},bU=function(a,c,d,e){let f={},g=[];for(let h=0;h<c.length;h++){let{offset:i,length:j,type:k}=c[h],l=function(a,c,d,e,f){var g;let h,i=[],j=[],k=[],l=bV,m=b;for(let f=0;f<d&&c+f<a.byteLength;f++){if(l===bW){m=function({type:a,dataView:c,offset:d}){if(a===ai){if(1===c.getUint8(d))return c.getUint8(d+1)}else if(a===aj)return c.getUint8(d);return b}({type:e,dataView:a,offset:c+f}),e===ai&&(f+=1),l=b$(e,l);continue}if(l===bZ){h=new DataView(a.buffer.slice(c+f,c+d));break}let g=a.getUint8(c+f);0===g?l=b$(e,l):l===bV?i.push(g):l===bX?j.push(g):l===bY&&k.push(g)}if(m!==b&&!f)return{};let n=P(h,m,(g=e)===ah||g===aj?"latin1":"utf-8");return n instanceof Promise?n.then(a=>b_(a,e,j,i)).catch(()=>b_("<text using unknown compression>".split(""),e,j,i)):b_(n,e,j,i)}(a,i,j,k,d);if(l instanceof Promise)g.push(l.then(({name:a,value:b,description:c})=>{try{if(b0(a,b))return{__exif:aZ(b2(b),6,e).tags};if(b1(a,b))return{__iptc:a8(b2(b),0,e)};if(a&&!b0(a,b)&&!b1(a,b))return{[a]:{value:b,description:c}}}catch(a){}return{}}));else{let{name:a,value:b,description:c}=l;a&&(f[a]={value:b,description:c})}}return{readTags:f,readTagsPromise:g.length>0?Promise.all(g):void 0}},bV="STATE_KEYWORD",bW="STATE_COMPRESSION",bX="STATE_LANG",bY="STATE_TRANSLATED_KEYWORD",bZ="STATE_TEXT";function b$(a,b){return b===bV&&[ai,aj].includes(a)?bW:b===bW?a===ai?bX:bZ:b===bX?bY:bZ}function b_(a,b,c,d){var e;let f=(e=a)instanceof DataView?H(e,0,e.byteLength):e;return{name:function(a,b,c){let d=K(c);if(a===ah||0===b.length)return d;let e=K(b);return`${d} (${e})`}(b,c,d),value:f,description:b===ai?a7("UTF-8",a):f}}function b0(a,b){return"raw profile type exif"===a.toLowerCase()&&"exif"===b.substring(1,5)}function b1(a,b){return"raw profile type iptc"===a.toLowerCase()&&"iptc"===b.substring(1,5)}function b2(a){var b=a.match(/\n(exif|iptc)\n\s*\d+\n([\s\S]*)$/)[2].replace(/\n/g,"");let c=new DataView(new ArrayBuffer(b.length/2));for(let a=0;a<b.length;a+=2)c.setUint8(a/2,parseInt(b.substring(a,a+2),16));return c}let b3=function(a,b){let c={};for(let d=0;d<b.length;d++){let e=aN(a,b[d]+0),f=H(a,b[d]+4,4);f===ak?(c["Pixels Per Unit X"]=function(a,b,c){if(!b4(a,b,c,0,4))return;let d=aN(a,b+af+0);return{value:d,description:""+d}}(a,b[d],e),c["Pixels Per Unit Y"]=function(a,b,c){if(!b4(a,b,c,4,4))return;let d=aN(a,b+af+4);return{value:d,description:""+d}}(a,b[d],e),c["Pixel Units"]=function(a,b,c){if(!b4(a,b,c,8,1))return;let d=aL(a,b+af+8);return{value:d,description:1===d?"meters":"Unknown"}}(a,b[d],e)):f===al&&(c["Modify Date"]=function(a,b,c){if(!b4(a,b,c,0,7))return;let d=aM(a,b+af),e=aL(a,b+af+2),f=aL(a,b+af+3),g=aL(a,b+af+4),h=aL(a,b+af+5),i=aL(a,b+af+6);return{value:[d,e,f,g,h,i],description:`${b5(d,4)}-${b5(e,2)}-${b5(f,2)} ${b5(g,2)}:${b5(h,2)}:${b5(i,2)}`}}(a,b[d],e))}return c};function b4(a,b,c,d,e){return d+e<=c&&b+af+d+e<=a.byteLength}function b5(a,b){return`${"0".repeat(b-(""+a).length)}${a}`}let b6=function(a,b){let c,d,e={},f=aL(a,b);return e.Alpha={value:+!!(c=16&f),description:c?"Yes":"No"},e.Animation={value:+!!(d=2&f),description:d?"Yes":"No"},e.ImageWidth=b7(a,b+4),e.ImageHeight=b7(a,b+7),e};function b7(a,b){let c=aL(a,b)+256*aL(a,b+1)+65536*aL(a,b+2)+1;return{value:c,description:c+"px"}}let b8=[6,7,99],b9=function(a,b,c){var d;if((d=b)&&(void 0===d.Compression||b8.includes(d.Compression.value))&&d.JPEGInterchangeFormat&&d.JPEGInterchangeFormat.value&&d.JPEGInterchangeFormatLength&&d.JPEGInterchangeFormatLength.value){b.type="image/jpeg";let d=c+b.JPEGInterchangeFormat.value;b.image=a.buffer.slice(d,d+b.JPEGInterchangeFormatLength.value),M(b,"base64",function(){return N(this.image)})}return b},ca=function(a,b){let c={},d=!1,e=cb(a,"exif","FocalLength",b),f=cb(a,"exif","FocalPlaneXResolution",b),g=cb(a,"exif","FocalPlaneYResolution",b),h=cb(a,"exif","FocalPlaneResolutionUnit",b),i=cb(a,"file","Image Width",b),j=cb(a,"file","Image Height",b),k=cb(a,"exif","FocalLengthIn35mmFilm",b)||function(a,b,c,d,e,f){if(a&&b&&c&&d&&e&&f)try{let g;switch(c){case 2:g=25.4;break;case 3:g=10;break;case 4:g=1;break;default:return}let h=a[0]/a[1]*g,i=b[0]/b[1]*g,j=Math.sqrt((d/h)**2+(e/i)**2);return f[0]/f[1]*(43.27/j)}catch(a){}}(f,g,h,i,j,e);k&&(c.FocalLength35efl={value:k,description:aA.FocalLengthIn35mmFilm(k)},d=!0);let l=function(a,b){if(a&&b)try{let c=b/(a[0]/a[1]);return{value:c,description:c.toFixed(1)}}catch(a){}}(e,k);l&&(c.ScaleFactorTo35mmEquivalent=l,d=!0);let m=function(a){if(a)try{let b=2*Math.atan(36/(2*a))*(180/Math.PI);return{value:b,description:b.toFixed(1)+" deg"}}catch(a){}}(k);if(m&&(c.FieldOfView=m,d=!0),d)return c};function cb(a,b,c,d){return d&&a[b]&&a[b][c]?a[b][c].value:!d&&a[c]?a[c].value:void 0}function cc(a){this.name="MetadataMissingError",this.message=a||"No Exif data",this.stack=Error().stack}cc.prototype=Error();let cd=cc,ce=function(a,b={}){var c,d;return"string"==typeof a?(b.async=!0,(function(a,b){var c;if(/^\w+:\/\//.test(a))return"undefined"!=typeof fetch?function(a,{length:b}={}){let c={method:"GET"};return Number.isInteger(b)&&b>=0&&(c.headers={range:`bytes=0-${b-1}`}),fetch(a,c).then(a=>a.arrayBuffer())}(a,b):function(a,{length:b}={}){return new Promise((c,d)=>{var e;let f={};Number.isInteger(b)&&b>=0&&(f.headers={range:`bytes=0-${b-1}`}),(e=a,/^https:\/\//.test(e)?__non_webpack_require__("https").get:__non_webpack_require__("http").get)(a,f,a=>{if(a.statusCode>=200&&a.statusCode<=299){let b=[];a.on("data",a=>b.push(Buffer.from(a))),a.on("error",a=>d(a)),a.on("end",()=>c(Buffer.concat(b)))}else d(`Could not fetch file: ${a.statusCode} ${a.statusMessage}`),a.resume()}).on("error",a=>d(a))})}(a,b);return(c=a,/^data:[^;,]*(;base64)?,/.test(c))?Promise.resolve(function(a){let b=a.substring(a.indexOf(",")+1);if(-1!==a.indexOf(";base64"))return"undefined"!=typeof atob?Uint8Array.from(atob(b),a=>a.charCodeAt(0)).buffer:"undefined"==typeof Buffer?void 0:void 0!==Buffer.from?Buffer.from(b,"base64"):new Buffer(b,"base64");let c=decodeURIComponent(b);return"undefined"!=typeof Buffer?void 0!==Buffer.from?Buffer.from(c):new Buffer(c):Uint8Array.from(c,a=>a.charCodeAt(0)).buffer}(a)):function(a,{length:b}={}){return new Promise((c,d)=>{let e=function(){try{return __non_webpack_require__("fs")}catch(a){return}}();e.open(a,(f,g)=>{f?d(f):e.stat(a,(f,h)=>{if(f)d(f);else{let f=Math.min(h.size,void 0!==b?b:h.size),i=Buffer.alloc(f);e.read(g,{buffer:i,length:f},b=>{b?d(b):e.close(g,b=>{b&&console.warn(`Could not close file ${a}:`,b),c(i)})})}})})})}(a,b)})(a,b).then(a=>cf(a,b))):(c=a,"undefined"!=typeof File&&c instanceof File)?(b.async=!0,(d=a,new Promise((a,b)=>{let c=new FileReader;c.onload=b=>a(b.target.result),c.onerror=()=>b(c.error),c.readAsArrayBuffer(d)})).then(a=>cf(a,b))):cf(a,b)};function cf(a,b){return function(a){try{return Buffer.isBuffer(a)}catch(a){return!1}}(a)&&(a=new Uint8Array(a).buffer),function(a,{expanded:b=!1,async:c=!1,includeUnknown:d=!1,domParser:e}={expanded:!1,async:!1,includeUnknown:!1,domParser:void 0}){var f,g,h,i,j;let k=!1,l={},m=[],{fileType:n,fileDataOffset:o,jfifDataOffset:p,tiffHeaderOffset:q,iptcDataOffset:r,xmpChunks:s,iccChunks:t,mpfDataOffset:u,pngHeaderOffset:v,pngTextChunks:w,pngChunkOffsets:x,vp8xChunkOffset:y,gifHeaderOffset:z}=ay(a,c);if(void 0!==o){k=!0;let c=a0(a,o);b?l.file=c:l=L({},l,c)}if(void 0!==p){k=!0;let c=a1(a,p);b?l.jfif=c:l=L({},l,c)}if(void 0!==q){k=!0;let{tags:c,byteOrder:h}=aZ(a,q,d);if(c.Thumbnail&&(l.Thumbnail=c.Thumbnail,delete c.Thumbnail),b?(l.exif=c,function(a){if(a.exif){if(a.exif.GPSLatitude&&a.exif.GPSLatitudeRef)try{a.gps=a.gps||{},a.gps.Latitude=S(a.exif.GPSLatitude.value),"S"===a.exif.GPSLatitudeRef.value.join("")&&(a.gps.Latitude=-a.gps.Latitude)}catch(a){}if(a.exif.GPSLongitude&&a.exif.GPSLongitudeRef)try{a.gps=a.gps||{},a.gps.Longitude=S(a.exif.GPSLongitude.value),"W"===a.exif.GPSLongitudeRef.value.join("")&&(a.gps.Longitude=-a.gps.Longitude)}catch(a){}if(a.exif.GPSAltitude&&a.exif.GPSAltitudeRef)try{a.gps=a.gps||{},a.gps.Altitude=a.exif.GPSAltitude.value[0]/a.exif.GPSAltitude.value[1],1===a.exif.GPSAltitudeRef.value&&(a.gps.Altitude=-a.gps.Altitude)}catch(a){}}}(l)):l=L({},l,c),c["IPTC-NAA"]&&void 0===r){let a=a8(c["IPTC-NAA"].value,0,d);b?l.iptc=a:l=L({},l,a)}if(0,c.ApplicationNotes&&!cg(s)){let a=bg(K(c.ApplicationNotes.value),void 0,e);b?l.xmp=a:(delete a._raw,l=L({},l,a))}if(0,c.ImageSourceData&&c.PhotoshopSettings){let a=bE(c.PhotoshopSettings.value,d);b?l.photoshop=a:l=L({},l,a)}if(0,c.ICC_Profile&&!ch(t)){let a=bK(c.ICC_Profile.value,[{offset:0,length:c.ICC_Profile.value.length,chunkNumber:1,chunksTotal:1}]);b?l.icc=a:l=L({},l,a)}if(0,c.MakerNote){if((f=c).Make&&f.Make.value&&Array.isArray(f.Make.value)&&"Canon"===f.Make.value[0]&&f.MakerNote&&f.MakerNote.__offset){let e=bO(a,q,c.MakerNote.__offset,h,d);b?l.makerNotes=e:l=L({},l,e)}else{let e;if(e="PENTAX ",(g=c).MakerNote.value.length>e.length&&K(g.MakerNote.value.slice(0,e.length))===e&&g.MakerNote.__offset){let e=bT(a,q,c.MakerNote.__offset,d);b?l.makerNotes=e:l=L({},l,e)}}}c.MakerNote&&delete c.MakerNote.__offset}if(void 0!==r){k=!0;let c=a8(a,r,d);b?l.iptc=c:l=L({},l,c)}if(cg(s)){k=!0;let c=bg(a,s,e);b?l.xmp=c:(delete c._raw,l=L({},l,c))}if(ch(t)){k=!0;let b=bK(a,t,c);b instanceof Promise?m.push(b.then(C)):C(b)}if(void 0!==u){k=!0;let c=a$(a,u,d);b?l.mpf=c:l=L({},l,c)}if(void 0!==v){k=!0;let c={"Image Width":function(a,b){if(b+0+4>a.byteLength)return;let c=aN(a,b);return{value:c,description:`${c}px`}}(h=a,i=v),"Image Height":function(a,b){if(b+4+4>a.byteLength)return;let c=aN(a,b+4);return{value:c,description:`${c}px`}}(h,i),"Bit Depth":function(a,b){if(b+8+1>a.byteLength)return;let c=aL(a,b+8);return{value:c,description:`${c}`}}(h,i),"Color Type":function(a,b){if(b+9+1>a.byteLength)return;let c=aL(a,b+9);return{value:c,description:({0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha"})[c]||"Unknown"}}(h,i),Compression:function(a,b){if(b+10+1>a.byteLength)return;let c=aL(a,b+10);return{value:c,description:0===c?"Deflate/Inflate":"Unknown"}}(h,i),Filter:function(a,b){if(b+11+1>a.byteLength)return;let c=aL(a,b+11);return{value:c,description:0===c?"Adaptive":"Unknown"}}(h,i),Interlace:function(a,b){if(b+12+1>a.byteLength)return;let c=aL(a,b+12);return{value:c,description:({0:"Noninterlaced",1:"Adam7 Interlace"})[c]||"Unknown"}}(h,i)};b?(l.png=l.png?L({},l.png,c):c,l.pngFile=c):l=L({},l,c)}if(void 0!==w){k=!0;let{readTags:b,readTagsPromise:e}=bU(a,w,c,d);D(b),e&&m.push(e.then(a=>a.forEach(D)))}if(void 0!==x){k=!0;let c=b3(a,x);b?l.png=l.png?L({},l.png,c):c:l=L({},l,c)}if(void 0!==y){k=!0;let c=b6(a,y);b?l.riff=l.riff?L({},l.riff,c):c:l=L({},l,c)}if(void 0!==z){k=!0;let c={"GIF Version":function(a){if(6>a.byteLength)return;let b=H(a,3,3);return{value:b,description:b}}(j=a),"Image Width":function(a){if(8>a.byteLength)return;let b=a.getUint16(6,!0);return{value:b,description:`${b}px`}}(j),"Image Height":function(a){if(10>a.byteLength)return;let b=a.getUint16(8,!0);return{value:b,description:`${b}px`}}(j),"Global Color Map":function(a){if(11>a.byteLength)return;let b=(128&a.getUint8(10))>>>7;return{value:b,description:1===b?"Yes":"No"}}(j),"Bits Per Pixel":function(a){if(11>a.byteLength)return;let b=(7&a.getUint8(10))+1;return{value:b,description:`${b} ${1===b?"bit":"bits"}`}}(j),"Color Resolution Depth":function(a){if(11>a.byteLength)return;let b=((112&a.getUint8(10))>>>4)+1;return{value:b,description:`${b} ${1===b?"bit":"bits"}`}}(j)};b?l.gif=l.gif?L({},l.gif,c):c:l=L({},l,c)}let A=ca(l,b);A&&(b?l.composite=A:l=L({},l,A));let B=b9(a,l.Thumbnail,q);if(B?(k=!0,l.Thumbnail=B):delete l.Thumbnail,n&&(b?(l.file||(l.file={}),l.file.FileType=n):l.FileType=n,k=!0),!k)throw new cd;if(c)return Promise.all(m).then(()=>l);return l;function C(a){b?l.icc=a:l=L({},l,a)}function D(a){if(b){for(let b of["exif","iptc"]){let c=`__${b}`;a[c]&&(l[b]=l[b]?L({},l.exif,a[c]):a[c],delete a[c])}l.png=l.png?L({},l.png,a):a,l.pngText=l.pngText?L({},l.png,a):a}else l=L({},l,a.__exif?a.__exif:{},a.__iptc?a.__iptc:{},a),delete l.__exif,delete l.__iptc}}(function(a){try{return new DataView(a)}catch(b){return new F(a)}}(a),b)}function cg(a){return Array.isArray(a)&&a.length>0}function ch(a){return Array.isArray(a)&&a.length>0}a.i(711592);var ci=a.i(579950);let cj=ci.BS.Struct({description:D.String,value:D.Number}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/NumberFileTag"),identifier:"NumberFileTag",title:"Number File Tag",description:"EXIF tag with a numeric value and a human-readable description."}),ck=ci.BS.Struct({description:D.String,value:D.Array(D.Number)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/NumberArrayFileTag"),identifier:"NumberArrayFileTag",title:"Number Array File Tag",description:"EXIF tag with an array of numbers (e.g., resolutions, coordinates)."}),cl=ci.BS.Struct({description:D.String,value:D.Union(D.Array(D.Number),D.Array(D.Array(D.Number)))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/NumberArray2DFileTag"),identifier:"NumberArray2DFileTag",title:"Number Array 2D File Tag",description:"EXIF tag with a 1D or 2D array of numbers (e.g., chroma subsampling)."}),cm=a=>ci.BS.Struct({id:D.Number,description:D.Union(D.String,D.Number),value:a}),cn=cm(D.Tuple(D.Number,D.Number)).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/RationalTag"),identifier:"RationalTag",title:"Rational Tag",description:"Typed EXIF tag whose value is a rational tuple [numerator, denominator] (e.g., shutter speed)."}),co=cm(D.Number).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/NumberTag"),identifier:"NumberTag",title:"Number Tag",description:"Typed EXIF tag with numeric value."}),cp=cm(D.Array(D.Number)).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/NumberArrayTag"),identifier:"NumberArrayTag",title:"Number Array Tag",description:"Typed EXIF tag with array of numbers."}),cq=cm(D.Array(D.String)).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/StringArrayTag"),identifier:"StringArrayTag",title:"String Array Tag",description:"Typed EXIF tag with array of strings."}),cr=cm(D.String).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/StringTag"),identifier:"StringTag",title:"String Tag",description:"Typed EXIF tag with string value."}),cs=ci.BS.Struct({description:D.String,value:D.Union(D.String,D.Number)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/ValueTag"),identifier:"ValueTag",title:"Value Tag",description:"Generic EXIF tag with a string or numeric value."}),ct=ci.BS.Struct({value:D.Literal("tiff","jpeg","png","heic","avif","webp","gif"),description:D.Literal("TIFF","JPEG","PNG","HEIC","AVIF","WebP","GIF")}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/FileTypeTag"),identifier:"FileTypeTag",title:"File Type Tag",description:"File container/codec identification reported by the reader."}),cu=ci.BS.Struct({fileType:D.optional(D.Union(ct,D.Literal("TIFF","JPEG","PNG","HEIC","AVIF","WebP","GIF"))).pipe(D.fromKey("FileType")),bitsPerSample:D.optional(cj).pipe(D.fromKey("Bits Per Sample")),height:D.optional(cj).pipe(D.fromKey("Image Height")),width:D.optional(cj).pipe(D.fromKey("Image Width")),colorComponents:D.optional(cj).pipe(D.fromKey("Color Components")),subsampling:D.optional(cl).pipe(D.fromKey("Subsampling"))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/FileTags"),identifier:"FileTags",title:"File Tags",description:"Basic file-level properties from container headers (dimensions, bit depth, subsampling, etc.)."}),cv=ci.BS.Struct({value:D.Number,description:D.Literal("None","inches","cm","Unknown")}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/JfifResolutionUnitTag"),identifier:"JfifResolutionUnitTag",title:"Jfif Resolution Unit Tag",description:"Resolution unit for JFIF (e.g., inches for DPI, centimeters for DPCM)."}),cw=ci.BS.Struct({value:D.Union(D.instanceOf(ArrayBuffer),D.instanceOf(SharedArrayBuffer),D.instanceOf(Buffer)),description:D.Literal("<24-bit RGB pixel data>")}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/JfifThumbnailTag"),identifier:"JfifThumbnailTag",title:"Jfif Thumbnail Tag",description:"Embedded JFIF thumbnail or raw RGB pixel data from the container."}),cx=ci.BS.Struct({jfifVersion:D.optional(cj).pipe(D.fromKey("JFIF Version")),resolutionUnit:D.optional(cv).pipe(D.fromKey("Resolution Unit")),xResolution:D.optional(cj).pipe(D.fromKey("XResolution")),yResolution:D.optional(cj).pipe(D.fromKey("YResolution")),jfifThumbnailWidth:D.optional(cj).pipe(D.fromKey("JFIF Thumbnail Width")),jfifThumbnailHeight:D.optional(cj).pipe(D.fromKey("JFIF Thumbnail Height")),jfifThumbnail:D.optional(cw).pipe(D.fromKey("JFIF Thumbnail"))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/JfifTags"),identifier:"JfifTags",title:"JFIF Tags",description:"JFIF segment fields including resolution and embedded thumbnail metadata."}),cy=ci.BS.Struct({value:D.Number,description:D.Literal("Grayscale","RGB","Palette","Grayscale with Alpha","RGB with Alpha","Unknown")}),cz=ci.BS.Struct({value:D.Number,description:D.Literal("Deflate/Inflate","Unknown")}),cA=ci.BS.Struct({value:D.Number,description:D.Literal("Adaptive","Unknown")}),cB=ci.BS.Struct({value:D.Number,description:D.Literal("Noninterlaced","Adam7 Interlace","Unknown")}),cC=ci.BS.Struct({imageWidth:D.optional(cj).pipe(D.fromKey("Image Width")),imageHeight:D.optional(cj).pipe(D.fromKey("Image Height")),bitDepth:D.optional(cj).pipe(D.fromKey("Bit Depth")),colorType:D.optional(cy).pipe(D.fromKey("Color Type")),compression:D.optional(cz).pipe(D.fromKey("Compression")),filter:D.optional(cA).pipe(D.fromKey("Filter")),interlace:D.optional(cB).pipe(D.fromKey("Interlace"))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PngFileTags"),identifier:"PngFileTags",title:"PNG File Tags",description:"IHDR-level PNG properties: dimensions, bit depth, color type, compression, filter, and interlace."}),cD=ci.BS.Struct({value:D.Number,description:D.Literal("meters","Unknown")}),cE=ci.BS.Struct({pixelsPerUnitX:D.optional(cj).pipe(D.fromKey("Pixels Per Unit X")),pixelsPerUnitY:D.optional(cj).pipe(D.fromKey("Pixels Per Unit Y")),pixelUnits:D.optional(cD).pipe(D.fromKey("Pixel Units")),modifyDate:D.optional(ck).pipe(D.fromKey("Modify Date"))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PngPhysTags"),identifier:"PngPhysTags",title:"PNG Physical Pixel Tags",description:"pHYs chunk-derived physical pixel density and units."}),cF=ci.BS.Struct({description:D.String,value:D.Union(D.String,D.Number)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PngTag"),identifier:"PngTag",title:"PNG Tag",description:"Generic PNG tag with a textual description and a string or numeric value."}),cG=ci.BS.Struct({...cC.fields,...cE.fields},D.Record({key:D.String,value:cF})).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PngTags"),identifier:"PngTags",title:"PNG Tags",description:"Aggregate PNG metadata combining IHDR/pHYs fields and arbitrary tag map."}),cH=ci.BS.Struct({description:D.String,value:D.String}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PngTextTag"),identifier:"PngTextTag",title:"PNG Text Tag",description:"PNG textual metadata entry (tEXt/zTXt/iTXt)."}),cI=D.Record({key:D.String,value:cH}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PngTextTags"),identifier:"PngTextTags",title:"PNG Text Tags",description:"Map of PNG textual metadata entries."}),cJ=ci.BS.Struct({value:D.Literal(0,1),description:D.Literal("No","Yes")}),cK=ci.BS.Struct({value:D.Literal(0,1),description:D.Literal("No","Yes")}),cL=ci.BS.Struct({value:D.Number,description:D.String}),cM=ci.BS.Struct({alpha:D.optional(cJ).pipe(D.fromKey("Alpha")),animation:D.optional(cK).pipe(D.fromKey("Animation")),imageWidth:D.optional(cL).pipe(D.fromKey("ImageWidth")),imageHeight:D.optional(cL).pipe(D.fromKey("ImageHeight"))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/RiffTags"),identifier:"RiffTags",title:"RIFF/WEBP Tags",description:"Basic WEBP/RIFF properties such as alpha, animation, and dimensions."}),cN=ci.BS.Struct({value:D.Literal("87a","89a"),description:D.Literal("87a","89a")}),cO=ci.BS.Struct({value:D.Literal(0,1),description:D.Literal("No","Yes")}),cP=ci.BS.Struct({value:D.Number,description:D.String}),cQ=ci.BS.Struct({value:D.Literal(1,2,3,4,5,6,7,8),description:D.String}),cR=ci.BS.Struct({gifVersion:cN.pipe(D.propertySignature,D.fromKey("GIF Version")),imageWidth:D.optional(cP).pipe(D.fromKey("Image Width")),imageHeight:D.optional(cP).pipe(D.fromKey("Image Height")),globalColorMap:D.optional(cO).pipe(D.fromKey("Global Color Map")),bitsPerPixel:D.optional(cQ).pipe(D.fromKey("Bits Per Pixel")),colorResolutionDepth:D.optional(cQ).pipe(D.fromKey("Color Resolution Depth"))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/GifTags"),identifier:"GifTags",title:"GIF Tags",description:"Core GIF header and logical screen descriptor fields."}),cS=ci.BS.Struct({value:D.Union(D.String,D.Array(D.suspend(()=>cS)),D.Record({key:D.String,value:D.suspend(()=>cS)})),attributes:D.Record({key:D.String,value:D.String}),description:D.String}),cT=D.Record({key:D.String,value:cS}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/XmpTags"),identifier:"XmpTags",title:"XMP Tags",description:"Recursive map of XMP metadata entries (namespaced XML properties)."}),cU=ci.BS.Struct({Latitude:D.optional(D.Number),Longitude:D.optional(D.Number),Altitude:D.optional(D.Number)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/GpsTags"),identifier:"GpsTags",title:"GPS Tags",description:"Simplified GPS coordinate values in decimal degrees and altitude in meters (if present)."}),cV=ci.BS.Struct({value:D.Array(D.Number),description:D.String}),cW=ci.BS.Struct({value:D.Number,description:D.String}),cX=ci.BS.Struct({ImageFlags:cV,ImageFormat:cW,ImageType:cW,ImageSize:cW,ImageOffset:cW,DependentImage1EntryNumber:cW,DependentImage2EntryNumber:cW,image:D.Union(D.instanceOf(ArrayBuffer),D.instanceOf(SharedArrayBuffer),D.instanceOf(Buffer)),base64:D.String}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/MPFImageTags"),identifier:"MPFImageTags",title:"MPF Image Tags",description:"Multi-Picture Format (MPF) entries for burst/live-photo auxiliary images."}),cY=ci.BS.Struct({PathInformation:D.optional(cr),ClippingPathName:D.optional(cr)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PhotoshopTags"),identifier:"PhotoshopTags",title:"Photoshop Tags",description:"Subset of Photoshop-specific metadata embedded in images."}),cZ=ci.BS.Struct({value:D.Number,description:D.Literal("None","Rotate 90 CW","Rotate 180","Rotate 270 CW","Unknown")}),c$=ci.BS.Struct({AutoRotate:D.optional(cZ)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/CanonTags"),identifier:"CanonTags",title:"Canon Maker Notes",description:"Common Canon-specific maker notes."}),c_=ci.BS.Struct({value:D.Array(D.Number),description:D.String}),c0=ci.BS.Struct({value:D.Number,description:D.String}),c1=ci.BS.Struct({value:D.Number,description:D.Literal("Horizontal (normal)","Rotate 270 CW","Rotate 180","Rotate 90 CW","Upwards","Downwards","Unknown")}),c2=ci.BS.Struct({value:D.Number,description:D.String}),c3=ci.BS.Struct({PentaxVersion:D.optional(c_),PentaxModelID:D.optional(c0),Orientation:D.optional(c1),RollAngle:D.optional(c2),PitchAngle:D.optional(c2)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/PentaxTags"),identifier:"PentaxTags",title:"Pentax Maker Notes",description:"Common Pentax-specific maker notes (orientation, roll/pitch)."}),c4=ci.BS.Struct({value:D.Number,description:D.String}),c5=ci.BS.Struct({FocalLength35efl:D.optional(c4),ScaleFactorTo35mmEquivalent:D.optional(c4),FieldOfView:D.optional(c4)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/CompositeTags"),identifier:"CompositeTags",title:"Composite Tags",description:"Calculated/composite properties derived from primary EXIF fields."}),c6=ci.BS.Struct({type:D.Literal("image/jpeg"),image:D.Union(D.instanceOf(ArrayBuffer),D.instanceOf(SharedArrayBuffer),D.instanceOf(Buffer)),base64:D.optional(D.String),Compression:D.optional(co),XResolution:D.optional(cn),YResolution:D.optional(cn),ResolutionUnit:D.optional(co),JPEGInterchangeFormat:D.optional(co),JPEGInterchangeFormatLength:D.optional(co),ImageWidth:D.optional(co),ImageLength:D.optional(co),YCbCrPositioning:D.optional(co),Orientation:D.optional(co),PhotometricInterpretation:D.optional(co),StripOffsets:D.optional(cp),SamplesPerPixel:D.optional(co),RowsPerStrip:D.optional(co),StripByteCounts:D.optional(cp)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/ThumbnailTags"),identifier:"ThumbnailTags",title:"Thumbnail Tags",description:"Embedded thumbnail metadata and pixel data (image/base64 may be removed by cleaners)."}),c7=D.Record({key:D.String,value:cs}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/IccTags"),identifier:"IccTags",title:"ICC Profile Tags",description:"ICC color profile key-value entries. Large binary fields may be cleaned by utilities."}),c8=ci.BS.Struct({interoperabilityIndex:D.optional(cq).pipe(D.fromKey("InteroperabilityIndex")),imageWidth:D.optional(co).pipe(D.fromKey("ImageWidth")),imageLength:D.optional(co).pipe(D.fromKey("ImageLength")),bitsPerSample:D.optional(cp).pipe(D.fromKey("BitsPerSample")),compression:D.optional(co).pipe(D.fromKey("Compression")),photometricInterpretation:D.optional(co).pipe(D.fromKey("PhotometricInterpretation")),documentName:D.optional(cq).pipe(D.fromKey("DocumentName")),imageDescription:D.optional(cq).pipe(D.fromKey("ImageDescription")),make:D.optional(cq).pipe(D.fromKey("Make")),model:D.optional(cq).pipe(D.fromKey("Model")),stripOffsets:D.optional(cp).pipe(D.fromKey("StripOffsets")),orientation:D.optional(co).pipe(D.fromKey("Orientation")),samplesPerPixel:D.optional(co).pipe(D.fromKey("SamplesPerPixel")),rowsPerStrip:D.optional(co).pipe(D.fromKey("RowsPerStrip")),stripByteCounts:D.optional(cp).pipe(D.fromKey("StripByteCounts")),xResolution:D.optional(D.Union(cn,cj)).pipe(D.fromKey("XResolution")),yResolution:D.optional(D.Union(cn,cj)).pipe(D.fromKey("YResolution")),planarConfiguration:D.optional(co).pipe(D.fromKey("PlanarConfiguration")),resolutionUnit:D.optional(co).pipe(D.fromKey("ResolutionUnit")),transferFunction:D.optional(cp).pipe(D.fromKey("TransferFunction")),software:D.optional(cq).pipe(D.fromKey("Software")),dateTime:D.optional(cq).pipe(D.fromKey("DateTime")),artist:D.optional(cq).pipe(D.fromKey("Artist")),whitePoint:D.optional(cp).pipe(D.fromKey("WhitePoint")),primaryChromaticities:D.optional(cp).pipe(D.fromKey("PrimaryChromaticities")),jpegInterchangeFormat:D.optional(co).pipe(D.fromKey("JPEGInterchangeFormat")),jpegInterchangeFormatLength:D.optional(co).pipe(D.fromKey("JPEGInterchangeFormatLength")),yCbCrCoefficients:D.optional(cp).pipe(D.fromKey("YCbCrCoefficients")),yCbCrSubSampling:D.optional(cp).pipe(D.fromKey("YCbCrSubSampling")),yCbCrPositioning:D.optional(co).pipe(D.fromKey("YCbCrPositioning")),referenceBlackWhite:D.optional(cp).pipe(D.fromKey("ReferenceBlackWhite")),copyright:D.optional(cq).pipe(D.fromKey("Copyright")),exifIfdPointer:D.optional(co).pipe(D.fromKey("Exif IFD Pointer")),gpsInfoIfdPointer:D.optional(co).pipe(D.fromKey("GPS Info IFD Pointer")),jfifVersion:D.optional(cj).pipe(D.fromKey("JFIF Version")),jfifResolutionUnit:D.optional(cv).pipe(D.fromKey("Resolution Unit")),jfifThumbnailWidth:D.optional(cj).pipe(D.fromKey("JFIF Thumbnail Width")),jfifThumbnailHeight:D.optional(cj).pipe(D.fromKey("JFIF Thumbnail Height")),jfifThumbnail:D.optional(cw).pipe(D.fromKey("JFIF Thumbnail")),exposureTime:D.optional(cn).pipe(D.fromKey("ExposureTime")),fNumber:D.optional(cn).pipe(D.fromKey("FNumber")),exposureProgram:D.optional(co).pipe(D.fromKey("ExposureProgram")),spectralSensitivity:D.optional(cq).pipe(D.fromKey("SpectralSensitivity")),isoSpeedRatings:D.optional(D.Union(co,cp)).pipe(D.fromKey("ISOSpeedRatings")),oecf:D.optional(D.Unknown).pipe(D.fromKey("OECF")),exifVersion:D.optional(cp).pipe(D.fromKey("ExifVersion")),dateTimeOriginal:D.optional(cq).pipe(D.fromKey("DateTimeOriginal")),dateTimeDigitized:D.optional(cq).pipe(D.fromKey("DateTimeDigitized")),componentsConfiguration:D.optional(cp).pipe(D.fromKey("ComponentsConfiguration")),compressedBitsPerPixel:D.optional(cn).pipe(D.fromKey("CompressedBitsPerPixel")),shutterSpeedValue:D.optional(cn).pipe(D.fromKey("ShutterSpeedValue")),apertureValue:D.optional(cn).pipe(D.fromKey("ApertureValue")),brightnessValue:D.optional(cn).pipe(D.fromKey("BrightnessValue")),exposureBiasValue:D.optional(cn).pipe(D.fromKey("ExposureBiasValue")),maxApertureValue:D.optional(cn).pipe(D.fromKey("MaxApertureValue")),subjectDistance:D.optional(cn).pipe(D.fromKey("SubjectDistance")),meteringMode:D.optional(co).pipe(D.fromKey("MeteringMode")),lightSource:D.optional(co).pipe(D.fromKey("LightSource")),flash:D.optional(co).pipe(D.fromKey("Flash")),focalLength:D.optional(cn).pipe(D.fromKey("FocalLength")),subjectArea:D.optional(cp).pipe(D.fromKey("SubjectArea")),makerNote:D.optional(D.Unknown).pipe(D.fromKey("MakerNote")),userComment:D.optional(D.Unknown).pipe(D.fromKey("UserComment")),subSecTime:D.optional(cq).pipe(D.fromKey("SubSecTime")),subSecTimeOriginal:D.optional(cq).pipe(D.fromKey("SubSecTimeOriginal")),subSecTimeDigitized:D.optional(cq).pipe(D.fromKey("SubSecTimeDigitized")),flashpixVersion:D.optional(cp).pipe(D.fromKey("FlashpixVersion")),colorSpace:D.optional(co).pipe(D.fromKey("ColorSpace")),pixelXDimension:D.optional(co).pipe(D.fromKey("PixelXDimension")),pixelYDimension:D.optional(co).pipe(D.fromKey("PixelYDimension")),relatedSoundFile:D.optional(cq).pipe(D.fromKey("RelatedSoundFile")),interoperabilityIfdPointer:D.optional(co).pipe(D.fromKey("Interoperability IFD Pointer")),flashEnergy:D.optional(co).pipe(D.fromKey("FlashEnergy")),spatialFrequencyResponse:D.optional(D.Unknown).pipe(D.fromKey("SpatialFrequencyResponse")),focalPlaneXResolution:D.optional(cn).pipe(D.fromKey("FocalPlaneXResolution")),focalPlaneYResolution:D.optional(cn).pipe(D.fromKey("FocalPlaneYResolution")),focalPlaneResolutionUnit:D.optional(co).pipe(D.fromKey("FocalPlaneResolutionUnit")),subjectLocation:D.optional(cp).pipe(D.fromKey("SubjectLocation")),exposureIndex:D.optional(cn).pipe(D.fromKey("ExposureIndex")),sensingMethod:D.optional(co).pipe(D.fromKey("SensingMethod")),fileSource:D.optional(co).pipe(D.fromKey("FileSource")),sceneType:D.optional(co).pipe(D.fromKey("SceneType")),cfaPattern:D.optional(D.Unknown).pipe(D.fromKey("CFAPattern")),customRendered:D.optional(co).pipe(D.fromKey("CustomRendered")),exposureMode:D.optional(co).pipe(D.fromKey("ExposureMode")),whiteBalance:D.optional(co).pipe(D.fromKey("WhiteBalance")),digitalZoomRatio:D.optional(cn).pipe(D.fromKey("DigitalZoomRatio")),focalLengthIn35mmFilm:D.optional(co).pipe(D.fromKey("FocalLengthIn35mmFilm")),sceneCaptureType:D.optional(co).pipe(D.fromKey("SceneCaptureType")),gainControl:D.optional(co).pipe(D.fromKey("GainControl")),contrast:D.optional(co).pipe(D.fromKey("Contrast")),saturation:D.optional(co).pipe(D.fromKey("Saturation")),sharpness:D.optional(co).pipe(D.fromKey("Sharpness")),deviceSettingDescription:D.optional(D.Unknown).pipe(D.fromKey("DeviceSettingDescription")),subjectDistanceRange:D.optional(co).pipe(D.fromKey("SubjectDistanceRange")),imageUniqueId:D.optional(cq).pipe(D.fromKey("ImageUniqueID")),lensMake:D.optional(cq).pipe(D.fromKey("LensMake")),lensModel:D.optional(cq).pipe(D.fromKey("LensModel")),offsetTime:D.optional(cq).pipe(D.fromKey("OffsetTime")),offsetTimeDigitized:D.optional(cq).pipe(D.fromKey("OffsetTimeDigitized")),offsetTimeOriginal:D.optional(cq).pipe(D.fromKey("OffsetTimeOriginal")),gpsHPositioningError:D.optional(cp).pipe(D.fromKey("GPSHPositioningError")),gpsVersionId:D.optional(co).pipe(D.fromKey("GPSVersionID")),gpsLatitudeRef:D.optional(cq).pipe(D.fromKey("GPSLatitudeRef")),gpsLatitude:D.optional(cm(D.Tuple(D.Tuple(D.Number,D.Number),D.Tuple(D.Number,D.Number),D.Tuple(D.Number,D.Number)))).pipe(D.fromKey("GPSLatitude")),gpsLongitudeRef:D.optional(cq).pipe(D.fromKey("GPSLongitudeRef")),gpsLongitude:D.optional(cm(D.Tuple(D.Tuple(D.Number,D.Number),D.Tuple(D.Number,D.Number),D.Tuple(D.Number,D.Number)))).pipe(D.fromKey("GPSLongitude")),gpsAltitudeRef:D.optional(co).pipe(D.fromKey("GPSAltitudeRef")),gpsAltitude:D.optional(cn).pipe(D.fromKey("GPSAltitude")),gpsTimeStamp:D.optional(cp).pipe(D.fromKey("GPSTimeStamp")),gpsSatellites:D.optional(cq).pipe(D.fromKey("GPSSatellites")),gpsStatus:D.optional(cq).pipe(D.fromKey("GPSStatus")),gpsMeasureMode:D.optional(cq).pipe(D.fromKey("GPSMeasureMode")),gpsDop:D.optional(co).pipe(D.fromKey("GPSDOP")),gpsSpeedRef:D.optional(cq).pipe(D.fromKey("GPSSpeedRef")),gpsSpeed:D.optional(co).pipe(D.fromKey("GPSSpeed")),gpsTrackRef:D.optional(cq).pipe(D.fromKey("GPSTrackRef")),gpsTrack:D.optional(co).pipe(D.fromKey("GPSTrack")),gpsImgDirectionRef:D.optional(cq).pipe(D.fromKey("GPSImgDirectionRef")),gpsImgDirection:D.optional(cn).pipe(D.fromKey("GPSImgDirection")),gpsMapDatum:D.optional(cq).pipe(D.fromKey("GPSMapDatum")),gpsDestLatitudeRef:D.optional(cq).pipe(D.fromKey("GPSDestLatitudeRef")),gpsDestLatitude:D.optional(cp).pipe(D.fromKey("GPSDestLatitude")),gpsDestLongitudeRef:D.optional(cq).pipe(D.fromKey("GPSDestLongitudeRef")),gpsDestLongitude:D.optional(cp).pipe(D.fromKey("GPSDestLongitude")),gpsDestBearingRef:D.optional(cq).pipe(D.fromKey("GPSDestBearingRef")),gpsDestBearing:D.optional(co).pipe(D.fromKey("GPSDestBearing")),gpsDestDistanceRef:D.optional(cq).pipe(D.fromKey("GPSDestDistanceRef")),gpsDestDistance:D.optional(co).pipe(D.fromKey("GPSDestDistance")),gpsProcessingMethod:D.optional(D.Unknown).pipe(D.fromKey("GPSProcessingMethod")),gpsAreaInformation:D.optional(D.Unknown).pipe(D.fromKey("GPSAreaInformation")),gpsDateStamp:D.optional(cq).pipe(D.fromKey("GPSDateStamp")),gpsDifferential:D.optional(co).pipe(D.fromKey("GPSDifferential")),mpfVersion:D.optional(cp).pipe(D.fromKey("MPFVersion")),numberOfImages:D.optional(co).pipe(D.fromKey("NumberOfImages")),mpEntry:D.optional(cp).pipe(D.fromKey("MPEntry")),imageUidList:D.optional(cp).pipe(D.fromKey("ImageUIDList")),totalFrames:D.optional(co).pipe(D.fromKey("TotalFrames")),images:D.optional(D.Array(cX)).pipe(D.fromKey("Images")),modelVersion:D.optional(cp).pipe(D.fromKey("Model Version")),destination:D.optional(cp).pipe(D.fromKey("Destination")),fileFormat:D.optional(cp).pipe(D.fromKey("File Format")),fileFormatVersion:D.optional(cp).pipe(D.fromKey("File Format Version")),serviceIdentifier:D.optional(cp).pipe(D.fromKey("Service Identifier")),envelopeNumber:D.optional(cp).pipe(D.fromKey("Envelope Number")),productId:D.optional(cp).pipe(D.fromKey("Product ID")),envelopePriority:D.optional(cp).pipe(D.fromKey("Envelope Priority")),dateSent:D.optional(cp).pipe(D.fromKey("Date Sent")),timeSent:D.optional(cp).pipe(D.fromKey("Time Sent")),codedCharacterSet:D.optional(cp).pipe(D.fromKey("Coded Character Set")),uno:D.optional(cp).pipe(D.fromKey("UNO")),armIdentifier:D.optional(cp).pipe(D.fromKey("ARM Identifier")),armVersion:D.optional(cp).pipe(D.fromKey("ARM Version")),recordVersion:D.optional(cp).pipe(D.fromKey("Record Version")),objectTypeReference:D.optional(cp).pipe(D.fromKey("Object Type Reference")),objectAttributeReference:D.optional(cp).pipe(D.fromKey("Object Attribute Reference")),objectName:D.optional(cp).pipe(D.fromKey("Object Name")),editStatus:D.optional(cp).pipe(D.fromKey("Edit Status")),editorialUpdate:D.optional(cp).pipe(D.fromKey("Editorial Update")),urgency:D.optional(cp).pipe(D.fromKey("Urgency")),subjectReference:D.optional(cp).pipe(D.fromKey("Subject Reference")),category:D.optional(cp).pipe(D.fromKey("Category")),supplementalCategory:D.optional(cp).pipe(D.fromKey("Supplemental Category")),fixtureIdentifier:D.optional(cp).pipe(D.fromKey("Fixture Identifier")),keywords:D.optional(D.Union(cp,D.Array(cp))).pipe(D.fromKey("Keywords")),contentLocationCode:D.optional(cp).pipe(D.fromKey("Content Location Code")),contentLocationName:D.optional(cp).pipe(D.fromKey("Content Location Name")),releaseDate:D.optional(cp).pipe(D.fromKey("Release Date")),releaseTime:D.optional(cp).pipe(D.fromKey("Release Time")),expirationDate:D.optional(cp).pipe(D.fromKey("Expiration Date")),expirationTime:D.optional(cp).pipe(D.fromKey("Expiration Time")),specialInstructions:D.optional(cp).pipe(D.fromKey("Special Instructions")),actionAdvised:D.optional(cp).pipe(D.fromKey("Action Advised")),referenceService:D.optional(cp).pipe(D.fromKey("Reference Service")),referenceDate:D.optional(cp).pipe(D.fromKey("Reference Date")),referenceNumber:D.optional(cp).pipe(D.fromKey("Reference Number")),dateCreated:D.optional(cp).pipe(D.fromKey("Date Created")),timeCreated:D.optional(cp).pipe(D.fromKey("Time Created")),digitalCreationDate:D.optional(cp).pipe(D.fromKey("Digital Creation Date")),digitalCreationTime:D.optional(cp).pipe(D.fromKey("Digital Creation Time")),originatingProgram:D.optional(cp).pipe(D.fromKey("Originating Program")),programVersion:D.optional(cp).pipe(D.fromKey("Program Version")),objectCycle:D.optional(cp).pipe(D.fromKey("Object Cycle")),byline:D.optional(cp).pipe(D.fromKey("By-line")),bylineTitle:D.optional(cp).pipe(D.fromKey("By-line Title")),city:D.optional(cp).pipe(D.fromKey("City")),subLocation:D.optional(cp).pipe(D.fromKey("Sub-location")),provinceState:D.optional(cp).pipe(D.fromKey("Province/State")),countryPrimaryLocationCode:D.optional(cp).pipe(D.fromKey("Country/Primary Location Code")),countryPrimaryLocationName:D.optional(cp).pipe(D.fromKey("Country/Primary Location Name")),originalTransmissionReference:D.optional(cp).pipe(D.fromKey("Original Transmission Reference")),headline:D.optional(cp).pipe(D.fromKey("Headline")),credit:D.optional(cp).pipe(D.fromKey("Credit")),source:D.optional(cp).pipe(D.fromKey("Source")),copyrightNotice:D.optional(cp).pipe(D.fromKey("Copyright Notice")),contact:D.optional(cp).pipe(D.fromKey("Contact")),captionAbstract:D.optional(cp).pipe(D.fromKey("Caption/Abstract")),writerEditor:D.optional(cp).pipe(D.fromKey("Writer/Editor")),rasterizedCaption:D.optional(cp).pipe(D.fromKey("Rasterized Caption")),imageType:D.optional(cp).pipe(D.fromKey("Image Type")),imageOrientation:D.optional(cp).pipe(D.fromKey("Image Orientation")),languageIdentifier:D.optional(cp).pipe(D.fromKey("Language Identifier")),audioType:D.optional(cp).pipe(D.fromKey("Audio Type")),audioSamplingRate:D.optional(cp).pipe(D.fromKey("Audio Sampling Rate")),audioSamplingResolution:D.optional(cp).pipe(D.fromKey("Audio Sampling Resolution")),audioDuration:D.optional(cp).pipe(D.fromKey("Audio Duration")),audioOutcue:D.optional(cp).pipe(D.fromKey("Audio Outcue")),shortDocumentId:D.optional(cp).pipe(D.fromKey("Short Document ID")),uniqueDocumentId:D.optional(cp).pipe(D.fromKey("Unique Document ID")),ownerId:D.optional(cp).pipe(D.fromKey("Owner ID")),objectDataPreviewFileFormat:D.optional(cp).pipe(D.fromKey("ObjectData Preview File Format")),record2Destination:D.optional(cp).pipe(D.fromKey("Record 2 destination")),objectDataPreviewFileFormatVersion:D.optional(cp).pipe(D.fromKey("ObjectData Preview File Format Version")),objectDataPreviewData:D.optional(cp).pipe(D.fromKey("ObjectData Preview Data")),sizeMode:D.optional(cp).pipe(D.fromKey("Size Mode")),maxSubfileSize:D.optional(cp).pipe(D.fromKey("Max Subfile Size")),objectDataSizeAnnounced:D.optional(cp).pipe(D.fromKey("ObjectData Size Announced")),maximumObjectDataSize:D.optional(cp).pipe(D.fromKey("Maximum ObjectData Size")),thumbnail:D.optional(c6).pipe(D.fromKey("Thumbnail"))}),c9=ci.BS.Struct({file:D.optional(cu),jfif:D.optional(cx),pngFile:D.optional(cC),pngText:D.optional(cI),png:D.optional(cG),exif:D.optional(c8),iptc:D.optional(c8),xmp:D.optional(D.Union(ci.BS.Json,ci.BS.Struct({_raw:D.String},D.Record({key:D.String,value:cS})),D.String)),icc:D.optional(c7),riff:D.optional(cM),gif:D.optional(cR),Thumbnail:D.optional(c6),gps:D.optional(cU),photoshop:D.optional(cY),makerNotes:D.optional(ci.BS.Struct({...c$.fields,...c3.fields})),composite:D.optional(c5)}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/ExpandedTags"),identifier:"ExpandedTags",title:"Expanded EXIF Metadata",description:"High-level structure compatible with ExifReader's expanded output across multiple containers."});ci.BS.Struct({...cT.fields,...c7.fields,...cG.fields,...cM.fields,...cR.fields,...cY.fields,...c$.fields,...c3.fields,...c5.fields,Thumbnail:D.optional(c6),Images:D.optional(D.Array(cX))}).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifTags/Tags"),identifier:"Tags",title:"Combined Tags",description:"Flattened union of container-specific tag maps for convenience."});let da=["base64","image","thumbnailImage","preview","previewImage","rawImage","blob","buffer","data","binaryData","iccProfile","colorProfile","embeddedImage","makerNoteImage"],db=a=>{let b=a.toLowerCase();return"thumbnail"!==b&&(da.some(a=>b.includes(a.toLowerCase()))||b.endsWith("image")||b.includes("base64"))},dc=a=>a instanceof ArrayBuffer||a instanceof Uint8Array?a.byteLength>1024:"string"==typeof a&&(a.length>1024||/^[A-Za-z0-9+/]+=*$/.test(a)&&a.length>100),dd=a=>{let b={};for(let[c,d]of Object.entries(a))!db(c)&&(dc(d)||(d&&"object"==typeof d&&!Array.isArray(d)?b[c]=dd(d):Array.isArray(d)?b[c]=d.filter(a=>!dc(a)).map(a=>a&&"object"==typeof a&&!Array.isArray(a)?dd(a):a):b[c]=d));return b},de=a=>a&&"object"==typeof a?dd(a):a,df=a=>{let b={...a};if(C.isNotNullable(b.icc)&&"object"==typeof b.icc&&(b={...b,icc:E.omit("base64","data","buffer")(b.icc)}),C.isNotNullable(b.xmp)&&"object"==typeof b.xmp&&(b={...b,xmp:E.omit("base64","rawXml","data")(b.xmp)}),C.isNotNullable(b.iptc)&&"object"==typeof b.iptc&&(b={...b,iptc:E.omit("base64","data","buffer")(b.iptc)}),C.isNotNullable(b.thumbnail)&&"object"==typeof b.thumbnail&&(b={...b,thumbnail:E.omit("image","base64","blob","buffer")(b.thumbnail)}),C.isNotNullable(b.exif)&&"object"==typeof b.exif){let a=dd(b.exif);b={...b,exif:a}}return b};class dg extends c9.annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/exif-metadata/ExifMetadata"),identifier:"ExifMetadata",title:"EXIF Metadata",description:"EXIF metadata extracted from an image file."}){static cleanExifData=de;static omitKnownLargeFields=df;static isLargeDataField=db;static isLargeDataValue=dc;static omitLargeDataFromObject=dd;static extractMetadata=i.fn("extractMetadata")(function*(a){let b=yield*B(a),c=de((yield*i.try({try:()=>ce(b,{expanded:!0}),catch:b=>new z({message:"Could not parse EXIF data",cause:b,fileName:a.name,fileType:a.type,fileSize:a.size,phase:"parse"})})));return yield*D.decodeUnknown(dg)(c).pipe(i.mapError(b=>new z({message:"Could not decode EXIF data to schema",cause:b,fileName:a.name,fileType:a.type,fileSize:a.size,phase:"decode"})))})}var dh=ci,di=D;class dj extends dh.BS.Class("FileAttributes")({size:di.NonNegativeInt,type:dh.BS.MimeType,lastModifiedDate:dh.BS.DateFromAllAcceptable,lastModified:dh.BS.DateFromAllAcceptable,name:di.NonEmptyString,webkitRelativePath:di.optional(di.NonEmptyString),relativePath:di.optional(di.NonEmptyString),path:di.optional(di.NonEmptyString)},{schemaId:Symbol.for("@beep/files-domain/value-objects/FileAttributes"),identifier:"FileAttributes",title:"FileAttributes",description:"File attributes schema"}){}D.declare(a=>a instanceof File).annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/FileInstance"),identifier:"FileInstance",title:"FileInstance",description:"Base file instance schema"});let dk=ci.BS.stringLiteralKit("B","kB","MB","GB","TB","PB","EB","ZB","YB");class dl extends dk.Schema.annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/ByteUnit"),identifier:"ByteUnit",title:"Byte Unit â€” SI (Decimal, baseâ€‘10)",description:"Byte units using SI decimal prefixes for file sizes: B, kB, MB, GB, TB, PB, EB, ZB, YB. Uses powers of 10 (1 kB = 1,000 B; 1 MB = 1,000,000 B). Prefer for storage/device specs and endâ€‘user file size displays. Caseâ€‘sensitive: 'B' means byte (8 bits)."}){static Options=dk.Options;static Enum=dk.Enum}let dm=ci.BS.stringLiteralKit("B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB");class dn extends dm.Schema.annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/BiByteUnit"),identifier:"BiByteUnit",title:"Byte Unit â€” IEC (Binary, baseâ€‘2)",description:"Byte units using IEC binary prefixes: B, KiB, MiB, GiB, TiB, PiB, EiB, ZiB, YiB. Uses powers of 2 (1 KiB = 1,024 B; 1 MiB = 1,024 KiB). Prefer for memory sizes and contexts requiring exact powersâ€‘ofâ€‘two semantics. Caseâ€‘sensitive: 'B' means byte (8 bits)."}){static Options=dm.Options;static Enum=dm.Enum}let dp=ci.BS.stringLiteralKit("b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit");class dq extends dp.Schema.annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/BitUnit"),identifier:"BitUnit",title:"Bit Unit â€” SI (Decimal, baseâ€‘10)",description:"Bit units with SI decimal prefixes, commonly used for data rates: b, kbit, Mbit, Gbit, Tbit, Pbit, Ebit, Zbit, Ybit. Uses powers of 10 (1 kbit = 1,000 b). Caseâ€‘sensitive: 'b' means bit; 8 bits = 1 byte. Practical rule of thumb: MB/s â‰ˆ Mb/s Ã· 8."}){static Options=dp.Options;static Enum=dp.Enum}let dr=ci.BS.stringLiteralKit("b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit");class ds extends dr.Schema.annotations({schemaId:Symbol.for("@beep/files-domain/value-objects/BiBitUnit"),identifier:"BiBitUnit",title:"Bit Unit â€” IEC (Binary, baseâ€‘2)",description:"Bit units with IEC binary prefixes: b, kibit, Mibit, Gibit, Tibit, Pibit, Eibit, Zibit, Yibit. Uses powers of 2 (1 kibit = 1,024 b). Less common than decimal bit units; use when exact baseâ€‘2 bit counts are required. Caseâ€‘sensitive: 'b' means bit."}){static Options=dr.Options;static Enum=dr.Enum}var dt=ci,du=D,dv=D;class dw extends dv.Class("FileSignature")({sequence:dv.Array(dv.Union(dv.Number,dv.NonEmptyString)),offset:dv.optional(dv.Int.pipe(dv.greaterThan(0))),skippedBytes:dv.optional(dv.Array(dv.Int.pipe(dv.greaterThan(0)))),description:dv.optional(dv.NonEmptyString),compatibleExtensions:dv.optional(dv.NonEmptyArray(dv.String))},{schemaId:Symbol.for("@beep/files-domain/value-objects/file-types/FileSignature"),identifier:"FileSignature",title:"File Signature",description:"File signature"}){}class dx extends du.Class("FileInfo")({extension:dt.BS.FileExtension,mimeType:dt.BS.MimeType,description:du.NonEmptyString,signatures:du.Array(dw)},{schemaId:Symbol.for("@beep/files-domain/value-objects/file-types/FileInfo"),identifier:"FileInfo",title:"File Info",description:"File information"}){}du.Class("DetectedFileInfo")({extension:dt.BS.FileExtension,mimeType:dt.BS.MimeType,description:du.String,signature:dw},{schemaId:Symbol.for("@beep/files-domain/value-objects/file-types/DetectedFileInfo"),identifier:"DetectedFileInfo",title:"Detected File Info",description:"File information detected by signature"});var dy=d,dz=a.i(389099);function dA(a,b=32){let c=a instanceof ArrayBuffer?new Uint8Array(a):a,d=[];if(C.or(C.and(dz.isArray,ci.BS.ArrayOfNumbers.is),C.or(ci.BS.ArrBuffer.is,ci.BS.Uint8Arr.is))(a))d=Array.from(c.slice(0,b));else throw TypeError(`Expected the \`file\` argument to be of type \`Array<number>\`, \`Uint8Array\`, or \`ArrayBuffer\`, got \`${typeof a}\``);if(!d.every(a=>C.and(C.isNumber,C.not(Number.isNaN))(a)))throw TypeError("File content contains illegal values");return d}function dB(a,b){let c=b.indexOf(".");return c>-1?dB(a[b.slice(0,c)],b.slice(c+1)):a[b]}function dC(a){let b=a.map(a=>String.fromCharCode(a)).join("");return b.includes("webm")?"webm":b.includes("matroska")?"mkv":void 0}function dD(a){return"ftypavif"===a.slice(4,12).map(a=>String.fromCharCode(a)).join("")}class dE extends dy.TaggedClass("VideoTypes"){static AVI=dx.make({extension:"avi",mimeType:"video/x-msvideo",description:"Audio Video Interleave video format",signatures:[dw.make({sequence:[82,73,70,70,65,86,73,32,76,73,83,84],skippedBytes:[4,5,6,7]})]});static FLV=dx.make({extension:"flv",mimeType:"video/x-flv",description:"Flash Video file",signatures:[dw.make({sequence:[70,76,86,1]}),dw.make({sequence:[102,116,121,112,77,52,86,32],description:"ISO Media, MPEG v4 system, or iTunes AVC-LC file",offset:4,compatibleExtensions:["mp4","m4v"]})]});static M4V=dx.make({extension:"m4v",mimeType:"video/x-m4v",description:"Apple's video container format, very similar to MP4",signatures:[dw.make({sequence:[102,116,121,112,109,112,52,50],description:"MPEG-4 video | QuickTime file",offset:4,compatibleExtensions:["mp4"]}),dw.make({sequence:[102,116,121,112,77,52,86,32],description:"ISO Media, MPEG v4 system, or iTunes AVC-LC file",offset:4,compatibleExtensions:["mp4","flv"]})]});static MKV=dx.make({extension:"mkv",mimeType:"video/x-matroska",description:"MKV (Matroska Video) is a flexible, open-source media container format that supports multiple audio, video, and subtitle streams in a single file",signatures:[dw.make({sequence:[26,69,223,163],description:"EBML identifier",compatibleExtensions:["webm","mka","mks","mk3d"]})]});static MOV=dx.make({extension:"mov",mimeType:"video/quicktime",description:"QuickTime movie file",signatures:[dw.make({sequence:[102,116,121,112,113,116,32,32],offset:4}),dw.make({sequence:[109,111,111,118],offset:4})]});static MP4=dx.make({extension:"mp4",mimeType:"video/mp4",description:"A multimedia container format widely used for storing audio, video, and other data, and is known for its high compression efficiency and compatibility with many devices",signatures:[dw.make({sequence:[102,116,121,112,77,83,78,86],description:"MPEG-4 video file",offset:4}),dw.make({sequence:[102,116,121,112,105,115,111,109],description:"ISO Base Media file (MPEG-4) v1",offset:4}),dw.make({sequence:[102,116,121,112,77,52,86,32],description:"ISO Media, MPEG v4 system, or iTunes AVC-LC file",offset:4,compatibleExtensions:["m4v","flv"]})]});static OGG=dx.make({extension:"ogg",mimeType:"video/ogg",description:"Ogg Vorbis Codec compressed Multimedia file",signatures:[dw.make({sequence:[79,103,103,83,0,2,0,0,0,0,0,0,0,0],compatibleExtensions:["oga","ogv","ogx"]})]});static SWF=dx.make({extension:"swf",mimeType:"application/x-shockwave-flash",description:"SWF (Shockwave Flash) is a file format for multimedia, vector graphics, and ActionScript, used for creating and delivering animations, games, and other interactive web-based content",signatures:[dw.make({sequence:[67,87,83],description:"Macromedia Shockwave Flash player file (zlib compressed, SWF 6 and later)"}),dw.make({sequence:[70,87,83],description:"Macromedia Shockwave Flash player file (uncompressed)"}),dw.make({sequence:[90,87,83],description:"Macromedia Shockwave Flash player file (uncompressed)"})]});static WEBM=dx.make({extension:"webm",mimeType:"video/webm",description:"WebM is a royalty-free, open-source media file format optimized for web delivery, using efficient VP8 video and Vorbis audio codecs",signatures:[dw.make({sequence:[26,69,223,163],description:"EBML identifier",compatibleExtensions:["mkv"]})]})}class dF{static BLEND=dx.make({extension:"blend",mimeType:"application/x-blender",description:"Blender File Format",signatures:[dw.make({sequence:[66,76,69,78,68,69,82]})]});static DOC=dx.make({extension:"doc",mimeType:"application/msword",description:"Old Microsoft Word documents",signatures:[dw.make({sequence:[208,207,17,224,161,177,26,225],compatibleExtensions:["xls","ppt","msi","msg","dot","pps","xla","wiz"],description:"An Object Linking and Embedding (OLE) Compound File (CF) (i.e., OLECF) file format, known as Compound Binary File format by Microsoft, used by Microsoft Office 97-2003 applications"}),dw.make({sequence:[219,165,45,0],description:"Microsoft Word 2.0 file format"})]});static ELF=dx.make({extension:"elf",mimeType:"application/x-executable",description:"Executable and Linking Format executable file (Linux/Unix)",signatures:[dw.make({sequence:[127,69,76,70]})]});static EXE=dx.make({extension:"exe",mimeType:"application/x-msdownload",description:"Windows/DOS executable file and its descendants",signatures:[dw.make({sequence:[77,90],compatibleExtensions:["acm","ax","cpl","com","dll","drv","efi","fon","iec","ime","mui","ocx","olb","pif","qts","qtx","rs","sys","scr","tsp","vbx","vxd"]}),dw.make({sequence:[90,77],description:"DOS ZM executable (rare)"})]});static INDD=dx.make({extension:"indd",mimeType:"application/x-indesign",description:"Adobe InDesign document",signatures:[dw.make({sequence:[6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29],compatibleExtensions:["indt"]})]});static MACHO=dx.make({extension:"macho",mimeType:"application/x-mach-binary",description:"Apple OS X ABI Mach-O binary file",signatures:[dw.make({sequence:[254,237,250,206],description:"32-bit"}),dw.make({sequence:[206,250,237,254],description:"32-bit, where target system has reverse byte ordering from host running compiler"}),dw.make({sequence:[254,237,250,207],description:"64-bit"}),dw.make({sequence:[207,250,237,254],description:"64-bit, where target system has reverse byte ordering from host running compiler"}),dw.make({sequence:[202,254,186,190],description:"Mach-O Fat Binary"})]});static PDF=dx.make({extension:"pdf",mimeType:"application/pdf",description:"Portable Document Format",signatures:[dw.make({sequence:[37,80,68,70,45]})]});static ORC=dx.make({extension:"orc",mimeType:"application/x-orc",description:"Apache ORC (Optimized Row Columnar) file format for columnar storage",signatures:[dw.make({sequence:[79,82,67]})]});static PARQUET=dx.make({extension:"parquet",mimeType:"application/vnd.apache.parquet",description:"Apache Parquet file format for columnar storage",signatures:[dw.make({sequence:[80,65,82,49]})]});static PS=dx.make({extension:"ps",mimeType:"application/postscript",description:"PostScript document",signatures:[dw.make({sequence:[37,33,80,83]})]});static RTF=dx.make({extension:"rtf",mimeType:"application/rtf",description:"Rich Text Format word processing file",signatures:[dw.make({sequence:[123,92,114,116,102,49]})]});static SQLITE=dx.make({extension:"sqlite",mimeType:"application/x-sqlite3",description:"SQLite database file",signatures:[dw.make({sequence:[83,81,76,105,116,101,32,102,111,114,109,97,116,32,51,0]})]});static STL=dx.make({extension:"stl",mimeType:"application/sla",description:"ASCII STL (STereoLithography) file for 3D printing",signatures:[dw.make({sequence:[115,111,108,105,100]})]});static TTF=dx.make({extension:"ttf",mimeType:"application/x-font-ttf",description:"TrueType font file",signatures:[dw.make({sequence:[116,114,117,101,0]}),dw.make({sequence:[0,1,0,0,0],compatibleExtensions:["tte, dfont"]})]});static PCAP=dx.make({extension:"pcap",mimeType:"application/vnd.tcpdump.pcap",description:"Libpcap File Format",signatures:[dw.make({sequence:[212,195,178,161]}),dw.make({sequence:[77,60,178,161],description:"Nanosecond resolution"})]})}class dG extends dy.TaggedClass("FileInfo"){static AVIF=dx.make({extension:"avif",mimeType:"image/avif",description:"Alliance for Open Media (AOMedia) Video 1 (AV1) Image File",signatures:[dw.make({sequence:[0,0,0]})]});static BMP=dx.make({extension:"bmp",mimeType:"image/bmp",description:"A bitmap format used mostly in Windows",signatures:[dw.make({sequence:[66,77],compatibleExtensions:["dib"]})]});static BPG=dx.make({extension:"bpg",mimeType:"image/bpg",description:"Better Portable Graphics image format",signatures:[dw.make({sequence:[66,80,71,251]})]});static CR2=dx.make({extension:"cr2",mimeType:"image/x-canon-cr2",description:"Canon digital camera RAW file",signatures:[dw.make({sequence:[73,73,42,0,16,0,0,0,67,82]})]});static EXR=dx.make({extension:"exr",mimeType:"image/x-exr",description:"OpenEXR bitmap image format",signatures:[dw.make({sequence:[118,47,49,1]})]});static GIF=dx.make({extension:"gif",mimeType:"image/gif",description:"Image file encoded in the Graphics Interchange Format (GIF)",signatures:[dw.make({sequence:[71,73,70,56,55,97]}),dw.make({sequence:[71,73,70,56,57,97]})]});static HEIC=dx.make({extension:"heic",mimeType:"image/heic",description:"A variant of the HEIF (High Efficiency Image Format) that store images on the latest Apple devices.",signatures:[dw.make({sequence:[102,116,121,112,104,101,105,99],offset:4}),dw.make({sequence:[102,116,121,112,109],offset:4})]});static ICO=dx.make({extension:"ico",mimeType:"image/x-icon",description:"Computer icon encoded in ICO file format",signatures:[dw.make({sequence:[0,0,1,0],compatibleExtensions:["spl"]})]});static JPEG=dx.make({extension:"jpeg",mimeType:"image/jpeg",description:"JPEG (Joint Photographic Experts Group) is a widely used lossy image compression format.",signatures:[dw.make({sequence:[255,216,255,225,69,120,105,102,0],skippedBytes:[4,5],description:"Digital camera JPG using Exchangeable Image File Format (EXIF)"}),dw.make({sequence:[255,216,255,232,83,80,73,70,70,0],skippedBytes:[4,5],description:"Still Picture Interchange File Format (SPIFF)"}),dw.make({sequence:[255,216,255,224,0,16,74,70,73,70,0,0],description:"JPEG raw or in the JFIF or Exif file format"}),dw.make({sequence:[255,216,255,238],description:"JPEG raw or in the JFIF or Exif file format"}),dw.make({sequence:[255,216,255,225,69,120,105,102,0,0],skippedBytes:[4,5],description:"JPEG raw or in the JFIF or Exif file format"}),dw.make({sequence:[255,216,255,224,74,70,73,70,0],skippedBytes:[4,5],description:"JPEG/JFIF graphics file",compatibleExtensions:["jfif","jpe"]}),dw.make({sequence:[255,216,255,224],description:"JPEG raw or in the JFIF or Exif file format"}),dw.make({sequence:[255,216],description:"Generic JPEGimage file",compatibleExtensions:["jpe"]})]});static PBM=dx.make({extension:"pbm",mimeType:"image/x-portable-bitmap",description:"PBM (Portable Bitmap) is a simple monochrome bitmap image format that uses plain text ASCII characters to represent binary image data",signatures:[dw.make({sequence:[80,49,10],description:"Portable bitmap ASCII"}),dw.make({sequence:[80,52,10],description:"Portable bitmap binary"})]});static PGM=dx.make({extension:"pgm",mimeType:"image/x-portable-graymap",description:"PGM (Portable Graymap) is a simple grayscale image format that uses ASCII text characters to represent binary image data.",signatures:[dw.make({sequence:[80,50,10],description:"Portable Gray Map ASCII"}),dw.make({sequence:[80,53,10],description:"Portable Gray Map binary"})]});static PNG=dx.make({extension:"png",mimeType:"image/png",description:"PNG (Portable Network Graphics) is a lossless image compression format that supports a wide range of color depths and transparency and is widely used for high-quality graphics.",signatures:[dw.make({sequence:[137,80,78,71,13,10,26,10]})]});static PPM=dx.make({extension:"ppm",mimeType:"image/x-portable-pixmap",description:"PPM (Portable Pixmap) is a simple color image format in the Portable Network Graphics (PNG) suite.",signatures:[dw.make({sequence:[80,51,10],description:"Portable Pixmap ASCII"}),dw.make({sequence:[80,54,10],description:"Portable Pixmap binary"})]});static PSD=dx.make({extension:"psd",mimeType:"image/vnd.adobe.photoshop",description:"PSD (Photoshop Document) is an Adobe Photoshop image file format",signatures:[dw.make({sequence:[56,66,80,83]})]});static WEBP=dx.make({extension:"webp",mimeType:"image/webp",description:"A modern image format that provides superior lossless and lossy compression for images on the web",signatures:[dw.make({sequence:[82,73,70,70,87,69,66,80],skippedBytes:[4,5,6,7]})]})}class dH extends dy.TaggedClass("CompressedTypes"){static _7Z=dx.make({extension:"7z",mimeType:"application/x-7z-compressed",description:"7-Zip compressed file",signatures:[dw.make({sequence:[55,122,188,175,39,28]})]});static LZH=dx.make({extension:"lzh",mimeType:"application/x-lzh-compressed",description:"Compressed file using Lempel-Ziv and Haruyasu (LZH) compression algorithm",signatures:[dw.make({sequence:[45,104,108,48,45],description:"Lempel Ziv Huffman archive file Method 0 (No compression)",compatibleExtensions:["lha"]}),dw.make({sequence:[45,104,108,53,45],description:"Lempel Ziv Huffman archive file Method 5 (8KiB sliding window)",compatibleExtensions:["lha"]})]});static RAR=dx.make({extension:"rar",mimeType:"application/x-rar-compressed",description:"Roshal ARchive compressed archive file",signatures:[dw.make({sequence:[82,97,114,33,26,7,0],description:"Compressed archive v5.00 onwards"}),dw.make({sequence:[82,97,114,33,26,7,1,0],description:"Compressed archive v1.50 onwards"})]});static ZIP=dx.make({extension:"zip",mimeType:"application/zip",description:"Compressed archive file",signatures:[dw.make({sequence:[87,105,110,90,105,112],offset:29152,description:"WinZip compressed archive"}),dw.make({sequence:[80,75,3,4,20,0,1,0,99,0,0,0,0,0],description:"ZLock Pro encrypted ZIP"}),dw.make({sequence:[80,75,76,73,84,69],offset:30,description:"PKLITE compressed ZIP archive (see also PKZIP)"}),dw.make({sequence:[80,75,83,112,88],offset:526,description:"PKSFX self-extracting executable compressed file (see also PKZIP)"}),dw.make({sequence:[80,75,3,4],description:"PKZIP archive file - zip file format and multiple formats based on it",compatibleExtensions:["aar","apk","docx","epub","ipa","jar","kmz","maff","msix","odp","ods","odt","pk3","pk4","pptx","usdz","vsdx","xlsx","xpi"]}),dw.make({sequence:[80,75,5,6],description:"PKZIP empty archive file - zip file format and multiple formats based on it",compatibleExtensions:["aar","apk","docx","epub","ipa","jar","kmz","maff","msix","odp","ods","odt","pk3","pk4","pptx","usdz","vsdx","xlsx","xpi"]}),dw.make({sequence:[80,75,7,8],description:"PKZIP multivolume archive file - zip file format and multiple formats based on it",compatibleExtensions:["aar","apk","docx","epub","ipa","jar","kmz","maff","msix","odp","ods","odt","pk3","pk4","pptx","usdz","vsdx","xlsx","xpi"]})]})}class dI extends dy.TaggedClass("AudioTypes"){static AAC=dx.make({extension:"aac",mimeType:"audio/aac",description:"Advanced Audio Coding (AAC) is an audio coding standard for lossy digital audio compression",signatures:[dw.make({sequence:[255,241],description:"MPEG-4 Advanced Audio Coding (AAC) Low Complexity (LC) audio file"}),dw.make({sequence:[255,249],description:"MPEG-2 Advanced Audio Coding (AAC) Low Complexity (LC) audio file"})]});static AMR=dx.make({extension:"amr",mimeType:"audio/amr",description:"Adaptive Multi-Rate ACELP (Algebraic Code Excited Linear Prediction) Codec, commonly audio format with GSM cell phones",signatures:[dw.make({sequence:[35,33,65,77,82]})]});static FLAC=dx.make({extension:"flac",mimeType:"audio/x-flac",description:"Free Lossless Audio Codec file",signatures:[dw.make({sequence:[102,76,97,67,0,0,0,34]})]});static M4A=dx.make({extension:"m4a",mimeType:"audio/x-m4a",description:"Apple Lossless Audio Codec file",signatures:[dw.make({sequence:[102,116,121,112,77,52,65,32],offset:4,compatibleExtensions:["aac"]},{disableValidation:!0})]});static MP3=dx.make({extension:"mp3",mimeType:"audio/mpeg",description:"A digital audio file format that uses compression to reduce file size while maintaining high quality sound",signatures:[dw.make({sequence:[255,251],description:"MPEG-1 Layer 3 file without an ID3 tag or with an ID3v1 tag (which is appended at the end of the file)"}),dw.make({sequence:[255,243],description:"MPEG-1 Layer 3 file without an ID3 tag or with an ID3v1 tag (which is appended at the end of the file)"}),dw.make({sequence:[255,242],description:"MPEG-1 Layer 3 file without an ID3 tag or with an ID3v1 tag (which is appended at the end of the file)"}),dw.make({sequence:[73,68,51],description:"MP3 file with an ID3v2 container"})]});static WAV=dx.make({extension:"wav",mimeType:"audio/wav",description:"Waveform Audio File Format",signatures:[dw.make({sequence:[82,73,70,70,87,65,86,69,102,109,116,32],skippedBytes:[4,5,6,7]})]})}let dJ=[...ci.BS.FileExtensionKit.pick("m4v","flv","mp4","mkv","webm","avif","heic")];class dK extends dy.TaggedClass("FileTypes"){static AAC=dI.AAC;static AMR=dI.AMR;static FLAC=dI.FLAC;static M4A=dI.M4A;static MP3=dI.MP3;static WAV=dI.WAV;static AVIF=dG.AVIF;static BMP=dG.BMP;static BPG=dG.BPG;static CR2=dG.CR2;static EXR=dG.EXR;static GIF=dG.GIF;static ICO=dG.ICO;static JPEG=dG.JPEG;static PBM=dG.PBM;static PGM=dG.PGM;static PNG=dG.PNG;static PPM=dG.PPM;static PSD=dG.PSD;static WEBP=dG.WEBP;static HEIC=dG.HEIC;static AVI=dE.AVI;static FLV=dE.FLV;static M4V=dE.M4V;static MKV=dE.MKV;static MOV=dE.MOV;static MP4=dE.MP4;static OGG=dE.OGG;static SWF=dE.SWF;static WEBM=dE.WEBM;static _7Z=dH._7Z;static LZH=dH.LZH;static RAR=dH.RAR;static ZIP=dH.ZIP;static BLEND=dF.BLEND;static DOC=dF.DOC;static ELF=dF.ELF;static EXE=dF.EXE;static INDD=dF.INDD;static MACHO=dF.MACHO;static ORC=dF.ORC;static PARQUET=dF.PARQUET;static PCAP=dF.PCAP;static PDF=dF.PDF;static PS=dF.PS;static RTF=dF.RTF;static SQLITE=dF.SQLITE;static STL=dF.STL;static TTF=dF.TTF;static getInfoByName(a){return dB(dK,a.toUpperCase())}static getSignaturesByName(a){let{signatures:b}=dB(dK,a.toUpperCase());return b}static detectSignature(a,b){for(let c of b){let b=!0,d=c.offset||0,e=0;for(let f=0;f<c.sequence.length;f++){if(c.skippedBytes?.includes(f)){e++;continue}if(a[d+f]!==c.sequence[f-e]){b=!1;break}}if(b)return c}}static detectTypeByAdditionalCheck(a,b){let c=b.map(a=>a.extension);if(c.some(a=>["m4v","flv","mp4","heic"].includes(a)))return c.includes("heic")&&d_(a)?"heic":eo(a)?"flv":ep(a)&&!d_(a)?"m4v":"mp4";if(c.some(a=>["mkv","webm"].includes(a))){let b=dC(a);return"mkv"===b&&eq(a)?"mkv":"webm"===b&&ev(a)?"webm":void 0}if(c.some(a=>["avif"].includes(a))&&dD(a))return"avif"}static detectBySignatures(a,b){for(let c of b){let b=0,d=!0,e=c.offset||0,f=c?.skippedBytes?c.sequence.length+c.skippedBytes.length:c.sequence.length;for(let g=0;g<f;g++){if(c.skippedBytes?.includes(g)){b++;continue}if(a[e+g]!==c.sequence[g-b]){d=!1;break}}if(d)return c}}static checkByFileType(a,b){if(Object.prototype.hasOwnProperty.call(dK,b.toUpperCase())){let c=dK.getSignaturesByName(b.toUpperCase());if(dK.detectSignature(a,c))return!0}return!1}}function dL(a,b){let c=dA(a);return!!dK.checkByFileType(c,"aac")||!b?.excludeSimilarTypes&&dO(c)}function dM(a){let b=dA(a);return dK.checkByFileType(b,"amr")}function dN(a){let b=dA(a);return dK.checkByFileType(b,"flac")}function dO(a){let b=dA(a);return dK.checkByFileType(b,"m4a")}function dP(a){let b=dA(a);return dK.checkByFileType(b,"mp3")}function dQ(a){let b=dA(a);return dK.checkByFileType(b,"wav")}function dR(a){let b=dA(a);return dK.checkByFileType(b,"_7z")}function dS(a){let b=dA(a);return dK.checkByFileType(b,"lzh")}function dT(a){let b=dA(a);return dK.checkByFileType(b,"rar")}function dU(a,b){let c=dA(a,b?.chunkSize||64);return dK.checkByFileType(c,"zip")}function dV(a){let b=dA(a);return!!dK.checkByFileType(b,"avif")&&dD(b)}function dW(a){let b=dA(a);return dK.checkByFileType(b,"bmp")}function dX(a){let b=dA(a);return dK.checkByFileType(b,"bpg")}function dY(a){let b=dA(a);return dK.checkByFileType(b,"cr2")}function dZ(a){let b=dA(a);return dK.checkByFileType(b,"exr")}function d$(a){let b=dA(a);return dK.checkByFileType(b,"gif")}function d_(a){let b,c=dA(a);return!!dK.checkByFileType(c,"avif")&&(b=c.map(a=>String.fromCharCode(a)).join(""),["ftypheic","ftyphevc","ftypmif1","ftypmsf1"].some(a=>b.includes(a)))}function d0(a){let b=dA(a);return dK.checkByFileType(b,"ico")}function d1(a){let b=dA(a);return dK.checkByFileType(b,"jpeg")}function d2(a){let b=dA(a);return dK.checkByFileType(b,"pbm")}function d3(a){let b=dA(a);return dK.checkByFileType(b,"pgm")}function d4(a){let b=dA(a);return dK.checkByFileType(b,"png")}function d5(a){let b=dA(a);return dK.checkByFileType(b,"ppm")}function d6(a){let b=dA(a);return dK.checkByFileType(b,"psd")}function d7(a){let b=dA(a);return dK.checkByFileType(b,"webp")}function d8(a){let b=dA(a);return dK.checkByFileType(b,"blend")}function d9(a){let b=dA(a);return dK.checkByFileType(b,"elf")}function ea(a){let b=dA(a);return dK.checkByFileType(b,"exe")}function eb(a){let b=dA(a);return dK.checkByFileType(b,"macho")}function ec(a){let b=dA(a);return dK.checkByFileType(b,"indd")}function ed(a){let b=dA(a);return dK.checkByFileType(b,"orc")}function ee(a){let b=dA(a);return dK.checkByFileType(b,"parquet")}function ef(a){let b=dA(a);return dK.checkByFileType(b,"pdf")}function eg(a){let b=dA(a);return dK.checkByFileType(b,"ps")}function eh(a){let b=dA(a);return dK.checkByFileType(b,"rtf")}function ei(a){let b=dA(a);return dK.checkByFileType(b,"sqlite")}function ej(a){let b=dA(a);return dK.checkByFileType(b,"stl")}function ek(a){let b=dA(a);return dK.checkByFileType(b,"ttf")}function el(a){let b=dA(a);return dK.checkByFileType(b,"doc")}function em(a){let b=dA(a);return dK.checkByFileType(b,"pcap")}function en(a){let b=dA(a);return dK.checkByFileType(b,"avi")}function eo(a){let b,c=dA(a);return!!dK.checkByFileType(c,"flv")&&(b=c.slice(0,3),new TextDecoder().decode(new Uint8Array(b)).includes("FLV"))}function ep(a){let b=dA(a);if(!dK.checkByFileType(b,"m4v"))return!1;let c=[102,116,121,112];for(let a=0;a<b.length-c.length;a++){let d=!0;for(let e=0;e<c.length;e++)if(b[a+e]!==c[e]){d=!1;break}if(d)return!0}return!1}function eq(a){let b=dA(a,64);return!!dK.checkByFileType(b,"mkv")&&"mkv"===dC(b)}function er(a){let b=dA(a);return dK.checkByFileType(b,"mov")}function es(a,b){let c=dA(a);return!!dK.checkByFileType(c,"mp4")||!b?.excludeSimilarTypes&&ep(c)}function et(a){let b=dA(a);return dK.checkByFileType(b,"ogg")}function eu(a){let b=dA(a);return dK.checkByFileType(b,"swf")}function ev(a){let b=dA(a,64);return!!dK.checkByFileType(b,"webm")&&"webm"===dC(b)}function ew(a,b,c){let d=[];for(let a of[...new Set(b.map(a=>{let b=a.split(".").join("").toUpperCase();return"7Z"===b?`_${b}`:b}))]){if(!Object.prototype.hasOwnProperty.call(dK,a))throw TypeError(`Type \`${a.toLowerCase()}\` is not supported. Please make sure that \`types\` list conatins only supported files`);d.push(a)}if(c&&Object.prototype.hasOwnProperty.call(c,"chunkSize")&&(c?.chunkSize??0)<=0)throw RangeError("chunkSize must be bigger than zero");if(!c||!c?.excludeSimilarTypes){var e;let a=(e=d).some(a=>"MP4"===a)?["M4V"]:e.some(a=>"AAC"===a)?["M4A"]:[];a.length>0&&(d=d.concat(a))}let f=[],g=[];for(let a of d){let b=dK.getSignaturesByName(a);f=f.concat(b),dJ.includes(a.toLowerCase())&&g.push(dK.getInfoByName(a))}let h=dA(a,c?.chunkSize||64),i=dK.detectSignature(h,f);if(!i)return!1;if(g.length>0){let a=g.filter(a=>a.signatures.includes(i));if(a.length>0){let b=dK.detectTypeByAdditionalCheck(h,a);return!!b&&d.some(a=>a.toLowerCase()===b)}}return!0}function ex(a,b){if(b&&Object.prototype.hasOwnProperty.call(b,"chunkSize")&&(b?.chunkSize??0)<=0)throw RangeError("chunkSize must be bigger than zero");let c=dA(a,b?.chunkSize||64);if(0===c.length)return;let d=[],e=[];for(let a in dK)if(Object.prototype.hasOwnProperty.call(dK,a)){let b=dK.getSignaturesByName(a),f=dK.detectBySignatures(c,b);if(f){let b=dK.getInfoByName(a);dJ.includes(b.extension)&&e.push(b.extension);let c={extension:b.extension,mimeType:b.mimeType,description:b.description,signature:{...f,sequence:f.sequence.map(a=>a.toString(16))}};d.push(c)}}if(0===d.length)return;if(1===d.length&&0===e.length)return d[0];let f=dK.detectTypeByAdditionalCheck(c,d);if(f)return d.find(a=>a.extension===f)}a.s(["AudioTypes",()=>dI,"CompressedTypes",()=>dH,"FILE_TYPES_REQUIRED_ADDITIONAL_CHECK",0,dJ,"FileTypes",()=>dK,"ImageTypes",()=>dG,"OtherTypes",()=>dF,"VideoTypes",()=>dE,"is7Z",()=>dR,"isAAC",()=>dL,"isAMR",()=>dM,"isAVI",()=>en,"isAVIF",()=>dV,"isBLEND",()=>d8,"isBMP",()=>dW,"isBPG",()=>dX,"isCR2",()=>dY,"isDOC",()=>el,"isELF",()=>d9,"isEXE",()=>ea,"isEXR",()=>dZ,"isFLAC",()=>dN,"isFLV",()=>eo,"isGIF",()=>d$,"isHEIC",()=>d_,"isICO",()=>d0,"isINDD",()=>ec,"isJPEG",()=>d1,"isLZH",()=>dS,"isM4A",()=>dO,"isM4V",()=>ep,"isMACHO",()=>eb,"isMKV",()=>eq,"isMOV",()=>er,"isMP3",()=>dP,"isMP4",()=>es,"isOGG",()=>et,"isORC",()=>ed,"isPARQUET",()=>ee,"isPBM",()=>d2,"isPCAP",()=>em,"isPDF",()=>ef,"isPGM",()=>d3,"isPNG",()=>d4,"isPPM",()=>d5,"isPS",()=>eg,"isPSD",()=>d6,"isRAR",()=>dT,"isRTF",()=>eh,"isSQLITE",()=>ei,"isSTL",()=>ej,"isSWF",()=>eu,"isTTF",()=>ek,"isWAV",()=>dQ,"isWEBM",()=>ev,"isWEBP",()=>d7,"isZIP",()=>dU,"validateFileType",()=>ew],765980),a.s(["detectFile",()=>ex],541584);var ey=a.i(541584),ez=a.i(765980);let eA={...ey,...ez};var eB=a.i(939013);let eC=i.fn("upload.validateFile")(function*({file:a,config:b}){let c=x(a.size);if("number"==typeof b?.maxSizeBytes&&a.size>b.maxSizeBytes){let d=x(b.maxSizeBytes);return yield*new e({message:`File too large: ${c} (max ${d})`,fileName:a.name,fileType:a.type,fileSize:a.size})}let d=b?.chunkSize??64,g=dA((yield*i.tryPromise({try:async()=>a.arrayBuffer(),catch:b=>new f({message:"Could not detect file type from signature",cause:b,fileName:a.name,fileType:a.type,fileSize:a.size,chunkSize:d})})),d),h=eA.detectFile(g,{chunkSize:d});if(!h)return yield*l.increment(o.detectionFailedTotal),yield*q("upload.validateFile: signature detection failed",p(a)),yield*new f({message:"Could not detect file type from signature",fileName:a.name,fileType:a.type,fileSize:a.size,chunkSize:d});let j=h?.mimeType??a.type;return(yield*D.decodeUnknown(ci.BS.MimeType)(j).pipe(i.tapError(b=>q("upload.validateFile: unsupported mime type",{...p(a),candidate:j,error:b})),i.mapError(b=>new e({message:`Unsupported mime type: ${j}`,cause:b,fileName:a.name,fileType:j,fileSize:a.size}))),b?.allowedMime&&!b.allowedMime.includes(j))?(yield*q("upload.validateFile: disallowed MIME",{...p(a),candidate:j,allowed:b.allowedMime}),yield*new e({message:`Disallowed type: ${j}`,fileName:a.name,fileType:a.type,fileSize:a.size,candidateMime:j,allowedMime:b.allowedMime})):{detected:h,formattedSize:c}}),eD=i.fn("upload.extractBasicMetadata")(function*({file:a,detected:b}){let c=a.webkitRelativePath,d=eB.isString(c)&&c.length>0,f=b?.mimeType??a.type,g={size:a.size,type:f,lastModifiedDate:a.lastModified,lastModified:a.lastModified,name:a.name,...d?{webkitRelativePath:c,relativePath:c}:{}};return{attributes:yield*D.decodeUnknown(dj)(g).pipe(i.tapError(b=>q("upload.extractBasicMetadata: invalid file attributes",{...p(a),candidateType:f,error:b})),i.mapError(b=>new e({message:"Invalid file attributes",cause:b,fileName:a.name,fileType:f,fileSize:a.size}))),detected:b}}),eE=i.fn("upload.extractExifMetadata")(function*({file:a,detected:b}){let c=b?.mimeType??a.type;if(c&&c.startsWith("image/"))return yield*i.gen(function*(){let b,c=yield*i.tryPromise({try:()=>a.arrayBuffer(),catch:b=>new g({message:"Could not parse EXIF data because array buffer could not be read",cause:b,fileName:a.name,fileType:a.type,fileSize:a.size,phase:"read"})}),d=yield*i.try({try:()=>ce(c,{expanded:!0}),catch:b=>new g({message:"Could not parse EXIF data",cause:b,fileName:a.name,fileType:a.type,fileSize:a.size,phase:"parse"})}),e=dg.cleanExifData(d),f=yield*D.decodeUnknown(dg)(e).pipe(i.mapError(b=>new g({message:"Could not decode EXIF data to schema",cause:b,fileName:a.name,fileType:a.type,fileSize:a.size,phase:"decode"})));return yield*l.increment(o.exifParsedTotal),yield*(b=p(a),i.logInfo("upload.extractExifMetadata: parsed EXIF").pipe(i.annotateLogs(b??{}))),f}).pipe(i.catchAll(b=>i.gen(function*(){yield*l.increment(o.exifFailedTotal),yield*q("upload.extractExifMetadata: non-fatal EXIF parse failure",{...p(a),error:b})})))});i.Service()("UploadFileService",{dependencies:[],accessors:!0,effect:i.gen(function*(){let a=i.fn("UploadFileService.processFile")(function*({file:a,config:b}){let c,d=i.gen(function*(){let c=yield*eC({file:a,config:b}),d=yield*eD({file:a,detected:c.detected}),e=yield*eE({file:a,detected:d.detected??c.detected});return{file:a,validated:c,basic:d,exif:e}});return yield*d.pipe((c=p(a),a=>a.pipe((0,k.withLogContext)({service:"upload",...c}),(0,k.withRootSpan)("upload.processFile"),(0,k.withSpanAndMetrics)("upload.processFile",{successCounter:o.filesProcessedTotal,errorCounter:o.filesFailedTotal,durationHistogram:o.processFileDurationMs,durationUnit:"millis"},{service:"upload",...c}))))}),b=i.fn("UploadFileService.processFiles")(function*({files:b,config:c}){let d,e,f=b.map(b=>a({file:b,config:c}));return yield*(d=f,e={concurrency:"unbounded",annotations:{service:"upload"}},i.gen(function*(){let a=yield*(0,j.accumulateEffects)(d,{concurrency:e?.concurrency});for(let[b,c]of(yield*i.logInfo("accumulate summary",{successes:a.successes.length,errors:a.errors.length}),a.errors.entries()))yield*i.logError(`accumulate error[${b}]`),yield*i.sync(()=>console.error(h.pretty(c)));let b=i.succeed(a);return e?.annotations&&(b=b.pipe(i.annotateLogs(e.annotations))),e?.spanLabel&&(b=b.pipe(i.withLogSpan(e.spanLabel))),yield*b}))});return{processFile:a,processFiles:b,validateFile:eC,extractBasicMetadata:eD,extractExifMetadata:eE}})});var eF=a.i(936415);function eG(){return(0,c.jsx)(eF.View,{})}a.s(["default",()=>eG],678829)}];

//# sourceMappingURL=apps_web_src_d84d2ea6._.js.map