module.exports=[849927,255465,536386,647340,546201,525761,139770,554548,898595,882701,129891,822419,a=>{"use strict";let b,c,d,e,f,g,h,i;var j,k,l=a.i(133698),m=a.i(676736),n=a.i(305212),o=a.i(852845),p=a.i(903694),q=a.i(415879),r=a.i(462665),s=a.i(528831);let t="~@beep/iam-sdk/Contract",u="~@beep/iam-sdk/Contract/ProviderDefined",v=a=>q.hasProperty(a,u),w={[t]:{_Requirements:m.identity},pipe(){return(0,p.pipeArguments)(this,arguments)},addDependency(){return y({...this})},setParameters(a){return y({...this,parametersSchema:r.isSchema(a)?a:r.Struct(a)})},setSuccess(a){return y({...this,successSchema:a})},setFailure(a){return y({...this,failureSchema:a})},annotate(a,b){return y({...this,annotations:l.add(this.annotations,a,b)})},annotateContext(a){return y({...this,annotations:l.merge(this.annotations,a)})}},x={...w,[u]:u},y=a=>{let b=Object.assign(Object.create(w),a);return b.id=`@beep/iam-sdk/Contract/${a.name}`,b},z=r.Struct({}),A=a=>y({name:a._tag,description:o.getOrUndefined(s.getDescriptionAnnotation(a.ast.to)),parametersSchema:a,successSchema:a.success,failureSchema:a.failure,failureMode:"error",annotations:l.empty()}),B=a=>{let b="Transformation"===a._tag?{...a.to.annotations,...a.annotations}:a.annotations;return s.DescriptionAnnotationId in b?b[s.DescriptionAnnotationId]:void 0},C=a=>{if(0===s.getPropertySignatures(a).length)return{type:"object",properties:{},required:[],additionalProperties:!1};let b={},c=n.fromAST(a,{definitions:b,topLevelReferenceStrategy:"skip"});return 0===Object.keys(b).length||(c.$defs=b),c};class D extends l.Tag("@beep/iam-sdk/Contract/Title")(){}class E extends l.Reference()("@beep/iam-sdk/Contract/Readonly",{defaultValue:m.constFalse}){}class F extends l.Reference()("@beep/iam-sdk/Contract/Destructive",{defaultValue:m.constTrue}){}class G extends l.Reference()("@beep/iam-sdk/Contract/Idempotent",{defaultValue:m.constFalse}){}class H extends l.Reference()("@beep/iam-sdk/Contract/OpenWorld",{defaultValue:m.constTrue}){}let I=/"__proto__"\s*:/,J=/"constructor"\s*:/;a.s(["Destructive",()=>F,"Idempotent",()=>G,"OpenWorld",()=>H,"ProviderDefinedTypeId",0,u,"Readonly",()=>E,"Title",()=>D,"TypeId",0,t,"fromTaggedRequest",0,A,"getDescription",0,a=>q.isNotUndefined(a.description)?a.description:B(a.parametersSchema.ast),"getDescriptionFromSchemaAst",0,B,"getJsonSchema",0,a=>C(a.parametersSchema.ast),"getJsonSchemaFromSchemaAst",0,C,"isProviderDefined",0,v,"isUserDefined",0,a=>q.hasProperty(a,t)&&!v(a),"make",0,(a,b)=>{let c=b?.success??r.Void,d=b?.failure??r.Never;return y({name:a,description:b?.description,parametersSchema:b?.parameters?r.Struct(b?.parameters):z,successSchema:c,failureSchema:d,failureMode:b?.failureMode??"error",annotations:l.empty()})},"providerDefined",0,a=>b=>{let c,d="failureMode"in b?b.failureMode:void 0,e=a?.success??r.Void,f=a?.failure??r.Never;return c={id:a.id,name:a.contractSetName,providerName:a.providerName,args:b,argsSchema:r.Struct(a.args),requiresImplementation:a.requiresImplementation??!1,parametersSchema:a?.parameters?r.Struct(a?.parameters):z,successSchema:e,failureSchema:f,failureMode:d??"error"},Object.assign(Object.create(x),c)},"unsafeSecureJsonParse",0,a=>{let{stackTraceLimit:b}=Error;Error.stackTraceLimit=0;try{let b;return b=JSON.parse(a),null!==b&&"object"==typeof b&&(I.test(a)||J.test(a))?function(a){let b=[a];for(;b.length;){let a=b;for(let c of(b=[],a)){if(Object.prototype.hasOwnProperty.call(c,"__proto__")||Object.prototype.hasOwnProperty.call(c,"constructor")&&Object.prototype.hasOwnProperty.call(c.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let a in c){let d=c[a];d&&"object"==typeof d&&b.push(d)}}}return a}(b):b}finally{Error.stackTraceLimit=b}}],255564);var K=a.i(649246),L=a.i(204456),M=a.i(3072),N=a.i(614639),O=a.i(357102);a.i(702333);var P=a.i(829929);a.i(628325);var Q=a.i(807310),R=a.i(483647),S=r;let T=Symbol.for("@beep/iam/IamError"),U=a=>a>=400&&a<500?R.value(a).pipe(R.when(400,()=>"Bad Request - Check request parameters, headers, and body format against API documentation."),R.when(401,()=>"Unauthorized - Verify API key, authentication credentials, or token expiration."),R.when(403,()=>"Forbidden - Check API permissions, usage limits, or resource access rights."),R.when(404,()=>"Not Found - Verify the endpoint URL, API version, and resource identifiers."),R.when(408,()=>"Request Timeout - Consider increasing timeout duration or implementing retry logic."),R.when(422,()=>"Unprocessable Entity - Check request data validation, required fields, and data formats."),R.when(429,()=>"Rate Limited - Implement exponential backoff or reduce request frequency."),R.orElse(()=>"Client error - Review request format, parameters, and API documentation.")):a>=500?"Server error - This is likely temporary. Implement retry logic with exponential backoff.":"Check API documentation for this status code.",V=P.BS.stringLiteralKit("Transport","Encode","InvalidUrl");class W extends V.Schema.annotations({schemaId:Symbol.for("@beep/iam/IamError/HttpRequestErrorReason"),identifier:"HttpRequestErrorReason",title:"HTTP Request Error Reason",description:"Reason for an HTTP request error."}){static Options=V.Options;static Enum=V.Enum}class X extends S.TaggedError("@beep/iam-sdk/IamError/HttpRequestError")("HttpRequestError",{module:S.String,method:S.String,reason:W,request:P.BS.HttpRequestDetails,description:S.optional(S.String),cause:S.optional(S.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpRequestError"),identifier:"HttpRequestError",title:"HTTP Request Error",description:"Error that occurs during HTTP request processing."}){[T]=T;static fromRequestError=({error:a,...b})=>new X({...b,cause:a,description:a.description,reason:a.reason,request:{hash:a.request.hash,headers:M.redact(a.request.headers),method:a.request.method,url:P.BS.URLString.make(a.request.url),urlParams:a.request.urlParams}});get message(){let a=`${this.request.method} ${this.request.url}`,b=this.description?`${this.reason}: ${this.description}`:`${this.reason}: An HTTP request error occurred.`;b+=` (${a})`;let c="";return R.value(this.reason).pipe(R.when(W.Enum.Encode,()=>{c+="Check the request body for any invalid data."}),R.when(W.Enum.InvalidUrl,()=>{c+="Verify that the URL format is correct and that all required parameters have been provided. Check for any special characters that may need encoding."}),R.when(W.Enum.Transport,()=>{c+="Check your network connection and try again."}),R.exhaustive),b+=`

Suggestion: ${c}`}}class Y extends P.BS.Class("HttpResponseDetails")({status:S.Number,headers:S.Record({key:S.String,value:S.String})},{schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpResponseDetails"),identifier:"HttpResponseDetails",title:"HTTP Response Details",description:"Details about an HTTP response that caused an error."}){}let Z=P.BS.stringLiteralKit("StatusCode","Decode","EmptyBody");class $ extends Z.Schema.annotations({schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpResponseErrorReason"),identifier:"HttpResponseErrorReason",title:"HTTP Response Error Reason",description:"Reason for an HTTP response error."}){static Options=Z.Options;static Enum=Z.Enum}class _ extends S.TaggedError("@beep/iam-sdk/IamError/HttpResponseError")("HttpResponseError",{module:S.String,method:S.String,request:Q.HttpRequestDetails,response:Y,body:S.optional(S.String),reason:$,description:S.optional(S.String)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpResponseError"),identifier:"HttpResponseError",title:"HTTP Response Error",description:"Error that occurs during HTTP response processing."}){[T]=T;static fromResponseError=({error:a,...b})=>{let c=K.void,d=a.response.headers["content-type"]??"";return d.includes("application/json")?c=a.response.json:(d.includes("text/")||d.includes("urlencoded"))&&(c=a.response.text),K.flatMap(K.merge(c),c=>new _({...b,description:a.description,reason:a.reason,request:{hash:a.request.hash,headers:M.redact(a.request.headers),method:a.request.method,url:P.BS.URLString.make(a.request.url),urlParams:a.request.urlParams},response:{headers:M.redact(a.response.headers),status:a.response.status},body:M.format(c)}))};get message(){let a=`${this.response.status} ${this.request.method} ${this.request.url}`,b=this.description?`${this.reason}: ${this.description}`:`${this.reason}: An HTTP response error occurred.`;b+=` (${a})`;let c="";switch(R.value(this.reason).pipe(R.when($.Enum.Decode,()=>{c+="The response format does not match what is expected. Verify API version compatibility, check response content-type, and/or examine if the endpoint schema has changed."}),R.when($.Enum.EmptyBody,()=>{c+="The response body was empty. This may indicate a server issue, API version mismatch, or the endpoint may have changed its response format."}),R.when($.Enum.StatusCode,()=>{c+=U(this.response.status)}),R.exhaustive),this.reason){case"Decode":c+="The response format does not match what is expected. Verify API version compatibility, check response content-type, and/or examine if the endpoint schema has changed.";break;case"EmptyBody":c+="The response body was empty. This may indicate a server issue, API version mismatch, or the endpoint may have changed its response format.";break;case"StatusCode":c+=U(this.response.status)}return b+=`

${c}`,q.isNotUndefined(this.body)&&(b+=`

Response Body: ${this.body}`),b}}class aa extends S.TaggedError("@beep/iam-sdk/IamError/MalformedInput")("MalformedInput",{module:S.String,method:S.String,description:S.optional(S.String),cause:S.optional(S.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/MalformedInput"),identifier:"MalformedInput",title:"Malformed Input Error",description:"Error thrown when input data doesn't match the expected format or schema."}){[T]=T}class ab extends S.TaggedError("@beep/iam-sdk/IamError/MalformedOutput")("MalformedOutput",{module:S.String,method:S.String,description:S.optional(S.String),cause:S.optional(S.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/MalformedOutput"),identifier:"MalformedOutput",title:"Malformed Output Error",description:"Error thrown when output data can't be parsed or validated."}){[T]=T;static fromParseError({error:a,...b}){return new ab({...b,cause:a})}}class ac extends S.TaggedError("@beep/iam-sdk/UnknownError")("UnknownError",{module:S.String,method:S.String,description:S.optional(S.String),cause:S.optional(S.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/UnknownError"),identifier:"UnknownError",title:"Unknown Error",description:"Catch-all error for unexpected runtime errors in AI operations."}){[T]=T;get message(){let a=`${this.module}.${this.method}`;return q.isUndefined(this.description)?`${a}: An error occurred`:`${a}: ${this.description}`}}S.Union(X,_,aa,ab,ac).annotations({schemaId:Symbol.for("@beep/iam-sdk/IamError"),identifier:"IamError",title:"IamError",description:"Union type representing all possible AI operation errors."});let ad={...L.CommitPrototype,...M.BaseProto,of:m.identity,toContext(a){return K.gen(this,function*(){let b=yield*K.context(),c=K.isEffect(a)?yield*a:a,d=new Map;for(let[a,e]of Object.entries(c)){let c=this.contracts[a];d.set(c.id,{implementation:e,context:b})}return l.unsafeMake(d)})},toLayer(a){return N.scopedContext(this.toContext(a))},commit(){return K.gen(this,function*(){let a=this.contracts,b=yield*K.context(),c=new WeakMap,d=K.fn("ContractSet.handle",{captureStackTrace:!1})(function*(d,e){yield*K.annotateCurrentSpan({contract:d,parameters:e});let f=a[d];if(q.isUndefined(f)){let b=Object.keys(a).join(",");return yield*new ab({module:"ContractSet",method:`${d}.handle`,description:`Failed to find contract with name '${d}' in contractSet - available contracts: ${b}`})}let g=(a=>{let d=c.get(a);if(q.isUndefined(d)){let e=b.unsafeMap.get(a.id),f=r.decodeUnknown(a.parametersSchema),g=r.Union(a.successSchema,a.failureSchema),h=r.validate(g),i=r.encodeUnknown(g);d={context:e.context,implementation:e.implementation,decodeParameters:f,validateResult:h,encodeResult:i},c.set(a,d)}return d})(f),h=yield*K.mapError(g.decodeParameters(e),a=>new ab({module:"ContractSet",method:`${d}.handle`,description:`Failed to decode contract call parameters for contract '${d}' from:
'${JSON.stringify(e,void 0,2)}'`,cause:a})),{isFailure:i,result:j}=yield*g.implementation(h).pipe(K.map(a=>({result:a,isFailure:!1})),K.catchAll(a=>"error"===f.failureMode?K.fail(a):K.succeed({result:a,isFailure:!0})),K.tap(({result:a})=>g.validateResult(a)),K.mapInputContext(a=>l.merge(g.context,a)),K.mapError(a=>O.isParseError(a)?new aa({module:"ContractSet",method:`${d}.handle`,description:`Failed to validate contract call result for contract '${d}'`,cause:a}):a)),k=yield*K.mapError(g.encodeResult(j),a=>new aa({module:"ContractSet",method:`${d}.handle`,description:`Failed to encode contract call result for contract '${d}'`,cause:a}));return{isFailure:i,result:j,encodedResult:k}});return{contracts:a,handle:d}})},toJSON(){return{_id:"@beep/iam-sdk/ContractSet",contracts:Array.from(Object.values(this.contracts)).map(a=>a.name)}},pipe(){return(0,p.pipeArguments)(this,arguments)}},ae=a=>Object.assign(()=>{},ad,{contracts:a}),af=ae({});a.s(["TypeId",0,"~@beep/iam-sdk/ContractSet","empty",0,af,"make",0,(...a)=>ae(((...a)=>{let b={};for(let c of a)b[c.name]=r.isSchema(c)?A(c):c;return b})(...a)),"merge",0,(...a)=>{let b={};for(let c of a)for(let[a,d]of Object.entries(c.contracts))b[a]=d;return ae(b)}],563479),a.i(973814);var ag=a.i(56298),ah=a.i(546081),ai=a.i(224785);let aj=[],ak=0,al=0,am=a=>{let b=[],c={get:()=>(c.lc||c.listen(()=>{})(),c.value),lc:0,listen:a=>(c.lc=b.push(a),()=>{for(let b=ak+4;b<aj.length;)aj[b]===a?aj.splice(b,4):b+=4;let d=b.indexOf(a);~d&&(b.splice(d,1),--c.lc||c.off())}),notify(a,d){al++;let e=!aj.length;for(let e of b)aj.push(e,c.value,a,d);if(e){for(ak=0;ak<aj.length;ak+=4)aj[ak](aj[ak+1],aj[ak+2],aj[ak+3]);aj.length=0}},off(){},set(a){let b=c.value;b!==a&&(c.value=a,c.notify(b))},subscribe(a){let b=c.listen(a);return a(c.value),b},value:a};return c};var an=Object.defineProperty,ao=Object.defineProperties,ap=Object.getOwnPropertyDescriptors,aq=Object.getOwnPropertySymbols,ar=Object.prototype.hasOwnProperty,as=Object.prototype.propertyIsEnumerable,at=(a,b,c)=>b in a?an(a,b,{enumerable:!0,configurable:!0,writable:!0,value:c}):a[b]=c,au=(a,b)=>{for(var c in b||(b={}))ar.call(b,c)&&at(a,c,b[c]);if(aq)for(var c of aq(b))as.call(b,c)&&at(a,c,b[c]);return a},av=(a,b)=>ao(a,ap(b)),aw=class extends Error{constructor(a,b,c){super(b||a.toString(),{cause:c}),this.status=a,this.statusText=b,this.error=c}},ax=async(a,b)=>{var c,d,e,f,g,h;let i=b||{},j={onRequest:[null==b?void 0:b.onRequest],onResponse:[null==b?void 0:b.onResponse],onSuccess:[null==b?void 0:b.onSuccess],onError:[null==b?void 0:b.onError],onRetry:[null==b?void 0:b.onRetry]};if(!b||!(null==b?void 0:b.plugins))return{url:a,options:i,hooks:j};for(let k of(null==b?void 0:b.plugins)||[]){if(k.init){let d=await (null==(c=k.init)?void 0:c.call(k,a.toString(),b));i=d.options||i,a=d.url}j.onRequest.push(null==(d=k.hooks)?void 0:d.onRequest),j.onResponse.push(null==(e=k.hooks)?void 0:e.onResponse),j.onSuccess.push(null==(f=k.hooks)?void 0:f.onSuccess),j.onError.push(null==(g=k.hooks)?void 0:g.onError),j.onRetry.push(null==(h=k.hooks)?void 0:h.onRetry)}return{url:a,options:i,hooks:j}},ay=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(){return this.options.delay}},az=class{constructor(a){this.options=a}shouldAttemptRetry(a,b){return this.options.shouldRetry?Promise.resolve(a<this.options.attempts&&this.options.shouldRetry(b)):Promise.resolve(a<this.options.attempts)}getDelay(a){return Math.min(this.options.maxDelay,this.options.baseDelay*2**a)}},aA=async a=>{let b={},c=async a=>"function"==typeof a?await a():a;if(null==a?void 0:a.auth){if("Bearer"===a.auth.type){let d=await c(a.auth.token);if(!d)return b;b.authorization=`Bearer ${d}`}else if("Basic"===a.auth.type){let d=c(a.auth.username),e=c(a.auth.password);if(!d||!e)return b;b.authorization=`Basic ${btoa(`${d}:${e}`)}`}else if("Custom"===a.auth.type){let d=c(a.auth.value);if(!d)return b;b.authorization=`${c(a.auth.prefix)} ${d}`}}return b},aB=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function aC(a){if(void 0===a)return!1;let b=typeof a;return"string"===b||"number"===b||"boolean"===b||null===b||"object"===b&&(!!Array.isArray(a)||!a.buffer&&(a.constructor&&"Object"===a.constructor.name||"function"==typeof a.toJSON))}function aD(a){try{return JSON.parse(a)}catch(b){return a}}async function aE(a){let b=new Headers(null==a?void 0:a.headers);for(let[c,d]of Object.entries(await aA(a)||{}))b.set(c,d);if(!b.has("content-type")){let c=aC(null==a?void 0:a.body)?"application/json":null;c&&b.set("content-type",c)}return b}var aF=class a extends Error{constructor(b,c){super(c||JSON.stringify(b,null,2)),this.issues=b,Object.setPrototypeOf(this,a.prototype)}};async function aG(a,b){let c=await a["~standard"].validate(b);if(c.issues)throw new aF(c.issues);return c.value}var aH=["get","post","put","patch","delete"],aI=async(a,b)=>{var c,d,e,f,g,h,i,j;let k,{hooks:l,url:m,options:n}=await ax(a,b),o=function(a){if(null==a?void 0:a.customFetchImpl)return a.customFetchImpl;if("undefined"!=typeof globalThis&&"function"==typeof globalThis.fetch)return globalThis.fetch;throw Error("No fetch implementation found")}(n),p=new AbortController,q=null!=(c=n.signal)?c:p.signal,r=function(a,b){let{baseURL:c,params:d,query:e}=b||{query:{},params:{},baseURL:""},f=a.startsWith("http")?a.split("/").slice(0,3).join("/"):c||"";if(a.startsWith("@")){let b=a.toString().split("@")[1].split("/")[0];aH.includes(b)&&(a=a.replace(`@${b}/`,"/"))}f.endsWith("/")||(f+="/");let[g,h]=a.replace(f,"").split("?"),i=new URLSearchParams(h);for(let[a,b]of Object.entries(e||{}))null!=b&&i.set(a,String(b));if(d)if(Array.isArray(d))for(let[a,b]of g.split("/").filter(a=>a.startsWith(":")).entries()){let c=d[a];g=g.replace(b,c)}else for(let[a,b]of Object.entries(d))g=g.replace(`:${a}`,String(b));(g=g.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(g=g.slice(1));let j=i.toString();return(j=j.length>0?`?${j}`.replace(/\+/g,"%20"):"",f.startsWith("http"))?new URL(`${g}${j}`,f):`${f}${g}${j}`}(m,n),s=function(a){if(!(null==a?void 0:a.body))return null;let b=new Headers(null==a?void 0:a.headers);if(aC(a.body)&&!b.has("content-type")){for(let[b,c]of Object.entries(null==a?void 0:a.body))c instanceof Date&&(a.body[b]=c.toISOString());return JSON.stringify(a.body)}return a.body}(n),t=await aE(n),u=function(a,b){var c;if(null==b?void 0:b.method)return b.method.toUpperCase();if(a.startsWith("@")){let d=null==(c=a.split("@")[1])?void 0:c.split("/")[0];return aH.includes(d)?d.toUpperCase():(null==b?void 0:b.body)?"POST":"GET"}return(null==b?void 0:b.body)?"POST":"GET"}(m,n),v=av(au({},n),{url:r,headers:t,body:s,method:u,signal:q});for(let a of l.onRequest)if(a){let b=await a(v);b instanceof Object&&(v=b)}("pipeTo"in v&&"function"==typeof v.pipeTo||"function"==typeof(null==(d=null==b?void 0:b.body)?void 0:d.pipe))&&!("duplex"in v)&&(v.duplex="half");let{clearTimeout:w}=(!(null==n?void 0:n.signal)&&(null==n?void 0:n.timeout)&&(k=setTimeout(()=>null==p?void 0:p.abort(),null==n?void 0:n.timeout)),{abortTimeout:k,clearTimeout:()=>{k&&clearTimeout(k)}}),x=await o(v.url,v);w();let y={response:x,request:v};for(let a of l.onResponse)if(a){let c=await a(av(au({},y),{response:(null==(e=null==b?void 0:b.hookOptions)?void 0:e.cloneResponse)?x.clone():x}));c instanceof Response?x=c:c instanceof Object&&(x=c.response)}if(x.ok){if("HEAD"===v.method)return{data:"",error:null};let a=function(a){let b=a.headers.get("content-type"),c=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!b)return"json";let d=b.split(";").shift()||"";return aB.test(d)?"json":c.has(d)||d.startsWith("text/")?"text":"blob"}(x),c={data:"",response:x,request:v};if("json"===a||"text"===a){let a=await x.text(),b=null!=(f=v.jsonParser)?f:aD;c.data=await b(a)}else c.data=await x[a]();for(let a of((null==v?void 0:v.output)&&v.output&&!v.disableValidation&&(c.data=await aG(v.output,c.data)),l.onSuccess))a&&await a(av(au({},c),{response:(null==(g=null==b?void 0:b.hookOptions)?void 0:g.cloneResponse)?x.clone():x}));return(null==b?void 0:b.throw)?c.data:{data:c.data,error:null}}let z=null!=(h=null==b?void 0:b.jsonParser)?h:aD,A=await x.text(),B=function(a){try{return JSON.parse(a),!0}catch(a){return!1}}(A),C=B?await z(A):null,D={response:x,responseText:A,request:v,error:av(au({},C),{status:x.status,statusText:x.statusText})};for(let a of l.onError)a&&await a(av(au({},D),{response:(null==(i=null==b?void 0:b.hookOptions)?void 0:i.cloneResponse)?x.clone():x}));if(null==b?void 0:b.retry){let c=function(a){if("number"==typeof a)return new ay({type:"linear",attempts:a,delay:1e3});switch(a.type){case"linear":return new ay(a);case"exponential":return new az(a);default:throw Error("Invalid retry strategy")}}(b.retry),d=null!=(j=b.retryAttempt)?j:0;if(await c.shouldAttemptRetry(d,x)){for(let a of l.onRetry)a&&await a(y);let e=c.getDelay(d);return await new Promise(a=>setTimeout(a,e)),await aI(a,av(au({},b),{retryAttempt:d+1}))}}if(null==b?void 0:b.throw)throw new aw(x.status,x.statusText,B?C:A);return{data:null,error:av(au({},C),{status:x.status,statusText:x.statusText})}};let aJ=Object.create(null),aK=a=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(a?aJ:globalThis),aL=new Proxy(aJ,{get:(a,b)=>aK()[b]??aJ[b],has:(a,b)=>b in aK()||b in aJ,set:(a,b,c)=>(aK(!0)[b]=c,!0),deleteProperty(a,b){if(!b)return!1;let c=aK(!0);return delete c[b],!0},ownKeys:()=>Object.keys(aK(!0))});"undefined"!=typeof process&&process.env;let aM=(a,b,c,d)=>{let e=am({data:null,error:null,isPending:!0,isRefetching:!1,refetch:a=>f(a)}),f=a=>{let f="function"==typeof d?d({data:e.get().data,error:e.get().error,isPending:e.get().isPending}):d;c(b,{...f,query:{...f?.query,...a?.query},async onSuccess(a){e.set({data:a.data,error:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch}),await f?.onSuccess?.(a)},async onError(a){let{request:b}=a,c="number"==typeof b.retry?b.retry:b.retry?.attempts,d=b.retryAttempt||0;c&&d<c||(e.set({error:a.error,data:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch}),await f?.onError?.(a))},async onRequest(a){let b=e.get();e.set({isPending:null===b.data,data:b.data,error:null,isRefetching:!0,refetch:e.value.refetch}),await f?.onRequest?.(a)}}).catch(a=>{e.set({error:a,data:null,isPending:!1,isRefetching:!1,refetch:e.value.refetch})})};for(let b of a=Array.isArray(a)?a:[a])b.subscribe(()=>{});return e};class aN extends Error{constructor(a,b){super(a),this.name="BetterAuthError",this.message=a,this.cause=b,this.stack=""}}function aO(a){return{newRole:a=>{var b;return{authorize(a,c="AND"){let d=!1;for(let[e,f]of Object.entries(a)){let a=b[e];if(!a)return{success:!1,error:`You are not allowed to access resource: ${e}`};if(Array.isArray(f))d=f.every(b=>a.includes(b));else if("object"==typeof f)d="OR"===f.connector?f.actions.some(b=>a.includes(b)):f.actions.every(b=>a.includes(b));else throw new aN("Invalid access control request");if(d&&"OR"===c)return{success:d};if(!d&&"AND"===c)return{success:!1,error:`unauthorized to access resource "${e}"`}}return d?{success:d}:{success:!1,error:"Not authorized"}},statements:b=a}},statements:a}}let aP=aO({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),aQ=aP.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"],ac:["create","read","update","delete"]}),aR=aP.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),aS=aP.newRole({organization:[],member:[],invitation:[],team:[],ac:["read"]}),aT={admin:aQ,owner:aR,member:aS};function aU(a){let b=new Uint8Array(a),c="";for(let a of b)c+=String.fromCharCode(a);return btoa(c).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function aV(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=(4-b.length%4)%4,d=atob(b.padEnd(b.length+c,"=")),e=new ArrayBuffer(d.length),f=new Uint8Array(e);for(let a=0;a<d.length;a++)f[a]=d.charCodeAt(a);return e}function aW(){return aX.stubThis(globalThis?.PublicKeyCredential!==void 0&&"function"==typeof globalThis.PublicKeyCredential)}let aX={stubThis:a=>a};function aY(a){let{id:b}=a;return{...a,id:aV(b),transports:a.transports}}function aZ(a){return"localhost"===a||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}class a$ extends Error{constructor({message:a,code:b,cause:c,name:d}){super(a,{cause:c}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=d??c.name,this.code=b}}let a_=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){let a=Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}let a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){let a=Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}},a0=["cross-platform","platform"];function a1(a){if(a&&!(0>a0.indexOf(a)))return a}async function a2(a){let b,c,d,e,f;!a.optionsJSON&&a.challenge&&(console.warn("startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),a={optionsJSON:a});let{optionsJSON:g,useAutoRegister:h=!1}=a;if(!aW())throw Error("WebAuthn is not supported in this browser");let i={...g,challenge:aV(g.challenge),user:{...g.user,id:aV(g.user.id)},excludeCredentials:g.excludeCredentials?.map(aY)},j={};h&&(j.mediation="conditional"),j.publicKey=i,j.signal=a_.createNewAbortSignal();try{b=await navigator.credentials.create(j)}catch(a){throw function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new a$({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("ConstraintError"===a.name){if(c.authenticatorSelection?.requireResidentKey===!0)return new a$({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});else if("conditional"===b.mediation&&c.authenticatorSelection?.userVerification==="required")return new a$({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});else if(c.authenticatorSelection?.userVerification==="required")return new a$({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else if("InvalidStateError"===a.name)return new a$({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});else if("NotAllowedError"===a.name)return new a$({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("NotSupportedError"===a.name)return new a$(0===c.pubKeyCredParams.filter(a=>"public-key"===a.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});else if("SecurityError"===a.name){let b=globalThis.location.hostname;if(!aZ(b))return new a$({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rp.id!==b)return new a$({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("TypeError"===a.name){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new a$({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if("UnknownError"===a.name)return new a$({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return a}({error:a,options:j})}if(!b)throw Error("Registration was not completed");let{id:k,rawId:l,response:m,type:n}=b;if("function"==typeof m.getTransports&&(d=m.getTransports()),"function"==typeof m.getPublicKeyAlgorithm)try{e=m.getPublicKeyAlgorithm()}catch(a){a3("getPublicKeyAlgorithm()",a)}if("function"==typeof m.getPublicKey)try{let a=m.getPublicKey();null!==a&&(f=aU(a))}catch(a){a3("getPublicKey()",a)}if("function"==typeof m.getAuthenticatorData)try{c=aU(m.getAuthenticatorData())}catch(a){a3("getAuthenticatorData()",a)}return{id:k,rawId:aU(l),response:{attestationObject:aU(m.attestationObject),clientDataJSON:aU(m.clientDataJSON),transports:d,publicKeyAlgorithm:e,publicKey:f,authenticatorData:c},type:n,clientExtensionResults:b.getClientExtensionResults(),authenticatorAttachment:a1(b.authenticatorAttachment)}}function a3(a,b){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${a}. You should report this error to them.
`,b)}let a4=a=>a;async function a5(a){let b,c,d;!a.optionsJSON&&a.challenge&&(console.warn("startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),a={optionsJSON:a});let{optionsJSON:e,useBrowserAutofill:f=!1,verifyBrowserAutofillInput:g=!0}=a;if(!aW())throw Error("WebAuthn is not supported in this browser");e.allowCredentials?.length!==0&&(b=e.allowCredentials?.map(aY));let h={...e,challenge:aV(e.challenge),allowCredentials:b},i={};if(f){if(!await function(){if(!aW())return a4(new Promise(a=>a(!1)));let a=globalThis.PublicKeyCredential;return a?.isConditionalMediationAvailable===void 0?a4(new Promise(a=>a(!1))):a4(a.isConditionalMediationAvailable())}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&g)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');i.mediation="conditional",h.allowCredentials=[]}i.publicKey=h,i.signal=a_.createNewAbortSignal();try{c=await navigator.credentials.get(i)}catch(a){throw function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new a$({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("NotAllowedError"===a.name)return new a$({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("SecurityError"===a.name){let b=globalThis.location.hostname;if(!aZ(b))return new a$({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rpId!==b)return new a$({message:`The RP ID "${c.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("UnknownError"===a.name)return new a$({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return a}({error:a,options:i})}if(!c)throw Error("Authentication was not completed");let{id:j,rawId:k,response:l,type:m}=c;return l.userHandle&&(d=aU(l.userHandle)),{id:j,rawId:aU(k),response:{authenticatorData:aU(l.authenticatorData),clientDataJSON:aU(l.clientDataJSON),signature:aU(l.signature),userHandle:d},type:m,clientExtensionResults:c.getClientExtensionResults(),authenticatorAttachment:a1(c.authenticatorAttachment)}}let a6=aO({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),a7=a6.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),a8=a6.newRole({user:[],session:[]}),a9={admin:a7,user:a8},ba=!1;function bb(a){if("undefined"==typeof document)return null;let b=document.cookie.split("; ").find(b=>b.startsWith(`${a}=`));return b?b.split("=")[1]:null}function bc(a,b="/api/auth"){if(function(a){try{let b=new URL(a).pathname.replace(/\/+$/,"")||"/";return"/"!==b}catch(b){throw new aN(`Invalid base URL: ${a}. Please provide a valid base URL.`)}}(a))return a;let c=a.replace(/\/+$/,"");return b&&"/"!==b?(b=b.startsWith("/")?b:`/${b}`,`${c}${b}`):c}let bd={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},be=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,bf={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},bg=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,bh={id:"redirect",name:"Redirect",hooks:{onSuccess(a){a.data?.url&&a.data?.redirect}}};var bi=a.i(800129);let bj=function(a){var b,c;let{pluginPathMethods:d,pluginsActions:e,pluginsAtoms:f,$fetch:g,$store:h,atomListeners:i}=((a,b)=>{var c;let d,e="credentials"in Request.prototype,f=function(a,b,c,d){if(a)return bc(a,b);if(!1!==d){let a=aL.BETTER_AUTH_URL||aL.NEXT_PUBLIC_BETTER_AUTH_URL||aL.PUBLIC_BETTER_AUTH_URL||aL.NUXT_PUBLIC_BETTER_AUTH_URL||aL.NUXT_PUBLIC_AUTH_URL||("/"!==aL.BASE_URL?aL.BASE_URL:void 0);if(a)return bc(a,b)}let e=c?.headers.get("x-forwarded-host"),f=c?.headers.get("x-forwarded-proto");if(e&&f)return bc(`${f}://${e}`,b);if(c){let a=function(a){try{return new URL(a).origin}catch(a){return null}}(c.url);if(!a)throw new aN("Could not get origin from request. Please provide a valid base URL.");return bc(a,b)}}(a?.baseURL,a?.basePath,void 0,b)??"/api/auth",g=a?.plugins?.flatMap(a=>a.fetchPlugins).filter(a=>void 0!==a)||[],h={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:a?.fetchOptions?.onSuccess,onError:a?.fetchOptions?.onError,onRequest:a?.fetchOptions?.onRequest,onResponse:a?.fetchOptions?.onResponse}},{onSuccess:i,onError:j,onRequest:k,onResponse:l,...m}=a?.fetchOptions||{},n=(c={baseURL:f,...e?{credentials:"include"}:{},method:"GET",jsonParser:a=>a?function(a,b={strict:!0}){return function(a,b={}){let{strict:c=!1,warnings:d=!1,reviver:e,parseDates:f=!0}=b;if("string"!=typeof a)return a;let g=a.trim();if(g.length>0&&'"'===g[0]&&g.endsWith('"')&&!g.slice(1,-1).includes('"'))return g.slice(1,-1);let h=g.toLowerCase();if(h.length<=9&&h in bf)return bf[h];if(!be.test(g)){if(c)throw SyntaxError("[better-json] Invalid JSON");return a}if(Object.entries(bd).some(([a,b])=>{let c=b.test(g);return c&&d&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${a} pattern`),c})&&c)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(g,(a,b)=>{if("__proto__"===a||"constructor"===a&&b&&"object"==typeof b&&"prototype"in b){d&&console.warn(`[better-json] Dropping "${a}" key to prevent prototype pollution`);return}if(f&&"string"==typeof b){let a=function(a){let b=bg.exec(a);if(!b)return null;let[,c,d,e,f,g,h,i,j,k,l]=b,m=new Date(Date.UTC(parseInt(c,10),parseInt(d,10)-1,parseInt(e,10),parseInt(f,10),parseInt(g,10),parseInt(h,10),i?parseInt(i.padEnd(3,"0"),10):0));if(j){let a=(60*parseInt(k,10)+parseInt(l,10))*("+"===j?-1:1);m.setUTCMinutes(m.getUTCMinutes()+a)}return m instanceof Date&&!isNaN(m.getTime())?m:null}(b);if(a)return a}return e?e(a,b):b})}catch(b){if(c)throw b;return a}}(a,b)}(a,{strict:!1}):null,customFetchImpl:fetch,...m,plugins:[h,...m.plugins||[],...a?.disableDefaultFetchPlugins?[]:[bh],...g]},async function(a,b){let d,e=av(au(au({},c),b),{plugins:[...(null==c?void 0:c.plugins)||[],(d=c||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(a,b){var c,e,f,g;let h=(null==(e=null==(c=d.plugins)?void 0:c.find(b=>{var c;return null!=(c=b.schema)&&!!c.config&&(a.startsWith(b.schema.config.baseURL||"")||a.startsWith(b.schema.config.prefix||""))}))?void 0:e.schema)||d.schema;if(h){let c=a;(null==(f=h.config)?void 0:f.prefix)&&c.startsWith(h.config.prefix)&&(c=c.replace(h.config.prefix,""),h.config.baseURL&&(a=a.replace(h.config.prefix,h.config.baseURL))),(null==(g=h.config)?void 0:g.baseURL)&&c.startsWith(h.config.baseURL)&&(c=c.replace(h.config.baseURL,""));let d=h.schema[c];if(d){let c=av(au({},b),{method:d.method,output:d.output});return(null==b?void 0:b.disableValidation)||(c=av(au({},c),{body:d.input?await aG(d.input,null==b?void 0:b.body):null==b?void 0:b.body,params:d.params?await aG(d.params,null==b?void 0:b.params):null==b?void 0:b.params,query:d.query?await aG(d.query,null==b?void 0:b.query):null==b?void 0:b.query})),{url:a,options:c}}}return{url:a,options:b}}})]});if(null==c?void 0:c.catchAllError)try{return await aI(a,e)}catch(a){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:a}}}return await aI(a,e)}),{$sessionSignal:o,session:p}={session:aM(d=am(!1),"/get-session",n,{method:"GET"}),$sessionSignal:d},q=a?.plugins||[],r={},s={$sessionSignal:o,session:p},t={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},u=[{signal:"$sessionSignal",matcher:a=>"/sign-out"===a||"/update-user"===a||a.startsWith("/sign-in")||a.startsWith("/sign-up")||"/delete-user"===a||"/verify-email"===a}];for(let a of q)a.getAtoms&&Object.assign(s,a.getAtoms?.(n)),a.pathMethods&&Object.assign(t,a.pathMethods),a.atomListeners&&u.push(...a.atomListeners);let v={notify:a=>{s[a].set(!s[a].get())},listen:(a,b)=>{s[a].subscribe(b)},atoms:s};for(let b of q)b.getActions&&Object.assign(r,b.getActions?.(n,v,a));return{get baseURL(){return f},pluginsActions:r,pluginsAtoms:s,pluginPathMethods:t,atomListeners:u,$fetch:n,$store:v}})(a),j={};for(let[a,b]of Object.entries(f)){j[`use${(c=a).charAt(0).toUpperCase()+c.slice(1)}`]=()=>(function(a,b={}){let c=(0,bi.useRef)(a.get()),{keys:d,deps:e=[a,d]}=b,f=(0,bi.useCallback)(b=>{let e=a=>{c.current!==a&&(c.current=a,b())};if(e(a.value),d?.length){let b;return b=new Set(d).add(void 0),a.listen((a,c,d)=>{b.has(d)&&e(a,c,d)})}return a.listen(e)},e),g=()=>c.current;return(0,bi.useSyncExternalStore)(f,g,g)})(b)}return b={...e,...j,$fetch:g,$store:h},function a(c=[]){return new Proxy(function(){},{get(d,e){var f;if("string"!=typeof e||"then"===e||"catch"===e||"finally"===e)return;let g=[...c,e],h=b;for(let a of g)if(h&&"object"==typeof h&&a in h)h=h[a];else{h=void 0;break}return"function"==typeof h?h:"object"==typeof(f=h)&&null!==f&&"get"in f&&"function"==typeof f.get&&"lc"in f&&"number"==typeof f.lc?h:a(g)},apply:async(a,b,e)=>{let h="/"+c.map(a=>a.replace(/[A-Z]/g,a=>`-${a.toLowerCase()}`)).join("/"),j=e[0]||{},k=e[1]||{},{query:l,fetchOptions:m,...n}=j,o={...k,...m},p=function(a,b,c){let d=b[a],{fetchOptions:e,query:f,...g}=c||{};return d||(e?.method?e.method:g&&Object.keys(g).length>0?"POST":"GET")}(h,d,j);return await g(h,{...o,body:"GET"===p?void 0:{...n,...o?.body||{}},query:l||o?.query,method:p,async onSuccess(a){await o?.onSuccess?.(a);let b=i?.find(a=>a.matcher(h));if(!b)return;let c=f[b.signal];if(!c)return;let d=c.get();setTimeout(()=>{c.set(!d)},10)}})}})}()}({baseURL:ai.clientEnv.authUrl,basePath:ai.clientEnv.authPath,plugins:[(b={admin:a7,user:a8,...j?.roles},{id:"admin-client",$InferServerPlugin:{},getActions:()=>({admin:{checkRolePermission:a=>(a=>{if(a.userId&&a.options?.adminUserIds?.includes(a.userId))return!0;if(!a.permissions&&!a.permission)return!1;let b=(a.role||a.options?.defaultRole||"user").split(","),c=a.options?.roles||a9;for(let d of b){let b=c[d],e=b?.authorize(a.permission??a.permissions);if(e?.success)return!0}return!1})({role:a.role,options:{ac:j?.ac,roles:b},permissions:a.permissions??a.permission})}}),pathMethods:{"/admin/list-users":"GET","/admin/stop-impersonating":"POST"}}),{id:"anonymous",$InferServerPlugin:{},pathMethods:{"/sign-in/anonymous":"POST"}},{id:"api-key",$InferServerPlugin:{},pathMethods:{"/api-key/create":"POST","/api-key/delete":"POST","/api-key/delete-all-expired-api-keys":"POST"}},{id:"infer-server-plugin",$InferServerPlugin:{}},{id:"generic-oauth-client",$InferServerPlugin:{}},{id:"better-auth-client",$InferServerPlugin:{}},{id:"multi-session",$InferServerPlugin:{},atomListeners:[{matcher:a=>"/multi-session/set-active"===a,signal:"$sessionSignal"}]},{id:"oidc-client",$InferServerPlugin:{}},(ai.clientEnv.googleClientId,{id:"one-tap",getActions:(a,b)=>({oneTap:async(a,b)=>{if(ba)return void console.warn("A Google One Tap request is already in progress. Please wait.");ba=!0;try{return void console.warn("Google One Tap is only available in browser environments")}catch(a){throw console.error("Error during Google One Tap flow:",a),a}finally{ba=!1}}}),getAtoms:a=>({})}),{id:"one-time-token",$InferServerPlugin:{}},(k={teams:{enabled:!0},dynamicAccessControl:{enabled:!0}},c=am(!1),d=am(!1),e=am(!1),f=am(!1),g={admin:aQ,member:aS,owner:aR,...k?.roles},{id:"organization",$InferServerPlugin:{},getActions:(a,b,c)=>({$Infer:{ActiveOrganization:{},Organization:{},Invitation:{},Member:{},Team:{}},organization:{checkRolePermission:a=>{var b;let c;return c=(b={role:a.role,options:{ac:k?.ac,roles:g},permissions:a.permissions??a.permission}).options.roles||aT,((a,b)=>{if(!a.permissions&&!a.permission)return!1;let c=a.role.split(","),d=a.options.creatorRole||"owner",e=c.includes(d),f=a.allowCreatorAllPermissions||!1;if(e&&f)return!0;for(let d of c){let c=b[d],e=c?.authorize(a.permissions??a.permission);if(e?.success)return!0}return!1})(b,c)}}}),getAtoms:a=>{let b=aM(c,"/organization/list",a,{method:"GET"}),g=aM([d],"/organization/get-full-organization",a,()=>({method:"GET"})),h=aM([e],"/organization/get-active-member",a,{method:"GET"}),i=aM([f],"/organization/get-active-member-role",a,{method:"GET"});return{$listOrg:c,$activeOrgSignal:d,$activeMemberSignal:e,$activeMemberRoleSignal:f,activeOrganization:g,listOrganizations:b,activeMember:h,activeMemberRole:i}},pathMethods:{"/organization/get-full-organization":"GET","/organization/list-user-teams":"GET"},atomListeners:[{matcher:a=>"/organization/create"===a||"/organization/delete"===a||"/organization/update"===a,signal:"$listOrg"},{matcher:a=>a.startsWith("/organization"),signal:"$activeOrgSignal"},{matcher:a=>a.startsWith("/organization/set-active"),signal:"$sessionSignal"},{matcher:a=>a.includes("/organization/update-member-role"),signal:"$activeMemberSignal"},{matcher:a=>a.includes("/organization/update-member-role"),signal:"$activeMemberRoleSignal"}]}),(h=am(),{id:"passkey",$InferServerPlugin:{},getActions:a=>((a,{$listPasskeys:b})=>({signIn:{passkey:async(b,c)=>{let d=await a("/passkey/generate-authenticate-options",{method:"POST"});if(!d.data)return d;try{let e=await a5({optionsJSON:d.data,useBrowserAutofill:b?.autoFill});return await a("/passkey/verify-authentication",{body:{response:e},...b?.fetchOptions,...c,method:"POST"})}catch(a){return{data:null,error:{code:"AUTH_CANCELLED",message:"auth cancelled",status:400,statusText:"BAD_REQUEST"}}}}},passkey:{addPasskey:async(c,d)=>{let e=await a("/passkey/generate-register-options",{method:"GET",query:{...c?.authenticatorAttachment&&{authenticatorAttachment:c.authenticatorAttachment},...c?.name&&{name:c.name}}});if(!e.data)return e;try{let f=await a2({optionsJSON:e.data,useAutoRegister:c?.useAutoRegister}),g=await a("/passkey/verify-registration",{...c?.fetchOptions,...d,body:{response:f,name:c?.name},method:"POST"});if(!g.data)return g;b.set(Math.random())}catch(a){if(a instanceof a$){if("ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"===a.code)return{data:null,error:{code:a.code,message:"previously registered",status:400,statusText:"BAD_REQUEST"}};if("ERROR_CEREMONY_ABORTED"===a.code)return{data:null,error:{code:a.code,message:"registration cancelled",status:400,statusText:"BAD_REQUEST"}};return{data:null,error:{code:a.code,message:a.message,status:400,statusText:"BAD_REQUEST"}}}return{data:null,error:{code:"UNKNOWN_ERROR",message:a instanceof Error?a.message:"unknown error",status:500,statusText:"INTERNAL_SERVER_ERROR"}}}}},$Infer:{}}))(a,{$listPasskeys:h}),getAtoms:a=>({listPasskeys:aM(h,"/passkey/list-user-passkeys",a,{method:"GET"}),$listPasskeys:h}),pathMethods:{"/passkey/register":"POST","/passkey/authenticate":"POST"},atomListeners:[{matcher:a=>"/passkey/verify-registration"===a||"/passkey/delete-passkey"===a||"/passkey/update-passkey"===a,signal:"_listPasskeys"}]}),{id:"phoneNumber",$InferServerPlugin:{},atomListeners:[{matcher:a=>"/phone-number/update"===a||"/phone-number/verify"===a,signal:"$sessionSignal"}]},{id:"siwe",$InferServerPlugin:{}},{id:"sso-client",$InferServerPlugin:{}},{id:"two-factor",$InferServerPlugin:{},atomListeners:[{matcher:a=>a.startsWith("/two-factor/"),signal:"$sessionSignal"}],pathMethods:{"/two-factor/disable":"POST","/two-factor/enable":"POST","/two-factor/send-otp":"POST","/two-factor/generate-backup-codes":"POST"},fetchPlugins:[{id:"two-factor",name:"two-factor",hooks:{async onSuccess(a){a.data?.twoFactorRedirect&&i?.onTwoFactorRedirect&&await i.onTwoFactorRedirect()}}}]},{id:"username",$InferServerPlugin:{}},{id:"stripe-client",$InferServerPlugin:{},pathMethods:{"/subscription/restore":"POST","/subscription/billing-portal":"POST"}},{id:"device-authorization",$InferServerPlugin:{},pathMethods:{"/device/code":"POST","/device/token":"POST","/device":"GET","/device/approve":"POST","/device/deny":"POST"}},((a={})=>{let b=a.cookieName||"better-auth.last_used_login_method";return{id:"last-login-method-client",getActions:()=>({getLastUsedLoginMethod:()=>bb(b),clearLastUsedLoginMethod:()=>{"undefined"!=typeof document&&(document.cookie=`${b}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)},isLastUsedLoginMethod:a=>bb(b)===a})}})()]}),{$store:bk,signIn:bl}=bj;bk.listen("$sessionSignal",async()=>{}),a.s(["client",0,bj],255465);var bm=ah;class bn extends bm.TaggedError("BetterAuthError"){message;constructor(a){super({message:a}),this.message=a}}class bo extends ah.TaggedError("IamError"){cause;customMessage;metadata;code;status;statusText;plugin;method;authCause;constructor(a,b,c={}){super({customMessage:b??"Unknown Error has occurred",cause:a,...c}),this.cause=a,this.customMessage=b,this.metadata=c,this.code=c.code,this.status=c.status,this.statusText=c.statusText,this.plugin=c.plugin,this.method=c.method,this.authCause=c.authCause}static match=(a,b={})=>{if(a instanceof bn)return new bo(a.cause,a.message,b);let c=q.hasProperty("message")(a)&&q.isString(a.message)?a.message:"Unknown Error has occurred";return new bo(new ag.BeepError.UnknownError({cause:a,customMessage:c}),c,b)};get message(){return this.customMessage??"Unknown Error has occurred"}}let bp=(a,b={})=>{let c=b.supportsAbort??!1,d=()=>{let b=a.metadata();return{plugin:b.plugin,method:b.method}},e=a=>bo.match(a,d());return{run:b=>{let f,g=d();return f=K.async(a=>{let d=c?new AbortController:void 0,f=!1,g=b=>{f||(f=!0,c&&d&&!d.signal.aborted&&d.abort(),a(b))},h=d?{signal:d.signal,onError:({error:a})=>{g(K.fail(e(a)))}}:{onError:({error:a})=>{g(K.fail(e(a)))}};try{b(h).then(a=>{g(K.succeed(a))},a=>{g(K.fail(e(a)))})}catch(a){g(K.fail(e(a)))}if(c)return K.sync(()=>{d&&!d.signal.aborted&&d.abort()})}),f.pipe(K.annotateLogs({contract:a.contract,plugin:g.plugin,method:g.method}))},raiseResult:a=>null==a.error?K.void:K.fail(e(a.error))}};var bq=a.i(255564),bq=bq,br=a.i(563479),br=br,bs=P,bt=r;class bu extends bs.BS.Class("OAuthRegisterPayload")({client_name:bt.NonEmptyTrimmedString,redirect_uris:bt.mutable(bt.Array(bs.BS.Url))},{schemaId:Symbol.for("@beep/iam-sdk/clients/OAuthRegisterPayload"),identifier:"OAuthRegisterPayload",description:"Payload for registering a new OAuth2 client."}){}let bv=bq.make("OAuthRegisterContract",{description:"Registers a new OAuth2 application.",parameters:bu.fields,failure:bt.instanceOf(bo),success:bt.Void}),bw=br.make(bv),bx=K.fn("OAuthRegisterHandler")(function*(a){let b=bp({contract:"OAuthRegisterContract",metadata:()=>({plugin:"oauth2",method:"register"})}),c=yield*r.encode(bu)(a).pipe(K.catchTag("ParseError",a=>K.dieMessage(a.message))),d=yield*b.run(()=>bj.oauth2.register(c));yield*b.raiseResult(d)});bw.of({OAuthRegisterContract:bx});var bq=bq,br=br,by=P;a.i(569411);var bz=a.i(763728);class bA extends by.BS.Class("AcceptInvitationPayload")({invitationId:bz.IamEntityIds.InvitationId},{schemaId:Symbol.for("@beep/iam-sdk/clients/AcceptInvitationPayload"),identifier:"AcceptInvitationPayload",description:"Payload for accepting an organization invitation."}){}let bB=bq.make("AcceptInvitationContract",{description:"Accepts an organization invitation.",parameters:bA.fields,failure:r.instanceOf(bo),success:r.Void}),bC=br.make(bB),bD=K.fn("AcceptInvitationHandler")(function*(a){let b=bp({contract:"AcceptInvitationContract",metadata:()=>({plugin:"organization",method:"acceptInvitation"})}),c=yield*b.run(()=>bj.organization.acceptInvitation(a));yield*b.raiseResult(c)});bC.of({AcceptInvitationContract:bD});var bq=bq,br=br,bE=P,bF=a.i(164166),bG=a.i(876065),bH=a.i(258046);let bI={newPassword:bE.BS.Password,passwordConfirm:bE.BS.Password},bJ=r.Struct(bI).pipe(r.filter(({newPassword:a,passwordConfirm:b})=>bG.equals(bH.value(a),bH.value(b))||"Passwords do not match"),r.annotations({identifier:"ResetPasswordPayload",description:"Payload containing the data required to reset a password.",schemaId:Symbol.for("@beep/iam-sdk/clients/ResetPasswordPayload")}));class bK extends bE.BS.Class("RequestResetPasswordPayload")({email:bE.BS.Email,redirectTo:bE.BS.StringWithDefault(bF.paths.auth.requestResetPassword)},{schemaId:Symbol.for("@beep/iam-sdk/clients/RequestResetPasswordPayload"),identifier:"RequestResetPasswordPayload",description:"Payload for requesting a password reset email."}){}let bL=bq.make("ResetPasswordContract",{description:"Resets a user's password using the provided token.",parameters:bI,failure:r.instanceOf(bo),success:r.Void}),bM=bq.make("RequestResetPasswordContract",{description:"Requests a password reset email for a user.",parameters:bK.fields,failure:r.instanceOf(bo),success:r.Void}),bN=br.make(bL,bM);a.s(["RecoverContractSet",0,bN,"RequestResetPasswordPayload",()=>bK,"ResetPasswordPayload",0,bJ],536386);let bO=K.fn("ResetPasswordHandler")(function*(a){let b=bp({contract:"ResetPasswordContract",metadata:()=>({plugin:"reset-password",method:"submit"})}),c=new URLSearchParams(window.location.search).get("token"),d=o.fromNullable(c);if(o.isNone(d))return yield*K.fail(new bo({id:"reset-password-token",resource:"reset-password-token"},"No token found",{plugin:"reset-password",method:"submit"}));let e=yield*r.encode(bJ)(a).pipe(K.catchTag("ParseError",a=>K.dieMessage(a.message))),f=yield*b.run(()=>bj.resetPassword({newPassword:e.newPassword,token:d.value}));yield*b.raiseResult(f)}),bP=K.fn("RequestPasswordResetHandler")(function*(a){let b=bp({contract:"RequestResetPasswordContract",metadata:()=>({plugin:"reset-password",method:"request"})}),c=yield*r.encode(bK)(a).pipe(K.catchTag("ParseError",a=>K.dieMessage(a.message))),d=yield*b.run(()=>bj.requestPasswordReset(c));yield*b.raiseResult(d)}),bQ=bN.of({ResetPasswordContract:bO,RequestResetPasswordContract:bP});a.s(["RecoverImplementations",0,bQ],647340),a.i(963081);var bR=a.i(509603),bq=bq,br=br,bS=P,bT=r;class bU extends bS.BS.Class("SignInEmailPayload")({email:bS.BS.Email,password:bS.BS.Password,rememberMe:bS.BS.BoolWithDefault(!1),captchaResponse:bT.Redacted(bT.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInEmailPayload"),identifier:"SignInEmailPayload",description:"Payload for signing in with email and password"}){}let bV=bq.make("SignInEmail",{description:"Signs the user in using email",parameters:bU.fields,failure:bT.instanceOf(bo),success:bT.Void});class bW extends bS.BS.Class("SignInSocialPayload")({provider:bR.AuthProviderNameValue,callbackURL:bT.optional(bS.BS.URLString)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInSocialPayload"),identifier:"SignInSocialPayload",description:"Payload for signing in with a supported social provider"}){}let bX=bq.make("SignInSocial",{description:"Contract for signing in a user with a social auth provider.",parameters:bW.fields,failure:bT.instanceOf(bo),success:bT.Void});class bY extends bS.BS.Class("SignInUsernamePayload")({username:bT.NonEmptyTrimmedString,password:bS.BS.Password,rememberMe:bS.BS.BoolWithDefault(!1),captchaResponse:bT.Redacted(bT.String),callbackURL:bT.optional(bS.BS.URLString)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInUsernamePayload"),identifier:"SignInUsernamePayload",description:"Payload for signing in with username and password"}){}let bZ=bq.make("SignInUsername",{description:"Signs the user in using their username.",parameters:bY.fields,failure:bT.instanceOf(bo),success:bT.Void});class b$ extends bS.BS.Class("SignInPhoneNumberPayload")({phoneNumber:bS.BS.Phone,password:bS.BS.Password,rememberMe:bS.BS.BoolWithDefault(!1),captchaResponse:bT.Redacted(bT.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInPhoneNumberPayload"),identifier:"SignInPhoneNumberPayload",description:"Payload for signing in with a phone number and password"}){}let b_=bq.make("SignInPhoneNumber",{description:"Signs the user in using their phone number.",parameters:b$.fields,failure:bT.instanceOf(bo),success:bT.Void});class b0 extends bS.BS.Class("SignInPasskeyPayload")({},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInPasskeyPayload"),identifier:"SignInPasskeyPayload",description:"Payload for signing in with a passkey",title:"Sign in with passkey"}){}let b1=bq.make("SignInPasskey",{description:"Signs the user in using a passkey.",parameters:b0.fields,failure:bT.instanceOf(bo),success:bT.Void}),b2=bT.Struct({}),b3=bq.make("SignInOneTap",{description:"Signs the user in using a one tap.",parameters:b2.fields,failure:bT.instanceOf(bo),success:bT.Void}),b4=br.make(bV,bX,bZ,b_,b1,b3);a.s(["SignInContractSet",0,b4,"SignInEmailPayload",()=>bU],546201);let b5=K.fn("SignInSocialHandler")(function*(a){let b=bp({contract:"SignInSocial",metadata:()=>({plugin:"signIn",method:"social"})});yield*K.flatMap(b.run(b=>bj.signIn.social({provider:a.provider,callbackURL:a.callbackURL},b.signal?{onError:b.onError,signal:b.signal}:{onError:b.onError})),b.raiseResult)}),b6=K.fn("SignInEmailHandler")(function*(a){let b=bp({contract:"SignInEmail",metadata:()=>({plugin:"signIn",method:"email"})}),c=yield*b.run(b=>bj.signIn.email({email:bH.value(a.email),password:bH.value(a.password),rememberMe:a.rememberMe,fetchOptions:b.signal?{headers:{"x-captcha-response":bH.value(a.captchaResponse)},onError:b.onError,signal:b.signal}:{headers:{"x-captcha-response":bH.value(a.captchaResponse)},onError:b.onError}}));yield*b.raiseResult(c),null==c.error&&bj.$store.notify("$sessionSignal")}),b7=K.fn("SignInUsernameHandler")(function*(a){let{username:b,password:c,rememberMe:d,captchaResponse:e,callbackURL:f}=a,g=bp({contract:"SignInUsername",metadata:()=>({plugin:"signIn",method:"username"})});yield*K.flatMap(g.run(a=>bj.signIn.username({username:b,password:bH.value(c),rememberMe:d,callbackURL:f,fetchOptions:a.signal?{headers:{"x-captcha-response":bH.value(e)},onError:a.onError,signal:a.signal}:{headers:{"x-captcha-response":bH.value(e)},onError:a.onError}})),a=>(null==a.error&&bj.$store.notify("$sessionSignal"),g.raiseResult(a)))}),b8=K.fn("SignInPhoneNumberHandler")(function*(a){let b=bp({contract:"SignInUsername",metadata:()=>({plugin:"signIn",method:"phoneNumber"})});yield*K.flatMap(b.run(b=>bj.signIn.phoneNumber({phoneNumber:bH.value(a.phoneNumber),password:bH.value(a.password),rememberMe:a.rememberMe,fetchOptions:b.signal?{headers:{"x-captcha-response":bH.value(a.captchaResponse)},onError:b.onError,signal:b.signal}:{headers:{"x-captcha-response":bH.value(a.captchaResponse)},onError:b.onError}})),a=>(null==a.error&&bj.$store.notify("$sessionSignal"),b.raiseResult(a)))}),b9=K.fn("SignInOneTapHandler")(function*(){let a=bp({contract:"SignInOneTap",metadata:()=>({plugin:"oneTap",method:"signIn"})});yield*a.run(a=>bj.oneTap({fetchOptions:a.signal?{onError:a.onError,signal:a.signal}:{onError:a.onError}}))}),ca=K.fn("SignInPasskey")(function*(){let a=bp({contract:"SignInPasskey",metadata:()=>({plugin:"signIn",method:"passkey"})});yield*K.flatMap(a.run(a=>bj.signIn.passkey({fetchOptions:a.signal?{onError:a.onError,signal:a.signal}:{onError:a.onError}})),b=>(null==b.error&&bj.$store.notify("$sessionSignal"),a.raiseResult(b)))}),cb=b4.of({SignInEmail:b6,SignInSocial:b5,SignInPhoneNumber:b8,SignInUsername:b7,SignInPasskey:ca,SignInOneTap:b9});a.s(["SignInImplementations",0,cb],525761);var bq=bq,br=br,cc=P,cd=r;class ce extends cc.BS.Class("SignOutPayload")({onSuccess:new cc.BS.Fn({input:cd.Undefined,output:cd.Void}).Schema},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignOutPayload"),identifier:"SignOutPayload",description:"Payload for signing out the current user."}){}let cf=bq.make("SignOutContract",{description:"Signs the current user out of their active session.",parameters:ce.fields,failure:cd.instanceOf(bo),success:cd.Void}),cg=br.make(cf),ch=K.fn("SignOutHandler")(function*(a){let b=bp({contract:"SignOutContract",metadata:()=>({plugin:"core",method:"signOut"})}),c=yield*b.run(b=>bj.signOut({fetchOptions:b.signal?{signal:b.signal,onSuccess:()=>a.onSuccess(void 0),onError:b.onError}:{onSuccess:()=>a.onSuccess(void 0),onError:b.onError}}));yield*b.raiseResult(c),null==c.error&&bj.$store.notify("$sessionSignal")}),ci=cg.of({SignOutContract:ch});a.s(["SignOutImplementations",0,ci],139770);var bq=bq,br=br,cj=P;a.i(279030),a.i(967811),a.i(74767);var ck=a.i(273697);a.s(["Model",()=>ck.Model],923916),a.i(923916),a.i(294474);var cl=a.i(738263);a.i(277298);var cm=a.i(821993);a.s(["ShardPrefix",()=>cm.ShardPrefix,"ShardPrefixDecoded",()=>cm.ShardPrefixDecoded,"ShardPrefixEncoded",()=>cm.ShardPrefixEncoded,"UploadPath",()=>cm.UploadPath,"UploadPathDecoded",()=>cm.UploadPathDecoded,"UploadPathEncoded",()=>cm.UploadPathEncoded,"UploadPathParser",()=>cm.UploadPathParser],942029),a.i(942029),a.s(["Model",()=>cl.Model,"ShardPrefix",()=>cm.ShardPrefix,"ShardPrefixDecoded",()=>cm.ShardPrefixDecoded,"ShardPrefixEncoded",()=>cm.ShardPrefixEncoded,"UploadPath",()=>cm.UploadPath,"UploadPathDecoded",()=>cm.UploadPathDecoded,"UploadPathEncoded",()=>cm.UploadPathEncoded,"UploadPathParser",()=>cm.UploadPathParser],647114),a.i(647114),a.i(15385);var cn=a.i(404269);a.i(555590);var co=a.i(226231),cp=a.i(247280),cq=a.i(582966);a.s(["OrganizationType",()=>co.OrganizationType,"OrganizationTypeEnum",()=>co.OrganizationTypeEnum,"OrganizationTypeOptions",()=>co.OrganizationTypeOptions,"SubscriptionStatus",()=>cp.SubscriptionStatus,"SubscriptionStatusEnum",()=>cp.SubscriptionStatusEnum,"SubscriptionStatusOptions",()=>cp.SubscriptionStatusOptions,"SubscriptionTier",()=>cq.SubscriptionTier,"SubscriptionTierEnum",()=>cq.SubscriptionTierEnum,"SubscriptionTierOptions",()=>cq.SubscriptionTierOptions,"makeOrganizationTypePgEnum",()=>co.makeOrganizationTypePgEnum,"makeSubscriptionStatusPgEnum",()=>cp.makeSubscriptionStatusPgEnum,"makeSubscriptionTierPgEnum",()=>cq.makeSubscriptionTierPgEnum,"organizationTypeKit",()=>co.organizationTypeKit],77368),a.i(77368),a.s(["Model",()=>cn.Model,"OrganizationModelSchemaId",()=>cn.OrganizationModelSchemaId,"OrganizationType",()=>co.OrganizationType,"OrganizationTypeEnum",()=>co.OrganizationTypeEnum,"OrganizationTypeOptions",()=>co.OrganizationTypeOptions,"SubscriptionStatus",()=>cp.SubscriptionStatus,"SubscriptionStatusEnum",()=>cp.SubscriptionStatusEnum,"SubscriptionStatusOptions",()=>cp.SubscriptionStatusOptions,"SubscriptionTier",()=>cq.SubscriptionTier,"SubscriptionTierEnum",()=>cq.SubscriptionTierEnum,"SubscriptionTierOptions",()=>cq.SubscriptionTierOptions,"makeOrganizationTypePgEnum",()=>co.makeOrganizationTypePgEnum,"makeSubscriptionStatusPgEnum",()=>cp.makeSubscriptionStatusPgEnum,"makeSubscriptionTierPgEnum",()=>cq.makeSubscriptionTierPgEnum,"organizationTypeKit",()=>co.organizationTypeKit],15496),a.i(15496),a.i(555661);var cr=a.i(186500);a.s(["Model",()=>cr.Model,"TeamModelSchemaId",()=>cr.TeamModelSchemaId],715069),a.i(715069),a.i(451684),a.i(443256);var cs=a.i(50074),ct=a.i(49102);a.s(["UserGender",()=>cs.UserGender,"UserGenderEnum",()=>cs.UserGenderEnum,"UserGenderKit",()=>cs.UserGenderKit,"UserGenderOptions",()=>cs.UserGenderOptions,"UserRole",()=>ct.UserRole,"UserRoleEnum",()=>ct.UserRoleEnum,"UserRoleKit",()=>ct.UserRoleKit,"UserRoleOptions",()=>ct.UserRoleOptions,"makeUserGenderPgEnum",()=>cs.makeUserGenderPgEnum,"makeUserRolePgEnum",()=>ct.makeUserRolePgEnum],672895),a.i(672895);var cu=a.i(702018),cv=a.i(662605);a.s(["Model",()=>cu.Model,"NewUser",()=>cv.NewUser,"UserGender",()=>cs.UserGender,"UserGenderEnum",()=>cs.UserGenderEnum,"UserGenderKit",()=>cs.UserGenderKit,"UserGenderOptions",()=>cs.UserGenderOptions,"UserRole",()=>ct.UserRole,"UserRoleEnum",()=>ct.UserRoleEnum,"UserRoleKit",()=>ct.UserRoleKit,"UserRoleOptions",()=>ct.UserRoleOptions,"makeUserGenderPgEnum",()=>cs.makeUserGenderPgEnum,"makeUserRolePgEnum",()=>ct.makeUserRolePgEnum],956854);var cw=a.i(956854);a.s(["User",0,cw],554548);var cw=cw,cx=m,cy=O,cz=bH,cA=r,cB=a.i(447932),cC=a.i(87112);let cD=cA.Struct({email:cj.BS.Email,rememberMe:cj.BS.BoolWithDefault(!1),redirectTo:cj.BS.StringWithDefault(bF.paths.dashboard.root),gender:cw.Model.insert.fields.gender,password:cj.BS.Password,passwordConfirm:cj.BS.Password,firstName:cA.NonEmptyTrimmedString,lastName:cA.NonEmptyTrimmedString,captchaResponse:cA.Redacted(cA.String)}),cE=cA.Struct({email:cA.encodedSchema(cj.BS.Email),rememberMe:cj.BS.BoolWithDefault(!1),callbackURL:cj.BS.StringWithDefault(bF.paths.dashboard.root),gender:cw.Model.insert.fields.gender,password:cA.encodedSchema(cj.BS.Password),passwordConfirm:cA.encodedSchema(cj.BS.Password),firstName:cA.NonEmptyTrimmedString,lastName:cA.NonEmptyTrimmedString,name:cA.NonEmptyTrimmedString,captchaResponse:cA.Redacted(cA.String)});class cF extends cA.transformOrFail(cD,cE,{strict:!0,decode:({rememberMe:a=!1,...b},c,d)=>cy.try({try:()=>{let c=cx.pipe(b.firstName,cB.concat(" "),cB.concat(b.lastName));return{firstName:b.firstName,lastName:b.lastName,gender:b.gender,email:cz.value(b.email),password:cz.value(b.password),passwordConfirm:cz.value(b.passwordConfirm),redirectTo:b.redirectTo,rememberMe:a,captchaResponse:cz.value(b.captchaResponse),name:c}},catch:()=>new cy.Type(d,b,"could not decode signup")}),encode:(a,b,c)=>cy.try({try:()=>cy.decodeSync(cD)(cC.omit(a,"name")),catch:()=>new cy.Type(c,a,"could not encode signup")})}){}class cG extends cj.BS.Class("SignUpEmailPayload")({value:cF,onSuccess:new cj.BS.Fn({input:cj.BS.URLPath,output:cA.Void}).Schema},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignUpEmailPayload"),identifier:"SignUpEmailPayload",description:"Payload for signing up a new user via email."}){}let cH=bq.make("SignUpEmail",{description:"Signs up a new user using email credentials.",parameters:cG.fields,failure:cA.instanceOf(bo),success:cA.Union(cA.TaggedStruct("Success",{}),cA.TaggedStruct("Failure",{}))}),cI=br.make(cH);a.s(["SignUpContractSet",0,cI,"SignUpValue",()=>cF],898595);let cJ=K.fn("SignUpEmailHandler")(function*(a){let b=bp({contract:"SignUpEmail",metadata:()=>({plugin:"signUp",method:"email"})}),{value:c,onSuccess:d}=a,{captchaResponse:e,...f}=c,g=yield*b.run(a=>bj.signUp.email({...f,fetchOptions:a.signal?{headers:{"x-captcha-response":bH.value(e)},onSuccess:()=>d(bF.paths.dashboard.root),onError:a.onError,signal:a.signal}:{headers:{"x-captcha-response":bH.value(e)},onSuccess:()=>d(bF.paths.dashboard.root),onError:a.onError}}));return yield*b.raiseResult(g),null==g.error&&bj.$store.notify("$sessionSignal"),g.error?{_tag:"Failure"}:{_tag:"Success"}}),cK=cI.of({SignUpEmail:cJ});a.s(["SignUpImplementations",0,cK],882701);var bq=bq,br=br,cL=P,cM=r;let cN=cM.Struct({}).annotations({schemaId:Symbol.for("@beep/iam-sdk/clients/SendOtpPayload"),identifier:"SendOtpPayload",description:"Payload for sending a one-time password via the two-factor adapter."});class cO extends cL.BS.Class("VerifyOtpPayload")({code:cM.Redacted(cM.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/VerifyOtpPayload"),identifier:"VerifyOtpPayload",description:"Payload containing the OTP verification code."}){}class cP extends cL.BS.Class("VerifyTotpPayload")({code:cM.Redacted(cM.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/VerifyTotpPayload"),identifier:"VerifyTotpPayload",description:"Payload containing the TOTP verification code."}){}let cQ=bq.make("SendOtpContract",{description:"Sends a one-time password to the user.",parameters:cN.fields,failure:cM.instanceOf(bo),success:cM.Void}),cR=bq.make("VerifyOtpContract",{description:"Verifies an OTP provided by the user.",parameters:cO.fields,failure:cM.instanceOf(bo),success:cM.Void}),cS=bq.make("VerifyTotpContract",{description:"Verifies a TOTP provided by the user.",parameters:cP.fields,failure:cM.instanceOf(bo),success:cM.Void}),cT=br.make(cQ,cR,cS),cU=K.fn("SendOtpContract")(function*(){let a=bp({contract:"SendOtpContract",metadata:()=>({plugin:"two-factor",method:"sendOtp"})}),b=yield*a.run(()=>bj.twoFactor.sendOtp());yield*a.raiseResult(b)}),cV=K.fn("VerifyOtpHandler")(function*(a){let b=bp({contract:"VerifyOtpContract",metadata:()=>({plugin:"two-factor",method:"verifyOtp"})}),c=yield*b.run(()=>bj.twoFactor.verifyOtp({code:bH.value(a.code)}));yield*b.raiseResult(c)}),cW=K.fn("VerifyTotpHandler")(function*(a){let b=bp({contract:"VerifyTotpContract",metadata:()=>({plugin:"two-factor",method:"verifyTotp"})}),c=yield*b.run(()=>bj.twoFactor.verifyTotp({code:bH.value(a.code)}));yield*b.raiseResult(c)});cT.of({SendOtpContract:cU,VerifyOtpContract:cV,VerifyTotpContract:cW});var bq=bq,br=br,cX=P,cY=r;class cZ extends cX.BS.Class("SendVerifyPhonePayload")({phoneNumber:cX.BS.Phone,code:cY.Redacted(cY.NonEmptyTrimmedString),updatePhoneNumber:cX.BS.BoolWithDefault(!0)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SendVerifyPhonePayload"),identifier:"SendVerifyPhonePayload",description:"Payload for verifying a user's phone number."}){}class c$ extends cY.Class("SendEmailVerificationPayload")({email:cX.BS.Email},{schemaId:Symbol.for("@beep/iam-sdk/clients/SendEmailVerificationPayload"),identifier:"SendEmailVerificationPayload",description:"Payload for sending an email verification link."}){}class c_ extends cY.Class("VerifyEmailPayload")({token:cY.Redacted(cY.String),onFailure:new cX.BS.Fn({input:cY.Undefined,output:cY.Void}).Schema,onSuccess:new cX.BS.Fn({input:cY.Undefined,output:cY.Void}).Schema},{schemaId:Symbol.for("@beep/iam-sdk/clients/VerifyEmailPayload"),identifier:"VerifyEmailPayload",description:"Payload for verifying an email address via a token."}){}let c0=bq.make("SendVerifyPhoneContract",{description:"Sends a phone verification request.",parameters:cZ.fields,failure:cY.instanceOf(bo),success:cY.Void}),c1=bq.make("SendEmailVerificationContract",{description:"Sends an email verification link to the user.",parameters:c$.fields,failure:cY.instanceOf(bo),success:cY.Void}),c2=bq.make("VerifyEmailContract",{description:"Verifies a user's email via a token.",parameters:c_.fields,failure:cY.instanceOf(bo),success:cY.Void}),c3=br.make(c0,c1,c2);a.s(["SendVerifyPhonePayload",()=>cZ,"VerifyContractSet",0,c3],129891);let c4=K.fn("SendEmailVerificationHandler")(function*(a){let b=bp({contract:"SendEmailVerificationContract",metadata:()=>({plugin:"verification",method:"sendVerificationEmail"})}),c=yield*b.run(b=>bj.sendVerificationEmail({email:bH.value(a.email),fetchOptions:b.signal?{onError:b.onError,signal:b.signal}:{onError:b.onError}}));yield*b.raiseResult(c)}),c5=K.fn("VerifyEmailHandler")(function*(a){let b=bp({contract:"VerifyEmailContract",metadata:()=>({plugin:"verification",method:"verifyEmail"})}),c=yield*b.run(b=>bj.verifyEmail({query:{token:bH.value(a.token)}},b.signal?{signal:b.signal,onSuccess:()=>{a.onSuccess(void 0)},onError:c=>{a.onFailure(void 0),b.onError(c)}}:{onSuccess:()=>{a.onSuccess(void 0)},onError:c=>{a.onFailure(void 0),b.onError(c)}}));yield*b.raiseResult(c)}),c6=K.fn("SendVerifyPhoneHandler")(function*(a){let{phoneNumber:b,code:c,updatePhoneNumber:d}=a,e=bp({contract:"SendVerifyPhoneContract",metadata:()=>({plugin:"verification",method:"phone"})}),f=yield*e.run(()=>bj.phoneNumber.verify({phoneNumber:bH.value(b),code:bH.value(c),updatePhoneNumber:d}));yield*e.raiseResult(f)}),c7=c3.of({SendVerifyPhoneContract:c6,SendEmailVerificationContract:c4,VerifyEmailContract:c5});a.s(["VerifyImplementations",0,c7],822419),a.s([],849927)},283654,132364,405674,a=>{"use strict";a.i(849927),a.i(569411);var b=a.i(164166),c=a.i(524263),d=a.i(676736),e=a.i(852845),f=a.i(447932);let g=[b.paths.dashboard.root,b.paths.settings.root,b.paths.admin.root,b.paths.organizations.root,b.paths.auth.device.root,"/account",b.paths.fileManager.root],h=a=>d.pipe(f.split("#")(a),c.head,e.getOrElse(()=>a)),i=a=>d.pipe(f.split("?")(a),c.head,e.getOrElse(()=>a)),j="callbackURL",k=`${b.paths.dashboard.root}`,l=a=>{let b;return!a||!f.startsWith("/")(a)||f.startsWith("//")(a)?k:(b=d.pipe(a,h,i),c.some(g,a=>f.startsWith(a)(b)))?a:k};a.s(["defaultTarget",0,k,"getURL",0,a=>l(a.get(j)),"paramName",0,j,"sanitizePath",0,l],132364),a.s([],405674),a.s([],283654)}];

//# sourceMappingURL=packages_iam_sdk_src_466c9610._.js.map