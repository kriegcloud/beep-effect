module.exports=[852460,a=>{"use strict";function b(a){return void 0===a||void 0===a}function c(a){return"string"==typeof a}function d(a){return"number"==typeof a}function e(a){return"boolean"==typeof a}function f(a){return null===a}function g(a){return a instanceof Date}function h(a){return"bigint"==typeof a}function i(a){return"undefined"!=typeof Buffer&&Buffer.isBuffer(a)}function j(a){return"function"==typeof a}function k(a){return"object"==typeof a&&null!==a}function l(a){return a[a.length-1]}function m(a){return Object.freeze(a)}function n(a){return o(a)?a:[a]}function o(a){return Array.isArray(a)}function p(a){return a}Object.prototype.toString,a.s(["asArray",()=>n,"freeze",()=>m,"getLast",()=>l,"isBigInt",()=>h,"isBoolean",()=>e,"isBuffer",()=>i,"isDate",()=>g,"isFunction",()=>j,"isNull",()=>f,"isNumber",()=>d,"isObject",()=>k,"isReadonlyArray",()=>o,"isString",()=>c,"isUndefined",()=>b,"noop",()=>p])},688966,929890,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"FromNode"===a.kind,create:a=>(0,b.freeze)({kind:"FromNode",froms:(0,b.freeze)(a)}),cloneWithFroms:(a,c)=>(0,b.freeze)({...a,froms:(0,b.freeze)([...a.froms,...c])})});a.s(["FromNode",0,c],688966);let d=(0,b.freeze)({is:a=>"GroupByNode"===a.kind,create:a=>(0,b.freeze)({kind:"GroupByNode",items:(0,b.freeze)(a)}),cloneWithItems:(a,c)=>(0,b.freeze)({...a,items:(0,b.freeze)([...a.items,...c])})});a.s(["GroupByNode",0,d],929890)},651861,25283,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"AndNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"AndNode",left:a,right:c})});a.s(["AndNode",0,c],651861);let d=(0,b.freeze)({is:a=>"OrNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"OrNode",left:a,right:c})});a.s(["OrNode",0,d],25283)},480243,a=>{"use strict";var b=a.i(852460),c=a.i(651861),d=a.i(25283);let e=(0,b.freeze)({is:a=>"HavingNode"===a.kind,create:a=>(0,b.freeze)({kind:"HavingNode",having:a}),cloneWithOperation:(a,e,f)=>(0,b.freeze)({...a,having:"And"===e?c.AndNode.create(a.having,f):d.OrNode.create(a.having,f)})});a.s(["HavingNode",0,e])},819910,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"InsertQueryNode"===a.kind,create:(a,c,d)=>(0,b.freeze)({kind:"InsertQueryNode",into:a,...c&&{with:c},replace:d}),createWithoutInto:()=>(0,b.freeze)({kind:"InsertQueryNode"}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c})});a.s(["InsertQueryNode",0,c])},934730,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"ListNode"===a.kind,create:a=>(0,b.freeze)({kind:"ListNode",items:(0,b.freeze)(a)})});a.s(["ListNode",0,c])},912475,648565,927466,900867,537186,a=>{"use strict";var b=a.i(852460),c=a.i(688966),d=a.i(934730);let e=(0,b.freeze)({is:a=>"UpdateQueryNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"UpdateQueryNode",table:1===a.length?a[0]:d.ListNode.create(a),...c&&{with:c}}),createWithoutTable:()=>(0,b.freeze)({kind:"UpdateQueryNode"}),cloneWithFromItems:(a,d)=>(0,b.freeze)({...a,from:a.from?c.FromNode.cloneWithFroms(a.from,d):c.FromNode.create(d)}),cloneWithUpdates:(a,c)=>(0,b.freeze)({...a,updates:a.updates?(0,b.freeze)([...a.updates,...c]):c}),cloneWithLimit:(a,c)=>(0,b.freeze)({...a,limit:c})});a.s(["UpdateQueryNode",0,e],912475),a.s(["DeleteQueryNode",()=>h],648565);let f=(0,b.freeze)({is:a=>"UsingNode"===a.kind,create:a=>(0,b.freeze)({kind:"UsingNode",tables:(0,b.freeze)(a)}),cloneWithTables:(a,c)=>(0,b.freeze)({...a,tables:(0,b.freeze)([...a.tables,...c])})});var g=a.i(639399);let h=(0,b.freeze)({is:a=>"DeleteQueryNode"===a.kind,create:(a,d)=>(0,b.freeze)({kind:"DeleteQueryNode",from:c.FromNode.create(a),...d&&{with:d}}),cloneWithOrderByItems:(a,b)=>g.QueryNode.cloneWithOrderByItems(a,b),cloneWithoutOrderBy:a=>g.QueryNode.cloneWithoutOrderBy(a),cloneWithLimit:(a,c)=>(0,b.freeze)({...a,limit:c}),cloneWithoutLimit:a=>(0,b.freeze)({...a,limit:void 0}),cloneWithUsing:(a,c)=>(0,b.freeze)({...a,using:void 0!==a.using?f.cloneWithTables(a.using,c):f.create(c)})});var i=a.i(651861),j=a.i(25283);let k=(0,b.freeze)({is:a=>"WhereNode"===a.kind,create:a=>(0,b.freeze)({kind:"WhereNode",where:a}),cloneWithOperation:(a,c,d)=>(0,b.freeze)({...a,where:"And"===c?i.AndNode.create(a.where,d):j.OrNode.create(a.where,d)})});a.s(["WhereNode",0,k],927466);let l=(0,b.freeze)({is:a=>"ReturningNode"===a.kind,create:a=>(0,b.freeze)({kind:"ReturningNode",selections:(0,b.freeze)(a)}),cloneWithSelections:(a,c)=>(0,b.freeze)({...a,selections:a.selections?(0,b.freeze)([...a.selections,...c]):(0,b.freeze)(c)})});a.s(["ReturningNode",0,l],900867);let m=(0,b.freeze)({is:a=>"ExplainNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"ExplainNode",format:a,options:c})});a.s(["ExplainNode",0,m],537186)},899297,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"WhenNode"===a.kind,create:a=>(0,b.freeze)({kind:"WhenNode",condition:a}),cloneWithResult:(a,c)=>(0,b.freeze)({...a,result:c})});a.s(["WhenNode",0,c])},737193,48323,a=>{"use strict";var b=a.i(852460),c=a.i(899297);let d=(0,b.freeze)({is:a=>"MergeQueryNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"MergeQueryNode",into:a,...c&&{with:c}}),cloneWithUsing:(a,c)=>(0,b.freeze)({...a,using:c}),cloneWithWhen:(a,c)=>(0,b.freeze)({...a,whens:a.whens?(0,b.freeze)([...a.whens,c]):(0,b.freeze)([c])}),cloneWithThen:(a,d)=>(0,b.freeze)({...a,whens:a.whens?(0,b.freeze)([...a.whens.slice(0,-1),c.WhenNode.cloneWithResult(a.whens[a.whens.length-1],d)]):void 0})});a.s(["MergeQueryNode",0,d],737193);let e=(0,b.freeze)({is:a=>"OutputNode"===a.kind,create:a=>(0,b.freeze)({kind:"OutputNode",selections:(0,b.freeze)(a)}),cloneWithSelections:(a,c)=>(0,b.freeze)({...a,selections:a.selections?(0,b.freeze)([...a.selections,...c]):(0,b.freeze)(c)})});a.s(["OutputNode",0,e],48323)},78606,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"OrderByNode"===a.kind,create:a=>(0,b.freeze)({kind:"OrderByNode",items:(0,b.freeze)([...a])}),cloneWithItems:(a,c)=>(0,b.freeze)({...a,items:(0,b.freeze)([...a.items,...c])})});a.s(["OrderByNode",0,c])},541595,639399,a=>{"use strict";a.s(["SelectQueryNode",()=>p],541595);var b=a.i(852460),c=a.i(688966),d=a.i(929890),e=a.i(480243);a.s(["QueryNode",()=>o],639399);var f=a.i(819910),g=a.i(912475),h=a.i(648565),i=a.i(927466),j=a.i(900867),k=a.i(537186),l=a.i(737193),m=a.i(48323),n=a.i(78606);let o=(0,b.freeze)({is:a=>p.is(a)||f.InsertQueryNode.is(a)||g.UpdateQueryNode.is(a)||h.DeleteQueryNode.is(a)||l.MergeQueryNode.is(a),cloneWithEndModifier:(a,c)=>(0,b.freeze)({...a,endModifiers:a.endModifiers?(0,b.freeze)([...a.endModifiers,c]):(0,b.freeze)([c])}),cloneWithWhere:(a,c)=>(0,b.freeze)({...a,where:a.where?i.WhereNode.cloneWithOperation(a.where,"And",c):i.WhereNode.create(c)}),cloneWithJoin:(a,c)=>(0,b.freeze)({...a,joins:a.joins?(0,b.freeze)([...a.joins,c]):(0,b.freeze)([c])}),cloneWithReturning:(a,c)=>(0,b.freeze)({...a,returning:a.returning?j.ReturningNode.cloneWithSelections(a.returning,c):j.ReturningNode.create(c)}),cloneWithoutReturning:a=>(0,b.freeze)({...a,returning:void 0}),cloneWithoutWhere:a=>(0,b.freeze)({...a,where:void 0}),cloneWithExplain:(a,c,d)=>(0,b.freeze)({...a,explain:k.ExplainNode.create(c,d?.toOperationNode())}),cloneWithTop:(a,c)=>(0,b.freeze)({...a,top:c}),cloneWithOutput:(a,c)=>(0,b.freeze)({...a,output:a.output?m.OutputNode.cloneWithSelections(a.output,c):m.OutputNode.create(c)}),cloneWithOrderByItems:(a,c)=>(0,b.freeze)({...a,orderBy:a.orderBy?n.OrderByNode.cloneWithItems(a.orderBy,c):n.OrderByNode.create(c)}),cloneWithoutOrderBy:a=>(0,b.freeze)({...a,orderBy:void 0})}),p=(0,b.freeze)({is:a=>"SelectQueryNode"===a.kind,create:a=>(0,b.freeze)({kind:"SelectQueryNode",...a&&{with:a}}),createFrom:(a,d)=>(0,b.freeze)({kind:"SelectQueryNode",from:c.FromNode.create(a),...d&&{with:d}}),cloneWithSelections:(a,c)=>(0,b.freeze)({...a,selections:a.selections?(0,b.freeze)([...a.selections,...c]):(0,b.freeze)(c)}),cloneWithDistinctOn:(a,c)=>(0,b.freeze)({...a,distinctOn:a.distinctOn?(0,b.freeze)([...a.distinctOn,...c]):(0,b.freeze)(c)}),cloneWithFrontModifier:(a,c)=>(0,b.freeze)({...a,frontModifiers:a.frontModifiers?(0,b.freeze)([...a.frontModifiers,c]):(0,b.freeze)([c])}),cloneWithOrderByItems:(a,b)=>o.cloneWithOrderByItems(a,b),cloneWithGroupByItems:(a,c)=>(0,b.freeze)({...a,groupBy:a.groupBy?d.GroupByNode.cloneWithItems(a.groupBy,c):d.GroupByNode.create(c)}),cloneWithLimit:(a,c)=>(0,b.freeze)({...a,limit:c}),cloneWithOffset:(a,c)=>(0,b.freeze)({...a,offset:c}),cloneWithFetch:(a,c)=>(0,b.freeze)({...a,fetch:c}),cloneWithHaving:(a,c)=>(0,b.freeze)({...a,having:a.having?e.HavingNode.cloneWithOperation(a.having,"And",c):e.HavingNode.create(c)}),cloneWithSetOperations:(a,c)=>(0,b.freeze)({...a,setOperations:a.setOperations?(0,b.freeze)([...a.setOperations,...c]):(0,b.freeze)([...c])}),cloneWithoutSelections:a=>(0,b.freeze)({...a,selections:[]}),cloneWithoutLimit:a=>(0,b.freeze)({...a,limit:void 0}),cloneWithoutOffset:a=>(0,b.freeze)({...a,offset:void 0}),cloneWithoutOrderBy:a=>o.cloneWithoutOrderBy(a),cloneWithoutGroupBy:a=>(0,b.freeze)({...a,groupBy:void 0})})},620860,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"IdentifierNode"===a.kind,create:a=>(0,b.freeze)({kind:"IdentifierNode",name:a})});a.s(["IdentifierNode",0,c])},204781,293807,452779,613344,919945,a=>{"use strict";var b=a.i(852460);let c=(0,b.freeze)({is:a=>"RawNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"RawNode",sqlFragments:(0,b.freeze)(a),parameters:(0,b.freeze)(c)}),createWithSql:a=>c.create([a],[]),createWithChild:a=>c.create(["",""],[a]),createWithChildren:a=>c.create(Array(a.length+1).fill(""),a)});a.s(["RawNode",0,c],293807);let d=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function e(a){let b="";for(let c=0;c<a;++c)b+=d[~~(Math.random()*d.length)];return b}function f(){return new g}a.s(["randomString",()=>e],452779);class g{#a;get queryId(){return void 0===this.#a&&(this.#a=e(8)),this.#a}}a.s(["createQueryId",()=>f],613344);let h=(0,b.freeze)({raw:(a,d=[])=>(0,b.freeze)({sql:a,query:c.createWithSql(a),parameters:(0,b.freeze)(d),queryId:f()})});a.s(["CompiledQuery",0,h],204781);let i=(0,b.freeze)({is:a=>"CreateTableNode"===a.kind,create:a=>(0,b.freeze)({kind:"CreateTableNode",table:a,columns:(0,b.freeze)([])}),cloneWithColumn:(a,c)=>(0,b.freeze)({...a,columns:(0,b.freeze)([...a.columns,c])}),cloneWithConstraint:(a,c)=>(0,b.freeze)({...a,constraints:a.constraints?(0,b.freeze)([...a.constraints,c]):(0,b.freeze)([c])}),cloneWithFrontModifier:(a,c)=>(0,b.freeze)({...a,frontModifiers:a.frontModifiers?(0,b.freeze)([...a.frontModifiers,c]):(0,b.freeze)([c])}),cloneWithEndModifier:(a,c)=>(0,b.freeze)({...a,endModifiers:a.endModifiers?(0,b.freeze)([...a.endModifiers,c]):(0,b.freeze)([c])}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c})});a.s(["CreateTableNode",0,i,"ON_COMMIT_ACTIONS",0,["preserve rows","delete rows","drop"]],919945)},477973,713123,477804,a=>{"use strict";var b=a.i(852460);class c{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#b=(0,b.freeze)({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)});visitNode=a=>{this.nodeStack.push(a),this.#b[a.kind](a),this.nodeStack.pop()}}a.s(["OperationNodeVisitor",()=>c],477973);let d=["->","->>"],e=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from","+","-","*","/","%","^","&","|","#","<<",">>","&&","||",...d,"not","-","exists","not exists","between","between symmetric"],f=(0,b.freeze)({is:a=>"OperatorNode"===a.kind,create:a=>(0,b.freeze)({kind:"OperatorNode",operator:a})});function g(a){return(0,b.isString)(a)&&d.includes(a)}a.s(["OPERATORS",0,e,"OperatorNode",0,f,"isJSONOperator",()=>g],713123);let h=(0,b.freeze)({is:a=>"ParensNode"===a.kind,create:a=>(0,b.freeze)({kind:"ParensNode",node:a})});a.s(["ParensNode",0,h],477804)},112741,908896,783005,a=>{"use strict";var b=a.i(852460),c=a.i(620860);let d=(0,b.freeze)({is:a=>"SchemableIdentifierNode"===a.kind,create:a=>(0,b.freeze)({kind:"SchemableIdentifierNode",identifier:c.IdentifierNode.create(a)}),createWithSchema:(a,d)=>(0,b.freeze)({kind:"SchemableIdentifierNode",schema:c.IdentifierNode.create(a),identifier:c.IdentifierNode.create(d)})});a.s(["SchemableIdentifierNode",0,d],908896);let e=(0,b.freeze)({is:a=>"CreateViewNode"===a.kind,create:a=>(0,b.freeze)({kind:"CreateViewNode",name:d.create(a)}),cloneWith:(a,c)=>(0,b.freeze)({...a,...c})});a.s(["CreateViewNode",0,e],112741);let f=(0,b.freeze)({is:a=>"SetOperationNode"===a.kind,create:(a,c,d)=>(0,b.freeze)({kind:"SetOperationNode",operator:a,expression:c,all:d})});a.s(["SetOperationNode",0,f],783005)},776452,328283,995401,524054,a=>{"use strict";var b=a.i(919945),c=a.i(819910),d=a.i(477973),e=a.i(713123),f=a.i(477804),g=a.i(293807),h=a.i(852460),i=a.i(112741),j=a.i(783005),k=a.i(899297);let l=new Set;function m(a){l.has(a)||(l.add(a),console.log(a))}a.s(["logOnce",()=>m],328283);let n=/'/g;class o extends d.OperationNodeVisitor{#c="";#d=[];get numParameters(){return this.#d.length}compileQuery(a,b){return this.#c="",this.#d=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(a),(0,h.freeze)({query:a,queryId:b,sql:this.getSql(),parameters:[...this.#d]})}getSql(){return this.#c}visitSelectQuery(a){let d=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!c.InsertQueryNode.is(this.parentNode)&&!b.CreateTableNode.is(this.parentNode)&&!i.CreateViewNode.is(this.parentNode)&&!j.SetOperationNode.is(this.parentNode);void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),d&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append("select"),a.distinctOn&&(this.append(" "),this.compileDistinctOn(a.distinctOn)),a.frontModifiers?.length&&(this.append(" "),this.compileList(a.frontModifiers," ")),a.top&&(this.append(" "),this.visitNode(a.top)),a.selections&&(this.append(" "),this.compileList(a.selections)),a.from&&(this.append(" "),this.visitNode(a.from)),a.joins&&(this.append(" "),this.compileList(a.joins," ")),a.where&&(this.append(" "),this.visitNode(a.where)),a.groupBy&&(this.append(" "),this.visitNode(a.groupBy)),a.having&&(this.append(" "),this.visitNode(a.having)),a.setOperations&&(this.append(" "),this.compileList(a.setOperations," ")),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),a.limit&&(this.append(" "),this.visitNode(a.limit)),a.offset&&(this.append(" "),this.visitNode(a.offset)),a.fetch&&(this.append(" "),this.visitNode(a.fetch)),a.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...a.endModifiers])," ")),d&&this.append(")")}visitFrom(a){this.append("from "),this.compileList(a.froms)}visitSelection(a){this.visitNode(a.selection)}visitColumn(a){this.visitNode(a.column)}compileDistinctOn(a){this.append("distinct on ("),this.compileList(a),this.append(")")}compileList(a,b=", "){let c=a.length-1;for(let d=0;d<=c;d++)this.visitNode(a[d]),d<c&&this.append(b)}visitWhere(a){this.append("where "),this.visitNode(a.where)}visitHaving(a){this.append("having "),this.visitNode(a.having)}visitInsertQuery(a){let b=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!g.RawNode.is(this.parentNode)&&!k.WhenNode.is(this.parentNode);void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),b&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append(a.replace?"replace":"insert"),a.ignore&&(m("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore")),a.orAction&&(this.append(" "),this.visitNode(a.orAction)),a.top&&(this.append(" "),this.visitNode(a.top)),a.into&&(this.append(" into "),this.visitNode(a.into)),a.columns&&(this.append(" ("),this.compileList(a.columns),this.append(")")),a.output&&(this.append(" "),this.visitNode(a.output)),a.values&&(this.append(" "),this.visitNode(a.values)),a.defaultValues&&(this.append(" "),this.append("default values")),a.onConflict&&(this.append(" "),this.visitNode(a.onConflict)),a.onDuplicateKey&&(this.append(" "),this.visitNode(a.onDuplicateKey)),a.returning&&(this.append(" "),this.visitNode(a.returning)),b&&this.append(")"),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitValues(a){this.append("values "),this.compileList(a.values)}visitDeleteQuery(a){let b=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!g.RawNode.is(this.parentNode);void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),b&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append("delete "),a.top&&(this.visitNode(a.top),this.append(" ")),this.visitNode(a.from),a.output&&(this.append(" "),this.visitNode(a.output)),a.using&&(this.append(" "),this.visitNode(a.using)),a.joins&&(this.append(" "),this.compileList(a.joins," ")),a.where&&(this.append(" "),this.visitNode(a.where)),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),a.limit&&(this.append(" "),this.visitNode(a.limit)),a.returning&&(this.append(" "),this.visitNode(a.returning)),b&&this.append(")"),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitReturning(a){this.append("returning "),this.compileList(a.selections)}visitAlias(a){this.visitNode(a.node),this.append(" as "),this.visitNode(a.alias)}visitReference(a){a.table&&(this.visitNode(a.table),this.append(".")),this.visitNode(a.column)}visitSelectAll(a){this.append("*")}visitIdentifier(a){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(a),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(a){if(!(0,h.isString)(a.name))throw Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(a.name))}visitAnd(a){this.visitNode(a.left),this.append(" and "),this.visitNode(a.right)}visitOr(a){this.visitNode(a.left),this.append(" or "),this.visitNode(a.right)}visitValue(a){a.immediate?this.appendImmediateValue(a.value):this.appendValue(a.value)}visitValueList(a){this.append("("),this.compileList(a.values),this.append(")")}visitTuple(a){this.append("("),this.compileList(a.values),this.append(")")}visitPrimitiveValueList(a){this.append("(");let{values:b}=a;for(let a=0;a<b.length;++a)this.appendValue(b[a]),a!==b.length-1&&this.append(", ");this.append(")")}visitParens(a){this.append("("),this.visitNode(a.node),this.append(")")}visitJoin(a){this.append(r[a.joinType]),this.append(" "),this.visitNode(a.table),a.on&&(this.append(" "),this.visitNode(a.on))}visitOn(a){this.append("on "),this.visitNode(a.on)}visitRaw(a){let{sqlFragments:b,parameters:c}=a;for(let a=0;a<b.length;++a)this.append(b[a]),c.length>a&&this.visitNode(c[a])}visitOperator(a){this.append(a.operator)}visitTable(a){this.visitNode(a.table)}visitSchemableIdentifier(a){a.schema&&(this.visitNode(a.schema),this.append(".")),this.visitNode(a.identifier)}visitCreateTable(a){this.append("create "),a.frontModifiers&&a.frontModifiers.length>0&&(this.compileList(a.frontModifiers," "),this.append(" ")),a.temporary&&this.append("temporary "),this.append("table "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.table),a.selectQuery?(this.append(" as "),this.visitNode(a.selectQuery)):(this.append(" ("),this.compileList([...a.columns,...a.constraints??[]]),this.append(")"),a.onCommit&&(this.append(" on commit "),this.append(a.onCommit)),a.endModifiers&&a.endModifiers.length>0&&(this.append(" "),this.compileList(a.endModifiers," ")))}visitColumnDefinition(a){a.ifNotExists&&this.append("if not exists "),this.visitNode(a.column),this.append(" "),this.visitNode(a.dataType),a.unsigned&&this.append(" unsigned"),a.frontModifiers&&a.frontModifiers.length>0&&(this.append(" "),this.compileList(a.frontModifiers," ")),a.generated&&(this.append(" "),this.visitNode(a.generated)),a.identity&&this.append(" identity"),a.defaultTo&&(this.append(" "),this.visitNode(a.defaultTo)),a.notNull&&this.append(" not null"),a.unique&&this.append(" unique"),a.nullsNotDistinct&&this.append(" nulls not distinct"),a.primaryKey&&this.append(" primary key"),a.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),a.references&&(this.append(" "),this.visitNode(a.references)),a.check&&(this.append(" "),this.visitNode(a.check)),a.endModifiers&&a.endModifiers.length>0&&(this.append(" "),this.compileList(a.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(a){this.append("references "),this.visitNode(a.table),this.append(" ("),this.compileList(a.columns),this.append(")"),a.onDelete&&(this.append(" on delete "),this.append(a.onDelete)),a.onUpdate&&(this.append(" on update "),this.append(a.onUpdate))}visitDropTable(a){this.append("drop table "),a.ifExists&&this.append("if exists "),this.visitNode(a.table),a.cascade&&this.append(" cascade")}visitDataType(a){this.append(a.dataType)}visitOrderBy(a){this.append("order by "),this.compileList(a.items)}visitOrderByItem(a){this.visitNode(a.orderBy),a.collation&&(this.append(" "),this.visitNode(a.collation)),a.direction&&(this.append(" "),this.visitNode(a.direction)),a.nulls&&(this.append(" nulls "),this.append(a.nulls))}visitGroupBy(a){this.append("group by "),this.compileList(a.items)}visitGroupByItem(a){this.visitNode(a.groupBy)}visitUpdateQuery(a){let b=void 0!==this.parentNode&&!f.ParensNode.is(this.parentNode)&&!g.RawNode.is(this.parentNode)&&!k.WhenNode.is(this.parentNode);if(void 0===this.parentNode&&a.explain&&(this.visitNode(a.explain),this.append(" ")),b&&this.append("("),a.with&&(this.visitNode(a.with),this.append(" ")),this.append("update "),a.top&&(this.visitNode(a.top),this.append(" ")),a.table&&(this.visitNode(a.table),this.append(" ")),this.append("set "),a.updates&&this.compileList(a.updates),a.output&&(this.append(" "),this.visitNode(a.output)),a.from&&(this.append(" "),this.visitNode(a.from)),a.joins){if(!a.from)throw Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(a.joins," ")}a.where&&(this.append(" "),this.visitNode(a.where)),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),a.limit&&(this.append(" "),this.visitNode(a.limit)),a.returning&&(this.append(" "),this.visitNode(a.returning)),b&&this.append(")"),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitColumnUpdate(a){this.visitNode(a.column),this.append(" = "),this.visitNode(a.value)}visitLimit(a){this.append("limit "),this.visitNode(a.limit)}visitOffset(a){this.append("offset "),this.visitNode(a.offset)}visitOnConflict(a){this.append("on conflict"),a.columns?(this.append(" ("),this.compileList(a.columns),this.append(")")):a.constraint?(this.append(" on constraint "),this.visitNode(a.constraint)):a.indexExpression&&(this.append(" ("),this.visitNode(a.indexExpression),this.append(")")),a.indexWhere&&(this.append(" "),this.visitNode(a.indexWhere)),!0===a.doNothing?this.append(" do nothing"):a.updates&&(this.append(" do update set "),this.compileList(a.updates),a.updateWhere&&(this.append(" "),this.visitNode(a.updateWhere)))}visitOnDuplicateKey(a){this.append("on duplicate key update "),this.compileList(a.updates)}visitCreateIndex(a){this.append("create "),a.unique&&this.append("unique "),this.append("index "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.name),a.table&&(this.append(" on "),this.visitNode(a.table)),a.using&&(this.append(" using "),this.visitNode(a.using)),a.columns&&(this.append(" ("),this.compileList(a.columns),this.append(")")),a.nullsNotDistinct&&this.append(" nulls not distinct"),a.where&&(this.append(" "),this.visitNode(a.where))}visitDropIndex(a){this.append("drop index "),a.ifExists&&this.append("if exists "),this.visitNode(a.name),a.table&&(this.append(" on "),this.visitNode(a.table)),a.cascade&&this.append(" cascade")}visitCreateSchema(a){this.append("create schema "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.schema)}visitDropSchema(a){this.append("drop schema "),a.ifExists&&this.append("if exists "),this.visitNode(a.schema),a.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("primary key ("),this.compileList(a.columns),this.append(")"),this.buildDeferrable(a)}buildDeferrable(a){void 0!==a.deferrable&&(a.deferrable?this.append(" deferrable"):this.append(" not deferrable")),void 0!==a.initiallyDeferred&&(a.initiallyDeferred?this.append(" initially deferred"):this.append(" initially immediate"))}visitUniqueConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("unique"),a.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(a.columns),this.append(")"),this.buildDeferrable(a)}visitCheckConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("check ("),this.visitNode(a.expression),this.append(")")}visitForeignKeyConstraint(a){a.name&&(this.append("constraint "),this.visitNode(a.name),this.append(" ")),this.append("foreign key ("),this.compileList(a.columns),this.append(") "),this.visitNode(a.references),a.onDelete&&(this.append(" on delete "),this.append(a.onDelete)),a.onUpdate&&(this.append(" on update "),this.append(a.onUpdate)),this.buildDeferrable(a)}visitList(a){this.compileList(a.items)}visitWith(a){this.append("with "),a.recursive&&this.append("recursive "),this.compileList(a.expressions)}visitCommonTableExpression(a){this.visitNode(a.name),this.append(" as "),(0,h.isBoolean)(a.materialized)&&(a.materialized||this.append("not "),this.append("materialized ")),this.visitNode(a.expression)}visitCommonTableExpressionName(a){this.visitNode(a.table),a.columns&&(this.append("("),this.compileList(a.columns),this.append(")"))}visitAlterTable(a){this.append("alter table "),this.visitNode(a.table),this.append(" "),a.renameTo&&(this.append("rename to "),this.visitNode(a.renameTo)),a.setSchema&&(this.append("set schema "),this.visitNode(a.setSchema)),a.addConstraint&&this.visitNode(a.addConstraint),a.dropConstraint&&this.visitNode(a.dropConstraint),a.renameConstraint&&this.visitNode(a.renameConstraint),a.columnAlterations&&this.compileColumnAlterations(a.columnAlterations),a.addIndex&&this.visitNode(a.addIndex),a.dropIndex&&this.visitNode(a.dropIndex)}visitAddColumn(a){this.append("add column "),this.visitNode(a.column)}visitRenameColumn(a){this.append("rename column "),this.visitNode(a.column),this.append(" to "),this.visitNode(a.renameTo)}visitDropColumn(a){this.append("drop column "),this.visitNode(a.column)}visitAlterColumn(a){this.append("alter column "),this.visitNode(a.column),this.append(" "),a.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(a.dataType),a.dataTypeExpression&&(this.append("using "),this.visitNode(a.dataTypeExpression))),a.setDefault&&(this.append("set default "),this.visitNode(a.setDefault)),a.dropDefault&&this.append("drop default"),a.setNotNull&&this.append("set not null"),a.dropNotNull&&this.append("drop not null")}visitModifyColumn(a){this.append("modify column "),this.visitNode(a.column)}visitAddConstraint(a){this.append("add "),this.visitNode(a.constraint)}visitDropConstraint(a){this.append("drop constraint "),a.ifExists&&this.append("if exists "),this.visitNode(a.constraintName),"cascade"===a.modifier?this.append(" cascade"):"restrict"===a.modifier&&this.append(" restrict")}visitRenameConstraint(a){this.append("rename constraint "),this.visitNode(a.oldName),this.append(" to "),this.visitNode(a.newName)}visitSetOperation(a){this.append(a.operator),this.append(" "),a.all&&this.append("all "),this.visitNode(a.expression)}visitCreateView(a){this.append("create "),a.orReplace&&this.append("or replace "),a.materialized&&this.append("materialized "),a.temporary&&this.append("temporary "),this.append("view "),a.ifNotExists&&this.append("if not exists "),this.visitNode(a.name),this.append(" "),a.columns&&(this.append("("),this.compileList(a.columns),this.append(") ")),a.as&&(this.append("as "),this.visitNode(a.as))}visitRefreshMaterializedView(a){this.append("refresh materialized view "),a.concurrently&&this.append("concurrently "),this.visitNode(a.name),a.withNoData?this.append(" with no data"):this.append(" with data")}visitDropView(a){this.append("drop "),a.materialized&&this.append("materialized "),this.append("view "),a.ifExists&&this.append("if exists "),this.visitNode(a.name),a.cascade&&this.append(" cascade")}visitGenerated(a){this.append("generated "),a.always&&this.append("always "),a.byDefault&&this.append("by default "),this.append("as "),a.identity&&this.append("identity"),a.expression&&(this.append("("),this.visitNode(a.expression),this.append(")")),a.stored&&this.append(" stored")}visitDefaultValue(a){this.append("default "),this.visitNode(a.defaultValue)}visitSelectModifier(a){a.rawModifier?this.visitNode(a.rawModifier):this.append(p[a.modifier]),a.of&&(this.append(" of "),this.compileList(a.of,", "))}visitCreateType(a){this.append("create type "),this.visitNode(a.name),a.enum&&(this.append(" as enum "),this.visitNode(a.enum))}visitDropType(a){this.append("drop type "),a.ifExists&&this.append("if exists "),this.visitNode(a.name)}visitExplain(a){this.append("explain"),(a.options||a.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),a.options&&(this.visitNode(a.options),a.format&&this.append(this.getExplainOptionsDelimiter())),a.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(a.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(a){this.append("default")}visitAggregateFunction(a){this.append(a.func),this.append("("),a.distinct&&this.append("distinct "),this.compileList(a.aggregated),a.orderBy&&(this.append(" "),this.visitNode(a.orderBy)),this.append(")"),a.withinGroup&&(this.append(" within group ("),this.visitNode(a.withinGroup),this.append(")")),a.filter&&(this.append(" filter("),this.visitNode(a.filter),this.append(")")),a.over&&(this.append(" "),this.visitNode(a.over))}visitOver(a){this.append("over("),a.partitionBy&&(this.visitNode(a.partitionBy),a.orderBy&&this.append(" ")),a.orderBy&&this.visitNode(a.orderBy),this.append(")")}visitPartitionBy(a){this.append("partition by "),this.compileList(a.items)}visitPartitionByItem(a){this.visitNode(a.partitionBy)}visitBinaryOperation(a){this.visitNode(a.leftOperand),this.append(" "),this.visitNode(a.operator),this.append(" "),this.visitNode(a.rightOperand)}visitUnaryOperation(a){this.visitNode(a.operator),this.isMinusOperator(a.operator)||this.append(" "),this.visitNode(a.operand)}isMinusOperator(a){return e.OperatorNode.is(a)&&"-"===a.operator}visitUsing(a){this.append("using "),this.compileList(a.tables)}visitFunction(a){this.append(a.func),this.append("("),this.compileList(a.arguments),this.append(")")}visitCase(a){this.append("case"),a.value&&(this.append(" "),this.visitNode(a.value)),a.when&&(this.append(" "),this.compileList(a.when," ")),a.else&&(this.append(" else "),this.visitNode(a.else)),this.append(" end"),a.isStatement&&this.append(" case")}visitWhen(a){this.append("when "),this.visitNode(a.condition),a.result&&(this.append(" then "),this.visitNode(a.result))}visitJSONReference(a){this.visitNode(a.reference),this.visitNode(a.traversal)}visitJSONPath(a){for(let b of(a.inOperator&&this.visitNode(a.inOperator),this.append("'$"),a.pathLegs))this.visitNode(b);this.append("'")}visitJSONPathLeg(a){let b="ArrayLocation"===a.type;this.append(b?"[":"."),this.append(String(a.value)),b&&this.append("]")}visitJSONOperatorChain(a){for(let b=0,c=a.values.length;b<c;b++)b===c-1?this.visitNode(a.operator):this.append("->"),this.visitNode(a.values[b])}visitMergeQuery(a){a.with&&(this.visitNode(a.with),this.append(" ")),this.append("merge "),a.top&&(this.visitNode(a.top),this.append(" ")),this.append("into "),this.visitNode(a.into),a.using&&(this.append(" "),this.visitNode(a.using)),a.whens&&(this.append(" "),this.compileList(a.whens," ")),a.returning&&(this.append(" "),this.visitNode(a.returning)),a.output&&(this.append(" "),this.visitNode(a.output)),a.endModifiers?.length&&(this.append(" "),this.compileList(a.endModifiers," "))}visitMatched(a){a.not&&this.append("not "),this.append("matched"),a.bySource&&this.append(" by source")}visitAddIndex(a){this.append("add "),a.unique&&this.append("unique "),this.append("index "),this.visitNode(a.name),a.columns&&(this.append(" ("),this.compileList(a.columns),this.append(")")),a.using&&(this.append(" using "),this.visitNode(a.using))}visitCast(a){this.append("cast("),this.visitNode(a.expression),this.append(" as "),this.visitNode(a.dataType),this.append(")")}visitFetch(a){this.append("fetch next "),this.visitNode(a.rowCount),this.append(` rows ${a.modifier}`)}visitOutput(a){this.append("output "),this.compileList(a.selections)}visitTop(a){this.append(`top(${a.expression})`),a.modifiers&&this.append(` ${a.modifiers}`)}visitOrAction(a){this.append(a.action)}visitCollate(a){this.append("collate "),this.visitNode(a.collation)}append(a){this.#c+=a}appendValue(a){this.addParameter(a),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(a){let b=this.getLeftIdentifierWrapper(),c=this.getRightIdentifierWrapper(),d="";for(let e of a)d+=e,e===b?d+=b:e===c&&(d+=c);return d}sanitizeStringLiteral(a){return a.replace(n,"''")}addParameter(a){this.#d.push(a)}appendImmediateValue(a){if((0,h.isString)(a))this.appendStringLiteral(a);else if((0,h.isNumber)(a)||(0,h.isBoolean)(a)||(0,h.isBigInt)(a))this.append(a.toString());else if((0,h.isNull)(a))this.append("null");else if((0,h.isDate)(a))this.appendImmediateValue(a.toISOString());else throw Error(`invalid immediate value ${a}`)}appendStringLiteral(a){this.append("'"),this.append(this.sanitizeStringLiteral(a)),this.append("'")}sortSelectModifiers(a){return a.sort((a,b)=>a.modifier&&b.modifier?q[a.modifier]-q[b.modifier]:1),(0,h.freeze)(a)}compileColumnAlterations(a){this.compileList(a)}announcesNewColumnDataType(){return!0}}let p=(0,h.freeze)({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),q=(0,h.freeze)({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),r=(0,h.freeze)({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"});a.s(["DefaultQueryCompiler",()=>o],776452);class s{transformQuery(a){return a.node}async transformResult(a){return a.result}}a.s(["NoopPlugin",()=>s],995401);let t=(0,h.freeze)({is:a=>"AliasNode"===a.kind,create:(a,b)=>(0,h.freeze)({kind:"AliasNode",node:a,alias:b})});a.s(["AliasNode",0,t],524054)},767319,a=>{"use strict";var b=a.i(852460),c=a.i(651861),d=a.i(25283);let e=(0,b.freeze)({is:a=>"OnNode"===a.kind,create:a=>(0,b.freeze)({kind:"OnNode",on:a}),cloneWithOperation:(a,e,f)=>(0,b.freeze)({...a,on:"And"===e?c.AndNode.create(a.on,f):d.OrNode.create(a.on,f)})}),f=(0,b.freeze)({is:a=>"JoinNode"===a.kind,create:(a,c)=>(0,b.freeze)({kind:"JoinNode",joinType:a,table:c,on:void 0}),createWithOn:(a,c,d)=>(0,b.freeze)({kind:"JoinNode",joinType:a,table:c,on:e.create(d)}),cloneWithOn:(a,c)=>(0,b.freeze)({...a,on:a.on?e.cloneWithOperation(a.on,"And",c):e.create(c)})});a.s(["JoinNode",0,f],767319)},154132,197365,506770,185545,158758,620033,340672,198722,962088,200635,167653,544447,806285,372590,209638,245228,a=>{"use strict";a.i(995401);var b=a.i(524054),c=a.i(620860),d=a.i(767319),e=a.i(934730),f=a.i(852460);class g{nodeStack=[];#e=(0,f.freeze)({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)});transformNode(a,b){if(!a)return a;this.nodeStack.push(a);let c=this.transformNodeImpl(a,b);return this.nodeStack.pop(),(0,f.freeze)(c)}transformNodeImpl(a,b){return this.#e[a.kind](a,b)}transformNodeList(a,b){return a?(0,f.freeze)(a.map(a=>this.transformNode(a,b))):a}transformSelectQuery(a,b){return{kind:"SelectQueryNode",from:this.transformNode(a.from,b),selections:this.transformNodeList(a.selections,b),distinctOn:this.transformNodeList(a.distinctOn,b),joins:this.transformNodeList(a.joins,b),groupBy:this.transformNode(a.groupBy,b),orderBy:this.transformNode(a.orderBy,b),where:this.transformNode(a.where,b),frontModifiers:this.transformNodeList(a.frontModifiers,b),endModifiers:this.transformNodeList(a.endModifiers,b),limit:this.transformNode(a.limit,b),offset:this.transformNode(a.offset,b),with:this.transformNode(a.with,b),having:this.transformNode(a.having,b),explain:this.transformNode(a.explain,b),setOperations:this.transformNodeList(a.setOperations,b),fetch:this.transformNode(a.fetch,b),top:this.transformNode(a.top,b)}}transformSelection(a,b){return{kind:"SelectionNode",selection:this.transformNode(a.selection,b)}}transformColumn(a,b){return{kind:"ColumnNode",column:this.transformNode(a.column,b)}}transformAlias(a,b){return{kind:"AliasNode",node:this.transformNode(a.node,b),alias:this.transformNode(a.alias,b)}}transformTable(a,b){return{kind:"TableNode",table:this.transformNode(a.table,b)}}transformFrom(a,b){return{kind:"FromNode",froms:this.transformNodeList(a.froms,b)}}transformReference(a,b){return{kind:"ReferenceNode",column:this.transformNode(a.column,b),table:this.transformNode(a.table,b)}}transformAnd(a,b){return{kind:"AndNode",left:this.transformNode(a.left,b),right:this.transformNode(a.right,b)}}transformOr(a,b){return{kind:"OrNode",left:this.transformNode(a.left,b),right:this.transformNode(a.right,b)}}transformValueList(a,b){return{kind:"ValueListNode",values:this.transformNodeList(a.values,b)}}transformParens(a,b){return{kind:"ParensNode",node:this.transformNode(a.node,b)}}transformJoin(a,b){return{kind:"JoinNode",joinType:a.joinType,table:this.transformNode(a.table,b),on:this.transformNode(a.on,b)}}transformRaw(a,b){return{kind:"RawNode",sqlFragments:(0,f.freeze)([...a.sqlFragments]),parameters:this.transformNodeList(a.parameters,b)}}transformWhere(a,b){return{kind:"WhereNode",where:this.transformNode(a.where,b)}}transformInsertQuery(a,b){return{kind:"InsertQueryNode",into:this.transformNode(a.into,b),columns:this.transformNodeList(a.columns,b),values:this.transformNode(a.values,b),returning:this.transformNode(a.returning,b),onConflict:this.transformNode(a.onConflict,b),onDuplicateKey:this.transformNode(a.onDuplicateKey,b),endModifiers:this.transformNodeList(a.endModifiers,b),with:this.transformNode(a.with,b),ignore:a.ignore,orAction:this.transformNode(a.orAction,b),replace:a.replace,explain:this.transformNode(a.explain,b),defaultValues:a.defaultValues,top:this.transformNode(a.top,b),output:this.transformNode(a.output,b)}}transformValues(a,b){return{kind:"ValuesNode",values:this.transformNodeList(a.values,b)}}transformDeleteQuery(a,b){return{kind:"DeleteQueryNode",from:this.transformNode(a.from,b),using:this.transformNode(a.using,b),joins:this.transformNodeList(a.joins,b),where:this.transformNode(a.where,b),returning:this.transformNode(a.returning,b),endModifiers:this.transformNodeList(a.endModifiers,b),with:this.transformNode(a.with,b),orderBy:this.transformNode(a.orderBy,b),limit:this.transformNode(a.limit,b),explain:this.transformNode(a.explain,b),top:this.transformNode(a.top,b),output:this.transformNode(a.output,b)}}transformReturning(a,b){return{kind:"ReturningNode",selections:this.transformNodeList(a.selections,b)}}transformCreateTable(a,b){return{kind:"CreateTableNode",table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b),constraints:this.transformNodeList(a.constraints,b),temporary:a.temporary,ifNotExists:a.ifNotExists,onCommit:a.onCommit,frontModifiers:this.transformNodeList(a.frontModifiers,b),endModifiers:this.transformNodeList(a.endModifiers,b),selectQuery:this.transformNode(a.selectQuery,b)}}transformColumnDefinition(a,b){return{kind:"ColumnDefinitionNode",column:this.transformNode(a.column,b),dataType:this.transformNode(a.dataType,b),references:this.transformNode(a.references,b),primaryKey:a.primaryKey,autoIncrement:a.autoIncrement,unique:a.unique,notNull:a.notNull,unsigned:a.unsigned,defaultTo:this.transformNode(a.defaultTo,b),check:this.transformNode(a.check,b),generated:this.transformNode(a.generated,b),frontModifiers:this.transformNodeList(a.frontModifiers,b),endModifiers:this.transformNodeList(a.endModifiers,b),nullsNotDistinct:a.nullsNotDistinct,identity:a.identity,ifNotExists:a.ifNotExists}}transformAddColumn(a,b){return{kind:"AddColumnNode",column:this.transformNode(a.column,b)}}transformDropTable(a,b){return{kind:"DropTableNode",table:this.transformNode(a.table,b),ifExists:a.ifExists,cascade:a.cascade}}transformOrderBy(a,b){return{kind:"OrderByNode",items:this.transformNodeList(a.items,b)}}transformOrderByItem(a,b){return{kind:"OrderByItemNode",orderBy:this.transformNode(a.orderBy,b),direction:this.transformNode(a.direction,b),collation:this.transformNode(a.collation,b),nulls:a.nulls}}transformGroupBy(a,b){return{kind:"GroupByNode",items:this.transformNodeList(a.items,b)}}transformGroupByItem(a,b){return{kind:"GroupByItemNode",groupBy:this.transformNode(a.groupBy,b)}}transformUpdateQuery(a,b){return{kind:"UpdateQueryNode",table:this.transformNode(a.table,b),from:this.transformNode(a.from,b),joins:this.transformNodeList(a.joins,b),where:this.transformNode(a.where,b),updates:this.transformNodeList(a.updates,b),returning:this.transformNode(a.returning,b),endModifiers:this.transformNodeList(a.endModifiers,b),with:this.transformNode(a.with,b),explain:this.transformNode(a.explain,b),limit:this.transformNode(a.limit,b),top:this.transformNode(a.top,b),output:this.transformNode(a.output,b),orderBy:this.transformNode(a.orderBy,b)}}transformColumnUpdate(a,b){return{kind:"ColumnUpdateNode",column:this.transformNode(a.column,b),value:this.transformNode(a.value,b)}}transformLimit(a,b){return{kind:"LimitNode",limit:this.transformNode(a.limit,b)}}transformOffset(a,b){return{kind:"OffsetNode",offset:this.transformNode(a.offset,b)}}transformOnConflict(a,b){return{kind:"OnConflictNode",columns:this.transformNodeList(a.columns,b),constraint:this.transformNode(a.constraint,b),indexExpression:this.transformNode(a.indexExpression,b),indexWhere:this.transformNode(a.indexWhere,b),updates:this.transformNodeList(a.updates,b),updateWhere:this.transformNode(a.updateWhere,b),doNothing:a.doNothing}}transformOnDuplicateKey(a,b){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(a.updates,b)}}transformCreateIndex(a,b){return{kind:"CreateIndexNode",name:this.transformNode(a.name,b),table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b),unique:a.unique,using:this.transformNode(a.using,b),ifNotExists:a.ifNotExists,where:this.transformNode(a.where,b),nullsNotDistinct:a.nullsNotDistinct}}transformList(a,b){return{kind:"ListNode",items:this.transformNodeList(a.items,b)}}transformDropIndex(a,b){return{kind:"DropIndexNode",name:this.transformNode(a.name,b),table:this.transformNode(a.table,b),ifExists:a.ifExists,cascade:a.cascade}}transformPrimaryKeyConstraint(a,b){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(a.columns,b),name:this.transformNode(a.name,b),deferrable:a.deferrable,initiallyDeferred:a.initiallyDeferred}}transformUniqueConstraint(a,b){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(a.columns,b),name:this.transformNode(a.name,b),nullsNotDistinct:a.nullsNotDistinct,deferrable:a.deferrable,initiallyDeferred:a.initiallyDeferred}}transformForeignKeyConstraint(a,b){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(a.columns,b),references:this.transformNode(a.references,b),name:this.transformNode(a.name,b),onDelete:a.onDelete,onUpdate:a.onUpdate,deferrable:a.deferrable,initiallyDeferred:a.initiallyDeferred}}transformSetOperation(a,b){return{kind:"SetOperationNode",operator:a.operator,expression:this.transformNode(a.expression,b),all:a.all}}transformReferences(a,b){return{kind:"ReferencesNode",table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b),onDelete:a.onDelete,onUpdate:a.onUpdate}}transformCheckConstraint(a,b){return{kind:"CheckConstraintNode",expression:this.transformNode(a.expression,b),name:this.transformNode(a.name,b)}}transformWith(a,b){return{kind:"WithNode",expressions:this.transformNodeList(a.expressions,b),recursive:a.recursive}}transformCommonTableExpression(a,b){return{kind:"CommonTableExpressionNode",name:this.transformNode(a.name,b),materialized:a.materialized,expression:this.transformNode(a.expression,b)}}transformCommonTableExpressionName(a,b){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(a.table,b),columns:this.transformNodeList(a.columns,b)}}transformHaving(a,b){return{kind:"HavingNode",having:this.transformNode(a.having,b)}}transformCreateSchema(a,b){return{kind:"CreateSchemaNode",schema:this.transformNode(a.schema,b),ifNotExists:a.ifNotExists}}transformDropSchema(a,b){return{kind:"DropSchemaNode",schema:this.transformNode(a.schema,b),ifExists:a.ifExists,cascade:a.cascade}}transformAlterTable(a,b){return{kind:"AlterTableNode",table:this.transformNode(a.table,b),renameTo:this.transformNode(a.renameTo,b),setSchema:this.transformNode(a.setSchema,b),columnAlterations:this.transformNodeList(a.columnAlterations,b),addConstraint:this.transformNode(a.addConstraint,b),dropConstraint:this.transformNode(a.dropConstraint,b),renameConstraint:this.transformNode(a.renameConstraint,b),addIndex:this.transformNode(a.addIndex,b),dropIndex:this.transformNode(a.dropIndex,b)}}transformDropColumn(a,b){return{kind:"DropColumnNode",column:this.transformNode(a.column,b)}}transformRenameColumn(a,b){return{kind:"RenameColumnNode",column:this.transformNode(a.column,b),renameTo:this.transformNode(a.renameTo,b)}}transformAlterColumn(a,b){return{kind:"AlterColumnNode",column:this.transformNode(a.column,b),dataType:this.transformNode(a.dataType,b),dataTypeExpression:this.transformNode(a.dataTypeExpression,b),setDefault:this.transformNode(a.setDefault,b),dropDefault:a.dropDefault,setNotNull:a.setNotNull,dropNotNull:a.dropNotNull}}transformModifyColumn(a,b){return{kind:"ModifyColumnNode",column:this.transformNode(a.column,b)}}transformAddConstraint(a,b){return{kind:"AddConstraintNode",constraint:this.transformNode(a.constraint,b)}}transformDropConstraint(a,b){return{kind:"DropConstraintNode",constraintName:this.transformNode(a.constraintName,b),ifExists:a.ifExists,modifier:a.modifier}}transformRenameConstraint(a,b){return{kind:"RenameConstraintNode",oldName:this.transformNode(a.oldName,b),newName:this.transformNode(a.newName,b)}}transformCreateView(a,b){return{kind:"CreateViewNode",name:this.transformNode(a.name,b),temporary:a.temporary,orReplace:a.orReplace,ifNotExists:a.ifNotExists,materialized:a.materialized,columns:this.transformNodeList(a.columns,b),as:this.transformNode(a.as,b)}}transformRefreshMaterializedView(a,b){return{kind:"RefreshMaterializedViewNode",name:this.transformNode(a.name,b),concurrently:a.concurrently,withNoData:a.withNoData}}transformDropView(a,b){return{kind:"DropViewNode",name:this.transformNode(a.name,b),ifExists:a.ifExists,materialized:a.materialized,cascade:a.cascade}}transformGenerated(a,b){return{kind:"GeneratedNode",byDefault:a.byDefault,always:a.always,identity:a.identity,stored:a.stored,expression:this.transformNode(a.expression,b)}}transformDefaultValue(a,b){return{kind:"DefaultValueNode",defaultValue:this.transformNode(a.defaultValue,b)}}transformOn(a,b){return{kind:"OnNode",on:this.transformNode(a.on,b)}}transformSelectModifier(a,b){return{kind:"SelectModifierNode",modifier:a.modifier,rawModifier:this.transformNode(a.rawModifier,b),of:this.transformNodeList(a.of,b)}}transformCreateType(a,b){return{kind:"CreateTypeNode",name:this.transformNode(a.name,b),enum:this.transformNode(a.enum,b)}}transformDropType(a,b){return{kind:"DropTypeNode",name:this.transformNode(a.name,b),ifExists:a.ifExists}}transformExplain(a,b){return{kind:"ExplainNode",format:a.format,options:this.transformNode(a.options,b)}}transformSchemableIdentifier(a,b){return{kind:"SchemableIdentifierNode",schema:this.transformNode(a.schema,b),identifier:this.transformNode(a.identifier,b)}}transformAggregateFunction(a,b){return{kind:"AggregateFunctionNode",func:a.func,aggregated:this.transformNodeList(a.aggregated,b),distinct:a.distinct,orderBy:this.transformNode(a.orderBy,b),withinGroup:this.transformNode(a.withinGroup,b),filter:this.transformNode(a.filter,b),over:this.transformNode(a.over,b)}}transformOver(a,b){return{kind:"OverNode",orderBy:this.transformNode(a.orderBy,b),partitionBy:this.transformNode(a.partitionBy,b)}}transformPartitionBy(a,b){return{kind:"PartitionByNode",items:this.transformNodeList(a.items,b)}}transformPartitionByItem(a,b){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(a.partitionBy,b)}}transformBinaryOperation(a,b){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(a.leftOperand,b),operator:this.transformNode(a.operator,b),rightOperand:this.transformNode(a.rightOperand,b)}}transformUnaryOperation(a,b){return{kind:"UnaryOperationNode",operator:this.transformNode(a.operator,b),operand:this.transformNode(a.operand,b)}}transformUsing(a,b){return{kind:"UsingNode",tables:this.transformNodeList(a.tables,b)}}transformFunction(a,b){return{kind:"FunctionNode",func:a.func,arguments:this.transformNodeList(a.arguments,b)}}transformCase(a,b){return{kind:"CaseNode",value:this.transformNode(a.value,b),when:this.transformNodeList(a.when,b),else:this.transformNode(a.else,b),isStatement:a.isStatement}}transformWhen(a,b){return{kind:"WhenNode",condition:this.transformNode(a.condition,b),result:this.transformNode(a.result,b)}}transformJSONReference(a,b){return{kind:"JSONReferenceNode",reference:this.transformNode(a.reference,b),traversal:this.transformNode(a.traversal,b)}}transformJSONPath(a,b){return{kind:"JSONPathNode",inOperator:this.transformNode(a.inOperator,b),pathLegs:this.transformNodeList(a.pathLegs,b)}}transformJSONPathLeg(a,b){return{kind:"JSONPathLegNode",type:a.type,value:a.value}}transformJSONOperatorChain(a,b){return{kind:"JSONOperatorChainNode",operator:this.transformNode(a.operator,b),values:this.transformNodeList(a.values,b)}}transformTuple(a,b){return{kind:"TupleNode",values:this.transformNodeList(a.values,b)}}transformMergeQuery(a,b){return{kind:"MergeQueryNode",into:this.transformNode(a.into,b),using:this.transformNode(a.using,b),whens:this.transformNodeList(a.whens,b),with:this.transformNode(a.with,b),top:this.transformNode(a.top,b),endModifiers:this.transformNodeList(a.endModifiers,b),output:this.transformNode(a.output,b),returning:this.transformNode(a.returning,b)}}transformMatched(a,b){return{kind:"MatchedNode",not:a.not,bySource:a.bySource}}transformAddIndex(a,b){return{kind:"AddIndexNode",name:this.transformNode(a.name,b),columns:this.transformNodeList(a.columns,b),unique:a.unique,using:this.transformNode(a.using,b),ifNotExists:a.ifNotExists}}transformCast(a,b){return{kind:"CastNode",expression:this.transformNode(a.expression,b),dataType:this.transformNode(a.dataType,b)}}transformFetch(a,b){return{kind:"FetchNode",rowCount:this.transformNode(a.rowCount,b),modifier:a.modifier}}transformTop(a,b){return{kind:"TopNode",expression:a.expression,modifiers:a.modifiers}}transformOutput(a,b){return{kind:"OutputNode",selections:this.transformNodeList(a.selections,b)}}transformDataType(a,b){return a}transformSelectAll(a,b){return a}transformIdentifier(a,b){return a}transformValue(a,b){return a}transformPrimitiveValueList(a,b){return a}transformOperator(a,b){return a}transformDefaultInsertValue(a,b){return a}transformOrAction(a,b){return a}transformCollate(a,b){return a}}a.s(["OperationNodeTransformer",()=>g],197365);var h=a.i(908896);let i=(0,f.freeze)({is:a=>"TableNode"===a.kind,create:a=>(0,f.freeze)({kind:"TableNode",table:h.SchemableIdentifierNode.create(a)}),createWithSchema:(a,b)=>(0,f.freeze)({kind:"TableNode",table:h.SchemableIdentifierNode.createWithSchema(a,b)})});a.s(["TableNode",0,i],506770);let j=(0,f.freeze)({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),k={json_agg:!0,to_json:!0};class l extends g{#f;#g=new Set;#h=new Set;constructor(a){super(),this.#f=a}transformNodeImpl(a,b){if(!this.#i(a))return super.transformNodeImpl(a,b);let c=this.#j(a);for(let a of c)this.#h.add(a);let d=this.#k(a);for(let a of d)this.#g.add(a);let e=super.transformNodeImpl(a,b);for(let a of d)this.#g.delete(a);for(let a of c)this.#h.delete(a);return e}transformSchemableIdentifier(a,b){let d=super.transformSchemableIdentifier(a,b);return d.schema||!this.#g.has(a.identifier.name)?d:{...d,schema:c.IdentifierNode.create(this.#f)}}transformReferences(a,b){let c=super.transformReferences(a,b);return c.table.table.schema?c:{...c,table:i.createWithSchema(this.#f,c.table.table.identifier.name)}}transformAggregateFunction(a,b){return{...super.transformAggregateFunction({...a,aggregated:[]},b),aggregated:this.#l(a,b,"aggregated")}}transformFunction(a,b){return{...super.transformFunction({...a,arguments:[]},b),arguments:this.#l(a,b,"arguments")}}#l(a,b,c){return k[a.func]?a[c].map(a=>!i.is(a)||a.table.schema?this.transformNode(a,b):{...a,table:this.transformIdentifier(a.table.identifier,b)}):this.transformNodeList(a[c],b)}#i(a){return a.kind in j}#k(a){let b=new Set;if("name"in a&&a.name&&h.SchemableIdentifierNode.is(a.name)&&this.#m(a.name,b),"from"in a&&a.from)for(let c of a.from.froms)this.#n(c,b);if("into"in a&&a.into&&this.#n(a.into,b),"table"in a&&a.table&&this.#n(a.table,b),"joins"in a&&a.joins)for(let c of a.joins)this.#n(c.table,b);return"using"in a&&a.using&&(d.JoinNode.is(a.using)?this.#n(a.using.table,b):this.#n(a.using,b)),b}#j(a){let b=new Set;return"with"in a&&a.with&&this.#o(a.with,b),b}#n(a,c){if(i.is(a))this.#m(a.table,c);else if(b.AliasNode.is(a)&&i.is(a.node))this.#m(a.node.table,c);else if(e.ListNode.is(a))for(let b of a.items)this.#n(b,c)}#m(a,b){let c=a.identifier.name;this.#g.has(c)||this.#h.has(c)||b.add(c)}#o(a,b){for(let c of a.expressions){let a=c.name.table.table.identifier.name;this.#h.has(a)||b.add(a)}}}class m{#p;constructor(a){this.#p=new l(a)}transformQuery(a){return this.#p.transformNode(a.node,a.queryId)}async transformResult(a){return a.result}}function n(a){return(0,f.isObject)(a)&&(0,f.isFunction)(a.toOperationNode)}a.s(["WithSchemaPlugin",()=>m],185545),(0,f.freeze)({__noMigrations__:!0}),a.s(["DEFAULT_MIGRATION_LOCK_TABLE",0,"kysely_migration_lock","DEFAULT_MIGRATION_TABLE",0,"kysely_migration"],154132),a.s(["isOperationNodeSource",()=>n],158758);let o=(0,f.freeze)({is:a=>"ValueNode"===a.kind,create:a=>(0,f.freeze)({kind:"ValueNode",value:a}),createImmediate:a=>(0,f.freeze)({kind:"ValueNode",value:a,immediate:!0})});a.s(["ValueNode",0,o],620033);let p=(0,f.freeze)({is:a=>"ColumnNode"===a.kind,create:a=>(0,f.freeze)({kind:"ColumnNode",column:c.IdentifierNode.create(a)})});a.s(["ColumnNode",0,p],340672);let q=(0,f.freeze)({is:a=>"SelectAllNode"===a.kind,create:()=>(0,f.freeze)({kind:"SelectAllNode"})});a.s(["SelectAllNode",0,q],198722);let r=(0,f.freeze)({is:a=>"ReferenceNode"===a.kind,create:(a,b)=>(0,f.freeze)({kind:"ReferenceNode",table:b,column:a}),createSelectAll:a=>(0,f.freeze)({kind:"ReferenceNode",table:a,column:q.create()})});function s(a){return(0,f.isObject)(a)&&"expressionType"in a&&n(a)}function t(a){return(0,f.isObject)(a)&&"expression"in a&&(0,f.isString)(a.alias)&&n(a)}a.s(["ReferenceNode",0,r],962088),a.s(["isAliasedExpression",()=>t,"isExpression",()=>s],200635);let u=(0,f.freeze)({is:a=>"SelectModifierNode"===a.kind,create:(a,b)=>(0,f.freeze)({kind:"SelectModifierNode",modifier:a,of:b}),createWithExpression:a=>(0,f.freeze)({kind:"SelectModifierNode",rawModifier:a})});a.s(["SelectModifierNode",0,u],167653),a.s(["parseFilterList",()=>M,"parseFilterObject",()=>L,"parseReferentialBinaryOperation",()=>K,"parseValueBinaryOperation",()=>J,"parseValueBinaryOperationOrExpression",()=>I],245228);let v=(0,f.freeze)({is:a=>"BinaryOperationNode"===a.kind,create:(a,b,c)=>(0,f.freeze)({kind:"BinaryOperationNode",leftOperand:a,operator:b,rightOperand:c})});a.s(["BinaryOperationNode",0,v],544447);var w=a.i(713123),x=a.i(489774);a.s(["isSafeImmediateValue",()=>D,"parseSafeImmediateValue",()=>E,"parseValueExpression",()=>C,"parseValueExpressionOrList",()=>B],209638);let y=(0,f.freeze)({is:a=>"PrimitiveValueListNode"===a.kind,create:a=>(0,f.freeze)({kind:"PrimitiveValueListNode",values:(0,f.freeze)([...a])})});a.s(["PrimitiveValueListNode",0,y],806285);let z=(0,f.freeze)({is:a=>"ValueListNode"===a.kind,create:a=>(0,f.freeze)({kind:"ValueListNode",values:(0,f.freeze)(a)})});a.s(["ValueListNode",0,z],372590);var A=a.i(704789);function B(a){var b;return(0,f.isReadonlyArray)(a)?(b=a).some(A.isExpressionOrFactory)?z.create(b.map(a=>C(a))):y.create(b):C(a)}function C(a){return(0,A.isExpressionOrFactory)(a)?(0,A.parseExpression)(a):o.create(a)}function D(a){return(0,f.isNumber)(a)||(0,f.isBoolean)(a)||(0,f.isNull)(a)}function E(a){if(!D(a))throw Error(`unsafe immediate value ${JSON.stringify(a)}`);return o.createImmediate(a)}var F=a.i(651861),G=a.i(477804),H=a.i(25283);function I(a){if(3===a.length)return J(a[0],a[1],a[2]);if(1===a.length)return C(a[0]);throw Error(`invalid arguments: ${JSON.stringify(a)}`)}function J(a,b,c){var d;return("is"===(d=b)||"is not"===d)&&N(c)?v.create((0,x.parseReferenceExpression)(a),O(b),o.createImmediate(c)):v.create((0,x.parseReferenceExpression)(a),O(b),B(c))}function K(a,b,c){return v.create((0,x.parseReferenceExpression)(a),O(b),(0,x.parseReferenceExpression)(c))}function L(a,b){return M(Object.entries(a).filter(([,a])=>!(0,f.isUndefined)(a)).map(([a,b])=>J(a,N(b)?"is":"=",b)),b)}function M(a,b,c=!0){let d="and"===b?F.AndNode.create:H.OrNode.create;if(0===a.length)return v.create(o.createImmediate(1),w.OperatorNode.create("="),o.createImmediate(+("and"===b)));let e=P(a[0]);for(let b=1;b<a.length;++b)e=d(e,P(a[b]));return a.length>1&&c?G.ParensNode.create(e):e}function N(a){return(0,f.isNull)(a)||(0,f.isBoolean)(a)}function O(a){if((0,f.isString)(a)&&w.OPERATORS.includes(a))return w.OperatorNode.create(a);if(n(a))return a.toOperationNode();throw Error(`invalid operator ${JSON.stringify(a)}`)}function P(a){return n(a)?a.toOperationNode():a}},497107,a=>{"use strict";var b=a.i(852460),c=a.i(78606);let d=(0,b.freeze)({is:a=>"PartitionByNode"===a.kind,create:a=>(0,b.freeze)({kind:"PartitionByNode",items:(0,b.freeze)(a)}),cloneWithItems:(a,c)=>(0,b.freeze)({...a,items:(0,b.freeze)([...a.items,...c])})}),e=(0,b.freeze)({is:a=>"OverNode"===a.kind,create:()=>(0,b.freeze)({kind:"OverNode"}),cloneWithOrderByItems:(a,d)=>(0,b.freeze)({...a,orderBy:a.orderBy?c.OrderByNode.cloneWithItems(a.orderBy,d):c.OrderByNode.create(d)}),cloneWithPartitionByItems:(a,c)=>(0,b.freeze)({...a,partitionBy:a.partitionBy?d.cloneWithItems(a.partitionBy,c):d.create(c)})});a.s(["OverNode",0,e],497107)},919560,627675,542769,966101,270557,885184,406271,272839,737327,273664,552817,9582,704789,489774,a=>{"use strict";var b=a.i(620860),c=a.i(158758),d=a.i(293807),e=a.i(620033);a.s(["parseAliasedStringReference",()=>bD,"parseColumnName",()=>bE,"parseJSONReference",()=>bB,"parseOrderedColumnName",()=>bF,"parseReferenceExpression",()=>bA,"parseReferenceExpressionOrList",()=>bz,"parseSimpleReferenceExpression",()=>by,"parseStringReference",()=>bC],489774);var f=a.i(524054),g=a.i(340672),h=a.i(962088),i=a.i(506770),j=a.i(852460);a.s(["isExpressionOrFactory",()=>bx,"parseAliasedExpression",()=>bw,"parseExpression",()=>bv],704789);var k=a.i(200635),l=a.i(167653),m=a.i(767319),n=a.i(245228),o=a.i(497107),p=a.i(541595);class q{#q;constructor(a){this.#q=(0,j.freeze)(a)}on(...a){return new q({...this.#q,joinNode:m.JoinNode.cloneWithOn(this.#q.joinNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}onRef(a,b,c){return new q({...this.#q,joinNode:m.JoinNode.cloneWithOn(this.#q.joinNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}onTrue(){return new q({...this.#q,joinNode:m.JoinNode.cloneWithOn(this.#q.joinNode,d.RawNode.createWithSql("true"))})}$call(a){return a(this)}toOperationNode(){return this.#q.joinNode}}var r=a.i(639399);a.s(["DynamicReferenceBuilder",()=>s,"isDynamicReferenceBuilder",()=>t],627675);class s{#r;get dynamicReference(){return this.#r}get refType(){}constructor(a){this.#r=a}toOperationNode(){return by(this.#r)}}function t(a){return(0,j.isObject)(a)&&(0,c.isOperationNodeSource)(a)&&(0,j.isString)(a.dynamicReference)}let u=(0,j.freeze)({is:a=>"OrderByItemNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"OrderByItemNode",orderBy:a,direction:b}),cloneWith:(a,b)=>(0,j.freeze)({...a,...b})});class v{#q;constructor(a){this.#q=(0,j.freeze)(a)}desc(){return new v({node:u.cloneWith(this.#q.node,{direction:d.RawNode.createWithSql("desc")})})}asc(){return new v({node:u.cloneWith(this.#q.node,{direction:d.RawNode.createWithSql("asc")})})}nullsLast(){return new v({node:u.cloneWith(this.#q.node,{nulls:"last"})})}nullsFirst(){return new v({node:u.cloneWith(this.#q.node,{nulls:"first"})})}collate(a){let c;return new v({node:u.cloneWith(this.#q.node,{collation:(c=a,(0,j.freeze)({kind:"CollateNode",collation:b.IdentifierNode.create(c)}))})})}toOperationNode(){return this.#q.node}}var w=a.i(328283);function x(a){return"asc"===a||"desc"===a}function y(a){if(2===a.length)return[z(a[0],a[1])];if(1===a.length){let[b]=a;return Array.isArray(b)?((0,w.logOnce)("orderBy(array) is deprecated, use multiple orderBy calls instead."),b.map(a=>z(a))):[z(b)]}throw Error(`Invalid number of arguments at order by! expected 1-2, received ${a.length}`)}function z(a,b){let c=function(a){if(bx(a))return bv(a);if(t(a))return a.toOperationNode();let[b,c]=a.split(" ");return c?((0,w.logOnce)("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),A(bC(b),c)):bC(a)}(a);if(u.is(c)){if(b)throw Error("Cannot specify direction twice!");return c}return A(c,b)}function A(a,b){if("string"==typeof b){if(!x(b))throw Error(`Invalid order by direction: ${b}`);return u.create(a,d.RawNode.createWithSql(b))}if((0,k.isExpression)(b))return(0,w.logOnce)("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),u.create(a,b.toOperationNode());let c=u.create(a);return b?b(new v({node:c})).toOperationNode():c}let B=(0,j.freeze)({is:a=>"PartitionByItemNode"===a.kind,create:a=>(0,j.freeze)({kind:"PartitionByItemNode",partitionBy:a})});class C{#q;constructor(a){this.#q=(0,j.freeze)(a)}orderBy(...a){return new C({overNode:o.OverNode.cloneWithOrderByItems(this.#q.overNode,y(a))})}clearOrderBy(){return new C({overNode:r.QueryNode.cloneWithoutOrderBy(this.#q.overNode)})}partitionBy(a){return new C({overNode:o.OverNode.cloneWithPartitionByItems(this.#q.overNode,bz(a).map(B.create))})}$call(a){return a(this)}toOperationNode(){return this.#q.overNode}}a.s(["QueryCreator",()=>aQ],272839);var D=a.i(198722);let E=(0,j.freeze)({is:a=>"SelectionNode"===a.kind,create:a=>(0,j.freeze)({kind:"SelectionNode",selection:a}),createSelectAll:()=>(0,j.freeze)({kind:"SelectionNode",selection:D.SelectAllNode.create()}),createSelectAllFromTable:a=>(0,j.freeze)({kind:"SelectionNode",selection:h.ReferenceNode.createSelectAll(a)})});a.s(["parseAliasedTable",()=>K,"parseTable",()=>L,"parseTableExpression",()=>J,"parseTableExpressionOrList",()=>I],966101),a.s(["DynamicTableBuilder",()=>F,"isAliasedDynamicTableBuilder",()=>H],542769);class F{#s;get table(){return this.#s}constructor(a){this.#s=a}as(a){return new G(this.#s,a)}}class G{#s;#t;get table(){return this.#s}get alias(){return this.#t}constructor(a,b){this.#s=a,this.#t=b}toOperationNode(){return f.AliasNode.create(L(this.#s),b.IdentifierNode.create(this.#t))}}function H(a){return(0,j.isObject)(a)&&(0,c.isOperationNodeSource)(a)&&(0,j.isString)(a.table)&&(0,j.isString)(a.alias)}function I(a){return(0,j.isReadonlyArray)(a)?a.map(a=>J(a)):[J(a)]}function J(a){return(0,j.isString)(a)?K(a):H(a)?a.toOperationNode():bw(a)}function K(a){let c=" as ";if(!a.includes(c))return L(a);{let[d,e]=a.split(c).map(M);return f.AliasNode.create(L(d),b.IdentifierNode.create(e))}}function L(a){if(!a.includes("."))return i.TableNode.create(a);{let[b,c]=a.split(".").map(M);return i.TableNode.createWithSchema(b,c)}}function M(a){return a.trim()}function N(a){return(0,j.isFunction)(a)?N(a(bu())):(0,j.isReadonlyArray)(a)?a.map(a=>O(a)):[O(a)]}function O(a){return(0,j.isString)(a)?E.create(bD(a)):t(a)?E.create(a.toOperationNode()):E.create(bw(a))}function P(a){return a?Array.isArray(a)?a.map(Q):[Q(a)]:[E.createSelectAll()]}function Q(a){if((0,j.isString)(a))return E.createSelectAllFromTable(L(a));throw Error(`invalid value selectAll expression: ${JSON.stringify(a)}`)}var R=a.i(806285),S=a.i(372590),T=a.i(209638);let U=(0,j.freeze)({is:a=>"ValuesNode"===a.kind,create:a=>(0,j.freeze)({kind:"ValuesNode",values:(0,j.freeze)(a)})}),V=(0,j.freeze)({is:a=>"DefaultInsertValueNode"===a.kind,create:()=>(0,j.freeze)({kind:"DefaultInsertValueNode"})});function W(a){var b;let c,d=(0,j.isFunction)(a)?a(bu()):a;return c=function(a){let b=new Map;for(let c of a)for(let a of Object.keys(c))b.has(a)||void 0===c[a]||b.set(a,b.size);return b}(b=(0,j.isReadonlyArray)(d)?d:(0,j.freeze)([d])),[(0,j.freeze)([...c.keys()].map(g.ColumnNode.create)),U.create(b.map(a=>(function(a,b){let c=Object.keys(a),d=Array.from({length:b.size}),e=!1,f=c.length;for(let g of c){let c=b.get(g);if((0,j.isUndefined)(c)){f--;continue}let h=a[g];((0,j.isUndefined)(h)||bx(h))&&(e=!0),d[c]=h}if(f<b.size||e){let a=V.create();return S.ValueListNode.create(d.map(b=>(0,j.isUndefined)(b)?a:(0,T.parseValueExpression)(b)))}return R.PrimitiveValueListNode.create(d)})(a,c)))]}var X=a.i(819910);let Y=(0,j.freeze)({is:a=>"ColumnUpdateNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"ColumnUpdateNode",column:a,value:b})});function Z(a){return Object.entries((0,j.isFunction)(a)?a(bu()):a).filter(([a,b])=>void 0!==b).map(([a,b])=>Y.create(g.ColumnNode.create(a),(0,T.parseValueExpression)(b)))}let $=(0,j.freeze)({is:a=>"OnDuplicateKeyNode"===a.kind,create:a=>(0,j.freeze)({kind:"OnDuplicateKeyNode",updates:a})});class _{insertId;numInsertedOrUpdatedRows;constructor(a,b){this.insertId=a,this.numInsertedOrUpdatedRows=b}}class aa extends Error{node;constructor(a){super("no result"),this.node=a}}function ab(a){return Object.prototype.hasOwnProperty.call(a,"prototype")}var ac=a.i(927466);let ad=(0,j.freeze)({is:a=>"OnConflictNode"===a.kind,create:()=>(0,j.freeze)({kind:"OnConflictNode"}),cloneWith:(a,b)=>(0,j.freeze)({...a,...b}),cloneWithIndexWhere:(a,b)=>(0,j.freeze)({...a,indexWhere:a.indexWhere?ac.WhereNode.cloneWithOperation(a.indexWhere,"And",b):ac.WhereNode.create(b)}),cloneWithIndexOrWhere:(a,b)=>(0,j.freeze)({...a,indexWhere:a.indexWhere?ac.WhereNode.cloneWithOperation(a.indexWhere,"Or",b):ac.WhereNode.create(b)}),cloneWithUpdateWhere:(a,b)=>(0,j.freeze)({...a,updateWhere:a.updateWhere?ac.WhereNode.cloneWithOperation(a.updateWhere,"And",b):ac.WhereNode.create(b)}),cloneWithUpdateOrWhere:(a,b)=>(0,j.freeze)({...a,updateWhere:a.updateWhere?ac.WhereNode.cloneWithOperation(a.updateWhere,"Or",b):ac.WhereNode.create(b)}),cloneWithoutIndexWhere:a=>(0,j.freeze)({...a,indexWhere:void 0}),cloneWithoutUpdateWhere:a=>(0,j.freeze)({...a,updateWhere:void 0})});class ae{#q;constructor(a){this.#q=(0,j.freeze)(a)}column(a){let b=g.ColumnNode.create(a);return new ae({...this.#q,onConflictNode:ad.cloneWith(this.#q.onConflictNode,{columns:this.#q.onConflictNode.columns?(0,j.freeze)([...this.#q.onConflictNode.columns,b]):(0,j.freeze)([b])})})}columns(a){let b=a.map(g.ColumnNode.create);return new ae({...this.#q,onConflictNode:ad.cloneWith(this.#q.onConflictNode,{columns:this.#q.onConflictNode.columns?(0,j.freeze)([...this.#q.onConflictNode.columns,...b]):(0,j.freeze)(b)})})}constraint(a){return new ae({...this.#q,onConflictNode:ad.cloneWith(this.#q.onConflictNode,{constraint:b.IdentifierNode.create(a)})})}expression(a){return new ae({...this.#q,onConflictNode:ad.cloneWith(this.#q.onConflictNode,{indexExpression:a.toOperationNode()})})}where(...a){return new ae({...this.#q,onConflictNode:ad.cloneWithIndexWhere(this.#q.onConflictNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new ae({...this.#q,onConflictNode:ad.cloneWithIndexWhere(this.#q.onConflictNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new ae({...this.#q,onConflictNode:ad.cloneWithoutIndexWhere(this.#q.onConflictNode)})}doNothing(){return new af({...this.#q,onConflictNode:ad.cloneWith(this.#q.onConflictNode,{doNothing:!0})})}doUpdateSet(a){return new ag({...this.#q,onConflictNode:ad.cloneWith(this.#q.onConflictNode,{updates:Z(a)})})}$call(a){return a(this)}}class af{#q;constructor(a){this.#q=(0,j.freeze)(a)}toOperationNode(){return this.#q.onConflictNode}}class ag{#q;constructor(a){this.#q=(0,j.freeze)(a)}where(...a){return new ag({...this.#q,onConflictNode:ad.cloneWithUpdateWhere(this.#q.onConflictNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new ag({...this.#q,onConflictNode:ad.cloneWithUpdateWhere(this.#q.onConflictNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new ag({...this.#q,onConflictNode:ad.cloneWithoutUpdateWhere(this.#q.onConflictNode)})}$call(a){return a(this)}toOperationNode(){return this.#q.onConflictNode}}let ah=(0,j.freeze)({is:a=>"TopNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"TopNode",expression:a,modifiers:b})});function ai(a,b){var c;if(!(0,j.isNumber)(a)&&!(0,j.isBigInt)(a))throw Error(`Invalid top expression: ${a}`);if(!(0,j.isUndefined)(b)&&"percent"!==(c=b)&&"with ties"!==c&&"percent with ties"!==c)throw Error(`Invalid top modifiers: ${b}`);return ah.create(a,b)}let aj=(0,j.freeze)({is:a=>"OrActionNode"===a.kind,create:a=>(0,j.freeze)({kind:"OrActionNode",action:a})});class ak{#q;constructor(a){this.#q=(0,j.freeze)(a)}values(a){let[b,c]=W(a);return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{columns:b,values:c})})}columns(a){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{columns:(0,j.freeze)(a.map(g.ColumnNode.create))})})}expression(a){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{values:bv(a)})})}defaultValues(){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{defaultValues:!0})})}modifyEnd(a){return new ak({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,a.toOperationNode())})}ignore(){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{orAction:aj.create("ignore")})})}orIgnore(){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{orAction:aj.create("ignore")})})}orAbort(){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{orAction:aj.create("abort")})})}orFail(){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{orAction:aj.create("fail")})})}orReplace(){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{orAction:aj.create("replace")})})}orRollback(){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{orAction:aj.create("rollback")})})}top(a,b){return new ak({...this.#q,queryNode:r.QueryNode.cloneWithTop(this.#q.queryNode,ai(a,b))})}onConflict(a){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{onConflict:a(new ae({onConflictNode:ad.create()})).toOperationNode()})})}onDuplicateKeyUpdate(a){return new ak({...this.#q,queryNode:X.InsertQueryNode.cloneWith(this.#q.queryNode,{onDuplicateKey:$.create(Z(a))})})}returning(a){return new ak({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,N(a))})}returningAll(){return new ak({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,P())})}output(a){return new ak({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,N(a))})}outputAll(a){return new ak({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,P(a))})}clearReturning(){return new ak({...this.#q,queryNode:r.QueryNode.cloneWithoutReturning(this.#q.queryNode)})}$call(a){return a(this)}$if(a,b){return a?b(this):new ak({...this.#q})}$castTo(){return new ak(this.#q)}$narrowType(){return new ak(this.#q)}$assertType(){return new ak(this.#q)}withPlugin(a){return new ak({...this.#q,executor:this.#q.executor.withPlugin(a)})}toOperationNode(){return this.#q.executor.transformQuery(this.#q.queryNode,this.#q.queryId)}compile(){return this.#q.executor.compileQuery(this.toOperationNode(),this.#q.queryId)}async execute(){let a=this.compile(),b=await this.#q.executor.executeQuery(a),{adapter:c}=this.#q.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new _(b.insertId,b.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=aa){let b=await this.executeTakeFirst();if(void 0===b)throw ab(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#q.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new ak({...this.#q,queryNode:r.QueryNode.cloneWithExplain(this.#q.queryNode,a,b)});return await c.execute()}}class al{numDeletedRows;constructor(a){this.numDeletedRows=a}}var am=a.i(648565);let an=(0,j.freeze)({is:a=>"LimitNode"===a.kind,create:a=>(0,j.freeze)({kind:"LimitNode",limit:a})});class ao{#q;constructor(a){this.#q=(0,j.freeze)(a)}where(...a){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithWhere(this.#q.queryNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithWhere(this.#q.queryNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithoutWhere(this.#q.queryNode)})}top(a,b){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithTop(this.#q.queryNode,ai(a,b))})}using(a){return new ao({...this.#q,queryNode:am.DeleteQueryNode.cloneWithUsing(this.#q.queryNode,I(a))})}innerJoin(...a){return this.#u("InnerJoin",a)}leftJoin(...a){return this.#u("LeftJoin",a)}rightJoin(...a){return this.#u("RightJoin",a)}fullJoin(...a){return this.#u("FullJoin",a)}#u(a,b){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithJoin(this.#q.queryNode,aR(a,b))})}returning(a){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,N(a))})}returningAll(a){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,P(a))})}output(a){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,N(a))})}outputAll(a){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,P(a))})}clearReturning(){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithoutReturning(this.#q.queryNode)})}clearLimit(){return new ao({...this.#q,queryNode:am.DeleteQueryNode.cloneWithoutLimit(this.#q.queryNode)})}orderBy(...a){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithOrderByItems(this.#q.queryNode,y(a))})}clearOrderBy(){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithoutOrderBy(this.#q.queryNode)})}limit(a){return new ao({...this.#q,queryNode:am.DeleteQueryNode.cloneWithLimit(this.#q.queryNode,an.create((0,T.parseValueExpression)(a)))})}modifyEnd(a){return new ao({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,a.toOperationNode())})}$call(a){return a(this)}$if(a,b){return a?b(this):new ao({...this.#q})}$castTo(){return new ao(this.#q)}$narrowType(){return new ao(this.#q)}$assertType(){return new ao(this.#q)}withPlugin(a){return new ao({...this.#q,executor:this.#q.executor.withPlugin(a)})}toOperationNode(){return this.#q.executor.transformQuery(this.#q.queryNode,this.#q.queryId)}compile(){return this.#q.executor.compileQuery(this.toOperationNode(),this.#q.queryId)}async execute(){let a=this.compile(),b=await this.#q.executor.executeQuery(a),{adapter:c}=this.#q.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new al(b.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=aa){let b=await this.executeTakeFirst();if(void 0===b)throw ab(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#q.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new ao({...this.#q,queryNode:r.QueryNode.cloneWithExplain(this.#q.queryNode,a,b)});return await c.execute()}}var ap=a.i(912475);class aq{numUpdatedRows;numChangedRows;constructor(a,b){this.numUpdatedRows=a,this.numChangedRows=b}}class ar{#q;constructor(a){this.#q=(0,j.freeze)(a)}where(...a){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithWhere(this.#q.queryNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithWhere(this.#q.queryNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}clearWhere(){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithoutWhere(this.#q.queryNode)})}top(a,b){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithTop(this.#q.queryNode,ai(a,b))})}from(a){return new ar({...this.#q,queryNode:ap.UpdateQueryNode.cloneWithFromItems(this.#q.queryNode,I(a))})}innerJoin(...a){return this.#u("InnerJoin",a)}leftJoin(...a){return this.#u("LeftJoin",a)}rightJoin(...a){return this.#u("RightJoin",a)}fullJoin(...a){return this.#u("FullJoin",a)}#u(a,b){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithJoin(this.#q.queryNode,aR(a,b))})}orderBy(...a){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithOrderByItems(this.#q.queryNode,y(a))})}clearOrderBy(){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithoutOrderBy(this.#q.queryNode)})}limit(a){return new ar({...this.#q,queryNode:ap.UpdateQueryNode.cloneWithLimit(this.#q.queryNode,an.create((0,T.parseValueExpression)(a)))})}set(...a){return new ar({...this.#q,queryNode:ap.UpdateQueryNode.cloneWithUpdates(this.#q.queryNode,function(...a){return 2===a.length?[Y.create(bA(a[0]),(0,T.parseValueExpression)(a[1]))]:Z(a[0])}(...a))})}returning(a){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,N(a))})}returningAll(a){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,P(a))})}output(a){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,N(a))})}outputAll(a){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,P(a))})}modifyEnd(a){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,a.toOperationNode())})}clearReturning(){return new ar({...this.#q,queryNode:r.QueryNode.cloneWithoutReturning(this.#q.queryNode)})}$call(a){return a(this)}$if(a,b){return a?b(this):new ar({...this.#q})}$castTo(){return new ar(this.#q)}$narrowType(){return new ar(this.#q)}$assertType(){return new ar(this.#q)}withPlugin(a){return new ar({...this.#q,executor:this.#q.executor.withPlugin(a)})}toOperationNode(){return this.#q.executor.transformQuery(this.#q.queryNode,this.#q.queryId)}compile(){return this.#q.executor.compileQuery(this.toOperationNode(),this.#q.queryId)}async execute(){let a=this.compile(),b=await this.#q.executor.executeQuery(a),{adapter:c}=this.#q.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new aq(b.numAffectedRows??BigInt(0),b.numChangedRows)]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=aa){let b=await this.executeTakeFirst();if(void 0===b)throw ab(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#q.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new ar({...this.#q,queryNode:r.QueryNode.cloneWithExplain(this.#q.queryNode,a,b)});return await c.execute()}}let as=(0,j.freeze)({is:a=>"CommonTableExpressionNameNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"CommonTableExpressionNameNode",table:i.TableNode.create(a),columns:b?(0,j.freeze)(b.map(g.ColumnNode.create)):void 0})}),at=(0,j.freeze)({is:a=>"CommonTableExpressionNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"CommonTableExpressionNode",name:a,expression:b}),cloneWith:(a,b)=>(0,j.freeze)({...a,...b})});class au{#q;constructor(a){this.#q=(0,j.freeze)(a)}materialized(){return new au({...this.#q,node:at.cloneWith(this.#q.node,{materialized:!0})})}notMaterialized(){return new au({...this.#q,node:at.cloneWith(this.#q.node,{materialized:!1})})}toOperationNode(){return this.#q.node}}function av(a,b){var c;let d=b(new aQ({executor:aK})).toOperationNode();return(0,j.isFunction)(a)?a((c=d,a=>new au({node:at.create(aw(a),c)}))).toOperationNode():at.create(aw(a),d)}function aw(a){if(!a.includes("("))return as.create(a);{let b=a.split(/[\(\)]/),c=b[0],d=b[1].split(",").map(a=>a.trim());return as.create(c,d)}}let ax=(0,j.freeze)({is:a=>"WithNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"WithNode",expressions:(0,j.freeze)([a]),...b}),cloneWithExpression:(a,b)=>(0,j.freeze)({...a,expressions:(0,j.freeze)([...a.expressions,b])})});var ay=a.i(613344),az=a.i(185545),aA=a.i(737193);let aB=(0,j.freeze)({is:a=>"MatchedNode"===a.kind,create:(a,b=!1)=>(0,j.freeze)({kind:"MatchedNode",not:a,bySource:b})});var aC=a.i(899297);function aD(a,b,c){return aC.WhenNode.create((0,n.parseFilterList)([aB.create(!a.isMatched,a.bySource),...b&&b.length>0?[3===b.length&&c?(0,n.parseReferentialBinaryOperation)(b[0],b[1],b[2]):(0,n.parseValueBinaryOperationOrExpression)(b)]:[]],"and",!1))}function aE(a){return(0,j.isString)(a)?d.RawNode.create([a],[]):(0,c.isOperationNodeSource)(a)?a.toOperationNode():a}class aF{#v;#w;#x;constructor(){this.#v=new Promise((a,b)=>{this.#x=b,this.#w=a})}get promise(){return this.#v}resolve=a=>{this.#w&&this.#w(a)};reject=a=>{this.#x&&this.#x(a)}}async function aG(a){let b=new aF,c=new aF;return a.provideConnection(async a=>(b.resolve(a),await c.promise)).catch(a=>b.reject(a)),(0,j.freeze)({connection:await b.promise,release:c.resolve})}a.s(["Deferred",()=>aF],270557),a.s(["provideControlledConnection",()=>aG],885184);let aH=(0,j.freeze)([]);class aI{#y;constructor(a=aH){this.#y=a}get plugins(){return this.#y}transformQuery(a,b){for(let c of this.#y){let d=c.transformQuery({node:a,queryId:b});if(d.kind===a.kind)a=d;else throw Error(`KyselyPlugin.transformQuery must return a node of the same kind that was given to it. The plugin was given a ${a.kind} but it returned a ${d.kind}`)}return a}async executeQuery(a){return await this.provideConnection(async b=>{let c=await b.executeQuery(a);return"numUpdatedOrDeletedRows"in c&&(0,w.logOnce)("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`."),await this.#z(c,a.queryId)})}async *stream(a,b){let{connection:c,release:d}=await aG(this);try{for await(let d of c.streamQuery(a,b))yield await this.#z(d,a.queryId)}finally{d()}}async #z(a,b){for(let c of this.#y)a=await c.transformResult({result:a,queryId:b});return a}}a.s(["QueryExecutorBase",()=>aI],406271);class aJ extends aI{get adapter(){throw Error("this query cannot be compiled to SQL")}compileQuery(){throw Error("this query cannot be compiled to SQL")}provideConnection(){throw Error("this query cannot be executed")}withConnectionProvider(){throw Error("this query cannot have a connection provider")}withPlugin(a){return new aJ([...this.plugins,a])}withPlugins(a){return new aJ([...this.plugins,...a])}withPluginAtFront(a){return new aJ([a,...this.plugins])}withoutPlugins(){return new aJ([])}}let aK=new aJ;class aL{numChangedRows;constructor(a){this.numChangedRows=a}}class aM{#q;constructor(a){this.#q=(0,j.freeze)(a)}modifyEnd(a){return new aM({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,a.toOperationNode())})}top(a,b){return new aM({...this.#q,queryNode:r.QueryNode.cloneWithTop(this.#q.queryNode,ai(a,b))})}using(...a){return new aN({...this.#q,queryNode:aA.MergeQueryNode.cloneWithUsing(this.#q.queryNode,aR("Using",a))})}returning(a){return new aM({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,N(a))})}returningAll(a){return new aM({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,P(a))})}output(a){return new aM({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,N(a))})}outputAll(a){return new aM({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,P(a))})}}class aN{#q;constructor(a){this.#q=(0,j.freeze)(a)}modifyEnd(a){return new aN({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,a.toOperationNode())})}top(a,b){return new aN({...this.#q,queryNode:r.QueryNode.cloneWithTop(this.#q.queryNode,ai(a,b))})}whenMatched(){return this.#A([])}whenMatchedAnd(...a){return this.#A(a)}whenMatchedAndRef(a,b,c){return this.#A([a,b,c],!0)}#A(a,b){return new aO({...this.#q,queryNode:aA.MergeQueryNode.cloneWithWhen(this.#q.queryNode,aD({isMatched:!0},a,b))})}whenNotMatched(){return this.#B([])}whenNotMatchedAnd(...a){return this.#B(a)}whenNotMatchedAndRef(a,b,c){return this.#B([a,b,c],!0)}whenNotMatchedBySource(){return this.#B([],!1,!0)}whenNotMatchedBySourceAnd(...a){return this.#B(a,!1,!0)}whenNotMatchedBySourceAndRef(a,b,c){return this.#B([a,b,c],!0,!0)}returning(a){return new aN({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,N(a))})}returningAll(a){return new aN({...this.#q,queryNode:r.QueryNode.cloneWithReturning(this.#q.queryNode,P(a))})}output(a){return new aN({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,N(a))})}outputAll(a){return new aN({...this.#q,queryNode:r.QueryNode.cloneWithOutput(this.#q.queryNode,P(a))})}#B(a,b=!1,c=!1){let d={...this.#q,queryNode:aA.MergeQueryNode.cloneWithWhen(this.#q.queryNode,aD({isMatched:!1,bySource:c},a,b))};return new(c?aO:aP)(d)}$call(a){return a(this)}$if(a,b){return a?b(this):new aN({...this.#q})}toOperationNode(){return this.#q.executor.transformQuery(this.#q.queryNode,this.#q.queryId)}compile(){return this.#q.executor.compileQuery(this.toOperationNode(),this.#q.queryId)}async execute(){let a=this.compile(),b=await this.#q.executor.executeQuery(a),{adapter:c}=this.#q.executor,d=a.query;return d.returning&&c.supportsReturning||d.output&&c.supportsOutput?b.rows:[new aL(b.numAffectedRows)]}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=aa){let b=await this.executeTakeFirst();if(void 0===b)throw ab(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}}class aO{#q;constructor(a){this.#q=(0,j.freeze)(a)}thenDelete(){return new aN({...this.#q,queryNode:aA.MergeQueryNode.cloneWithThen(this.#q.queryNode,aE("delete"))})}thenDoNothing(){return new aN({...this.#q,queryNode:aA.MergeQueryNode.cloneWithThen(this.#q.queryNode,aE("do nothing"))})}thenUpdate(a){return new aN({...this.#q,queryNode:aA.MergeQueryNode.cloneWithThen(this.#q.queryNode,aE(a(new ar({queryId:this.#q.queryId,executor:aK,queryNode:ap.UpdateQueryNode.createWithoutTable()}))))})}thenUpdateSet(...a){return this.thenUpdate(b=>b.set(...a))}}class aP{#q;constructor(a){this.#q=(0,j.freeze)(a)}thenDoNothing(){return new aN({...this.#q,queryNode:aA.MergeQueryNode.cloneWithThen(this.#q.queryNode,aE("do nothing"))})}thenInsertValues(a){let[b,c]=W(a);return new aN({...this.#q,queryNode:aA.MergeQueryNode.cloneWithThen(this.#q.queryNode,aE(X.InsertQueryNode.cloneWith(X.InsertQueryNode.createWithoutInto(),{columns:b,values:c})))})}}class aQ{#q;constructor(a){this.#q=(0,j.freeze)(a)}selectFrom(a){return new a1({queryId:(0,ay.createQueryId)(),executor:this.#q.executor,queryNode:p.SelectQueryNode.createFrom(I(a),this.#q.withNode)})}selectNoFrom(a){return new a1({queryId:(0,ay.createQueryId)(),executor:this.#q.executor,queryNode:p.SelectQueryNode.cloneWithSelections(p.SelectQueryNode.create(this.#q.withNode),N(a))})}insertInto(a){return new ak({queryId:(0,ay.createQueryId)(),executor:this.#q.executor,queryNode:X.InsertQueryNode.create(L(a),this.#q.withNode)})}replaceInto(a){return new ak({queryId:(0,ay.createQueryId)(),executor:this.#q.executor,queryNode:X.InsertQueryNode.create(L(a),this.#q.withNode,!0)})}deleteFrom(a){return new ao({queryId:(0,ay.createQueryId)(),executor:this.#q.executor,queryNode:am.DeleteQueryNode.create(I(a),this.#q.withNode)})}updateTable(a){return new ar({queryId:(0,ay.createQueryId)(),executor:this.#q.executor,queryNode:ap.UpdateQueryNode.create(I(a),this.#q.withNode)})}mergeInto(a){return new aM({queryId:(0,ay.createQueryId)(),executor:this.#q.executor,queryNode:aA.MergeQueryNode.create(K(a),this.#q.withNode)})}with(a,b){let c=av(a,b);return new aQ({...this.#q,withNode:this.#q.withNode?ax.cloneWithExpression(this.#q.withNode,c):ax.create(c)})}withRecursive(a,b){let c=av(a,b);return new aQ({...this.#q,withNode:this.#q.withNode?ax.cloneWithExpression(this.#q.withNode,c):ax.create(c,{recursive:!0})})}withPlugin(a){return new aQ({...this.#q,executor:this.#q.executor.withPlugin(a)})}withoutPlugins(){return new aQ({...this.#q,executor:this.#q.executor.withoutPlugins()})}withSchema(a){return new aQ({...this.#q,executor:this.#q.executor.withPluginAtFront(new az.WithSchemaPlugin(a))})}}function aR(a,b){var c,d,e,f,g,h;if(3===b.length){return c=a,d=b[0],e=b[1],f=b[2],m.JoinNode.createWithOn(c,J(d),(0,n.parseReferentialBinaryOperation)(e,"=",f))}if(2===b.length)return function(a,b,c){return c(new q({joinNode:m.JoinNode.create(a,J(b))})).toOperationNode()}(a,b[0],b[1]);if(1===b.length){return g=a,h=b[0],m.JoinNode.create(g,J(h))}throw Error("not implemented")}let aS=(0,j.freeze)({is:a=>"OffsetNode"===a.kind,create:a=>(0,j.freeze)({kind:"OffsetNode",offset:a})}),aT=(0,j.freeze)({is:a=>"GroupByItemNode"===a.kind,create:a=>(0,j.freeze)({kind:"GroupByItemNode",groupBy:a})});var aU=a.i(783005);function aV(a,b,c){return(0,j.isFunction)(b)&&(b=b(bu())),(0,j.isReadonlyArray)(b)||(b=[b]),b.map(b=>aU.SetOperationNode.create(a,bv(b),c))}var aW=a.i(651861),aX=a.i(25283),aY=a.i(477804);class aZ{#C;constructor(a){this.#C=a}get expressionType(){}as(a){return new a$(this,a)}or(...a){return new a_(aX.OrNode.create(this.#C,(0,n.parseValueBinaryOperationOrExpression)(a)))}and(...a){return new a0(aW.AndNode.create(this.#C,(0,n.parseValueBinaryOperationOrExpression)(a)))}$castTo(){return new aZ(this.#C)}$notNull(){return new aZ(this.#C)}toOperationNode(){return this.#C}}class a${#D;#t;constructor(a,b){this.#D=a,this.#t=b}get expression(){return this.#D}get alias(){return this.#t}toOperationNode(){return f.AliasNode.create(this.#D.toOperationNode(),(0,c.isOperationNodeSource)(this.#t)?this.#t.toOperationNode():b.IdentifierNode.create(this.#t))}}class a_{#C;constructor(a){this.#C=a}get expressionType(){}as(a){return new a$(this,a)}or(...a){return new a_(aX.OrNode.create(this.#C,(0,n.parseValueBinaryOperationOrExpression)(a)))}$castTo(){return new a_(this.#C)}toOperationNode(){return aY.ParensNode.create(this.#C)}}class a0{#C;constructor(a){this.#C=a}get expressionType(){}as(a){return new a$(this,a)}and(...a){return new a0(aW.AndNode.create(this.#C,(0,n.parseValueBinaryOperationOrExpression)(a)))}$castTo(){return new a0(this.#C)}toOperationNode(){return aY.ParensNode.create(this.#C)}}class a1{#q;constructor(a){this.#q=(0,j.freeze)(a)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...a){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithWhere(this.#q.queryNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}whereRef(a,b,c){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithWhere(this.#q.queryNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}having(...a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithHaving(this.#q.queryNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}havingRef(a,b,c){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithHaving(this.#q.queryNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}select(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSelections(this.#q.queryNode,N(a))})}distinctOn(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithDistinctOn(this.#q.queryNode,bz(a))})}modifyFront(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithFrontModifier(this.#q.queryNode,l.SelectModifierNode.createWithExpression(a.toOperationNode()))})}modifyEnd(a){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,l.SelectModifierNode.createWithExpression(a.toOperationNode()))})}distinct(){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithFrontModifier(this.#q.queryNode,l.SelectModifierNode.create("Distinct"))})}forUpdate(a){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,l.SelectModifierNode.create("ForUpdate",a?(0,j.asArray)(a).map(L):void 0))})}forShare(a){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,l.SelectModifierNode.create("ForShare",a?(0,j.asArray)(a).map(L):void 0))})}forKeyShare(a){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,l.SelectModifierNode.create("ForKeyShare",a?(0,j.asArray)(a).map(L):void 0))})}forNoKeyUpdate(a){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,l.SelectModifierNode.create("ForNoKeyUpdate",a?(0,j.asArray)(a).map(L):void 0))})}skipLocked(){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,l.SelectModifierNode.create("SkipLocked"))})}noWait(){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithEndModifier(this.#q.queryNode,l.SelectModifierNode.create("NoWait"))})}selectAll(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSelections(this.#q.queryNode,P(a))})}innerJoin(...a){return this.#u("InnerJoin",a)}leftJoin(...a){return this.#u("LeftJoin",a)}rightJoin(...a){return this.#u("RightJoin",a)}fullJoin(...a){return this.#u("FullJoin",a)}crossJoin(...a){return this.#u("CrossJoin",a)}innerJoinLateral(...a){return this.#u("LateralInnerJoin",a)}leftJoinLateral(...a){return this.#u("LateralLeftJoin",a)}crossJoinLateral(...a){return this.#u("LateralCrossJoin",a)}crossApply(...a){return this.#u("CrossApply",a)}outerApply(...a){return this.#u("OuterApply",a)}#u(a,b){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithJoin(this.#q.queryNode,aR(a,b))})}orderBy(...a){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithOrderByItems(this.#q.queryNode,y(a))})}groupBy(a){var b;return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithGroupByItems(this.#q.queryNode,(b=a,bz(b=(0,j.isFunction)(b)?b(bu()):b).map(aT.create)))})}limit(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithLimit(this.#q.queryNode,an.create((0,T.parseValueExpression)(a)))})}offset(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithOffset(this.#q.queryNode,aS.create((0,T.parseValueExpression)(a)))})}fetch(a,b="only"){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithFetch(this.#q.queryNode,function(a,b){var c;let d,f;if(!(0,j.isNumber)(a)&&!(0,j.isBigInt)(a))throw Error(`Invalid fetch row count: ${a}`);if("only"!==(c=b)&&"with ties"!==c)throw Error(`Invalid fetch modifier: ${b}`);return d=a,f=b,{kind:"FetchNode",rowCount:e.ValueNode.create(d),modifier:f}}(a,b))})}top(a,b){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithTop(this.#q.queryNode,ai(a,b))})}union(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSetOperations(this.#q.queryNode,aV("union",a,!1))})}unionAll(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSetOperations(this.#q.queryNode,aV("union",a,!0))})}intersect(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSetOperations(this.#q.queryNode,aV("intersect",a,!1))})}intersectAll(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSetOperations(this.#q.queryNode,aV("intersect",a,!0))})}except(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSetOperations(this.#q.queryNode,aV("except",a,!1))})}exceptAll(a){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithSetOperations(this.#q.queryNode,aV("except",a,!0))})}as(a){return new a2(this,a)}clearSelect(){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithoutSelections(this.#q.queryNode)})}clearWhere(){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithoutWhere(this.#q.queryNode)})}clearLimit(){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithoutLimit(this.#q.queryNode)})}clearOffset(){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithoutOffset(this.#q.queryNode)})}clearOrderBy(){return new a1({...this.#q,queryNode:r.QueryNode.cloneWithoutOrderBy(this.#q.queryNode)})}clearGroupBy(){return new a1({...this.#q,queryNode:p.SelectQueryNode.cloneWithoutGroupBy(this.#q.queryNode)})}$call(a){return a(this)}$if(a,b){return a?b(this):new a1({...this.#q})}$castTo(){return new a1(this.#q)}$narrowType(){return new a1(this.#q)}$assertType(){return new a1(this.#q)}$asTuple(){return new aZ(this.toOperationNode())}$asScalar(){return new aZ(this.toOperationNode())}withPlugin(a){return new a1({...this.#q,executor:this.#q.executor.withPlugin(a)})}toOperationNode(){return this.#q.executor.transformQuery(this.#q.queryNode,this.#q.queryId)}compile(){return this.#q.executor.compileQuery(this.toOperationNode(),this.#q.queryId)}async execute(){let a=this.compile();return(await this.#q.executor.executeQuery(a)).rows}async executeTakeFirst(){let[a]=await this.execute();return a}async executeTakeFirstOrThrow(a=aa){let b=await this.executeTakeFirst();if(void 0===b)throw ab(a)?new a(this.toOperationNode()):a(this.toOperationNode());return b}async *stream(a=100){let b=this.compile();for await(let c of this.#q.executor.stream(b,a))yield*c.rows}async explain(a,b){let c=new a1({...this.#q,queryNode:r.QueryNode.cloneWithExplain(this.#q.queryNode,a,b)});return await c.execute()}}class a2{#E;#t;constructor(a,b){this.#E=a,this.#t=b}get expression(){return this.#E}get alias(){return this.#t}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return f.AliasNode.create(this.#E.toOperationNode(),b.IdentifierNode.create(this.#t))}}a.s(["createFunctionModule",()=>a8],737327);var a3=a.i(78606);let a4=(0,j.freeze)({is:a=>"AggregateFunctionNode"===a.kind,create:(a,b=[])=>(0,j.freeze)({kind:"AggregateFunctionNode",func:a,aggregated:b}),cloneWithDistinct:a=>(0,j.freeze)({...a,distinct:!0}),cloneWithOrderBy(a,b,c=!1){let d=c?"withinGroup":"orderBy";return(0,j.freeze)({...a,[d]:a[d]?a3.OrderByNode.cloneWithItems(a[d],b):a3.OrderByNode.create(b)})},cloneWithFilter:(a,b)=>(0,j.freeze)({...a,filter:a.filter?ac.WhereNode.cloneWithOperation(a.filter,"And",b):ac.WhereNode.create(b)}),cloneWithOrFilter:(a,b)=>(0,j.freeze)({...a,filter:a.filter?ac.WhereNode.cloneWithOperation(a.filter,"Or",b):ac.WhereNode.create(b)}),cloneWithOver:(a,b)=>(0,j.freeze)({...a,over:b})}),a5=(0,j.freeze)({is:a=>"FunctionNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"FunctionNode",func:a,arguments:b})});class a6{#q;constructor(a){this.#q=(0,j.freeze)(a)}get expressionType(){}as(a){return new a7(this,a)}distinct(){return new a6({...this.#q,aggregateFunctionNode:a4.cloneWithDistinct(this.#q.aggregateFunctionNode)})}orderBy(...a){return new a6({...this.#q,aggregateFunctionNode:r.QueryNode.cloneWithOrderByItems(this.#q.aggregateFunctionNode,y(a))})}clearOrderBy(){return new a6({...this.#q,aggregateFunctionNode:r.QueryNode.cloneWithoutOrderBy(this.#q.aggregateFunctionNode)})}withinGroupOrderBy(...a){return new a6({...this.#q,aggregateFunctionNode:a4.cloneWithOrderBy(this.#q.aggregateFunctionNode,y(a),!0)})}filterWhere(...a){return new a6({...this.#q,aggregateFunctionNode:a4.cloneWithFilter(this.#q.aggregateFunctionNode,(0,n.parseValueBinaryOperationOrExpression)(a))})}filterWhereRef(a,b,c){return new a6({...this.#q,aggregateFunctionNode:a4.cloneWithFilter(this.#q.aggregateFunctionNode,(0,n.parseReferentialBinaryOperation)(a,b,c))})}over(a){let b=new C({overNode:o.OverNode.create()});return new a6({...this.#q,aggregateFunctionNode:a4.cloneWithOver(this.#q.aggregateFunctionNode,(a?a(b):b).toOperationNode())})}$call(a){return a(this)}$castTo(){return new a6(this.#q)}$notNull(){return new a6(this.#q)}toOperationNode(){return this.#q.aggregateFunctionNode}}class a7{#F;#t;constructor(a,b){this.#F=a,this.#t=b}get expression(){return this.#F}get alias(){return this.#t}toOperationNode(){return f.AliasNode.create(this.#F.toOperationNode(),b.IdentifierNode.create(this.#t))}}function a8(){let a=(a,b)=>new aZ(a5.create(a,bz(b??[]))),b=(a,b)=>new a6({aggregateFunctionNode:a4.create(a,b?bz(b):void 0)});return Object.assign(a,{agg:b,avg:a=>b("avg",[a]),coalesce:(...b)=>a("coalesce",b),count:a=>b("count",[a]),countAll:a=>new a6({aggregateFunctionNode:a4.create("count",P(a))}),max:a=>b("max",[a]),min:a=>b("min",[a]),sum:a=>b("sum",[a]),any:b=>a("any",[b]),jsonAgg:a=>new a6({aggregateFunctionNode:a4.create("json_agg",[(0,j.isString)(a)?L(a):a.toOperationNode()])}),toJson:a=>new aZ(a5.create("to_json",[(0,j.isString)(a)?L(a):a.toOperationNode()]))})}var a9=a.i(713123);let ba=(0,j.freeze)({is:a=>"UnaryOperationNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"UnaryOperationNode",operator:a,operand:b})});a.s(["CaseBuilder",()=>bc],552817);let bb=(0,j.freeze)({is:a=>"CaseNode"===a.kind,create:a=>(0,j.freeze)({kind:"CaseNode",value:a}),cloneWithWhen:(a,b)=>(0,j.freeze)({...a,when:(0,j.freeze)(a.when?[...a.when,b]:[b])}),cloneWithThen:(a,b)=>(0,j.freeze)({...a,when:a.when?(0,j.freeze)([...a.when.slice(0,-1),aC.WhenNode.cloneWithResult(a.when[a.when.length-1],b)]):void 0}),cloneWith:(a,b)=>(0,j.freeze)({...a,...b})});a.s(["CaseNode",0,bb],273664);class bc{#q;constructor(a){this.#q=(0,j.freeze)(a)}when(...a){return new bd({...this.#q,node:bb.cloneWithWhen(this.#q.node,aC.WhenNode.create((0,n.parseValueBinaryOperationOrExpression)(a)))})}}class bd{#q;constructor(a){this.#q=(0,j.freeze)(a)}then(a){return new be({...this.#q,node:bb.cloneWithThen(this.#q.node,(0,T.isSafeImmediateValue)(a)?(0,T.parseSafeImmediateValue)(a):(0,T.parseValueExpression)(a))})}}class be{#q;constructor(a){this.#q=(0,j.freeze)(a)}when(...a){return new bd({...this.#q,node:bb.cloneWithWhen(this.#q.node,aC.WhenNode.create((0,n.parseValueBinaryOperationOrExpression)(a)))})}else(a){return new bf({...this.#q,node:bb.cloneWith(this.#q.node,{else:(0,T.isSafeImmediateValue)(a)?(0,T.parseSafeImmediateValue)(a):(0,T.parseValueExpression)(a)})})}end(){return new aZ(bb.cloneWith(this.#q.node,{isStatement:!1}))}endCase(){return new aZ(bb.cloneWith(this.#q.node,{isStatement:!0}))}}class bf{#q;constructor(a){this.#q=(0,j.freeze)(a)}end(){return new aZ(bb.cloneWith(this.#q.node,{isStatement:!1}))}endCase(){return new aZ(bb.cloneWith(this.#q.node,{isStatement:!0}))}}let bg=(0,j.freeze)({is:a=>"JSONOperatorChainNode"===a.kind,create:a=>(0,j.freeze)({kind:"JSONOperatorChainNode",operator:a,values:(0,j.freeze)([])}),cloneWithValue:(a,b)=>(0,j.freeze)({...a,values:(0,j.freeze)([...a.values,b])})}),bh=(0,j.freeze)({is:a=>"JSONPathLegNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"JSONPathLegNode",type:a,value:b})}),bi=(0,j.freeze)({is:a=>"JSONPathNode"===a.kind,create:a=>(0,j.freeze)({kind:"JSONPathNode",inOperator:a,pathLegs:(0,j.freeze)([])}),cloneWithLeg:(a,b)=>(0,j.freeze)({...a,pathLegs:(0,j.freeze)([...a.pathLegs,b])})}),bj=(0,j.freeze)({is:a=>"JSONReferenceNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"JSONReferenceNode",reference:a,traversal:b}),cloneWithTraversal:(a,b)=>(0,j.freeze)({...a,traversal:b})});class bk{#C;constructor(a){this.#C=a}at(a){return this.#G("ArrayLocation",a)}key(a){return this.#G("Member",a)}#G(a,b){return new bl(bj.is(this.#C)?bj.cloneWithTraversal(this.#C,bi.is(this.#C.traversal)?bi.cloneWithLeg(this.#C.traversal,bh.create(a,b)):bg.cloneWithValue(this.#C.traversal,e.ValueNode.createImmediate(b))):bi.cloneWithLeg(this.#C,bh.create(a,b)))}}class bl extends bk{#C;constructor(a){super(a),this.#C=a}get expressionType(){}as(a){return new bm(this,a)}$castTo(){return new bl(this.#C)}$notNull(){return new bl(this.#C)}toOperationNode(){return this.#C}}class bm{#H;#t;constructor(a,b){this.#H=a,this.#t=b}get expression(){return this.#H}get alias(){return this.#t}toOperationNode(){return f.AliasNode.create(this.#H.toOperationNode(),(0,c.isOperationNodeSource)(this.#t)?this.#t.toOperationNode():b.IdentifierNode.create(this.#t))}}var bn=a.i(544447);let bo=(0,j.freeze)({is:a=>"TupleNode"===a.kind,create:a=>(0,j.freeze)({kind:"TupleNode",values:(0,j.freeze)(a)})}),bp=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],bq=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],br=(0,j.freeze)({is:a=>"DataTypeNode"===a.kind,create:a=>(0,j.freeze)({kind:"DataTypeNode",dataType:a})});function bs(a){if((0,c.isOperationNodeSource)(a))return a.toOperationNode();if(bp.includes(a)||bq.some(b=>b.test(a)))return br.create(a);throw Error(`invalid column data type ${JSON.stringify(a)}`)}a.s(["parseDataTypeExpression",()=>bs],9582);let bt=(0,j.freeze)({is:a=>"CastNode"===a.kind,create:(a,b)=>(0,j.freeze)({kind:"CastNode",expression:a,dataType:b})});function bu(a=aK){function b(a,b){return new aZ(ba.create(a9.OperatorNode.create(a),bA(b)))}let c=Object.assign(function(a,b,c){return new aZ((0,n.parseValueBinaryOperation)(a,b,c))},{fn:void 0,eb:void 0,selectFrom:b=>new a1({queryId:(0,ay.createQueryId)(),executor:a,queryNode:p.SelectQueryNode.createFrom(I(b))}),case:a=>new bc({node:bb.create((0,j.isUndefined)(a)?void 0:bA(a))}),ref:(a,b)=>(0,j.isUndefined)(b)?new aZ(bC(a)):new bk(bB(a,b)),jsonPath:()=>new bk(bi.create()),table:a=>new aZ(L(a)),val:a=>new aZ((0,T.parseValueExpression)(a)),refTuple:(...a)=>new aZ(bo.create(a.map(bA))),tuple:(...a)=>new aZ(bo.create(a.map(T.parseValueExpression))),lit:a=>new aZ((0,T.parseSafeImmediateValue)(a)),unary:b,not:a=>b("not",a),exists:a=>b("exists",a),neg:a=>b("-",a),between:(a,b,c)=>new aZ(bn.BinaryOperationNode.create(bA(a),a9.OperatorNode.create("between"),aW.AndNode.create((0,T.parseValueExpression)(b),(0,T.parseValueExpression)(c)))),betweenSymmetric:(a,b,c)=>new aZ(bn.BinaryOperationNode.create(bA(a),a9.OperatorNode.create("between symmetric"),aW.AndNode.create((0,T.parseValueExpression)(b),(0,T.parseValueExpression)(c)))),and:a=>new aZ((0,j.isReadonlyArray)(a)?(0,n.parseFilterList)(a,"and"):(0,n.parseFilterObject)(a,"and")),or:a=>new aZ((0,j.isReadonlyArray)(a)?(0,n.parseFilterList)(a,"or"):(0,n.parseFilterObject)(a,"or")),parens(...a){let b=(0,n.parseValueBinaryOperationOrExpression)(a);return new aZ(aY.ParensNode.is(b)?b:aY.ParensNode.create(b))},cast:(a,b)=>new aZ(bt.create(bA(a),bs(b))),withSchema:b=>bu(a.withPluginAtFront(new az.WithSchemaPlugin(b)))});return c.fn=a8(),c.eb=c,c}function bv(a){if((0,c.isOperationNodeSource)(a))return a.toOperationNode();if((0,j.isFunction)(a))return a(bu()).toOperationNode();throw Error(`invalid expression: ${JSON.stringify(a)}`)}function bw(a){if((0,c.isOperationNodeSource)(a))return a.toOperationNode();if((0,j.isFunction)(a))return a(bu()).toOperationNode();throw Error(`invalid aliased expression: ${JSON.stringify(a)}`)}function bx(a){return(0,k.isExpression)(a)||(0,k.isAliasedExpression)(a)||(0,j.isFunction)(a)}function by(a){return(0,j.isString)(a)?bC(a):a.toOperationNode()}function bz(a){return(0,j.isReadonlyArray)(a)?a.map(a=>bA(a)):[bA(a)]}function bA(a){return bx(a)?bv(a):by(a)}function bB(a,b){let c=bC(a);if((0,a9.isJSONOperator)(b))return bj.create(c,bg.create(a9.OperatorNode.create(b)));let d=b.slice(0,-1);if((0,a9.isJSONOperator)(d))return bj.create(c,bi.create(a9.OperatorNode.create(d)));throw Error(`Invalid JSON operator: ${b}`)}function bC(a){if(!a.includes("."))return h.ReferenceNode.create(g.ColumnNode.create(a));let b=a.split(".").map(bG);if(3===b.length)return function(a){let[b,c,d]=a;return h.ReferenceNode.create(g.ColumnNode.create(d),i.TableNode.createWithSchema(b,c))}(b);if(2===b.length)return function(a){let[b,c]=a;return h.ReferenceNode.create(g.ColumnNode.create(c),i.TableNode.create(b))}(b);throw Error(`invalid column reference ${a}`)}function bD(a){let c=" as ";if(!a.includes(c))return bC(a);{let[d,e]=a.split(c).map(bG);return f.AliasNode.create(bC(d),b.IdentifierNode.create(e))}}function bE(a){return g.ColumnNode.create(a)}function bF(a){if(!a.includes(" "))return bE(a);{let[b,c]=a.split(" ").map(bG);if(!x(c))throw Error(`invalid order direction "${c}" next to "${b}"`);return y([b,c])[0]}}function bG(a){return a.trim()}class bH{#q;constructor(a){this.#q=(0,j.freeze)(a)}get expressionType(){}get isRawBuilder(){return!0}as(a){return new bJ(this,a)}$castTo(){return new bH({...this.#q})}$notNull(){return new bH(this.#q)}withPlugin(a){return new bH({...this.#q,plugins:void 0!==this.#q.plugins?(0,j.freeze)([...this.#q.plugins,a]):(0,j.freeze)([a])})}toOperationNode(){return this.#I(this.#J())}compile(a){return this.#K(this.#J(a))}async execute(a){let b=this.#J(a);return b.executeQuery(this.#K(b))}#J(a){let b=void 0!==a?a.getExecutor():aK;return void 0!==this.#q.plugins?b.withPlugins(this.#q.plugins):b}#I(a){return a.transformQuery(this.#q.rawNode,this.#q.queryId)}#K(a){return a.compileQuery(this.#I(a),this.#q.queryId)}}function bI(a){return new bH(a)}class bJ{#L;#t;constructor(a,b){this.#L=a,this.#t=b}get expression(){return this.#L}get alias(){return this.#t}get rawBuilder(){return this.#L}toOperationNode(){return f.AliasNode.create(this.#L.toOperationNode(),(0,c.isOperationNodeSource)(this.#t)?this.#t.toOperationNode():b.IdentifierNode.create(this.#t))}}let bK=Object.assign((a,...b)=>bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.create(a,b?.map(bL)??[])}),{ref:a=>bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.createWithChild(bC(a))}),val:a=>bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.createWithChild((0,T.parseValueExpression)(a))}),value(a){return this.val(a)},table:a=>bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.createWithChild(L(a))}),id(...a){let c=Array(a.length+1).fill(".");return c[0]="",c[c.length-1]="",bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.create(c,a.map(b.IdentifierNode.create))})},lit:a=>bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.createWithChild(e.ValueNode.createImmediate(a))}),literal(a){return this.lit(a)},raw:a=>bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.createWithSql(a)}),join(a,b=bK`, `){let c=Array(Math.max(2*a.length-1,0)),e=b.toOperationNode();for(let b=0;b<a.length;++b)c[2*b]=bL(a[b]),b!==a.length-1&&(c[2*b+1]=e);return bI({queryId:(0,ay.createQueryId)(),rawNode:d.RawNode.createWithChildren(c)})}});function bL(a){return(0,c.isOperationNodeSource)(a)?a.toOperationNode():(0,T.parseValueExpression)(a)}a.s(["sql",0,bK],919560)}];

//# sourceMappingURL=node_modules_kysely_dist_esm_2e8d9acd._.js.map