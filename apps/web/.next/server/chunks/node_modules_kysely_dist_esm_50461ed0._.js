module.exports=[459094,e=>{"use strict";function t(e){return void 0===e||void 0===e}function i(e){return"string"==typeof e}function r(e){return"number"==typeof e}function o(e){return"boolean"==typeof e}function s(e){return null===e}function n(e){return e instanceof Date}function a(e){return"bigint"==typeof e}function d(e){return"undefined"!=typeof Buffer&&Buffer.isBuffer(e)}function p(e){return"function"==typeof e}function h(e){return"object"==typeof e&&null!==e}function u(e){return e[e.length-1]}function l(e){return Object.freeze(e)}function c(e){return N(e)?e:[e]}function N(e){return Array.isArray(e)}function f(e){return e}Object.prototype.toString,e.s(["asArray",()=>c,"freeze",()=>l,"getLast",()=>u,"isBigInt",()=>a,"isBoolean",()=>o,"isBuffer",()=>d,"isDate",()=>n,"isFunction",()=>p,"isNull",()=>s,"isNumber",()=>r,"isObject",()=>h,"isReadonlyArray",()=>N,"isString",()=>i,"isUndefined",()=>t,"noop",()=>f])},490870,466065,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"FromNode"===e.kind,create:e=>(0,t.freeze)({kind:"FromNode",froms:(0,t.freeze)(e)}),cloneWithFroms:(e,i)=>(0,t.freeze)({...e,froms:(0,t.freeze)([...e.froms,...i])})});e.s(["FromNode",0,i],490870);let r=(0,t.freeze)({is:e=>"GroupByNode"===e.kind,create:e=>(0,t.freeze)({kind:"GroupByNode",items:(0,t.freeze)(e)}),cloneWithItems:(e,i)=>(0,t.freeze)({...e,items:(0,t.freeze)([...e.items,...i])})});e.s(["GroupByNode",0,r],466065)},9445,816032,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"AndNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"AndNode",left:e,right:i})});e.s(["AndNode",0,i],9445);let r=(0,t.freeze)({is:e=>"OrNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"OrNode",left:e,right:i})});e.s(["OrNode",0,r],816032)},657878,e=>{"use strict";var t=e.i(459094),i=e.i(9445),r=e.i(816032);let o=(0,t.freeze)({is:e=>"HavingNode"===e.kind,create:e=>(0,t.freeze)({kind:"HavingNode",having:e}),cloneWithOperation:(e,o,s)=>(0,t.freeze)({...e,having:"And"===o?i.AndNode.create(e.having,s):r.OrNode.create(e.having,s)})});e.s(["HavingNode",0,o])},280182,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"InsertQueryNode"===e.kind,create:(e,i,r)=>(0,t.freeze)({kind:"InsertQueryNode",into:e,...i&&{with:i},replace:r}),createWithoutInto:()=>(0,t.freeze)({kind:"InsertQueryNode"}),cloneWith:(e,i)=>(0,t.freeze)({...e,...i})});e.s(["InsertQueryNode",0,i])},836519,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"ListNode"===e.kind,create:e=>(0,t.freeze)({kind:"ListNode",items:(0,t.freeze)(e)})});e.s(["ListNode",0,i])},388758,391889,210636,62120,234066,e=>{"use strict";var t=e.i(459094),i=e.i(490870),r=e.i(836519);let o=(0,t.freeze)({is:e=>"UpdateQueryNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"UpdateQueryNode",table:1===e.length?e[0]:r.ListNode.create(e),...i&&{with:i}}),createWithoutTable:()=>(0,t.freeze)({kind:"UpdateQueryNode"}),cloneWithFromItems:(e,r)=>(0,t.freeze)({...e,from:e.from?i.FromNode.cloneWithFroms(e.from,r):i.FromNode.create(r)}),cloneWithUpdates:(e,i)=>(0,t.freeze)({...e,updates:e.updates?(0,t.freeze)([...e.updates,...i]):i}),cloneWithLimit:(e,i)=>(0,t.freeze)({...e,limit:i})});e.s(["UpdateQueryNode",0,o],388758),e.s(["DeleteQueryNode",()=>a],391889);let s=(0,t.freeze)({is:e=>"UsingNode"===e.kind,create:e=>(0,t.freeze)({kind:"UsingNode",tables:(0,t.freeze)(e)}),cloneWithTables:(e,i)=>(0,t.freeze)({...e,tables:(0,t.freeze)([...e.tables,...i])})});var n=e.i(192868);let a=(0,t.freeze)({is:e=>"DeleteQueryNode"===e.kind,create:(e,r)=>(0,t.freeze)({kind:"DeleteQueryNode",from:i.FromNode.create(e),...r&&{with:r}}),cloneWithOrderByItems:(e,t)=>n.QueryNode.cloneWithOrderByItems(e,t),cloneWithoutOrderBy:e=>n.QueryNode.cloneWithoutOrderBy(e),cloneWithLimit:(e,i)=>(0,t.freeze)({...e,limit:i}),cloneWithoutLimit:e=>(0,t.freeze)({...e,limit:void 0}),cloneWithUsing:(e,i)=>(0,t.freeze)({...e,using:void 0!==e.using?s.cloneWithTables(e.using,i):s.create(i)})});var d=e.i(9445),p=e.i(816032);let h=(0,t.freeze)({is:e=>"WhereNode"===e.kind,create:e=>(0,t.freeze)({kind:"WhereNode",where:e}),cloneWithOperation:(e,i,r)=>(0,t.freeze)({...e,where:"And"===i?d.AndNode.create(e.where,r):p.OrNode.create(e.where,r)})});e.s(["WhereNode",0,h],210636);let u=(0,t.freeze)({is:e=>"ReturningNode"===e.kind,create:e=>(0,t.freeze)({kind:"ReturningNode",selections:(0,t.freeze)(e)}),cloneWithSelections:(e,i)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...i]):(0,t.freeze)(i)})});e.s(["ReturningNode",0,u],62120);let l=(0,t.freeze)({is:e=>"ExplainNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"ExplainNode",format:e,options:i})});e.s(["ExplainNode",0,l],234066)},202423,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"WhenNode"===e.kind,create:e=>(0,t.freeze)({kind:"WhenNode",condition:e}),cloneWithResult:(e,i)=>(0,t.freeze)({...e,result:i})});e.s(["WhenNode",0,i])},91494,720266,e=>{"use strict";var t=e.i(459094),i=e.i(202423);let r=(0,t.freeze)({is:e=>"MergeQueryNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"MergeQueryNode",into:e,...i&&{with:i}}),cloneWithUsing:(e,i)=>(0,t.freeze)({...e,using:i}),cloneWithWhen:(e,i)=>(0,t.freeze)({...e,whens:e.whens?(0,t.freeze)([...e.whens,i]):(0,t.freeze)([i])}),cloneWithThen:(e,r)=>(0,t.freeze)({...e,whens:e.whens?(0,t.freeze)([...e.whens.slice(0,-1),i.WhenNode.cloneWithResult(e.whens[e.whens.length-1],r)]):void 0})});e.s(["MergeQueryNode",0,r],91494);let o=(0,t.freeze)({is:e=>"OutputNode"===e.kind,create:e=>(0,t.freeze)({kind:"OutputNode",selections:(0,t.freeze)(e)}),cloneWithSelections:(e,i)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...i]):(0,t.freeze)(i)})});e.s(["OutputNode",0,o],720266)},969565,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"OrderByNode"===e.kind,create:e=>(0,t.freeze)({kind:"OrderByNode",items:(0,t.freeze)([...e])}),cloneWithItems:(e,i)=>(0,t.freeze)({...e,items:(0,t.freeze)([...e.items,...i])})});e.s(["OrderByNode",0,i])},19254,192868,e=>{"use strict";e.s(["SelectQueryNode",()=>f],19254);var t=e.i(459094),i=e.i(490870),r=e.i(466065),o=e.i(657878);e.s(["QueryNode",()=>N],192868);var s=e.i(280182),n=e.i(388758),a=e.i(391889),d=e.i(210636),p=e.i(62120),h=e.i(234066),u=e.i(91494),l=e.i(720266),c=e.i(969565);let N=(0,t.freeze)({is:e=>f.is(e)||s.InsertQueryNode.is(e)||n.UpdateQueryNode.is(e)||a.DeleteQueryNode.is(e)||u.MergeQueryNode.is(e),cloneWithEndModifier:(e,i)=>(0,t.freeze)({...e,endModifiers:e.endModifiers?(0,t.freeze)([...e.endModifiers,i]):(0,t.freeze)([i])}),cloneWithWhere:(e,i)=>(0,t.freeze)({...e,where:e.where?d.WhereNode.cloneWithOperation(e.where,"And",i):d.WhereNode.create(i)}),cloneWithJoin:(e,i)=>(0,t.freeze)({...e,joins:e.joins?(0,t.freeze)([...e.joins,i]):(0,t.freeze)([i])}),cloneWithReturning:(e,i)=>(0,t.freeze)({...e,returning:e.returning?p.ReturningNode.cloneWithSelections(e.returning,i):p.ReturningNode.create(i)}),cloneWithoutReturning:e=>(0,t.freeze)({...e,returning:void 0}),cloneWithoutWhere:e=>(0,t.freeze)({...e,where:void 0}),cloneWithExplain:(e,i,r)=>(0,t.freeze)({...e,explain:h.ExplainNode.create(i,r?.toOperationNode())}),cloneWithTop:(e,i)=>(0,t.freeze)({...e,top:i}),cloneWithOutput:(e,i)=>(0,t.freeze)({...e,output:e.output?l.OutputNode.cloneWithSelections(e.output,i):l.OutputNode.create(i)}),cloneWithOrderByItems:(e,i)=>(0,t.freeze)({...e,orderBy:e.orderBy?c.OrderByNode.cloneWithItems(e.orderBy,i):c.OrderByNode.create(i)}),cloneWithoutOrderBy:e=>(0,t.freeze)({...e,orderBy:void 0})}),f=(0,t.freeze)({is:e=>"SelectQueryNode"===e.kind,create:e=>(0,t.freeze)({kind:"SelectQueryNode",...e&&{with:e}}),createFrom:(e,r)=>(0,t.freeze)({kind:"SelectQueryNode",from:i.FromNode.create(e),...r&&{with:r}}),cloneWithSelections:(e,i)=>(0,t.freeze)({...e,selections:e.selections?(0,t.freeze)([...e.selections,...i]):(0,t.freeze)(i)}),cloneWithDistinctOn:(e,i)=>(0,t.freeze)({...e,distinctOn:e.distinctOn?(0,t.freeze)([...e.distinctOn,...i]):(0,t.freeze)(i)}),cloneWithFrontModifier:(e,i)=>(0,t.freeze)({...e,frontModifiers:e.frontModifiers?(0,t.freeze)([...e.frontModifiers,i]):(0,t.freeze)([i])}),cloneWithOrderByItems:(e,t)=>N.cloneWithOrderByItems(e,t),cloneWithGroupByItems:(e,i)=>(0,t.freeze)({...e,groupBy:e.groupBy?r.GroupByNode.cloneWithItems(e.groupBy,i):r.GroupByNode.create(i)}),cloneWithLimit:(e,i)=>(0,t.freeze)({...e,limit:i}),cloneWithOffset:(e,i)=>(0,t.freeze)({...e,offset:i}),cloneWithFetch:(e,i)=>(0,t.freeze)({...e,fetch:i}),cloneWithHaving:(e,i)=>(0,t.freeze)({...e,having:e.having?o.HavingNode.cloneWithOperation(e.having,"And",i):o.HavingNode.create(i)}),cloneWithSetOperations:(e,i)=>(0,t.freeze)({...e,setOperations:e.setOperations?(0,t.freeze)([...e.setOperations,...i]):(0,t.freeze)([...i])}),cloneWithoutSelections:e=>(0,t.freeze)({...e,selections:[]}),cloneWithoutLimit:e=>(0,t.freeze)({...e,limit:void 0}),cloneWithoutOffset:e=>(0,t.freeze)({...e,offset:void 0}),cloneWithoutOrderBy:e=>N.cloneWithoutOrderBy(e),cloneWithoutGroupBy:e=>(0,t.freeze)({...e,groupBy:void 0})})},361761,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"IdentifierNode"===e.kind,create:e=>(0,t.freeze)({kind:"IdentifierNode",name:e})});e.s(["IdentifierNode",0,i])},390476,1765,818728,726951,769972,e=>{"use strict";var t=e.i(459094);let i=(0,t.freeze)({is:e=>"RawNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"RawNode",sqlFragments:(0,t.freeze)(e),parameters:(0,t.freeze)(i)}),createWithSql:e=>i.create([e],[]),createWithChild:e=>i.create(["",""],[e]),createWithChildren:e=>i.create(Array(e.length+1).fill(""),e)});e.s(["RawNode",0,i],1765);let r=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function o(e){let t="";for(let i=0;i<e;++i)t+=r[~~(Math.random()*r.length)];return t}function s(){return new n}e.s(["randomString",()=>o],818728);class n{#e;get queryId(){return void 0===this.#e&&(this.#e=o(8)),this.#e}}e.s(["createQueryId",()=>s],726951);let a=(0,t.freeze)({raw:(e,r=[])=>(0,t.freeze)({sql:e,query:i.createWithSql(e),parameters:(0,t.freeze)(r),queryId:s()})});e.s(["CompiledQuery",0,a],390476);let d=(0,t.freeze)({is:e=>"CreateTableNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateTableNode",table:e,columns:(0,t.freeze)([])}),cloneWithColumn:(e,i)=>(0,t.freeze)({...e,columns:(0,t.freeze)([...e.columns,i])}),cloneWithConstraint:(e,i)=>(0,t.freeze)({...e,constraints:e.constraints?(0,t.freeze)([...e.constraints,i]):(0,t.freeze)([i])}),cloneWithFrontModifier:(e,i)=>(0,t.freeze)({...e,frontModifiers:e.frontModifiers?(0,t.freeze)([...e.frontModifiers,i]):(0,t.freeze)([i])}),cloneWithEndModifier:(e,i)=>(0,t.freeze)({...e,endModifiers:e.endModifiers?(0,t.freeze)([...e.endModifiers,i]):(0,t.freeze)([i])}),cloneWith:(e,i)=>(0,t.freeze)({...e,...i})});e.s(["CreateTableNode",0,d,"ON_COMMIT_ACTIONS",0,["preserve rows","delete rows","drop"]],769972)},783849,380727,688986,e=>{"use strict";var t=e.i(459094);class i{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#t=(0,t.freeze)({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)});visitNode=e=>{this.nodeStack.push(e),this.#t[e.kind](e),this.nodeStack.pop()}}e.s(["OperationNodeVisitor",()=>i],783849);let r=["->","->>"],o=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from","+","-","*","/","%","^","&","|","#","<<",">>","&&","||",...r,"not","-","exists","not exists","between","between symmetric"],s=(0,t.freeze)({is:e=>"OperatorNode"===e.kind,create:e=>(0,t.freeze)({kind:"OperatorNode",operator:e})});function n(e){return(0,t.isString)(e)&&r.includes(e)}e.s(["OPERATORS",0,o,"OperatorNode",0,s,"isJSONOperator",()=>n],380727);let a=(0,t.freeze)({is:e=>"ParensNode"===e.kind,create:e=>(0,t.freeze)({kind:"ParensNode",node:e})});e.s(["ParensNode",0,a],688986)},78655,566586,439504,e=>{"use strict";var t=e.i(459094),i=e.i(361761);let r=(0,t.freeze)({is:e=>"SchemableIdentifierNode"===e.kind,create:e=>(0,t.freeze)({kind:"SchemableIdentifierNode",identifier:i.IdentifierNode.create(e)}),createWithSchema:(e,r)=>(0,t.freeze)({kind:"SchemableIdentifierNode",schema:i.IdentifierNode.create(e),identifier:i.IdentifierNode.create(r)})});e.s(["SchemableIdentifierNode",0,r],566586);let o=(0,t.freeze)({is:e=>"CreateViewNode"===e.kind,create:e=>(0,t.freeze)({kind:"CreateViewNode",name:r.create(e)}),cloneWith:(e,i)=>(0,t.freeze)({...e,...i})});e.s(["CreateViewNode",0,o],78655);let s=(0,t.freeze)({is:e=>"SetOperationNode"===e.kind,create:(e,i,r)=>(0,t.freeze)({kind:"SetOperationNode",operator:e,expression:i,all:r})});e.s(["SetOperationNode",0,s],439504)},736306,168599,1925,950495,e=>{"use strict";var t=e.i(769972),i=e.i(280182),r=e.i(783849),o=e.i(380727),s=e.i(688986),n=e.i(1765),a=e.i(459094),d=e.i(78655),p=e.i(439504),h=e.i(202423);let u=new Set;function l(e){u.has(e)||(u.add(e),console.log(e))}e.s(["logOnce",()=>l],168599);let c=/'/g;class N extends r.OperationNodeVisitor{#i="";#r=[];get numParameters(){return this.#r.length}compileQuery(e,t){return this.#i="",this.#r=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(e),(0,a.freeze)({query:e,queryId:t,sql:this.getSql(),parameters:[...this.#r]})}getSql(){return this.#i}visitSelectQuery(e){let r=void 0!==this.parentNode&&!s.ParensNode.is(this.parentNode)&&!i.InsertQueryNode.is(this.parentNode)&&!t.CreateTableNode.is(this.parentNode)&&!d.CreateViewNode.is(this.parentNode)&&!p.SetOperationNode.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),r&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("select"),e.distinctOn&&(this.append(" "),this.compileDistinctOn(e.distinctOn)),e.frontModifiers?.length&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.top&&(this.append(" "),this.visitNode(e.top)),e.selections&&(this.append(" "),this.compileList(e.selections)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.groupBy&&(this.append(" "),this.visitNode(e.groupBy)),e.having&&(this.append(" "),this.visitNode(e.having)),e.setOperations&&(this.append(" "),this.compileList(e.setOperations," ")),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.offset&&(this.append(" "),this.visitNode(e.offset)),e.fetch&&(this.append(" "),this.visitNode(e.fetch)),e.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...e.endModifiers])," ")),r&&this.append(")")}visitFrom(e){this.append("from "),this.compileList(e.froms)}visitSelection(e){this.visitNode(e.selection)}visitColumn(e){this.visitNode(e.column)}compileDistinctOn(e){this.append("distinct on ("),this.compileList(e),this.append(")")}compileList(e,t=", "){let i=e.length-1;for(let r=0;r<=i;r++)this.visitNode(e[r]),r<i&&this.append(t)}visitWhere(e){this.append("where "),this.visitNode(e.where)}visitHaving(e){this.append("having "),this.visitNode(e.having)}visitInsertQuery(e){let t=void 0!==this.parentNode&&!s.ParensNode.is(this.parentNode)&&!n.RawNode.is(this.parentNode)&&!h.WhenNode.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append(e.replace?"replace":"insert"),e.ignore&&(l("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore")),e.orAction&&(this.append(" "),this.visitNode(e.orAction)),e.top&&(this.append(" "),this.visitNode(e.top)),e.into&&(this.append(" into "),this.visitNode(e.into)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.output&&(this.append(" "),this.visitNode(e.output)),e.values&&(this.append(" "),this.visitNode(e.values)),e.defaultValues&&(this.append(" "),this.append("default values")),e.onConflict&&(this.append(" "),this.visitNode(e.onConflict)),e.onDuplicateKey&&(this.append(" "),this.visitNode(e.onDuplicateKey)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitValues(e){this.append("values "),this.compileList(e.values)}visitDeleteQuery(e){let t=void 0!==this.parentNode&&!s.ParensNode.is(this.parentNode)&&!n.RawNode.is(this.parentNode);void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("delete "),e.top&&(this.visitNode(e.top),this.append(" ")),this.visitNode(e.from),e.output&&(this.append(" "),this.visitNode(e.output)),e.using&&(this.append(" "),this.visitNode(e.using)),e.joins&&(this.append(" "),this.compileList(e.joins," ")),e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitReturning(e){this.append("returning "),this.compileList(e.selections)}visitAlias(e){this.visitNode(e.node),this.append(" as "),this.visitNode(e.alias)}visitReference(e){e.table&&(this.visitNode(e.table),this.append(".")),this.visitNode(e.column)}visitSelectAll(e){this.append("*")}visitIdentifier(e){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(e),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(e){if(!(0,a.isString)(e.name))throw Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(e.name))}visitAnd(e){this.visitNode(e.left),this.append(" and "),this.visitNode(e.right)}visitOr(e){this.visitNode(e.left),this.append(" or "),this.visitNode(e.right)}visitValue(e){e.immediate?this.appendImmediateValue(e.value):this.appendValue(e.value)}visitValueList(e){this.append("("),this.compileList(e.values),this.append(")")}visitTuple(e){this.append("("),this.compileList(e.values),this.append(")")}visitPrimitiveValueList(e){this.append("(");let{values:t}=e;for(let e=0;e<t.length;++e)this.appendValue(t[e]),e!==t.length-1&&this.append(", ");this.append(")")}visitParens(e){this.append("("),this.visitNode(e.node),this.append(")")}visitJoin(e){this.append(y[e.joinType]),this.append(" "),this.visitNode(e.table),e.on&&(this.append(" "),this.visitNode(e.on))}visitOn(e){this.append("on "),this.visitNode(e.on)}visitRaw(e){let{sqlFragments:t,parameters:i}=e;for(let e=0;e<t.length;++e)this.append(t[e]),i.length>e&&this.visitNode(i[e])}visitOperator(e){this.append(e.operator)}visitTable(e){this.visitNode(e.table)}visitSchemableIdentifier(e){e.schema&&(this.visitNode(e.schema),this.append(".")),this.visitNode(e.identifier)}visitCreateTable(e){this.append("create "),e.frontModifiers&&e.frontModifiers.length>0&&(this.compileList(e.frontModifiers," "),this.append(" ")),e.temporary&&this.append("temporary "),this.append("table "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.table),e.selectQuery?(this.append(" as "),this.visitNode(e.selectQuery)):(this.append(" ("),this.compileList([...e.columns,...e.constraints??[]]),this.append(")"),e.onCommit&&(this.append(" on commit "),this.append(e.onCommit)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," ")))}visitColumnDefinition(e){e.ifNotExists&&this.append("if not exists "),this.visitNode(e.column),this.append(" "),this.visitNode(e.dataType),e.unsigned&&this.append(" unsigned"),e.frontModifiers&&e.frontModifiers.length>0&&(this.append(" "),this.compileList(e.frontModifiers," ")),e.generated&&(this.append(" "),this.visitNode(e.generated)),e.identity&&this.append(" identity"),e.defaultTo&&(this.append(" "),this.visitNode(e.defaultTo)),e.notNull&&this.append(" not null"),e.unique&&this.append(" unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.primaryKey&&this.append(" primary key"),e.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),e.references&&(this.append(" "),this.visitNode(e.references)),e.check&&(this.append(" "),this.visitNode(e.check)),e.endModifiers&&e.endModifiers.length>0&&(this.append(" "),this.compileList(e.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(e){this.append("references "),this.visitNode(e.table),this.append(" ("),this.compileList(e.columns),this.append(")"),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate))}visitDropTable(e){this.append("drop table "),e.ifExists&&this.append("if exists "),this.visitNode(e.table),e.cascade&&this.append(" cascade")}visitDataType(e){this.append(e.dataType)}visitOrderBy(e){this.append("order by "),this.compileList(e.items)}visitOrderByItem(e){this.visitNode(e.orderBy),e.collation&&(this.append(" "),this.visitNode(e.collation)),e.direction&&(this.append(" "),this.visitNode(e.direction)),e.nulls&&(this.append(" nulls "),this.append(e.nulls))}visitGroupBy(e){this.append("group by "),this.compileList(e.items)}visitGroupByItem(e){this.visitNode(e.groupBy)}visitUpdateQuery(e){let t=void 0!==this.parentNode&&!s.ParensNode.is(this.parentNode)&&!n.RawNode.is(this.parentNode)&&!h.WhenNode.is(this.parentNode);if(void 0===this.parentNode&&e.explain&&(this.visitNode(e.explain),this.append(" ")),t&&this.append("("),e.with&&(this.visitNode(e.with),this.append(" ")),this.append("update "),e.top&&(this.visitNode(e.top),this.append(" ")),e.table&&(this.visitNode(e.table),this.append(" ")),this.append("set "),e.updates&&this.compileList(e.updates),e.output&&(this.append(" "),this.visitNode(e.output)),e.from&&(this.append(" "),this.visitNode(e.from)),e.joins){if(!e.from)throw Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(e.joins," ")}e.where&&(this.append(" "),this.visitNode(e.where)),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),e.limit&&(this.append(" "),this.visitNode(e.limit)),e.returning&&(this.append(" "),this.visitNode(e.returning)),t&&this.append(")"),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitColumnUpdate(e){this.visitNode(e.column),this.append(" = "),this.visitNode(e.value)}visitLimit(e){this.append("limit "),this.visitNode(e.limit)}visitOffset(e){this.append("offset "),this.visitNode(e.offset)}visitOnConflict(e){this.append("on conflict"),e.columns?(this.append(" ("),this.compileList(e.columns),this.append(")")):e.constraint?(this.append(" on constraint "),this.visitNode(e.constraint)):e.indexExpression&&(this.append(" ("),this.visitNode(e.indexExpression),this.append(")")),e.indexWhere&&(this.append(" "),this.visitNode(e.indexWhere)),!0===e.doNothing?this.append(" do nothing"):e.updates&&(this.append(" do update set "),this.compileList(e.updates),e.updateWhere&&(this.append(" "),this.visitNode(e.updateWhere)))}visitOnDuplicateKey(e){this.append("on duplicate key update "),this.compileList(e.updates)}visitCreateIndex(e){this.append("create "),e.unique&&this.append("unique "),this.append("index "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.using&&(this.append(" using "),this.visitNode(e.using)),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.nullsNotDistinct&&this.append(" nulls not distinct"),e.where&&(this.append(" "),this.visitNode(e.where))}visitDropIndex(e){this.append("drop index "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.table&&(this.append(" on "),this.visitNode(e.table)),e.cascade&&this.append(" cascade")}visitCreateSchema(e){this.append("create schema "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.schema)}visitDropSchema(e){this.append("drop schema "),e.ifExists&&this.append("if exists "),this.visitNode(e.schema),e.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("primary key ("),this.compileList(e.columns),this.append(")"),this.buildDeferrable(e)}buildDeferrable(e){void 0!==e.deferrable&&(e.deferrable?this.append(" deferrable"):this.append(" not deferrable")),void 0!==e.initiallyDeferred&&(e.initiallyDeferred?this.append(" initially deferred"):this.append(" initially immediate"))}visitUniqueConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("unique"),e.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(e.columns),this.append(")"),this.buildDeferrable(e)}visitCheckConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("check ("),this.visitNode(e.expression),this.append(")")}visitForeignKeyConstraint(e){e.name&&(this.append("constraint "),this.visitNode(e.name),this.append(" ")),this.append("foreign key ("),this.compileList(e.columns),this.append(") "),this.visitNode(e.references),e.onDelete&&(this.append(" on delete "),this.append(e.onDelete)),e.onUpdate&&(this.append(" on update "),this.append(e.onUpdate)),this.buildDeferrable(e)}visitList(e){this.compileList(e.items)}visitWith(e){this.append("with "),e.recursive&&this.append("recursive "),this.compileList(e.expressions)}visitCommonTableExpression(e){this.visitNode(e.name),this.append(" as "),(0,a.isBoolean)(e.materialized)&&(e.materialized||this.append("not "),this.append("materialized ")),this.visitNode(e.expression)}visitCommonTableExpressionName(e){this.visitNode(e.table),e.columns&&(this.append("("),this.compileList(e.columns),this.append(")"))}visitAlterTable(e){this.append("alter table "),this.visitNode(e.table),this.append(" "),e.renameTo&&(this.append("rename to "),this.visitNode(e.renameTo)),e.setSchema&&(this.append("set schema "),this.visitNode(e.setSchema)),e.addConstraint&&this.visitNode(e.addConstraint),e.dropConstraint&&this.visitNode(e.dropConstraint),e.renameConstraint&&this.visitNode(e.renameConstraint),e.columnAlterations&&this.compileColumnAlterations(e.columnAlterations),e.addIndex&&this.visitNode(e.addIndex),e.dropIndex&&this.visitNode(e.dropIndex)}visitAddColumn(e){this.append("add column "),this.visitNode(e.column)}visitRenameColumn(e){this.append("rename column "),this.visitNode(e.column),this.append(" to "),this.visitNode(e.renameTo)}visitDropColumn(e){this.append("drop column "),this.visitNode(e.column)}visitAlterColumn(e){this.append("alter column "),this.visitNode(e.column),this.append(" "),e.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(e.dataType),e.dataTypeExpression&&(this.append("using "),this.visitNode(e.dataTypeExpression))),e.setDefault&&(this.append("set default "),this.visitNode(e.setDefault)),e.dropDefault&&this.append("drop default"),e.setNotNull&&this.append("set not null"),e.dropNotNull&&this.append("drop not null")}visitModifyColumn(e){this.append("modify column "),this.visitNode(e.column)}visitAddConstraint(e){this.append("add "),this.visitNode(e.constraint)}visitDropConstraint(e){this.append("drop constraint "),e.ifExists&&this.append("if exists "),this.visitNode(e.constraintName),"cascade"===e.modifier?this.append(" cascade"):"restrict"===e.modifier&&this.append(" restrict")}visitRenameConstraint(e){this.append("rename constraint "),this.visitNode(e.oldName),this.append(" to "),this.visitNode(e.newName)}visitSetOperation(e){this.append(e.operator),this.append(" "),e.all&&this.append("all "),this.visitNode(e.expression)}visitCreateView(e){this.append("create "),e.orReplace&&this.append("or replace "),e.materialized&&this.append("materialized "),e.temporary&&this.append("temporary "),this.append("view "),e.ifNotExists&&this.append("if not exists "),this.visitNode(e.name),this.append(" "),e.columns&&(this.append("("),this.compileList(e.columns),this.append(") ")),e.as&&(this.append("as "),this.visitNode(e.as))}visitRefreshMaterializedView(e){this.append("refresh materialized view "),e.concurrently&&this.append("concurrently "),this.visitNode(e.name),e.withNoData?this.append(" with no data"):this.append(" with data")}visitDropView(e){this.append("drop "),e.materialized&&this.append("materialized "),this.append("view "),e.ifExists&&this.append("if exists "),this.visitNode(e.name),e.cascade&&this.append(" cascade")}visitGenerated(e){this.append("generated "),e.always&&this.append("always "),e.byDefault&&this.append("by default "),this.append("as "),e.identity&&this.append("identity"),e.expression&&(this.append("("),this.visitNode(e.expression),this.append(")")),e.stored&&this.append(" stored")}visitDefaultValue(e){this.append("default "),this.visitNode(e.defaultValue)}visitSelectModifier(e){e.rawModifier?this.visitNode(e.rawModifier):this.append(f[e.modifier]),e.of&&(this.append(" of "),this.compileList(e.of,", "))}visitCreateType(e){this.append("create type "),this.visitNode(e.name),e.enum&&(this.append(" as enum "),this.visitNode(e.enum))}visitDropType(e){this.append("drop type "),e.ifExists&&this.append("if exists "),this.visitNode(e.name)}visitExplain(e){this.append("explain"),(e.options||e.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),e.options&&(this.visitNode(e.options),e.format&&this.append(this.getExplainOptionsDelimiter())),e.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(e.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(e){this.append("default")}visitAggregateFunction(e){this.append(e.func),this.append("("),e.distinct&&this.append("distinct "),this.compileList(e.aggregated),e.orderBy&&(this.append(" "),this.visitNode(e.orderBy)),this.append(")"),e.withinGroup&&(this.append(" within group ("),this.visitNode(e.withinGroup),this.append(")")),e.filter&&(this.append(" filter("),this.visitNode(e.filter),this.append(")")),e.over&&(this.append(" "),this.visitNode(e.over))}visitOver(e){this.append("over("),e.partitionBy&&(this.visitNode(e.partitionBy),e.orderBy&&this.append(" ")),e.orderBy&&this.visitNode(e.orderBy),this.append(")")}visitPartitionBy(e){this.append("partition by "),this.compileList(e.items)}visitPartitionByItem(e){this.visitNode(e.partitionBy)}visitBinaryOperation(e){this.visitNode(e.leftOperand),this.append(" "),this.visitNode(e.operator),this.append(" "),this.visitNode(e.rightOperand)}visitUnaryOperation(e){this.visitNode(e.operator),this.isMinusOperator(e.operator)||this.append(" "),this.visitNode(e.operand)}isMinusOperator(e){return o.OperatorNode.is(e)&&"-"===e.operator}visitUsing(e){this.append("using "),this.compileList(e.tables)}visitFunction(e){this.append(e.func),this.append("("),this.compileList(e.arguments),this.append(")")}visitCase(e){this.append("case"),e.value&&(this.append(" "),this.visitNode(e.value)),e.when&&(this.append(" "),this.compileList(e.when," ")),e.else&&(this.append(" else "),this.visitNode(e.else)),this.append(" end"),e.isStatement&&this.append(" case")}visitWhen(e){this.append("when "),this.visitNode(e.condition),e.result&&(this.append(" then "),this.visitNode(e.result))}visitJSONReference(e){this.visitNode(e.reference),this.visitNode(e.traversal)}visitJSONPath(e){for(let t of(e.inOperator&&this.visitNode(e.inOperator),this.append("'$"),e.pathLegs))this.visitNode(t);this.append("'")}visitJSONPathLeg(e){let t="ArrayLocation"===e.type;this.append(t?"[":"."),this.append(String(e.value)),t&&this.append("]")}visitJSONOperatorChain(e){for(let t=0,i=e.values.length;t<i;t++)t===i-1?this.visitNode(e.operator):this.append("->"),this.visitNode(e.values[t])}visitMergeQuery(e){e.with&&(this.visitNode(e.with),this.append(" ")),this.append("merge "),e.top&&(this.visitNode(e.top),this.append(" ")),this.append("into "),this.visitNode(e.into),e.using&&(this.append(" "),this.visitNode(e.using)),e.whens&&(this.append(" "),this.compileList(e.whens," ")),e.returning&&(this.append(" "),this.visitNode(e.returning)),e.output&&(this.append(" "),this.visitNode(e.output)),e.endModifiers?.length&&(this.append(" "),this.compileList(e.endModifiers," "))}visitMatched(e){e.not&&this.append("not "),this.append("matched"),e.bySource&&this.append(" by source")}visitAddIndex(e){this.append("add "),e.unique&&this.append("unique "),this.append("index "),this.visitNode(e.name),e.columns&&(this.append(" ("),this.compileList(e.columns),this.append(")")),e.using&&(this.append(" using "),this.visitNode(e.using))}visitCast(e){this.append("cast("),this.visitNode(e.expression),this.append(" as "),this.visitNode(e.dataType),this.append(")")}visitFetch(e){this.append("fetch next "),this.visitNode(e.rowCount),this.append(` rows ${e.modifier}`)}visitOutput(e){this.append("output "),this.compileList(e.selections)}visitTop(e){this.append(`top(${e.expression})`),e.modifiers&&this.append(` ${e.modifiers}`)}visitOrAction(e){this.append(e.action)}visitCollate(e){this.append("collate "),this.visitNode(e.collation)}append(e){this.#i+=e}appendValue(e){this.addParameter(e),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(e){let t=this.getLeftIdentifierWrapper(),i=this.getRightIdentifierWrapper(),r="";for(let o of e)r+=o,o===t?r+=t:o===i&&(r+=i);return r}sanitizeStringLiteral(e){return e.replace(c,"''")}addParameter(e){this.#r.push(e)}appendImmediateValue(e){if((0,a.isString)(e))this.appendStringLiteral(e);else if((0,a.isNumber)(e)||(0,a.isBoolean)(e)||(0,a.isBigInt)(e))this.append(e.toString());else if((0,a.isNull)(e))this.append("null");else if((0,a.isDate)(e))this.appendImmediateValue(e.toISOString());else throw Error(`invalid immediate value ${e}`)}appendStringLiteral(e){this.append("'"),this.append(this.sanitizeStringLiteral(e)),this.append("'")}sortSelectModifiers(e){return e.sort((e,t)=>e.modifier&&t.modifier?m[e.modifier]-m[t.modifier]:1),(0,a.freeze)(e)}compileColumnAlterations(e){this.compileList(e)}announcesNewColumnDataType(){return!0}}let f=(0,a.freeze)({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),m=(0,a.freeze)({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),y=(0,a.freeze)({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"});e.s(["DefaultQueryCompiler",()=>N],736306);class w{transformQuery(e){return e.node}async transformResult(e){return e.result}}e.s(["NoopPlugin",()=>w],1925);let v=(0,a.freeze)({is:e=>"AliasNode"===e.kind,create:(e,t)=>(0,a.freeze)({kind:"AliasNode",node:e,alias:t})});e.s(["AliasNode",0,v],950495)},628616,e=>{"use strict";var t=e.i(459094),i=e.i(9445),r=e.i(816032);let o=(0,t.freeze)({is:e=>"OnNode"===e.kind,create:e=>(0,t.freeze)({kind:"OnNode",on:e}),cloneWithOperation:(e,o,s)=>(0,t.freeze)({...e,on:"And"===o?i.AndNode.create(e.on,s):r.OrNode.create(e.on,s)})}),s=(0,t.freeze)({is:e=>"JoinNode"===e.kind,create:(e,i)=>(0,t.freeze)({kind:"JoinNode",joinType:e,table:i,on:void 0}),createWithOn:(e,i,r)=>(0,t.freeze)({kind:"JoinNode",joinType:e,table:i,on:o.create(r)}),cloneWithOn:(e,i)=>(0,t.freeze)({...e,on:e.on?o.cloneWithOperation(e.on,"And",i):o.create(i)})});e.s(["JoinNode",0,s],628616)},77033,236300,238227,899948,344473,504196,381196,944550,506083,426893,772638,409762,734010,193846,329961,154996,e=>{"use strict";e.i(1925);var t=e.i(950495),i=e.i(361761),r=e.i(628616),o=e.i(836519),s=e.i(459094);class n{nodeStack=[];#o=(0,s.freeze)({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)});transformNode(e,t){if(!e)return e;this.nodeStack.push(e);let i=this.transformNodeImpl(e,t);return this.nodeStack.pop(),(0,s.freeze)(i)}transformNodeImpl(e,t){return this.#o[e.kind](e,t)}transformNodeList(e,t){return e?(0,s.freeze)(e.map(e=>this.transformNode(e,t))):e}transformSelectQuery(e,t){return{kind:"SelectQueryNode",from:this.transformNode(e.from,t),selections:this.transformNodeList(e.selections,t),distinctOn:this.transformNodeList(e.distinctOn,t),joins:this.transformNodeList(e.joins,t),groupBy:this.transformNode(e.groupBy,t),orderBy:this.transformNode(e.orderBy,t),where:this.transformNode(e.where,t),frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),limit:this.transformNode(e.limit,t),offset:this.transformNode(e.offset,t),with:this.transformNode(e.with,t),having:this.transformNode(e.having,t),explain:this.transformNode(e.explain,t),setOperations:this.transformNodeList(e.setOperations,t),fetch:this.transformNode(e.fetch,t),top:this.transformNode(e.top,t)}}transformSelection(e,t){return{kind:"SelectionNode",selection:this.transformNode(e.selection,t)}}transformColumn(e,t){return{kind:"ColumnNode",column:this.transformNode(e.column,t)}}transformAlias(e,t){return{kind:"AliasNode",node:this.transformNode(e.node,t),alias:this.transformNode(e.alias,t)}}transformTable(e,t){return{kind:"TableNode",table:this.transformNode(e.table,t)}}transformFrom(e,t){return{kind:"FromNode",froms:this.transformNodeList(e.froms,t)}}transformReference(e,t){return{kind:"ReferenceNode",column:this.transformNode(e.column,t),table:this.transformNode(e.table,t)}}transformAnd(e,t){return{kind:"AndNode",left:this.transformNode(e.left,t),right:this.transformNode(e.right,t)}}transformOr(e,t){return{kind:"OrNode",left:this.transformNode(e.left,t),right:this.transformNode(e.right,t)}}transformValueList(e,t){return{kind:"ValueListNode",values:this.transformNodeList(e.values,t)}}transformParens(e,t){return{kind:"ParensNode",node:this.transformNode(e.node,t)}}transformJoin(e,t){return{kind:"JoinNode",joinType:e.joinType,table:this.transformNode(e.table,t),on:this.transformNode(e.on,t)}}transformRaw(e,t){return{kind:"RawNode",sqlFragments:(0,s.freeze)([...e.sqlFragments]),parameters:this.transformNodeList(e.parameters,t)}}transformWhere(e,t){return{kind:"WhereNode",where:this.transformNode(e.where,t)}}transformInsertQuery(e,t){return{kind:"InsertQueryNode",into:this.transformNode(e.into,t),columns:this.transformNodeList(e.columns,t),values:this.transformNode(e.values,t),returning:this.transformNode(e.returning,t),onConflict:this.transformNode(e.onConflict,t),onDuplicateKey:this.transformNode(e.onDuplicateKey,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),ignore:e.ignore,orAction:this.transformNode(e.orAction,t),replace:e.replace,explain:this.transformNode(e.explain,t),defaultValues:e.defaultValues,top:this.transformNode(e.top,t),output:this.transformNode(e.output,t)}}transformValues(e,t){return{kind:"ValuesNode",values:this.transformNodeList(e.values,t)}}transformDeleteQuery(e,t){return{kind:"DeleteQueryNode",from:this.transformNode(e.from,t),using:this.transformNode(e.using,t),joins:this.transformNodeList(e.joins,t),where:this.transformNode(e.where,t),returning:this.transformNode(e.returning,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),orderBy:this.transformNode(e.orderBy,t),limit:this.transformNode(e.limit,t),explain:this.transformNode(e.explain,t),top:this.transformNode(e.top,t),output:this.transformNode(e.output,t)}}transformReturning(e,t){return{kind:"ReturningNode",selections:this.transformNodeList(e.selections,t)}}transformCreateTable(e,t){return{kind:"CreateTableNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),constraints:this.transformNodeList(e.constraints,t),temporary:e.temporary,ifNotExists:e.ifNotExists,onCommit:e.onCommit,frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),selectQuery:this.transformNode(e.selectQuery,t)}}transformColumnDefinition(e,t){return{kind:"ColumnDefinitionNode",column:this.transformNode(e.column,t),dataType:this.transformNode(e.dataType,t),references:this.transformNode(e.references,t),primaryKey:e.primaryKey,autoIncrement:e.autoIncrement,unique:e.unique,notNull:e.notNull,unsigned:e.unsigned,defaultTo:this.transformNode(e.defaultTo,t),check:this.transformNode(e.check,t),generated:this.transformNode(e.generated,t),frontModifiers:this.transformNodeList(e.frontModifiers,t),endModifiers:this.transformNodeList(e.endModifiers,t),nullsNotDistinct:e.nullsNotDistinct,identity:e.identity,ifNotExists:e.ifNotExists}}transformAddColumn(e,t){return{kind:"AddColumnNode",column:this.transformNode(e.column,t)}}transformDropTable(e,t){return{kind:"DropTableNode",table:this.transformNode(e.table,t),ifExists:e.ifExists,cascade:e.cascade}}transformOrderBy(e,t){return{kind:"OrderByNode",items:this.transformNodeList(e.items,t)}}transformOrderByItem(e,t){return{kind:"OrderByItemNode",orderBy:this.transformNode(e.orderBy,t),direction:this.transformNode(e.direction,t),collation:this.transformNode(e.collation,t),nulls:e.nulls}}transformGroupBy(e,t){return{kind:"GroupByNode",items:this.transformNodeList(e.items,t)}}transformGroupByItem(e,t){return{kind:"GroupByItemNode",groupBy:this.transformNode(e.groupBy,t)}}transformUpdateQuery(e,t){return{kind:"UpdateQueryNode",table:this.transformNode(e.table,t),from:this.transformNode(e.from,t),joins:this.transformNodeList(e.joins,t),where:this.transformNode(e.where,t),updates:this.transformNodeList(e.updates,t),returning:this.transformNode(e.returning,t),endModifiers:this.transformNodeList(e.endModifiers,t),with:this.transformNode(e.with,t),explain:this.transformNode(e.explain,t),limit:this.transformNode(e.limit,t),top:this.transformNode(e.top,t),output:this.transformNode(e.output,t),orderBy:this.transformNode(e.orderBy,t)}}transformColumnUpdate(e,t){return{kind:"ColumnUpdateNode",column:this.transformNode(e.column,t),value:this.transformNode(e.value,t)}}transformLimit(e,t){return{kind:"LimitNode",limit:this.transformNode(e.limit,t)}}transformOffset(e,t){return{kind:"OffsetNode",offset:this.transformNode(e.offset,t)}}transformOnConflict(e,t){return{kind:"OnConflictNode",columns:this.transformNodeList(e.columns,t),constraint:this.transformNode(e.constraint,t),indexExpression:this.transformNode(e.indexExpression,t),indexWhere:this.transformNode(e.indexWhere,t),updates:this.transformNodeList(e.updates,t),updateWhere:this.transformNode(e.updateWhere,t),doNothing:e.doNothing}}transformOnDuplicateKey(e,t){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(e.updates,t)}}transformCreateIndex(e,t){return{kind:"CreateIndexNode",name:this.transformNode(e.name,t),table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),unique:e.unique,using:this.transformNode(e.using,t),ifNotExists:e.ifNotExists,where:this.transformNode(e.where,t),nullsNotDistinct:e.nullsNotDistinct}}transformList(e,t){return{kind:"ListNode",items:this.transformNodeList(e.items,t)}}transformDropIndex(e,t){return{kind:"DropIndexNode",name:this.transformNode(e.name,t),table:this.transformNode(e.table,t),ifExists:e.ifExists,cascade:e.cascade}}transformPrimaryKeyConstraint(e,t){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(e.columns,t),name:this.transformNode(e.name,t),deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformUniqueConstraint(e,t){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(e.columns,t),name:this.transformNode(e.name,t),nullsNotDistinct:e.nullsNotDistinct,deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformForeignKeyConstraint(e,t){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(e.columns,t),references:this.transformNode(e.references,t),name:this.transformNode(e.name,t),onDelete:e.onDelete,onUpdate:e.onUpdate,deferrable:e.deferrable,initiallyDeferred:e.initiallyDeferred}}transformSetOperation(e,t){return{kind:"SetOperationNode",operator:e.operator,expression:this.transformNode(e.expression,t),all:e.all}}transformReferences(e,t){return{kind:"ReferencesNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t),onDelete:e.onDelete,onUpdate:e.onUpdate}}transformCheckConstraint(e,t){return{kind:"CheckConstraintNode",expression:this.transformNode(e.expression,t),name:this.transformNode(e.name,t)}}transformWith(e,t){return{kind:"WithNode",expressions:this.transformNodeList(e.expressions,t),recursive:e.recursive}}transformCommonTableExpression(e,t){return{kind:"CommonTableExpressionNode",name:this.transformNode(e.name,t),materialized:e.materialized,expression:this.transformNode(e.expression,t)}}transformCommonTableExpressionName(e,t){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(e.table,t),columns:this.transformNodeList(e.columns,t)}}transformHaving(e,t){return{kind:"HavingNode",having:this.transformNode(e.having,t)}}transformCreateSchema(e,t){return{kind:"CreateSchemaNode",schema:this.transformNode(e.schema,t),ifNotExists:e.ifNotExists}}transformDropSchema(e,t){return{kind:"DropSchemaNode",schema:this.transformNode(e.schema,t),ifExists:e.ifExists,cascade:e.cascade}}transformAlterTable(e,t){return{kind:"AlterTableNode",table:this.transformNode(e.table,t),renameTo:this.transformNode(e.renameTo,t),setSchema:this.transformNode(e.setSchema,t),columnAlterations:this.transformNodeList(e.columnAlterations,t),addConstraint:this.transformNode(e.addConstraint,t),dropConstraint:this.transformNode(e.dropConstraint,t),renameConstraint:this.transformNode(e.renameConstraint,t),addIndex:this.transformNode(e.addIndex,t),dropIndex:this.transformNode(e.dropIndex,t)}}transformDropColumn(e,t){return{kind:"DropColumnNode",column:this.transformNode(e.column,t)}}transformRenameColumn(e,t){return{kind:"RenameColumnNode",column:this.transformNode(e.column,t),renameTo:this.transformNode(e.renameTo,t)}}transformAlterColumn(e,t){return{kind:"AlterColumnNode",column:this.transformNode(e.column,t),dataType:this.transformNode(e.dataType,t),dataTypeExpression:this.transformNode(e.dataTypeExpression,t),setDefault:this.transformNode(e.setDefault,t),dropDefault:e.dropDefault,setNotNull:e.setNotNull,dropNotNull:e.dropNotNull}}transformModifyColumn(e,t){return{kind:"ModifyColumnNode",column:this.transformNode(e.column,t)}}transformAddConstraint(e,t){return{kind:"AddConstraintNode",constraint:this.transformNode(e.constraint,t)}}transformDropConstraint(e,t){return{kind:"DropConstraintNode",constraintName:this.transformNode(e.constraintName,t),ifExists:e.ifExists,modifier:e.modifier}}transformRenameConstraint(e,t){return{kind:"RenameConstraintNode",oldName:this.transformNode(e.oldName,t),newName:this.transformNode(e.newName,t)}}transformCreateView(e,t){return{kind:"CreateViewNode",name:this.transformNode(e.name,t),temporary:e.temporary,orReplace:e.orReplace,ifNotExists:e.ifNotExists,materialized:e.materialized,columns:this.transformNodeList(e.columns,t),as:this.transformNode(e.as,t)}}transformRefreshMaterializedView(e,t){return{kind:"RefreshMaterializedViewNode",name:this.transformNode(e.name,t),concurrently:e.concurrently,withNoData:e.withNoData}}transformDropView(e,t){return{kind:"DropViewNode",name:this.transformNode(e.name,t),ifExists:e.ifExists,materialized:e.materialized,cascade:e.cascade}}transformGenerated(e,t){return{kind:"GeneratedNode",byDefault:e.byDefault,always:e.always,identity:e.identity,stored:e.stored,expression:this.transformNode(e.expression,t)}}transformDefaultValue(e,t){return{kind:"DefaultValueNode",defaultValue:this.transformNode(e.defaultValue,t)}}transformOn(e,t){return{kind:"OnNode",on:this.transformNode(e.on,t)}}transformSelectModifier(e,t){return{kind:"SelectModifierNode",modifier:e.modifier,rawModifier:this.transformNode(e.rawModifier,t),of:this.transformNodeList(e.of,t)}}transformCreateType(e,t){return{kind:"CreateTypeNode",name:this.transformNode(e.name,t),enum:this.transformNode(e.enum,t)}}transformDropType(e,t){return{kind:"DropTypeNode",name:this.transformNode(e.name,t),ifExists:e.ifExists}}transformExplain(e,t){return{kind:"ExplainNode",format:e.format,options:this.transformNode(e.options,t)}}transformSchemableIdentifier(e,t){return{kind:"SchemableIdentifierNode",schema:this.transformNode(e.schema,t),identifier:this.transformNode(e.identifier,t)}}transformAggregateFunction(e,t){return{kind:"AggregateFunctionNode",func:e.func,aggregated:this.transformNodeList(e.aggregated,t),distinct:e.distinct,orderBy:this.transformNode(e.orderBy,t),withinGroup:this.transformNode(e.withinGroup,t),filter:this.transformNode(e.filter,t),over:this.transformNode(e.over,t)}}transformOver(e,t){return{kind:"OverNode",orderBy:this.transformNode(e.orderBy,t),partitionBy:this.transformNode(e.partitionBy,t)}}transformPartitionBy(e,t){return{kind:"PartitionByNode",items:this.transformNodeList(e.items,t)}}transformPartitionByItem(e,t){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(e.partitionBy,t)}}transformBinaryOperation(e,t){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(e.leftOperand,t),operator:this.transformNode(e.operator,t),rightOperand:this.transformNode(e.rightOperand,t)}}transformUnaryOperation(e,t){return{kind:"UnaryOperationNode",operator:this.transformNode(e.operator,t),operand:this.transformNode(e.operand,t)}}transformUsing(e,t){return{kind:"UsingNode",tables:this.transformNodeList(e.tables,t)}}transformFunction(e,t){return{kind:"FunctionNode",func:e.func,arguments:this.transformNodeList(e.arguments,t)}}transformCase(e,t){return{kind:"CaseNode",value:this.transformNode(e.value,t),when:this.transformNodeList(e.when,t),else:this.transformNode(e.else,t),isStatement:e.isStatement}}transformWhen(e,t){return{kind:"WhenNode",condition:this.transformNode(e.condition,t),result:this.transformNode(e.result,t)}}transformJSONReference(e,t){return{kind:"JSONReferenceNode",reference:this.transformNode(e.reference,t),traversal:this.transformNode(e.traversal,t)}}transformJSONPath(e,t){return{kind:"JSONPathNode",inOperator:this.transformNode(e.inOperator,t),pathLegs:this.transformNodeList(e.pathLegs,t)}}transformJSONPathLeg(e,t){return{kind:"JSONPathLegNode",type:e.type,value:e.value}}transformJSONOperatorChain(e,t){return{kind:"JSONOperatorChainNode",operator:this.transformNode(e.operator,t),values:this.transformNodeList(e.values,t)}}transformTuple(e,t){return{kind:"TupleNode",values:this.transformNodeList(e.values,t)}}transformMergeQuery(e,t){return{kind:"MergeQueryNode",into:this.transformNode(e.into,t),using:this.transformNode(e.using,t),whens:this.transformNodeList(e.whens,t),with:this.transformNode(e.with,t),top:this.transformNode(e.top,t),endModifiers:this.transformNodeList(e.endModifiers,t),output:this.transformNode(e.output,t),returning:this.transformNode(e.returning,t)}}transformMatched(e,t){return{kind:"MatchedNode",not:e.not,bySource:e.bySource}}transformAddIndex(e,t){return{kind:"AddIndexNode",name:this.transformNode(e.name,t),columns:this.transformNodeList(e.columns,t),unique:e.unique,using:this.transformNode(e.using,t),ifNotExists:e.ifNotExists}}transformCast(e,t){return{kind:"CastNode",expression:this.transformNode(e.expression,t),dataType:this.transformNode(e.dataType,t)}}transformFetch(e,t){return{kind:"FetchNode",rowCount:this.transformNode(e.rowCount,t),modifier:e.modifier}}transformTop(e,t){return{kind:"TopNode",expression:e.expression,modifiers:e.modifiers}}transformOutput(e,t){return{kind:"OutputNode",selections:this.transformNodeList(e.selections,t)}}transformDataType(e,t){return e}transformSelectAll(e,t){return e}transformIdentifier(e,t){return e}transformValue(e,t){return e}transformPrimitiveValueList(e,t){return e}transformOperator(e,t){return e}transformDefaultInsertValue(e,t){return e}transformOrAction(e,t){return e}transformCollate(e,t){return e}}e.s(["OperationNodeTransformer",()=>n],236300);var a=e.i(566586);let d=(0,s.freeze)({is:e=>"TableNode"===e.kind,create:e=>(0,s.freeze)({kind:"TableNode",table:a.SchemableIdentifierNode.create(e)}),createWithSchema:(e,t)=>(0,s.freeze)({kind:"TableNode",table:a.SchemableIdentifierNode.createWithSchema(e,t)})});e.s(["TableNode",0,d],238227);let p=(0,s.freeze)({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),h={json_agg:!0,to_json:!0};class u extends n{#s;#n=new Set;#a=new Set;constructor(e){super(),this.#s=e}transformNodeImpl(e,t){if(!this.#d(e))return super.transformNodeImpl(e,t);let i=this.#p(e);for(let e of i)this.#a.add(e);let r=this.#h(e);for(let e of r)this.#n.add(e);let o=super.transformNodeImpl(e,t);for(let e of r)this.#n.delete(e);for(let e of i)this.#a.delete(e);return o}transformSchemableIdentifier(e,t){let r=super.transformSchemableIdentifier(e,t);return r.schema||!this.#n.has(e.identifier.name)?r:{...r,schema:i.IdentifierNode.create(this.#s)}}transformReferences(e,t){let i=super.transformReferences(e,t);return i.table.table.schema?i:{...i,table:d.createWithSchema(this.#s,i.table.table.identifier.name)}}transformAggregateFunction(e,t){return{...super.transformAggregateFunction({...e,aggregated:[]},t),aggregated:this.#u(e,t,"aggregated")}}transformFunction(e,t){return{...super.transformFunction({...e,arguments:[]},t),arguments:this.#u(e,t,"arguments")}}#u(e,t,i){return h[e.func]?e[i].map(e=>!d.is(e)||e.table.schema?this.transformNode(e,t):{...e,table:this.transformIdentifier(e.table.identifier,t)}):this.transformNodeList(e[i],t)}#d(e){return e.kind in p}#h(e){let t=new Set;if("name"in e&&e.name&&a.SchemableIdentifierNode.is(e.name)&&this.#l(e.name,t),"from"in e&&e.from)for(let i of e.from.froms)this.#c(i,t);if("into"in e&&e.into&&this.#c(e.into,t),"table"in e&&e.table&&this.#c(e.table,t),"joins"in e&&e.joins)for(let i of e.joins)this.#c(i.table,t);return"using"in e&&e.using&&(r.JoinNode.is(e.using)?this.#c(e.using.table,t):this.#c(e.using,t)),t}#p(e){let t=new Set;return"with"in e&&e.with&&this.#N(e.with,t),t}#c(e,i){if(d.is(e))this.#l(e.table,i);else if(t.AliasNode.is(e)&&d.is(e.node))this.#l(e.node.table,i);else if(o.ListNode.is(e))for(let t of e.items)this.#c(t,i)}#l(e,t){let i=e.identifier.name;this.#n.has(i)||this.#a.has(i)||t.add(i)}#N(e,t){for(let i of e.expressions){let e=i.name.table.table.identifier.name;this.#a.has(e)||t.add(e)}}}class l{#f;constructor(e){this.#f=new u(e)}transformQuery(e){return this.#f.transformNode(e.node,e.queryId)}async transformResult(e){return e.result}}function c(e){return(0,s.isObject)(e)&&(0,s.isFunction)(e.toOperationNode)}e.s(["WithSchemaPlugin",()=>l],899948),(0,s.freeze)({__noMigrations__:!0}),e.s(["DEFAULT_MIGRATION_LOCK_TABLE",0,"kysely_migration_lock","DEFAULT_MIGRATION_TABLE",0,"kysely_migration"],77033),e.s(["isOperationNodeSource",()=>c],344473);let N=(0,s.freeze)({is:e=>"ValueNode"===e.kind,create:e=>(0,s.freeze)({kind:"ValueNode",value:e}),createImmediate:e=>(0,s.freeze)({kind:"ValueNode",value:e,immediate:!0})});e.s(["ValueNode",0,N],504196);let f=(0,s.freeze)({is:e=>"ColumnNode"===e.kind,create:e=>(0,s.freeze)({kind:"ColumnNode",column:i.IdentifierNode.create(e)})});e.s(["ColumnNode",0,f],381196);let m=(0,s.freeze)({is:e=>"SelectAllNode"===e.kind,create:()=>(0,s.freeze)({kind:"SelectAllNode"})});e.s(["SelectAllNode",0,m],944550);let y=(0,s.freeze)({is:e=>"ReferenceNode"===e.kind,create:(e,t)=>(0,s.freeze)({kind:"ReferenceNode",table:t,column:e}),createSelectAll:e=>(0,s.freeze)({kind:"ReferenceNode",table:e,column:m.create()})});function w(e){return(0,s.isObject)(e)&&"expressionType"in e&&c(e)}function v(e){return(0,s.isObject)(e)&&"expression"in e&&(0,s.isString)(e.alias)&&c(e)}e.s(["ReferenceNode",0,y],506083),e.s(["isAliasedExpression",()=>v,"isExpression",()=>w],426893);let g=(0,s.freeze)({is:e=>"SelectModifierNode"===e.kind,create:(e,t)=>(0,s.freeze)({kind:"SelectModifierNode",modifier:e,of:t}),createWithExpression:e=>(0,s.freeze)({kind:"SelectModifierNode",rawModifier:e})});e.s(["SelectModifierNode",0,g],772638),e.s(["parseFilterList",()=>D,"parseFilterObject",()=>R,"parseReferentialBinaryOperation",()=>E,"parseValueBinaryOperation",()=>A,"parseValueBinaryOperationOrExpression",()=>L],154996);let O=(0,s.freeze)({is:e=>"BinaryOperationNode"===e.kind,create:(e,t,i)=>(0,s.freeze)({kind:"BinaryOperationNode",leftOperand:e,operator:t,rightOperand:i})});e.s(["BinaryOperationNode",0,O],409762);var b=e.i(380727),W=e.i(258390);e.s(["isSafeImmediateValue",()=>I,"parseSafeImmediateValue",()=>k,"parseValueExpression",()=>q,"parseValueExpressionOrList",()=>S],329961);let x=(0,s.freeze)({is:e=>"PrimitiveValueListNode"===e.kind,create:e=>(0,s.freeze)({kind:"PrimitiveValueListNode",values:(0,s.freeze)([...e])})});e.s(["PrimitiveValueListNode",0,x],734010);let z=(0,s.freeze)({is:e=>"ValueListNode"===e.kind,create:e=>(0,s.freeze)({kind:"ValueListNode",values:(0,s.freeze)(e)})});e.s(["ValueListNode",0,z],193846);var C=e.i(769918);function S(e){var t;return(0,s.isReadonlyArray)(e)?(t=e).some(C.isExpressionOrFactory)?z.create(t.map(e=>q(e))):x.create(t):q(e)}function q(e){return(0,C.isExpressionOrFactory)(e)?(0,C.parseExpression)(e):N.create(e)}function I(e){return(0,s.isNumber)(e)||(0,s.isBoolean)(e)||(0,s.isNull)(e)}function k(e){if(!I(e))throw Error(`unsafe immediate value ${JSON.stringify(e)}`);return N.createImmediate(e)}var B=e.i(9445),Q=e.i(688986),T=e.i(816032);function L(e){if(3===e.length)return A(e[0],e[1],e[2]);if(1===e.length)return q(e[0]);throw Error(`invalid arguments: ${JSON.stringify(e)}`)}function A(e,t,i){var r;return("is"===(r=t)||"is not"===r)&&M(i)?O.create((0,W.parseReferenceExpression)(e),F(t),N.createImmediate(i)):O.create((0,W.parseReferenceExpression)(e),F(t),S(i))}function E(e,t,i){return O.create((0,W.parseReferenceExpression)(e),F(t),(0,W.parseReferenceExpression)(i))}function R(e,t){return D(Object.entries(e).filter(([,e])=>!(0,s.isUndefined)(e)).map(([e,t])=>A(e,M(t)?"is":"=",t)),t)}function D(e,t,i=!0){let r="and"===t?B.AndNode.create:T.OrNode.create;if(0===e.length)return O.create(N.createImmediate(1),b.OperatorNode.create("="),N.createImmediate(+("and"===t)));let o=V(e[0]);for(let t=1;t<e.length;++t)o=r(o,V(e[t]));return e.length>1&&i?Q.ParensNode.create(o):o}function M(e){return(0,s.isNull)(e)||(0,s.isBoolean)(e)}function F(e){if((0,s.isString)(e)&&b.OPERATORS.includes(e))return b.OperatorNode.create(e);if(c(e))return e.toOperationNode();throw Error(`invalid operator ${JSON.stringify(e)}`)}function V(e){return c(e)?e.toOperationNode():e}},338028,e=>{"use strict";var t=e.i(459094),i=e.i(969565);let r=(0,t.freeze)({is:e=>"PartitionByNode"===e.kind,create:e=>(0,t.freeze)({kind:"PartitionByNode",items:(0,t.freeze)(e)}),cloneWithItems:(e,i)=>(0,t.freeze)({...e,items:(0,t.freeze)([...e.items,...i])})}),o=(0,t.freeze)({is:e=>"OverNode"===e.kind,create:()=>(0,t.freeze)({kind:"OverNode"}),cloneWithOrderByItems:(e,r)=>(0,t.freeze)({...e,orderBy:e.orderBy?i.OrderByNode.cloneWithItems(e.orderBy,r):i.OrderByNode.create(r)}),cloneWithPartitionByItems:(e,i)=>(0,t.freeze)({...e,partitionBy:e.partitionBy?r.cloneWithItems(e.partitionBy,i):r.create(i)})});e.s(["OverNode",0,o],338028)},913031,870445,326015,292465,286474,646599,752564,78800,925176,902757,591658,875670,769918,258390,e=>{"use strict";var t=e.i(361761),i=e.i(344473),r=e.i(1765),o=e.i(504196);e.s(["parseAliasedStringReference",()=>tI,"parseColumnName",()=>tk,"parseJSONReference",()=>tS,"parseOrderedColumnName",()=>tB,"parseReferenceExpression",()=>tC,"parseReferenceExpressionOrList",()=>tz,"parseSimpleReferenceExpression",()=>tx,"parseStringReference",()=>tq],258390);var s=e.i(950495),n=e.i(381196),a=e.i(506083),d=e.i(238227),p=e.i(459094);e.s(["isExpressionOrFactory",()=>tW,"parseAliasedExpression",()=>tb,"parseExpression",()=>tO],769918);var h=e.i(426893),u=e.i(772638),l=e.i(628616),c=e.i(154996),N=e.i(338028),f=e.i(19254);class m{#m;constructor(e){this.#m=(0,p.freeze)(e)}on(...e){return new m({...this.#m,joinNode:l.JoinNode.cloneWithOn(this.#m.joinNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}onRef(e,t,i){return new m({...this.#m,joinNode:l.JoinNode.cloneWithOn(this.#m.joinNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}onTrue(){return new m({...this.#m,joinNode:l.JoinNode.cloneWithOn(this.#m.joinNode,r.RawNode.createWithSql("true"))})}$call(e){return e(this)}toOperationNode(){return this.#m.joinNode}}var y=e.i(192868);e.s(["DynamicReferenceBuilder",()=>w,"isDynamicReferenceBuilder",()=>v],870445);class w{#y;get dynamicReference(){return this.#y}get refType(){}constructor(e){this.#y=e}toOperationNode(){return tx(this.#y)}}function v(e){return(0,p.isObject)(e)&&(0,i.isOperationNodeSource)(e)&&(0,p.isString)(e.dynamicReference)}let g=(0,p.freeze)({is:e=>"OrderByItemNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"OrderByItemNode",orderBy:e,direction:t}),cloneWith:(e,t)=>(0,p.freeze)({...e,...t})});class O{#m;constructor(e){this.#m=(0,p.freeze)(e)}desc(){return new O({node:g.cloneWith(this.#m.node,{direction:r.RawNode.createWithSql("desc")})})}asc(){return new O({node:g.cloneWith(this.#m.node,{direction:r.RawNode.createWithSql("asc")})})}nullsLast(){return new O({node:g.cloneWith(this.#m.node,{nulls:"last"})})}nullsFirst(){return new O({node:g.cloneWith(this.#m.node,{nulls:"first"})})}collate(e){let i;return new O({node:g.cloneWith(this.#m.node,{collation:(i=e,(0,p.freeze)({kind:"CollateNode",collation:t.IdentifierNode.create(i)}))})})}toOperationNode(){return this.#m.node}}var b=e.i(168599);function W(e){return"asc"===e||"desc"===e}function x(e){if(2===e.length)return[z(e[0],e[1])];if(1===e.length){let[t]=e;return Array.isArray(t)?((0,b.logOnce)("orderBy(array) is deprecated, use multiple orderBy calls instead."),t.map(e=>z(e))):[z(t)]}throw Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function z(e,t){let i=function(e){if(tW(e))return tO(e);if(v(e))return e.toOperationNode();let[t,i]=e.split(" ");return i?((0,b.logOnce)("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),C(tq(t),i)):tq(e)}(e);if(g.is(i)){if(t)throw Error("Cannot specify direction twice!");return i}return C(i,t)}function C(e,t){if("string"==typeof t){if(!W(t))throw Error(`Invalid order by direction: ${t}`);return g.create(e,r.RawNode.createWithSql(t))}if((0,h.isExpression)(t))return(0,b.logOnce)("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),g.create(e,t.toOperationNode());let i=g.create(e);return t?t(new O({node:i})).toOperationNode():i}let S=(0,p.freeze)({is:e=>"PartitionByItemNode"===e.kind,create:e=>(0,p.freeze)({kind:"PartitionByItemNode",partitionBy:e})});class q{#m;constructor(e){this.#m=(0,p.freeze)(e)}orderBy(...e){return new q({overNode:N.OverNode.cloneWithOrderByItems(this.#m.overNode,x(e))})}clearOrderBy(){return new q({overNode:y.QueryNode.cloneWithoutOrderBy(this.#m.overNode)})}partitionBy(e){return new q({overNode:N.OverNode.cloneWithPartitionByItems(this.#m.overNode,tz(e).map(S.create))})}$call(e){return e(this)}toOperationNode(){return this.#m.overNode}}e.s(["QueryCreator",()=>eP],78800);var I=e.i(944550);let k=(0,p.freeze)({is:e=>"SelectionNode"===e.kind,create:e=>(0,p.freeze)({kind:"SelectionNode",selection:e}),createSelectAll:()=>(0,p.freeze)({kind:"SelectionNode",selection:I.SelectAllNode.create()}),createSelectAllFromTable:e=>(0,p.freeze)({kind:"SelectionNode",selection:a.ReferenceNode.createSelectAll(e)})});e.s(["parseAliasedTable",()=>E,"parseTable",()=>R,"parseTableExpression",()=>A,"parseTableExpressionOrList",()=>L],292465),e.s(["DynamicTableBuilder",()=>B,"isAliasedDynamicTableBuilder",()=>T],326015);class B{#w;get table(){return this.#w}constructor(e){this.#w=e}as(e){return new Q(this.#w,e)}}class Q{#w;#v;get table(){return this.#w}get alias(){return this.#v}constructor(e,t){this.#w=e,this.#v=t}toOperationNode(){return s.AliasNode.create(R(this.#w),t.IdentifierNode.create(this.#v))}}function T(e){return(0,p.isObject)(e)&&(0,i.isOperationNodeSource)(e)&&(0,p.isString)(e.table)&&(0,p.isString)(e.alias)}function L(e){return(0,p.isReadonlyArray)(e)?e.map(e=>A(e)):[A(e)]}function A(e){return(0,p.isString)(e)?E(e):T(e)?e.toOperationNode():tb(e)}function E(e){let i=" as ";if(!e.includes(i))return R(e);{let[r,o]=e.split(i).map(D);return s.AliasNode.create(R(r),t.IdentifierNode.create(o))}}function R(e){if(!e.includes("."))return d.TableNode.create(e);{let[t,i]=e.split(".").map(D);return d.TableNode.createWithSchema(t,i)}}function D(e){return e.trim()}function M(e){return(0,p.isFunction)(e)?M(e(tg())):(0,p.isReadonlyArray)(e)?e.map(e=>F(e)):[F(e)]}function F(e){return(0,p.isString)(e)?k.create(tI(e)):v(e)?k.create(e.toOperationNode()):k.create(tb(e))}function V(e){return e?Array.isArray(e)?e.map(P):[P(e)]:[k.createSelectAll()]}function P(e){if((0,p.isString)(e))return k.createSelectAllFromTable(R(e));throw Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}var J=e.i(734010),U=e.i(193846),j=e.i(329961);let $=(0,p.freeze)({is:e=>"ValuesNode"===e.kind,create:e=>(0,p.freeze)({kind:"ValuesNode",values:(0,p.freeze)(e)})}),K=(0,p.freeze)({is:e=>"DefaultInsertValueNode"===e.kind,create:()=>(0,p.freeze)({kind:"DefaultInsertValueNode"})});function G(e){var t;let i,r=(0,p.isFunction)(e)?e(tg()):e;return i=function(e){let t=new Map;for(let i of e)for(let e of Object.keys(i))t.has(e)||void 0===i[e]||t.set(e,t.size);return t}(t=(0,p.isReadonlyArray)(r)?r:(0,p.freeze)([r])),[(0,p.freeze)([...i.keys()].map(n.ColumnNode.create)),$.create(t.map(e=>(function(e,t){let i=Object.keys(e),r=Array.from({length:t.size}),o=!1,s=i.length;for(let n of i){let i=t.get(n);if((0,p.isUndefined)(i)){s--;continue}let a=e[n];((0,p.isUndefined)(a)||tW(a))&&(o=!0),r[i]=a}if(s<t.size||o){let e=K.create();return U.ValueListNode.create(r.map(t=>(0,p.isUndefined)(t)?e:(0,j.parseValueExpression)(t)))}return J.PrimitiveValueListNode.create(r)})(e,i)))]}var _=e.i(280182);let H=(0,p.freeze)({is:e=>"ColumnUpdateNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"ColumnUpdateNode",column:e,value:t})});function X(e){return Object.entries((0,p.isFunction)(e)?e(tg()):e).filter(([e,t])=>void 0!==t).map(([e,t])=>H.create(n.ColumnNode.create(e),(0,j.parseValueExpression)(t)))}let Y=(0,p.freeze)({is:e=>"OnDuplicateKeyNode"===e.kind,create:e=>(0,p.freeze)({kind:"OnDuplicateKeyNode",updates:e})});class Z{insertId;numInsertedOrUpdatedRows;constructor(e,t){this.insertId=e,this.numInsertedOrUpdatedRows=t}}class ee extends Error{node;constructor(e){super("no result"),this.node=e}}function et(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}var ei=e.i(210636);let er=(0,p.freeze)({is:e=>"OnConflictNode"===e.kind,create:()=>(0,p.freeze)({kind:"OnConflictNode"}),cloneWith:(e,t)=>(0,p.freeze)({...e,...t}),cloneWithIndexWhere:(e,t)=>(0,p.freeze)({...e,indexWhere:e.indexWhere?ei.WhereNode.cloneWithOperation(e.indexWhere,"And",t):ei.WhereNode.create(t)}),cloneWithIndexOrWhere:(e,t)=>(0,p.freeze)({...e,indexWhere:e.indexWhere?ei.WhereNode.cloneWithOperation(e.indexWhere,"Or",t):ei.WhereNode.create(t)}),cloneWithUpdateWhere:(e,t)=>(0,p.freeze)({...e,updateWhere:e.updateWhere?ei.WhereNode.cloneWithOperation(e.updateWhere,"And",t):ei.WhereNode.create(t)}),cloneWithUpdateOrWhere:(e,t)=>(0,p.freeze)({...e,updateWhere:e.updateWhere?ei.WhereNode.cloneWithOperation(e.updateWhere,"Or",t):ei.WhereNode.create(t)}),cloneWithoutIndexWhere:e=>(0,p.freeze)({...e,indexWhere:void 0}),cloneWithoutUpdateWhere:e=>(0,p.freeze)({...e,updateWhere:void 0})});class eo{#m;constructor(e){this.#m=(0,p.freeze)(e)}column(e){let t=n.ColumnNode.create(e);return new eo({...this.#m,onConflictNode:er.cloneWith(this.#m.onConflictNode,{columns:this.#m.onConflictNode.columns?(0,p.freeze)([...this.#m.onConflictNode.columns,t]):(0,p.freeze)([t])})})}columns(e){let t=e.map(n.ColumnNode.create);return new eo({...this.#m,onConflictNode:er.cloneWith(this.#m.onConflictNode,{columns:this.#m.onConflictNode.columns?(0,p.freeze)([...this.#m.onConflictNode.columns,...t]):(0,p.freeze)(t)})})}constraint(e){return new eo({...this.#m,onConflictNode:er.cloneWith(this.#m.onConflictNode,{constraint:t.IdentifierNode.create(e)})})}expression(e){return new eo({...this.#m,onConflictNode:er.cloneWith(this.#m.onConflictNode,{indexExpression:e.toOperationNode()})})}where(...e){return new eo({...this.#m,onConflictNode:er.cloneWithIndexWhere(this.#m.onConflictNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,i){return new eo({...this.#m,onConflictNode:er.cloneWithIndexWhere(this.#m.onConflictNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}clearWhere(){return new eo({...this.#m,onConflictNode:er.cloneWithoutIndexWhere(this.#m.onConflictNode)})}doNothing(){return new es({...this.#m,onConflictNode:er.cloneWith(this.#m.onConflictNode,{doNothing:!0})})}doUpdateSet(e){return new en({...this.#m,onConflictNode:er.cloneWith(this.#m.onConflictNode,{updates:X(e)})})}$call(e){return e(this)}}class es{#m;constructor(e){this.#m=(0,p.freeze)(e)}toOperationNode(){return this.#m.onConflictNode}}class en{#m;constructor(e){this.#m=(0,p.freeze)(e)}where(...e){return new en({...this.#m,onConflictNode:er.cloneWithUpdateWhere(this.#m.onConflictNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,i){return new en({...this.#m,onConflictNode:er.cloneWithUpdateWhere(this.#m.onConflictNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}clearWhere(){return new en({...this.#m,onConflictNode:er.cloneWithoutUpdateWhere(this.#m.onConflictNode)})}$call(e){return e(this)}toOperationNode(){return this.#m.onConflictNode}}let ea=(0,p.freeze)({is:e=>"TopNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"TopNode",expression:e,modifiers:t})});function ed(e,t){var i;if(!(0,p.isNumber)(e)&&!(0,p.isBigInt)(e))throw Error(`Invalid top expression: ${e}`);if(!(0,p.isUndefined)(t)&&"percent"!==(i=t)&&"with ties"!==i&&"percent with ties"!==i)throw Error(`Invalid top modifiers: ${t}`);return ea.create(e,t)}let ep=(0,p.freeze)({is:e=>"OrActionNode"===e.kind,create:e=>(0,p.freeze)({kind:"OrActionNode",action:e})});class eh{#m;constructor(e){this.#m=(0,p.freeze)(e)}values(e){let[t,i]=G(e);return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{columns:t,values:i})})}columns(e){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{columns:(0,p.freeze)(e.map(n.ColumnNode.create))})})}expression(e){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{values:tO(e)})})}defaultValues(){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{defaultValues:!0})})}modifyEnd(e){return new eh({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,e.toOperationNode())})}ignore(){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{orAction:ep.create("ignore")})})}orIgnore(){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{orAction:ep.create("ignore")})})}orAbort(){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{orAction:ep.create("abort")})})}orFail(){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{orAction:ep.create("fail")})})}orReplace(){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{orAction:ep.create("replace")})})}orRollback(){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{orAction:ep.create("rollback")})})}top(e,t){return new eh({...this.#m,queryNode:y.QueryNode.cloneWithTop(this.#m.queryNode,ed(e,t))})}onConflict(e){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{onConflict:e(new eo({onConflictNode:er.create()})).toOperationNode()})})}onDuplicateKeyUpdate(e){return new eh({...this.#m,queryNode:_.InsertQueryNode.cloneWith(this.#m.queryNode,{onDuplicateKey:Y.create(X(e))})})}returning(e){return new eh({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,M(e))})}returningAll(){return new eh({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,V())})}output(e){return new eh({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,M(e))})}outputAll(e){return new eh({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,V(e))})}clearReturning(){return new eh({...this.#m,queryNode:y.QueryNode.cloneWithoutReturning(this.#m.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new eh({...this.#m})}$castTo(){return new eh(this.#m)}$narrowType(){return new eh(this.#m)}$assertType(){return new eh(this.#m)}withPlugin(e){return new eh({...this.#m,executor:this.#m.executor.withPlugin(e)})}toOperationNode(){return this.#m.executor.transformQuery(this.#m.queryNode,this.#m.queryId)}compile(){return this.#m.executor.compileQuery(this.toOperationNode(),this.#m.queryId)}async execute(){let e=this.compile(),t=await this.#m.executor.executeQuery(e),{adapter:i}=this.#m.executor,r=e.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?t.rows:[new Z(t.insertId,t.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=ee){let t=await this.executeTakeFirst();if(void 0===t)throw et(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let i of this.#m.executor.stream(t,e))yield*i.rows}async explain(e,t){let i=new eh({...this.#m,queryNode:y.QueryNode.cloneWithExplain(this.#m.queryNode,e,t)});return await i.execute()}}class eu{numDeletedRows;constructor(e){this.numDeletedRows=e}}var el=e.i(391889);let ec=(0,p.freeze)({is:e=>"LimitNode"===e.kind,create:e=>(0,p.freeze)({kind:"LimitNode",limit:e})});class eN{#m;constructor(e){this.#m=(0,p.freeze)(e)}where(...e){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithWhere(this.#m.queryNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,i){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithWhere(this.#m.queryNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}clearWhere(){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithoutWhere(this.#m.queryNode)})}top(e,t){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithTop(this.#m.queryNode,ed(e,t))})}using(e){return new eN({...this.#m,queryNode:el.DeleteQueryNode.cloneWithUsing(this.#m.queryNode,L(e))})}innerJoin(...e){return this.#g("InnerJoin",e)}leftJoin(...e){return this.#g("LeftJoin",e)}rightJoin(...e){return this.#g("RightJoin",e)}fullJoin(...e){return this.#g("FullJoin",e)}#g(e,t){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithJoin(this.#m.queryNode,eJ(e,t))})}returning(e){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,M(e))})}returningAll(e){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,V(e))})}output(e){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,M(e))})}outputAll(e){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,V(e))})}clearReturning(){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithoutReturning(this.#m.queryNode)})}clearLimit(){return new eN({...this.#m,queryNode:el.DeleteQueryNode.cloneWithoutLimit(this.#m.queryNode)})}orderBy(...e){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithOrderByItems(this.#m.queryNode,x(e))})}clearOrderBy(){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithoutOrderBy(this.#m.queryNode)})}limit(e){return new eN({...this.#m,queryNode:el.DeleteQueryNode.cloneWithLimit(this.#m.queryNode,ec.create((0,j.parseValueExpression)(e)))})}modifyEnd(e){return new eN({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,e.toOperationNode())})}$call(e){return e(this)}$if(e,t){return e?t(this):new eN({...this.#m})}$castTo(){return new eN(this.#m)}$narrowType(){return new eN(this.#m)}$assertType(){return new eN(this.#m)}withPlugin(e){return new eN({...this.#m,executor:this.#m.executor.withPlugin(e)})}toOperationNode(){return this.#m.executor.transformQuery(this.#m.queryNode,this.#m.queryId)}compile(){return this.#m.executor.compileQuery(this.toOperationNode(),this.#m.queryId)}async execute(){let e=this.compile(),t=await this.#m.executor.executeQuery(e),{adapter:i}=this.#m.executor,r=e.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?t.rows:[new eu(t.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=ee){let t=await this.executeTakeFirst();if(void 0===t)throw et(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let i of this.#m.executor.stream(t,e))yield*i.rows}async explain(e,t){let i=new eN({...this.#m,queryNode:y.QueryNode.cloneWithExplain(this.#m.queryNode,e,t)});return await i.execute()}}var ef=e.i(388758);class em{numUpdatedRows;numChangedRows;constructor(e,t){this.numUpdatedRows=e,this.numChangedRows=t}}class ey{#m;constructor(e){this.#m=(0,p.freeze)(e)}where(...e){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithWhere(this.#m.queryNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,i){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithWhere(this.#m.queryNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}clearWhere(){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithoutWhere(this.#m.queryNode)})}top(e,t){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithTop(this.#m.queryNode,ed(e,t))})}from(e){return new ey({...this.#m,queryNode:ef.UpdateQueryNode.cloneWithFromItems(this.#m.queryNode,L(e))})}innerJoin(...e){return this.#g("InnerJoin",e)}leftJoin(...e){return this.#g("LeftJoin",e)}rightJoin(...e){return this.#g("RightJoin",e)}fullJoin(...e){return this.#g("FullJoin",e)}#g(e,t){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithJoin(this.#m.queryNode,eJ(e,t))})}orderBy(...e){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithOrderByItems(this.#m.queryNode,x(e))})}clearOrderBy(){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithoutOrderBy(this.#m.queryNode)})}limit(e){return new ey({...this.#m,queryNode:ef.UpdateQueryNode.cloneWithLimit(this.#m.queryNode,ec.create((0,j.parseValueExpression)(e)))})}set(...e){return new ey({...this.#m,queryNode:ef.UpdateQueryNode.cloneWithUpdates(this.#m.queryNode,function(...e){return 2===e.length?[H.create(tC(e[0]),(0,j.parseValueExpression)(e[1]))]:X(e[0])}(...e))})}returning(e){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,M(e))})}returningAll(e){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,V(e))})}output(e){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,M(e))})}outputAll(e){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,V(e))})}modifyEnd(e){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,e.toOperationNode())})}clearReturning(){return new ey({...this.#m,queryNode:y.QueryNode.cloneWithoutReturning(this.#m.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new ey({...this.#m})}$castTo(){return new ey(this.#m)}$narrowType(){return new ey(this.#m)}$assertType(){return new ey(this.#m)}withPlugin(e){return new ey({...this.#m,executor:this.#m.executor.withPlugin(e)})}toOperationNode(){return this.#m.executor.transformQuery(this.#m.queryNode,this.#m.queryId)}compile(){return this.#m.executor.compileQuery(this.toOperationNode(),this.#m.queryId)}async execute(){let e=this.compile(),t=await this.#m.executor.executeQuery(e),{adapter:i}=this.#m.executor,r=e.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?t.rows:[new em(t.numAffectedRows??BigInt(0),t.numChangedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=ee){let t=await this.executeTakeFirst();if(void 0===t)throw et(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let i of this.#m.executor.stream(t,e))yield*i.rows}async explain(e,t){let i=new ey({...this.#m,queryNode:y.QueryNode.cloneWithExplain(this.#m.queryNode,e,t)});return await i.execute()}}let ew=(0,p.freeze)({is:e=>"CommonTableExpressionNameNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"CommonTableExpressionNameNode",table:d.TableNode.create(e),columns:t?(0,p.freeze)(t.map(n.ColumnNode.create)):void 0})}),ev=(0,p.freeze)({is:e=>"CommonTableExpressionNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"CommonTableExpressionNode",name:e,expression:t}),cloneWith:(e,t)=>(0,p.freeze)({...e,...t})});class eg{#m;constructor(e){this.#m=(0,p.freeze)(e)}materialized(){return new eg({...this.#m,node:ev.cloneWith(this.#m.node,{materialized:!0})})}notMaterialized(){return new eg({...this.#m,node:ev.cloneWith(this.#m.node,{materialized:!1})})}toOperationNode(){return this.#m.node}}function eO(e,t){var i;let r=t(new eP({executor:eE})).toOperationNode();return(0,p.isFunction)(e)?e((i=r,e=>new eg({node:ev.create(eb(e),i)}))).toOperationNode():ev.create(eb(e),r)}function eb(e){if(!e.includes("("))return ew.create(e);{let t=e.split(/[\(\)]/),i=t[0],r=t[1].split(",").map(e=>e.trim());return ew.create(i,r)}}let eW=(0,p.freeze)({is:e=>"WithNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"WithNode",expressions:(0,p.freeze)([e]),...t}),cloneWithExpression:(e,t)=>(0,p.freeze)({...e,expressions:(0,p.freeze)([...e.expressions,t])})});var ex=e.i(726951),ez=e.i(899948),eC=e.i(91494);let eS=(0,p.freeze)({is:e=>"MatchedNode"===e.kind,create:(e,t=!1)=>(0,p.freeze)({kind:"MatchedNode",not:e,bySource:t})});var eq=e.i(202423);function eI(e,t,i){return eq.WhenNode.create((0,c.parseFilterList)([eS.create(!e.isMatched,e.bySource),...t&&t.length>0?[3===t.length&&i?(0,c.parseReferentialBinaryOperation)(t[0],t[1],t[2]):(0,c.parseValueBinaryOperationOrExpression)(t)]:[]],"and",!1))}function ek(e){return(0,p.isString)(e)?r.RawNode.create([e],[]):(0,i.isOperationNodeSource)(e)?e.toOperationNode():e}class eB{#O;#b;#W;constructor(){this.#O=new Promise((e,t)=>{this.#W=t,this.#b=e})}get promise(){return this.#O}resolve=e=>{this.#b&&this.#b(e)};reject=e=>{this.#W&&this.#W(e)}}async function eQ(e){let t=new eB,i=new eB;return e.provideConnection(async e=>(t.resolve(e),await i.promise)).catch(e=>t.reject(e)),(0,p.freeze)({connection:await t.promise,release:i.resolve})}e.s(["Deferred",()=>eB],286474),e.s(["provideControlledConnection",()=>eQ],646599);let eT=(0,p.freeze)([]);class eL{#x;constructor(e=eT){this.#x=e}get plugins(){return this.#x}transformQuery(e,t){for(let i of this.#x){let r=i.transformQuery({node:e,queryId:t});if(r.kind===e.kind)e=r;else throw Error(`KyselyPlugin.transformQuery must return a node of the same kind that was given to it. The plugin was given a ${e.kind} but it returned a ${r.kind}`)}return e}async executeQuery(e){return await this.provideConnection(async t=>{let i=await t.executeQuery(e);return"numUpdatedOrDeletedRows"in i&&(0,b.logOnce)("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`."),await this.#z(i,e.queryId)})}async *stream(e,t){let{connection:i,release:r}=await eQ(this);try{for await(let r of i.streamQuery(e,t))yield await this.#z(r,e.queryId)}finally{r()}}async #z(e,t){for(let i of this.#x)e=await i.transformResult({result:e,queryId:t});return e}}e.s(["QueryExecutorBase",()=>eL],752564);class eA extends eL{get adapter(){throw Error("this query cannot be compiled to SQL")}compileQuery(){throw Error("this query cannot be compiled to SQL")}provideConnection(){throw Error("this query cannot be executed")}withConnectionProvider(){throw Error("this query cannot have a connection provider")}withPlugin(e){return new eA([...this.plugins,e])}withPlugins(e){return new eA([...this.plugins,...e])}withPluginAtFront(e){return new eA([e,...this.plugins])}withoutPlugins(){return new eA([])}}let eE=new eA;class eR{numChangedRows;constructor(e){this.numChangedRows=e}}class eD{#m;constructor(e){this.#m=(0,p.freeze)(e)}modifyEnd(e){return new eD({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,e.toOperationNode())})}top(e,t){return new eD({...this.#m,queryNode:y.QueryNode.cloneWithTop(this.#m.queryNode,ed(e,t))})}using(...e){return new eM({...this.#m,queryNode:eC.MergeQueryNode.cloneWithUsing(this.#m.queryNode,eJ("Using",e))})}returning(e){return new eD({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,M(e))})}returningAll(e){return new eD({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,V(e))})}output(e){return new eD({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,M(e))})}outputAll(e){return new eD({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,V(e))})}}class eM{#m;constructor(e){this.#m=(0,p.freeze)(e)}modifyEnd(e){return new eM({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,e.toOperationNode())})}top(e,t){return new eM({...this.#m,queryNode:y.QueryNode.cloneWithTop(this.#m.queryNode,ed(e,t))})}whenMatched(){return this.#C([])}whenMatchedAnd(...e){return this.#C(e)}whenMatchedAndRef(e,t,i){return this.#C([e,t,i],!0)}#C(e,t){return new eF({...this.#m,queryNode:eC.MergeQueryNode.cloneWithWhen(this.#m.queryNode,eI({isMatched:!0},e,t))})}whenNotMatched(){return this.#S([])}whenNotMatchedAnd(...e){return this.#S(e)}whenNotMatchedAndRef(e,t,i){return this.#S([e,t,i],!0)}whenNotMatchedBySource(){return this.#S([],!1,!0)}whenNotMatchedBySourceAnd(...e){return this.#S(e,!1,!0)}whenNotMatchedBySourceAndRef(e,t,i){return this.#S([e,t,i],!0,!0)}returning(e){return new eM({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,M(e))})}returningAll(e){return new eM({...this.#m,queryNode:y.QueryNode.cloneWithReturning(this.#m.queryNode,V(e))})}output(e){return new eM({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,M(e))})}outputAll(e){return new eM({...this.#m,queryNode:y.QueryNode.cloneWithOutput(this.#m.queryNode,V(e))})}#S(e,t=!1,i=!1){let r={...this.#m,queryNode:eC.MergeQueryNode.cloneWithWhen(this.#m.queryNode,eI({isMatched:!1,bySource:i},e,t))};return new(i?eF:eV)(r)}$call(e){return e(this)}$if(e,t){return e?t(this):new eM({...this.#m})}toOperationNode(){return this.#m.executor.transformQuery(this.#m.queryNode,this.#m.queryId)}compile(){return this.#m.executor.compileQuery(this.toOperationNode(),this.#m.queryId)}async execute(){let e=this.compile(),t=await this.#m.executor.executeQuery(e),{adapter:i}=this.#m.executor,r=e.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?t.rows:[new eR(t.numAffectedRows)]}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=ee){let t=await this.executeTakeFirst();if(void 0===t)throw et(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}}class eF{#m;constructor(e){this.#m=(0,p.freeze)(e)}thenDelete(){return new eM({...this.#m,queryNode:eC.MergeQueryNode.cloneWithThen(this.#m.queryNode,ek("delete"))})}thenDoNothing(){return new eM({...this.#m,queryNode:eC.MergeQueryNode.cloneWithThen(this.#m.queryNode,ek("do nothing"))})}thenUpdate(e){return new eM({...this.#m,queryNode:eC.MergeQueryNode.cloneWithThen(this.#m.queryNode,ek(e(new ey({queryId:this.#m.queryId,executor:eE,queryNode:ef.UpdateQueryNode.createWithoutTable()}))))})}thenUpdateSet(...e){return this.thenUpdate(t=>t.set(...e))}}class eV{#m;constructor(e){this.#m=(0,p.freeze)(e)}thenDoNothing(){return new eM({...this.#m,queryNode:eC.MergeQueryNode.cloneWithThen(this.#m.queryNode,ek("do nothing"))})}thenInsertValues(e){let[t,i]=G(e);return new eM({...this.#m,queryNode:eC.MergeQueryNode.cloneWithThen(this.#m.queryNode,ek(_.InsertQueryNode.cloneWith(_.InsertQueryNode.createWithoutInto(),{columns:t,values:i})))})}}class eP{#m;constructor(e){this.#m=(0,p.freeze)(e)}selectFrom(e){return new e9({queryId:(0,ex.createQueryId)(),executor:this.#m.executor,queryNode:f.SelectQueryNode.createFrom(L(e),this.#m.withNode)})}selectNoFrom(e){return new e9({queryId:(0,ex.createQueryId)(),executor:this.#m.executor,queryNode:f.SelectQueryNode.cloneWithSelections(f.SelectQueryNode.create(this.#m.withNode),M(e))})}insertInto(e){return new eh({queryId:(0,ex.createQueryId)(),executor:this.#m.executor,queryNode:_.InsertQueryNode.create(R(e),this.#m.withNode)})}replaceInto(e){return new eh({queryId:(0,ex.createQueryId)(),executor:this.#m.executor,queryNode:_.InsertQueryNode.create(R(e),this.#m.withNode,!0)})}deleteFrom(e){return new eN({queryId:(0,ex.createQueryId)(),executor:this.#m.executor,queryNode:el.DeleteQueryNode.create(L(e),this.#m.withNode)})}updateTable(e){return new ey({queryId:(0,ex.createQueryId)(),executor:this.#m.executor,queryNode:ef.UpdateQueryNode.create(L(e),this.#m.withNode)})}mergeInto(e){return new eD({queryId:(0,ex.createQueryId)(),executor:this.#m.executor,queryNode:eC.MergeQueryNode.create(E(e),this.#m.withNode)})}with(e,t){let i=eO(e,t);return new eP({...this.#m,withNode:this.#m.withNode?eW.cloneWithExpression(this.#m.withNode,i):eW.create(i)})}withRecursive(e,t){let i=eO(e,t);return new eP({...this.#m,withNode:this.#m.withNode?eW.cloneWithExpression(this.#m.withNode,i):eW.create(i,{recursive:!0})})}withPlugin(e){return new eP({...this.#m,executor:this.#m.executor.withPlugin(e)})}withoutPlugins(){return new eP({...this.#m,executor:this.#m.executor.withoutPlugins()})}withSchema(e){return new eP({...this.#m,executor:this.#m.executor.withPluginAtFront(new ez.WithSchemaPlugin(e))})}}function eJ(e,t){var i,r,o,s,n,a;if(3===t.length){return i=e,r=t[0],o=t[1],s=t[2],l.JoinNode.createWithOn(i,A(r),(0,c.parseReferentialBinaryOperation)(o,"=",s))}if(2===t.length)return function(e,t,i){return i(new m({joinNode:l.JoinNode.create(e,A(t))})).toOperationNode()}(e,t[0],t[1]);if(1===t.length){return n=e,a=t[0],l.JoinNode.create(n,A(a))}throw Error("not implemented")}let eU=(0,p.freeze)({is:e=>"OffsetNode"===e.kind,create:e=>(0,p.freeze)({kind:"OffsetNode",offset:e})}),ej=(0,p.freeze)({is:e=>"GroupByItemNode"===e.kind,create:e=>(0,p.freeze)({kind:"GroupByItemNode",groupBy:e})});var e$=e.i(439504);function eK(e,t,i){return(0,p.isFunction)(t)&&(t=t(tg())),(0,p.isReadonlyArray)(t)||(t=[t]),t.map(t=>e$.SetOperationNode.create(e,tO(t),i))}var eG=e.i(9445),e_=e.i(816032),eH=e.i(688986);class eX{#q;constructor(e){this.#q=e}get expressionType(){}as(e){return new eY(this,e)}or(...e){return new eZ(e_.OrNode.create(this.#q,(0,c.parseValueBinaryOperationOrExpression)(e)))}and(...e){return new e0(eG.AndNode.create(this.#q,(0,c.parseValueBinaryOperationOrExpression)(e)))}$castTo(){return new eX(this.#q)}$notNull(){return new eX(this.#q)}toOperationNode(){return this.#q}}class eY{#I;#v;constructor(e,t){this.#I=e,this.#v=t}get expression(){return this.#I}get alias(){return this.#v}toOperationNode(){return s.AliasNode.create(this.#I.toOperationNode(),(0,i.isOperationNodeSource)(this.#v)?this.#v.toOperationNode():t.IdentifierNode.create(this.#v))}}class eZ{#q;constructor(e){this.#q=e}get expressionType(){}as(e){return new eY(this,e)}or(...e){return new eZ(e_.OrNode.create(this.#q,(0,c.parseValueBinaryOperationOrExpression)(e)))}$castTo(){return new eZ(this.#q)}toOperationNode(){return eH.ParensNode.create(this.#q)}}class e0{#q;constructor(e){this.#q=e}get expressionType(){}as(e){return new eY(this,e)}and(...e){return new e0(eG.AndNode.create(this.#q,(0,c.parseValueBinaryOperationOrExpression)(e)))}$castTo(){return new e0(this.#q)}toOperationNode(){return eH.ParensNode.create(this.#q)}}class e9{#m;constructor(e){this.#m=(0,p.freeze)(e)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...e){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithWhere(this.#m.queryNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}whereRef(e,t,i){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithWhere(this.#m.queryNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}having(...e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithHaving(this.#m.queryNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}havingRef(e,t,i){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithHaving(this.#m.queryNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}select(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSelections(this.#m.queryNode,M(e))})}distinctOn(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithDistinctOn(this.#m.queryNode,tz(e))})}modifyFront(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithFrontModifier(this.#m.queryNode,u.SelectModifierNode.createWithExpression(e.toOperationNode()))})}modifyEnd(e){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,u.SelectModifierNode.createWithExpression(e.toOperationNode()))})}distinct(){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithFrontModifier(this.#m.queryNode,u.SelectModifierNode.create("Distinct"))})}forUpdate(e){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,u.SelectModifierNode.create("ForUpdate",e?(0,p.asArray)(e).map(R):void 0))})}forShare(e){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,u.SelectModifierNode.create("ForShare",e?(0,p.asArray)(e).map(R):void 0))})}forKeyShare(e){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,u.SelectModifierNode.create("ForKeyShare",e?(0,p.asArray)(e).map(R):void 0))})}forNoKeyUpdate(e){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,u.SelectModifierNode.create("ForNoKeyUpdate",e?(0,p.asArray)(e).map(R):void 0))})}skipLocked(){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,u.SelectModifierNode.create("SkipLocked"))})}noWait(){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithEndModifier(this.#m.queryNode,u.SelectModifierNode.create("NoWait"))})}selectAll(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSelections(this.#m.queryNode,V(e))})}innerJoin(...e){return this.#g("InnerJoin",e)}leftJoin(...e){return this.#g("LeftJoin",e)}rightJoin(...e){return this.#g("RightJoin",e)}fullJoin(...e){return this.#g("FullJoin",e)}crossJoin(...e){return this.#g("CrossJoin",e)}innerJoinLateral(...e){return this.#g("LateralInnerJoin",e)}leftJoinLateral(...e){return this.#g("LateralLeftJoin",e)}crossJoinLateral(...e){return this.#g("LateralCrossJoin",e)}crossApply(...e){return this.#g("CrossApply",e)}outerApply(...e){return this.#g("OuterApply",e)}#g(e,t){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithJoin(this.#m.queryNode,eJ(e,t))})}orderBy(...e){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithOrderByItems(this.#m.queryNode,x(e))})}groupBy(e){var t;return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithGroupByItems(this.#m.queryNode,(t=e,tz(t=(0,p.isFunction)(t)?t(tg()):t).map(ej.create)))})}limit(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithLimit(this.#m.queryNode,ec.create((0,j.parseValueExpression)(e)))})}offset(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithOffset(this.#m.queryNode,eU.create((0,j.parseValueExpression)(e)))})}fetch(e,t="only"){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithFetch(this.#m.queryNode,function(e,t){var i;let r,s;if(!(0,p.isNumber)(e)&&!(0,p.isBigInt)(e))throw Error(`Invalid fetch row count: ${e}`);if("only"!==(i=t)&&"with ties"!==i)throw Error(`Invalid fetch modifier: ${t}`);return r=e,s=t,{kind:"FetchNode",rowCount:o.ValueNode.create(r),modifier:s}}(e,t))})}top(e,t){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithTop(this.#m.queryNode,ed(e,t))})}union(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSetOperations(this.#m.queryNode,eK("union",e,!1))})}unionAll(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSetOperations(this.#m.queryNode,eK("union",e,!0))})}intersect(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSetOperations(this.#m.queryNode,eK("intersect",e,!1))})}intersectAll(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSetOperations(this.#m.queryNode,eK("intersect",e,!0))})}except(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSetOperations(this.#m.queryNode,eK("except",e,!1))})}exceptAll(e){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithSetOperations(this.#m.queryNode,eK("except",e,!0))})}as(e){return new e6(this,e)}clearSelect(){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithoutSelections(this.#m.queryNode)})}clearWhere(){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithoutWhere(this.#m.queryNode)})}clearLimit(){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithoutLimit(this.#m.queryNode)})}clearOffset(){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithoutOffset(this.#m.queryNode)})}clearOrderBy(){return new e9({...this.#m,queryNode:y.QueryNode.cloneWithoutOrderBy(this.#m.queryNode)})}clearGroupBy(){return new e9({...this.#m,queryNode:f.SelectQueryNode.cloneWithoutGroupBy(this.#m.queryNode)})}$call(e){return e(this)}$if(e,t){return e?t(this):new e9({...this.#m})}$castTo(){return new e9(this.#m)}$narrowType(){return new e9(this.#m)}$assertType(){return new e9(this.#m)}$asTuple(){return new eX(this.toOperationNode())}$asScalar(){return new eX(this.toOperationNode())}withPlugin(e){return new e9({...this.#m,executor:this.#m.executor.withPlugin(e)})}toOperationNode(){return this.#m.executor.transformQuery(this.#m.queryNode,this.#m.queryId)}compile(){return this.#m.executor.compileQuery(this.toOperationNode(),this.#m.queryId)}async execute(){let e=this.compile();return(await this.#m.executor.executeQuery(e)).rows}async executeTakeFirst(){let[e]=await this.execute();return e}async executeTakeFirstOrThrow(e=ee){let t=await this.executeTakeFirst();if(void 0===t)throw et(e)?new e(this.toOperationNode()):e(this.toOperationNode());return t}async *stream(e=100){let t=this.compile();for await(let i of this.#m.executor.stream(t,e))yield*i.rows}async explain(e,t){let i=new e9({...this.#m,queryNode:y.QueryNode.cloneWithExplain(this.#m.queryNode,e,t)});return await i.execute()}}class e6{#k;#v;constructor(e,t){this.#k=e,this.#v=t}get expression(){return this.#k}get alias(){return this.#v}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return s.AliasNode.create(this.#k.toOperationNode(),t.IdentifierNode.create(this.#v))}}e.s(["createFunctionModule",()=>e3],925176);var e8=e.i(969565);let e1=(0,p.freeze)({is:e=>"AggregateFunctionNode"===e.kind,create:(e,t=[])=>(0,p.freeze)({kind:"AggregateFunctionNode",func:e,aggregated:t}),cloneWithDistinct:e=>(0,p.freeze)({...e,distinct:!0}),cloneWithOrderBy(e,t,i=!1){let r=i?"withinGroup":"orderBy";return(0,p.freeze)({...e,[r]:e[r]?e8.OrderByNode.cloneWithItems(e[r],t):e8.OrderByNode.create(t)})},cloneWithFilter:(e,t)=>(0,p.freeze)({...e,filter:e.filter?ei.WhereNode.cloneWithOperation(e.filter,"And",t):ei.WhereNode.create(t)}),cloneWithOrFilter:(e,t)=>(0,p.freeze)({...e,filter:e.filter?ei.WhereNode.cloneWithOperation(e.filter,"Or",t):ei.WhereNode.create(t)}),cloneWithOver:(e,t)=>(0,p.freeze)({...e,over:t})}),e4=(0,p.freeze)({is:e=>"FunctionNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"FunctionNode",func:e,arguments:t})});class e2{#m;constructor(e){this.#m=(0,p.freeze)(e)}get expressionType(){}as(e){return new e5(this,e)}distinct(){return new e2({...this.#m,aggregateFunctionNode:e1.cloneWithDistinct(this.#m.aggregateFunctionNode)})}orderBy(...e){return new e2({...this.#m,aggregateFunctionNode:y.QueryNode.cloneWithOrderByItems(this.#m.aggregateFunctionNode,x(e))})}clearOrderBy(){return new e2({...this.#m,aggregateFunctionNode:y.QueryNode.cloneWithoutOrderBy(this.#m.aggregateFunctionNode)})}withinGroupOrderBy(...e){return new e2({...this.#m,aggregateFunctionNode:e1.cloneWithOrderBy(this.#m.aggregateFunctionNode,x(e),!0)})}filterWhere(...e){return new e2({...this.#m,aggregateFunctionNode:e1.cloneWithFilter(this.#m.aggregateFunctionNode,(0,c.parseValueBinaryOperationOrExpression)(e))})}filterWhereRef(e,t,i){return new e2({...this.#m,aggregateFunctionNode:e1.cloneWithFilter(this.#m.aggregateFunctionNode,(0,c.parseReferentialBinaryOperation)(e,t,i))})}over(e){let t=new q({overNode:N.OverNode.create()});return new e2({...this.#m,aggregateFunctionNode:e1.cloneWithOver(this.#m.aggregateFunctionNode,(e?e(t):t).toOperationNode())})}$call(e){return e(this)}$castTo(){return new e2(this.#m)}$notNull(){return new e2(this.#m)}toOperationNode(){return this.#m.aggregateFunctionNode}}class e5{#B;#v;constructor(e,t){this.#B=e,this.#v=t}get expression(){return this.#B}get alias(){return this.#v}toOperationNode(){return s.AliasNode.create(this.#B.toOperationNode(),t.IdentifierNode.create(this.#v))}}function e3(){let e=(e,t)=>new eX(e4.create(e,tz(t??[]))),t=(e,t)=>new e2({aggregateFunctionNode:e1.create(e,t?tz(t):void 0)});return Object.assign(e,{agg:t,avg:e=>t("avg",[e]),coalesce:(...t)=>e("coalesce",t),count:e=>t("count",[e]),countAll:e=>new e2({aggregateFunctionNode:e1.create("count",V(e))}),max:e=>t("max",[e]),min:e=>t("min",[e]),sum:e=>t("sum",[e]),any:t=>e("any",[t]),jsonAgg:e=>new e2({aggregateFunctionNode:e1.create("json_agg",[(0,p.isString)(e)?R(e):e.toOperationNode()])}),toJson:e=>new eX(e4.create("to_json",[(0,p.isString)(e)?R(e):e.toOperationNode()]))})}var e7=e.i(380727);let te=(0,p.freeze)({is:e=>"UnaryOperationNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"UnaryOperationNode",operator:e,operand:t})});e.s(["CaseBuilder",()=>ti],591658);let tt=(0,p.freeze)({is:e=>"CaseNode"===e.kind,create:e=>(0,p.freeze)({kind:"CaseNode",value:e}),cloneWithWhen:(e,t)=>(0,p.freeze)({...e,when:(0,p.freeze)(e.when?[...e.when,t]:[t])}),cloneWithThen:(e,t)=>(0,p.freeze)({...e,when:e.when?(0,p.freeze)([...e.when.slice(0,-1),eq.WhenNode.cloneWithResult(e.when[e.when.length-1],t)]):void 0}),cloneWith:(e,t)=>(0,p.freeze)({...e,...t})});e.s(["CaseNode",0,tt],902757);class ti{#m;constructor(e){this.#m=(0,p.freeze)(e)}when(...e){return new tr({...this.#m,node:tt.cloneWithWhen(this.#m.node,eq.WhenNode.create((0,c.parseValueBinaryOperationOrExpression)(e)))})}}class tr{#m;constructor(e){this.#m=(0,p.freeze)(e)}then(e){return new to({...this.#m,node:tt.cloneWithThen(this.#m.node,(0,j.isSafeImmediateValue)(e)?(0,j.parseSafeImmediateValue)(e):(0,j.parseValueExpression)(e))})}}class to{#m;constructor(e){this.#m=(0,p.freeze)(e)}when(...e){return new tr({...this.#m,node:tt.cloneWithWhen(this.#m.node,eq.WhenNode.create((0,c.parseValueBinaryOperationOrExpression)(e)))})}else(e){return new ts({...this.#m,node:tt.cloneWith(this.#m.node,{else:(0,j.isSafeImmediateValue)(e)?(0,j.parseSafeImmediateValue)(e):(0,j.parseValueExpression)(e)})})}end(){return new eX(tt.cloneWith(this.#m.node,{isStatement:!1}))}endCase(){return new eX(tt.cloneWith(this.#m.node,{isStatement:!0}))}}class ts{#m;constructor(e){this.#m=(0,p.freeze)(e)}end(){return new eX(tt.cloneWith(this.#m.node,{isStatement:!1}))}endCase(){return new eX(tt.cloneWith(this.#m.node,{isStatement:!0}))}}let tn=(0,p.freeze)({is:e=>"JSONOperatorChainNode"===e.kind,create:e=>(0,p.freeze)({kind:"JSONOperatorChainNode",operator:e,values:(0,p.freeze)([])}),cloneWithValue:(e,t)=>(0,p.freeze)({...e,values:(0,p.freeze)([...e.values,t])})}),ta=(0,p.freeze)({is:e=>"JSONPathLegNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"JSONPathLegNode",type:e,value:t})}),td=(0,p.freeze)({is:e=>"JSONPathNode"===e.kind,create:e=>(0,p.freeze)({kind:"JSONPathNode",inOperator:e,pathLegs:(0,p.freeze)([])}),cloneWithLeg:(e,t)=>(0,p.freeze)({...e,pathLegs:(0,p.freeze)([...e.pathLegs,t])})}),tp=(0,p.freeze)({is:e=>"JSONReferenceNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"JSONReferenceNode",reference:e,traversal:t}),cloneWithTraversal:(e,t)=>(0,p.freeze)({...e,traversal:t})});class th{#q;constructor(e){this.#q=e}at(e){return this.#Q("ArrayLocation",e)}key(e){return this.#Q("Member",e)}#Q(e,t){return new tu(tp.is(this.#q)?tp.cloneWithTraversal(this.#q,td.is(this.#q.traversal)?td.cloneWithLeg(this.#q.traversal,ta.create(e,t)):tn.cloneWithValue(this.#q.traversal,o.ValueNode.createImmediate(t))):td.cloneWithLeg(this.#q,ta.create(e,t)))}}class tu extends th{#q;constructor(e){super(e),this.#q=e}get expressionType(){}as(e){return new tl(this,e)}$castTo(){return new tu(this.#q)}$notNull(){return new tu(this.#q)}toOperationNode(){return this.#q}}class tl{#T;#v;constructor(e,t){this.#T=e,this.#v=t}get expression(){return this.#T}get alias(){return this.#v}toOperationNode(){return s.AliasNode.create(this.#T.toOperationNode(),(0,i.isOperationNodeSource)(this.#v)?this.#v.toOperationNode():t.IdentifierNode.create(this.#v))}}var tc=e.i(409762);let tN=(0,p.freeze)({is:e=>"TupleNode"===e.kind,create:e=>(0,p.freeze)({kind:"TupleNode",values:(0,p.freeze)(e)})}),tf=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],tm=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],ty=(0,p.freeze)({is:e=>"DataTypeNode"===e.kind,create:e=>(0,p.freeze)({kind:"DataTypeNode",dataType:e})});function tw(e){if((0,i.isOperationNodeSource)(e))return e.toOperationNode();if(tf.includes(e)||tm.some(t=>t.test(e)))return ty.create(e);throw Error(`invalid column data type ${JSON.stringify(e)}`)}e.s(["parseDataTypeExpression",()=>tw],875670);let tv=(0,p.freeze)({is:e=>"CastNode"===e.kind,create:(e,t)=>(0,p.freeze)({kind:"CastNode",expression:e,dataType:t})});function tg(e=eE){function t(e,t){return new eX(te.create(e7.OperatorNode.create(e),tC(t)))}let i=Object.assign(function(e,t,i){return new eX((0,c.parseValueBinaryOperation)(e,t,i))},{fn:void 0,eb:void 0,selectFrom:t=>new e9({queryId:(0,ex.createQueryId)(),executor:e,queryNode:f.SelectQueryNode.createFrom(L(t))}),case:e=>new ti({node:tt.create((0,p.isUndefined)(e)?void 0:tC(e))}),ref:(e,t)=>(0,p.isUndefined)(t)?new eX(tq(e)):new th(tS(e,t)),jsonPath:()=>new th(td.create()),table:e=>new eX(R(e)),val:e=>new eX((0,j.parseValueExpression)(e)),refTuple:(...e)=>new eX(tN.create(e.map(tC))),tuple:(...e)=>new eX(tN.create(e.map(j.parseValueExpression))),lit:e=>new eX((0,j.parseSafeImmediateValue)(e)),unary:t,not:e=>t("not",e),exists:e=>t("exists",e),neg:e=>t("-",e),between:(e,t,i)=>new eX(tc.BinaryOperationNode.create(tC(e),e7.OperatorNode.create("between"),eG.AndNode.create((0,j.parseValueExpression)(t),(0,j.parseValueExpression)(i)))),betweenSymmetric:(e,t,i)=>new eX(tc.BinaryOperationNode.create(tC(e),e7.OperatorNode.create("between symmetric"),eG.AndNode.create((0,j.parseValueExpression)(t),(0,j.parseValueExpression)(i)))),and:e=>new eX((0,p.isReadonlyArray)(e)?(0,c.parseFilterList)(e,"and"):(0,c.parseFilterObject)(e,"and")),or:e=>new eX((0,p.isReadonlyArray)(e)?(0,c.parseFilterList)(e,"or"):(0,c.parseFilterObject)(e,"or")),parens(...e){let t=(0,c.parseValueBinaryOperationOrExpression)(e);return new eX(eH.ParensNode.is(t)?t:eH.ParensNode.create(t))},cast:(e,t)=>new eX(tv.create(tC(e),tw(t))),withSchema:t=>tg(e.withPluginAtFront(new ez.WithSchemaPlugin(t)))});return i.fn=e3(),i.eb=i,i}function tO(e){if((0,i.isOperationNodeSource)(e))return e.toOperationNode();if((0,p.isFunction)(e))return e(tg()).toOperationNode();throw Error(`invalid expression: ${JSON.stringify(e)}`)}function tb(e){if((0,i.isOperationNodeSource)(e))return e.toOperationNode();if((0,p.isFunction)(e))return e(tg()).toOperationNode();throw Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function tW(e){return(0,h.isExpression)(e)||(0,h.isAliasedExpression)(e)||(0,p.isFunction)(e)}function tx(e){return(0,p.isString)(e)?tq(e):e.toOperationNode()}function tz(e){return(0,p.isReadonlyArray)(e)?e.map(e=>tC(e)):[tC(e)]}function tC(e){return tW(e)?tO(e):tx(e)}function tS(e,t){let i=tq(e);if((0,e7.isJSONOperator)(t))return tp.create(i,tn.create(e7.OperatorNode.create(t)));let r=t.slice(0,-1);if((0,e7.isJSONOperator)(r))return tp.create(i,td.create(e7.OperatorNode.create(r)));throw Error(`Invalid JSON operator: ${t}`)}function tq(e){if(!e.includes("."))return a.ReferenceNode.create(n.ColumnNode.create(e));let t=e.split(".").map(tQ);if(3===t.length)return function(e){let[t,i,r]=e;return a.ReferenceNode.create(n.ColumnNode.create(r),d.TableNode.createWithSchema(t,i))}(t);if(2===t.length)return function(e){let[t,i]=e;return a.ReferenceNode.create(n.ColumnNode.create(i),d.TableNode.create(t))}(t);throw Error(`invalid column reference ${e}`)}function tI(e){let i=" as ";if(!e.includes(i))return tq(e);{let[r,o]=e.split(i).map(tQ);return s.AliasNode.create(tq(r),t.IdentifierNode.create(o))}}function tk(e){return n.ColumnNode.create(e)}function tB(e){if(!e.includes(" "))return tk(e);{let[t,i]=e.split(" ").map(tQ);if(!W(i))throw Error(`invalid order direction "${i}" next to "${t}"`);return x([t,i])[0]}}function tQ(e){return e.trim()}class tT{#m;constructor(e){this.#m=(0,p.freeze)(e)}get expressionType(){}get isRawBuilder(){return!0}as(e){return new tA(this,e)}$castTo(){return new tT({...this.#m})}$notNull(){return new tT(this.#m)}withPlugin(e){return new tT({...this.#m,plugins:void 0!==this.#m.plugins?(0,p.freeze)([...this.#m.plugins,e]):(0,p.freeze)([e])})}toOperationNode(){return this.#L(this.#A())}compile(e){return this.#E(this.#A(e))}async execute(e){let t=this.#A(e);return t.executeQuery(this.#E(t))}#A(e){let t=void 0!==e?e.getExecutor():eE;return void 0!==this.#m.plugins?t.withPlugins(this.#m.plugins):t}#L(e){return e.transformQuery(this.#m.rawNode,this.#m.queryId)}#E(e){return e.compileQuery(this.#L(e),this.#m.queryId)}}function tL(e){return new tT(e)}class tA{#R;#v;constructor(e,t){this.#R=e,this.#v=t}get expression(){return this.#R}get alias(){return this.#v}get rawBuilder(){return this.#R}toOperationNode(){return s.AliasNode.create(this.#R.toOperationNode(),(0,i.isOperationNodeSource)(this.#v)?this.#v.toOperationNode():t.IdentifierNode.create(this.#v))}}let tE=Object.assign((e,...t)=>tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.create(e,t?.map(tR)??[])}),{ref:e=>tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.createWithChild(tq(e))}),val:e=>tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.createWithChild((0,j.parseValueExpression)(e))}),value(e){return this.val(e)},table:e=>tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.createWithChild(R(e))}),id(...e){let i=Array(e.length+1).fill(".");return i[0]="",i[i.length-1]="",tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.create(i,e.map(t.IdentifierNode.create))})},lit:e=>tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.createWithChild(o.ValueNode.createImmediate(e))}),literal(e){return this.lit(e)},raw:e=>tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.createWithSql(e)}),join(e,t=tE`, `){let i=Array(Math.max(2*e.length-1,0)),o=t.toOperationNode();for(let t=0;t<e.length;++t)i[2*t]=tR(e[t]),t!==e.length-1&&(i[2*t+1]=o);return tL({queryId:(0,ex.createQueryId)(),rawNode:r.RawNode.createWithChildren(i)})}});function tR(e){return(0,i.isOperationNodeSource)(e)?e.toOperationNode():(0,j.parseValueExpression)(e)}e.s(["sql",0,tE],913031)}];

//# sourceMappingURL=node_modules_kysely_dist_esm_50461ed0._.js.map