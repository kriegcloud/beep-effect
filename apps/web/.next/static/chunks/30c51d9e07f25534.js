(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,567602,176478,94061,323349,663875,183020,161231,237214,729177,953279,757971,165527,e=>{"use strict";let t,r,n,i,a,o,s,l,c;var d,u,p=e.i(741140),m=e.i(915838),f=e.i(375688),h=e.i(886999),g=e.i(862409),y=e.i(681830),S=e.i(277233),b=e.i(618458);let E="~@beep/iam-sdk/Contract",w="~@beep/iam-sdk/Contract/ProviderDefined",R=e=>y.hasProperty(e,w),v={[E]:{_Requirements:m.identity},pipe(){return(0,g.pipeArguments)(this,arguments)},addDependency(){return T({...this})},setParameters(e){return T({...this,parametersSchema:S.isSchema(e)?e:S.Struct(e)})},setSuccess(e){return T({...this,successSchema:e})},setFailure(e){return T({...this,failureSchema:e})},annotate(e,t){return T({...this,annotations:p.add(this.annotations,e,t)})},annotateContext(e){return T({...this,annotations:p.merge(this.annotations,e)})}},P={...v,[w]:w},T=e=>{let t=Object.assign(Object.create(v),e);return t.id=`@beep/iam-sdk/Contract/${e.name}`,t},O=S.Struct({}),I=e=>T({name:e._tag,description:h.getOrUndefined(b.getDescriptionAnnotation(e.ast.to)),parametersSchema:e,successSchema:e.success,failureSchema:e.failure,failureMode:"error",annotations:p.empty()}),k=e=>{let t="Transformation"===e._tag?{...e.to.annotations,...e.annotations}:e.annotations;return b.DescriptionAnnotationId in t?t[b.DescriptionAnnotationId]:void 0},U=e=>{if(0===b.getPropertySignatures(e).length)return{type:"object",properties:{},required:[],additionalProperties:!1};let t={},r=f.fromAST(e,{definitions:t,topLevelReferenceStrategy:"skip"});return 0===Object.keys(t).length||(r.$defs=t),r};class A extends p.Tag("@beep/iam-sdk/Contract/Title")(){}class C extends p.Reference()("@beep/iam-sdk/Contract/Readonly",{defaultValue:m.constFalse}){}class x extends p.Reference()("@beep/iam-sdk/Contract/Destructive",{defaultValue:m.constTrue}){}class _ extends p.Reference()("@beep/iam-sdk/Contract/Idempotent",{defaultValue:m.constFalse}){}class N extends p.Reference()("@beep/iam-sdk/Contract/OpenWorld",{defaultValue:m.constTrue}){}let $=/"__proto__"\s*:/,D=/"constructor"\s*:/;e.s(["Destructive",()=>x,"Idempotent",()=>_,"OpenWorld",()=>N,"ProviderDefinedTypeId",0,w,"Readonly",()=>C,"Title",()=>A,"TypeId",0,E,"fromTaggedRequest",0,I,"getDescription",0,e=>y.isNotUndefined(e.description)?e.description:k(e.parametersSchema.ast),"getDescriptionFromSchemaAst",0,k,"getJsonSchema",0,e=>U(e.parametersSchema.ast),"getJsonSchemaFromSchemaAst",0,U,"isProviderDefined",0,R,"isUserDefined",0,e=>y.hasProperty(e,E)&&!R(e),"make",0,(e,t)=>{let r=t?.success??S.Void,n=t?.failure??S.Never;return T({name:e,description:t?.description,parametersSchema:t?.parameters?S.Struct(t?.parameters):O,successSchema:r,failureSchema:n,failureMode:t?.failureMode??"error",annotations:p.empty()})},"providerDefined",0,e=>t=>{let r,n="failureMode"in t?t.failureMode:void 0,i=e?.success??S.Void,a=e?.failure??S.Never;return r={id:e.id,name:e.contractSetName,providerName:e.providerName,args:t,argsSchema:S.Struct(e.args),requiresImplementation:e.requiresImplementation??!1,parametersSchema:e?.parameters?S.Struct(e?.parameters):O,successSchema:i,failureSchema:a,failureMode:n??"error"},Object.assign(Object.create(P),r)},"unsafeSecureJsonParse",0,e=>{let{stackTraceLimit:t}=Error;Error.stackTraceLimit=0;try{let t;return t=JSON.parse(e),null!==t&&"object"==typeof t&&($.test(e)||D.test(e))?function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let n=r[e];n&&"object"==typeof n&&t.push(n)}}}return e}(t):t}finally{Error.stackTraceLimit=t}}],815140);var q=e.i(878753),M=e.i(532102),B=e.i(643284),V=e.i(874068),L=e.i(47342);e.i(69368);var j=e.i(527828);e.i(234272);var H=e.i(154405),z=e.i(977343),G=S;let F=Symbol.for("@beep/iam/IamError"),W=e=>e>=400&&e<500?z.value(e).pipe(z.when(400,()=>"Bad Request - Check request parameters, headers, and body format against API documentation."),z.when(401,()=>"Unauthorized - Verify API key, authentication credentials, or token expiration."),z.when(403,()=>"Forbidden - Check API permissions, usage limits, or resource access rights."),z.when(404,()=>"Not Found - Verify the endpoint URL, API version, and resource identifiers."),z.when(408,()=>"Request Timeout - Consider increasing timeout duration or implementing retry logic."),z.when(422,()=>"Unprocessable Entity - Check request data validation, required fields, and data formats."),z.when(429,()=>"Rate Limited - Implement exponential backoff or reduce request frequency."),z.orElse(()=>"Client error - Review request format, parameters, and API documentation.")):e>=500?"Server error - This is likely temporary. Implement retry logic with exponential backoff.":"Check API documentation for this status code.",K=j.BS.stringLiteralKit("Transport","Encode","InvalidUrl");class J extends K.Schema.annotations({schemaId:Symbol.for("@beep/iam/IamError/HttpRequestErrorReason"),identifier:"HttpRequestErrorReason",title:"HTTP Request Error Reason",description:"Reason for an HTTP request error."}){static Options=K.Options;static Enum=K.Enum}class Y extends G.TaggedError("@beep/iam-sdk/IamError/HttpRequestError")("HttpRequestError",{module:G.String,method:G.String,reason:J,request:j.BS.HttpRequestDetails,description:G.optional(G.String),cause:G.optional(G.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpRequestError"),identifier:"HttpRequestError",title:"HTTP Request Error",description:"Error that occurs during HTTP request processing."}){[F]=F;static fromRequestError=({error:e,...t})=>new Y({...t,cause:e,description:e.description,reason:e.reason,request:{hash:e.request.hash,headers:B.redact(e.request.headers),method:e.request.method,url:j.BS.URLString.make(e.request.url),urlParams:e.request.urlParams}});get message(){let e=`${this.request.method} ${this.request.url}`,t=this.description?`${this.reason}: ${this.description}`:`${this.reason}: An HTTP request error occurred.`;t+=` (${e})`;let r="";return z.value(this.reason).pipe(z.when(J.Enum.Encode,()=>{r+="Check the request body for any invalid data."}),z.when(J.Enum.InvalidUrl,()=>{r+="Verify that the URL format is correct and that all required parameters have been provided. Check for any special characters that may need encoding."}),z.when(J.Enum.Transport,()=>{r+="Check your network connection and try again."}),z.exhaustive),t+=`

Suggestion: ${r}`}}class Q extends j.BS.Class("HttpResponseDetails")({status:G.Number,headers:G.Record({key:G.String,value:G.String})},{schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpResponseDetails"),identifier:"HttpResponseDetails",title:"HTTP Response Details",description:"Details about an HTTP response that caused an error."}){}let X=j.BS.stringLiteralKit("StatusCode","Decode","EmptyBody");class Z extends X.Schema.annotations({schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpResponseErrorReason"),identifier:"HttpResponseErrorReason",title:"HTTP Response Error Reason",description:"Reason for an HTTP response error."}){static Options=X.Options;static Enum=X.Enum}class ee extends G.TaggedError("@beep/iam-sdk/IamError/HttpResponseError")("HttpResponseError",{module:G.String,method:G.String,request:H.HttpRequestDetails,response:Q,body:G.optional(G.String),reason:Z,description:G.optional(G.String)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/HttpResponseError"),identifier:"HttpResponseError",title:"HTTP Response Error",description:"Error that occurs during HTTP response processing."}){[F]=F;static fromResponseError=({error:e,...t})=>{let r=q.void,n=e.response.headers["content-type"]??"";return n.includes("application/json")?r=e.response.json:(n.includes("text/")||n.includes("urlencoded"))&&(r=e.response.text),q.flatMap(q.merge(r),r=>new ee({...t,description:e.description,reason:e.reason,request:{hash:e.request.hash,headers:B.redact(e.request.headers),method:e.request.method,url:j.BS.URLString.make(e.request.url),urlParams:e.request.urlParams},response:{headers:B.redact(e.response.headers),status:e.response.status},body:B.format(r)}))};get message(){let e=`${this.response.status} ${this.request.method} ${this.request.url}`,t=this.description?`${this.reason}: ${this.description}`:`${this.reason}: An HTTP response error occurred.`;t+=` (${e})`;let r="";switch(z.value(this.reason).pipe(z.when(Z.Enum.Decode,()=>{r+="The response format does not match what is expected. Verify API version compatibility, check response content-type, and/or examine if the endpoint schema has changed."}),z.when(Z.Enum.EmptyBody,()=>{r+="The response body was empty. This may indicate a server issue, API version mismatch, or the endpoint may have changed its response format."}),z.when(Z.Enum.StatusCode,()=>{r+=W(this.response.status)}),z.exhaustive),this.reason){case"Decode":r+="The response format does not match what is expected. Verify API version compatibility, check response content-type, and/or examine if the endpoint schema has changed.";break;case"EmptyBody":r+="The response body was empty. This may indicate a server issue, API version mismatch, or the endpoint may have changed its response format.";break;case"StatusCode":r+=W(this.response.status)}return t+=`

${r}`,y.isNotUndefined(this.body)&&(t+=`

Response Body: ${this.body}`),t}}class et extends G.TaggedError("@beep/iam-sdk/IamError/MalformedInput")("MalformedInput",{module:G.String,method:G.String,description:G.optional(G.String),cause:G.optional(G.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/MalformedInput"),identifier:"MalformedInput",title:"Malformed Input Error",description:"Error thrown when input data doesn't match the expected format or schema."}){[F]=F}class er extends G.TaggedError("@beep/iam-sdk/IamError/MalformedOutput")("MalformedOutput",{module:G.String,method:G.String,description:G.optional(G.String),cause:G.optional(G.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/IamError/MalformedOutput"),identifier:"MalformedOutput",title:"Malformed Output Error",description:"Error thrown when output data can't be parsed or validated."}){[F]=F;static fromParseError({error:e,...t}){return new er({...t,cause:e})}}class en extends G.TaggedError("@beep/iam-sdk/UnknownError")("UnknownError",{module:G.String,method:G.String,description:G.optional(G.String),cause:G.optional(G.Defect)},{schemaId:Symbol.for("@beep/iam-sdk/UnknownError"),identifier:"UnknownError",title:"Unknown Error",description:"Catch-all error for unexpected runtime errors in AI operations."}){[F]=F;get message(){let e=`${this.module}.${this.method}`;return y.isUndefined(this.description)?`${e}: An error occurred`:`${e}: ${this.description}`}}G.Union(Y,ee,et,er,en).annotations({schemaId:Symbol.for("@beep/iam-sdk/IamError"),identifier:"IamError",title:"IamError",description:"Union type representing all possible AI operation errors."});let ei={...M.CommitPrototype,...B.BaseProto,of:m.identity,toContext(e){return q.gen(this,function*(){let t=yield*q.context(),r=q.isEffect(e)?yield*e:e,n=new Map;for(let[e,i]of Object.entries(r)){let r=this.contracts[e];n.set(r.id,{implementation:i,context:t})}return p.unsafeMake(n)})},toLayer(e){return V.scopedContext(this.toContext(e))},commit(){return q.gen(this,function*(){let e=this.contracts,t=yield*q.context(),r=new WeakMap,n=q.fn("ContractSet.handle",{captureStackTrace:!1})(function*(n,i){yield*q.annotateCurrentSpan({contract:n,parameters:i});let a=e[n];if(y.isUndefined(a)){let t=Object.keys(e).join(",");return yield*new er({module:"ContractSet",method:`${n}.handle`,description:`Failed to find contract with name '${n}' in contractSet - available contracts: ${t}`})}let o=(e=>{let n=r.get(e);if(y.isUndefined(n)){let i=t.unsafeMap.get(e.id),a=S.decodeUnknown(e.parametersSchema),o=S.Union(e.successSchema,e.failureSchema),s=S.validate(o),l=S.encodeUnknown(o);n={context:i.context,implementation:i.implementation,decodeParameters:a,validateResult:s,encodeResult:l},r.set(e,n)}return n})(a),s=yield*q.mapError(o.decodeParameters(i),e=>new er({module:"ContractSet",method:`${n}.handle`,description:`Failed to decode contract call parameters for contract '${n}' from:
'${JSON.stringify(i,void 0,2)}'`,cause:e})),{isFailure:l,result:c}=yield*o.implementation(s).pipe(q.map(e=>({result:e,isFailure:!1})),q.catchAll(e=>"error"===a.failureMode?q.fail(e):q.succeed({result:e,isFailure:!0})),q.tap(({result:e})=>o.validateResult(e)),q.mapInputContext(e=>p.merge(o.context,e)),q.mapError(e=>L.isParseError(e)?new et({module:"ContractSet",method:`${n}.handle`,description:`Failed to validate contract call result for contract '${n}'`,cause:e}):e)),d=yield*q.mapError(o.encodeResult(c),e=>new et({module:"ContractSet",method:`${n}.handle`,description:`Failed to encode contract call result for contract '${n}'`,cause:e}));return{isFailure:l,result:c,encodedResult:d}});return{contracts:e,handle:n}})},toJSON(){return{_id:"@beep/iam-sdk/ContractSet",contracts:Array.from(Object.values(this.contracts)).map(e=>e.name)}},pipe(){return(0,g.pipeArguments)(this,arguments)}},ea=e=>Object.assign(()=>{},ei,{contracts:e}),eo=ea({});e.s(["TypeId",0,"~@beep/iam-sdk/ContractSet","empty",0,eo,"make",0,(...e)=>ea(((...e)=>{let t={};for(let r of e)t[r.name]=S.isSchema(r)?I(r):r;return t})(...e)),"merge",0,(...e)=>{let t={};for(let r of e)for(let[e,n]of Object.entries(r.contracts))t[e]=n;return ea(t)}],901809),e.i(458991);var es=e.i(6368),el=e.i(300767),ec=e.i(190659),ed=e.i(524062);let eu=[],ep=0,em=0,ef=e=>{let t=[],r={get:()=>(r.lc||r.listen(()=>{})(),r.value),lc:0,listen:e=>(r.lc=t.push(e),()=>{for(let t=ep+4;t<eu.length;)eu[t]===e?eu.splice(t,4):t+=4;let n=t.indexOf(e);~n&&(t.splice(n,1),--r.lc||r.off())}),notify(e,n){em++;let i=!eu.length;for(let i of t)eu.push(i,r.value,e,n);if(i){for(ep=0;ep<eu.length;ep+=4)eu[ep](eu[ep+1],eu[ep+2],eu[ep+3]);eu.length=0}},off(){},set(e){let t=r.value;t!==e&&(r.value=e,r.notify(t))},subscribe(e){let t=r.listen(e);return e(r.value),t},value:e};return r};var eh=Object.defineProperty,eg=Object.defineProperties,ey=Object.getOwnPropertyDescriptors,eS=Object.getOwnPropertySymbols,eb=Object.prototype.hasOwnProperty,eE=Object.prototype.propertyIsEnumerable,ew=(e,t,r)=>t in e?eh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,eR=(e,t)=>{for(var r in t||(t={}))eb.call(t,r)&&ew(e,r,t[r]);if(eS)for(var r of eS(t))eE.call(t,r)&&ew(e,r,t[r]);return e},ev=(e,t)=>eg(e,ey(t)),eP=class extends Error{constructor(e,t,r){super(t||e.toString(),{cause:r}),this.status=e,this.statusText=t,this.error=r}},eT=async(e,t)=>{var r,n,i,a,o,s;let l=t||{},c={onRequest:[null==t?void 0:t.onRequest],onResponse:[null==t?void 0:t.onResponse],onSuccess:[null==t?void 0:t.onSuccess],onError:[null==t?void 0:t.onError],onRetry:[null==t?void 0:t.onRetry]};if(!t||!(null==t?void 0:t.plugins))return{url:e,options:l,hooks:c};for(let d of(null==t?void 0:t.plugins)||[]){if(d.init){let n=await (null==(r=d.init)?void 0:r.call(d,e.toString(),t));l=n.options||l,e=n.url}c.onRequest.push(null==(n=d.hooks)?void 0:n.onRequest),c.onResponse.push(null==(i=d.hooks)?void 0:i.onResponse),c.onSuccess.push(null==(a=d.hooks)?void 0:a.onSuccess),c.onError.push(null==(o=d.hooks)?void 0:o.onError),c.onRetry.push(null==(s=d.hooks)?void 0:s.onRetry)}return{url:e,options:l,hooks:c}},eO=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},eI=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}},ek=async e=>{let t={},r=async e=>"function"==typeof e?await e():e;if(null==e?void 0:e.auth){if("Bearer"===e.auth.type){let n=await r(e.auth.token);if(!n)return t;t.authorization=`Bearer ${n}`}else if("Basic"===e.auth.type){let n=r(e.auth.username),i=r(e.auth.password);if(!n||!i)return t;t.authorization=`Basic ${btoa(`${n}:${i}`)}`}else if("Custom"===e.auth.type){let n=r(e.auth.value);if(!n)return t;t.authorization=`${r(e.auth.prefix)} ${n}`}}return t},eU=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function eA(e){if(void 0===e)return!1;let t=typeof e;return"string"===t||"number"===t||"boolean"===t||null===t||"object"===t&&(!!Array.isArray(e)||!e.buffer&&(e.constructor&&"Object"===e.constructor.name||"function"==typeof e.toJSON))}function eC(e){try{return JSON.parse(e)}catch(t){return e}}function ex(e){return"function"==typeof e}async function e_(e){let t=new Headers(null==e?void 0:e.headers);for(let[r,n]of Object.entries(await ek(e)||{}))t.set(r,n);if(!t.has("content-type")){let r=eA(null==e?void 0:e.body)?"application/json":null;r&&t.set("content-type",r)}return t}var eN=class e extends Error{constructor(t,r){super(r||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,e.prototype)}};async function e$(e,t){let r=await e["~standard"].validate(t);if(r.issues)throw new eN(r.issues);return r.value}var eD=["get","post","put","patch","delete"],eq=async(e,t)=>{var r,n,i,a,o,s,l,c;let d,{hooks:u,url:p,options:m}=await eT(e,t),f=function(e){if(null==e?void 0:e.customFetchImpl)return e.customFetchImpl;if("undefined"!=typeof globalThis&&ex(globalThis.fetch))return globalThis.fetch;if("undefined"!=typeof window&&ex(window.fetch))return window.fetch;throw Error("No fetch implementation found")}(m),h=new AbortController,g=null!=(r=m.signal)?r:h.signal,y=function(e,t){let{baseURL:r,params:n,query:i}=t||{query:{},params:{},baseURL:""},a=e.startsWith("http")?e.split("/").slice(0,3).join("/"):r||"";if(e.startsWith("@")){let t=e.toString().split("@")[1].split("/")[0];eD.includes(t)&&(e=e.replace(`@${t}/`,"/"))}a.endsWith("/")||(a+="/");let[o,s]=e.replace(a,"").split("?"),l=new URLSearchParams(s);for(let[e,t]of Object.entries(i||{}))null!=t&&l.set(e,String(t));if(n)if(Array.isArray(n))for(let[e,t]of o.split("/").filter(e=>e.startsWith(":")).entries()){let r=n[e];o=o.replace(t,r)}else for(let[e,t]of Object.entries(n))o=o.replace(`:${e}`,String(t));(o=o.split("/").map(encodeURIComponent).join("/")).startsWith("/")&&(o=o.slice(1));let c=l.toString();return(c=c.length>0?`?${c}`.replace(/\+/g,"%20"):"",a.startsWith("http"))?new URL(`${o}${c}`,a):`${a}${o}${c}`}(p,m),S=function(e){if(!(null==e?void 0:e.body))return null;let t=new Headers(null==e?void 0:e.headers);if(eA(e.body)&&!t.has("content-type")){for(let[t,r]of Object.entries(null==e?void 0:e.body))r instanceof Date&&(e.body[t]=r.toISOString());return JSON.stringify(e.body)}return e.body}(m),b=await e_(m),E=function(e,t){var r;if(null==t?void 0:t.method)return t.method.toUpperCase();if(e.startsWith("@")){let n=null==(r=e.split("@")[1])?void 0:r.split("/")[0];return eD.includes(n)?n.toUpperCase():(null==t?void 0:t.body)?"POST":"GET"}return(null==t?void 0:t.body)?"POST":"GET"}(p,m),w=ev(eR({},m),{url:y,headers:b,body:S,method:E,signal:g});for(let e of u.onRequest)if(e){let t=await e(w);t instanceof Object&&(w=t)}("pipeTo"in w&&"function"==typeof w.pipeTo||"function"==typeof(null==(n=null==t?void 0:t.body)?void 0:n.pipe))&&!("duplex"in w)&&(w.duplex="half");let{clearTimeout:R}=(!(null==m?void 0:m.signal)&&(null==m?void 0:m.timeout)&&(d=setTimeout(()=>null==h?void 0:h.abort(),null==m?void 0:m.timeout)),{abortTimeout:d,clearTimeout:()=>{d&&clearTimeout(d)}}),v=await f(w.url,w);R();let P={response:v,request:w};for(let e of u.onResponse)if(e){let r=await e(ev(eR({},P),{response:(null==(i=null==t?void 0:t.hookOptions)?void 0:i.cloneResponse)?v.clone():v}));r instanceof Response?v=r:r instanceof Object&&(v=r.response)}if(v.ok){if("HEAD"===w.method)return{data:"",error:null};let e=function(e){let t=e.headers.get("content-type"),r=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";let n=t.split(";").shift()||"";return eU.test(n)?"json":r.has(n)||n.startsWith("text/")?"text":"blob"}(v),r={data:"",response:v,request:w};if("json"===e||"text"===e){let e=await v.text(),t=null!=(a=w.jsonParser)?a:eC;r.data=await t(e)}else r.data=await v[e]();for(let e of((null==w?void 0:w.output)&&w.output&&!w.disableValidation&&(r.data=await e$(w.output,r.data)),u.onSuccess))e&&await e(ev(eR({},r),{response:(null==(o=null==t?void 0:t.hookOptions)?void 0:o.cloneResponse)?v.clone():v}));return(null==t?void 0:t.throw)?r.data:{data:r.data,error:null}}let T=null!=(s=null==t?void 0:t.jsonParser)?s:eC,O=await v.text(),I=function(e){try{return JSON.parse(e),!0}catch(e){return!1}}(O),k=I?await T(O):null,U={response:v,responseText:O,request:w,error:ev(eR({},k),{status:v.status,statusText:v.statusText})};for(let e of u.onError)e&&await e(ev(eR({},U),{response:(null==(l=null==t?void 0:t.hookOptions)?void 0:l.cloneResponse)?v.clone():v}));if(null==t?void 0:t.retry){let r=function(e){if("number"==typeof e)return new eO({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new eO(e);case"exponential":return new eI(e);default:throw Error("Invalid retry strategy")}}(t.retry),n=null!=(c=t.retryAttempt)?c:0;if(await r.shouldAttemptRetry(n,v)){for(let e of u.onRetry)e&&await e(P);let i=r.getDelay(n);return await new Promise(e=>setTimeout(e,i)),await eq(e,ev(eR({},t),{retryAttempt:n+1}))}}if(null==t?void 0:t.throw)throw new eP(v.status,v.statusText,I?k:O);return{data:null,error:ev(eR({},k),{status:v.status,statusText:v.statusText})}};let eM=Object.create(null),eB=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?eM:globalThis),eV=new Proxy(eM,{get:(e,t)=>eB()[t]??eM[t],has:(e,t)=>t in eB()||t in eM,set:(e,t,r)=>(eB(!0)[t]=r,!0),deleteProperty(e,t){if(!t)return!1;let r=eB(!0);return delete r[t],!0},ownKeys:()=>Object.keys(eB(!0))});void 0!==ed.default&&ed.default.env;let eL=(e,t)=>{var r,n;return r=r=>{let n=t(r);n&&e.events[6].push(n)},n=t=>{let r=e.listen;e.listen=(...n)=>(e.lc||e.active||(e.active=!0,t()),r(...n));let n=e.off;return e.events[6]=[],e.off=()=>{n(),setTimeout(()=>{if(e.active&&!e.lc){for(let t of(e.active=!1,e.events[6]))t();e.events[6]=[]}},1e3)},()=>{e.listen=r,e.off=n}},e.events=e.events||{},e.events[15]||(e.events[15]=n(t=>{e.events[5].reduceRight((e,t)=>(t(e),e),{shared:{},...t})})),e.events[5]=e.events[5]||[],e.events[5].push(r),()=>{let t=e.events[5],n=t.indexOf(r);t.splice(n,1),t.length||(delete e.events[5],e.events[15](),delete e.events[15])}},ej="undefined"==typeof window,eH=(e,t,r,n)=>{let i=ef({data:null,error:null,isPending:!0,isRefetching:!1,refetch:e=>a(e)}),a=e=>{let a="function"==typeof n?n({data:i.get().data,error:i.get().error,isPending:i.get().isPending}):n;r(t,{...a,query:{...a?.query,...e?.query},async onSuccess(e){i.set({data:e.data,error:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await a?.onSuccess?.(e)},async onError(e){let{request:t}=e,r="number"==typeof t.retry?t.retry:t.retry?.attempts,n=t.retryAttempt||0;r&&n<r||(i.set({error:e.error,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch}),await a?.onError?.(e))},async onRequest(e){let t=i.get();i.set({isPending:null===t.data,data:t.data,error:null,isRefetching:!0,refetch:i.value.refetch}),await a?.onRequest?.(e)}}).catch(e=>{i.set({error:e,data:null,isPending:!1,isRefetching:!1,refetch:i.value.refetch})})};e=Array.isArray(e)?e:[e];let o=!1;for(let t of e)t.subscribe(()=>{ej||(o?a():eL(i,()=>{let e=setTimeout(()=>{o||(a(),o=!0)},0);return()=>{i.off(),t.off(),clearTimeout(e)}}))});return i};class ez extends Error{constructor(e,t){super(e),this.name="BetterAuthError",this.message=e,this.cause=t,this.stack=""}}function eG(e){return{newRole:e=>{var t;return{authorize(e,r="AND"){let n=!1;for(let[i,a]of Object.entries(e)){let e=t[i];if(!e)return{success:!1,error:`You are not allowed to access resource: ${i}`};if(Array.isArray(a))n=a.every(t=>e.includes(t));else if("object"==typeof a)n="OR"===a.connector?a.actions.some(t=>e.includes(t)):a.actions.every(t=>e.includes(t));else throw new ez("Invalid access control request");if(n&&"OR"===r)return{success:n};if(!n&&"AND"===r)return{success:!1,error:`unauthorized to access resource "${i}"`}}return n?{success:n}:{success:!1,error:"Not authorized"}},statements:t=e}},statements:e}}let eF=eG({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),eW=eF.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"],ac:["create","read","update","delete"]}),eK=eF.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),eJ=eF.newRole({organization:[],member:[],invitation:[],team:[],ac:["read"]}),eY={admin:eW,owner:eK,member:eJ};function eQ(e){let t=new Uint8Array(e),r="";for(let e of t)r+=String.fromCharCode(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function eX(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4,n=atob(t.padEnd(t.length+r,"=")),i=new ArrayBuffer(n.length),a=new Uint8Array(i);for(let e=0;e<n.length;e++)a[e]=n.charCodeAt(e);return i}function eZ(){return e0.stubThis(globalThis?.PublicKeyCredential!==void 0&&"function"==typeof globalThis.PublicKeyCredential)}let e0={stubThis:e=>e};function e1(e){let{id:t}=e;return{...e,id:eX(t),transports:e.transports}}function e2(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}class e6 extends Error{constructor({message:e,code:t,cause:r,name:n}){super(e,{cause:r}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=n??r.name,this.code=t}}let e4=new class{constructor(){Object.defineProperty(this,"controller",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}},e7=["cross-platform","platform"];function e3(e){if(e&&!(0>e7.indexOf(e)))return e}async function e5(e){let t,r,n,i,a;!e.optionsJSON&&e.challenge&&(console.warn("startRegistration() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:o,useAutoRegister:s=!1}=e;if(!eZ())throw Error("WebAuthn is not supported in this browser");let l={...o,challenge:eX(o.challenge),user:{...o.user,id:eX(o.user.id)},excludeCredentials:o.excludeCredentials?.map(e1)},c={};s&&(c.mediation="conditional"),c.publicKey=l,c.signal=e4.createNewAbortSignal();try{t=await navigator.credentials.create(c)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new e6({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if(r.authenticatorSelection?.requireResidentKey===!0)return new e6({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});else if("conditional"===t.mediation&&r.authenticatorSelection?.userVerification==="required")return new e6({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});else if(r.authenticatorSelection?.userVerification==="required")return new e6({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new e6({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new e6({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new e6(0===r.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!e2(t))return new e6({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rp.id!==t)return new e6({message:`The RP ID "${r.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(r.user.id.byteLength<1||r.user.id.byteLength>64)return new e6({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new e6({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:c})}if(!t)throw Error("Registration was not completed");let{id:d,rawId:u,response:p,type:m}=t;if("function"==typeof p.getTransports&&(n=p.getTransports()),"function"==typeof p.getPublicKeyAlgorithm)try{i=p.getPublicKeyAlgorithm()}catch(e){e8("getPublicKeyAlgorithm()",e)}if("function"==typeof p.getPublicKey)try{let e=p.getPublicKey();null!==e&&(a=eQ(e))}catch(e){e8("getPublicKey()",e)}if("function"==typeof p.getAuthenticatorData)try{r=eQ(p.getAuthenticatorData())}catch(e){e8("getAuthenticatorData()",e)}return{id:d,rawId:eQ(u),response:{attestationObject:eQ(p.attestationObject),clientDataJSON:eQ(p.clientDataJSON),transports:n,publicKeyAlgorithm:i,publicKey:a,authenticatorData:r},type:m,clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:e3(t.authenticatorAttachment)}}function e8(e,t){console.warn(`The browser extension that intercepted this WebAuthn API call incorrectly implemented ${e}. You should report this error to them.
`,t)}let e9=e=>e;async function te(e){let t,r,n;!e.optionsJSON&&e.challenge&&(console.warn("startAuthentication() was not called correctly. It will try to continue with the provided options, but this call should be refactored to use the expected call structure instead. See https://simplewebauthn.dev/docs/packages/browser#typeerror-cannot-read-properties-of-undefined-reading-challenge for more information."),e={optionsJSON:e});let{optionsJSON:i,useBrowserAutofill:a=!1,verifyBrowserAutofillInput:o=!0}=e;if(!eZ())throw Error("WebAuthn is not supported in this browser");i.allowCredentials?.length!==0&&(t=i.allowCredentials?.map(e1));let s={...i,challenge:eX(i.challenge),allowCredentials:t},l={};if(a){if(!await function(){if(!eZ())return e9(new Promise(e=>e(!1)));let e=globalThis.PublicKeyCredential;return e?.isConditionalMediationAvailable===void 0?e9(new Promise(e=>e(!1))):e9(e.isConditionalMediationAvailable())}())throw Error("Browser does not support WebAuthn autofill");if(document.querySelectorAll("input[autocomplete$='webauthn']").length<1&&o)throw Error('No <input> with "webauthn" as the only or last value in its `autocomplete` attribute was detected');l.mediation="conditional",s.allowCredentials=[]}l.publicKey=s,l.signal=e4.createNewAbortSignal();try{r=await navigator.credentials.get(l)}catch(e){throw function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new e6({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new e6({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=globalThis.location.hostname;if(!e2(t))return new e6({message:`${globalThis.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new e6({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new e6({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return e}({error:e,options:l})}if(!r)throw Error("Authentication was not completed");let{id:c,rawId:d,response:u,type:p}=r;return u.userHandle&&(n=eQ(u.userHandle)),{id:c,rawId:eQ(d),response:{authenticatorData:eQ(u.authenticatorData),clientDataJSON:eQ(u.clientDataJSON),signature:eQ(u.signature),userHandle:n},type:p,clientExtensionResults:r.getClientExtensionResults(),authenticatorAttachment:e3(r.authenticatorAttachment)}}let tt=eG({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),tr=tt.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),tn=tt.newRole({user:[],session:[]}),ti={admin:tr,user:tn},ta=!1;function to(e){if("undefined"==typeof document)return null;let t=document.cookie.split("; ").find(t=>t.startsWith(`${e}=`));return t?t.split("=")[1]:null}function ts(e,t="/api/auth"){if(function(e){try{let t=new URL(e).pathname.replace(/\/+$/,"")||"/";return"/"!==t}catch(t){throw new ez(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}(e))return e;let r=e.replace(/\/+$/,"");return t&&"/"!==t?(t=t.startsWith("/")?t:`/${t}`,`${r}${t}`):r}let tl={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},tc=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,td={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:1/0,"-infinity":-1/0},tu=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/,tp={id:"redirect",name:"Redirect",hooks:{onSuccess(e){if(e.data?.url&&e.data?.redirect&&"undefined"!=typeof window&&window.location&&window.location)try{window.location.href=e.data.url}catch{}}}};var tm=e.i(514499);let tf=function(e){var t,r;let{pluginPathMethods:n,pluginsActions:i,pluginsAtoms:a,$fetch:o,$store:s,atomListeners:l}=((e,t)=>{var r;let n,i="credentials"in Request.prototype,a=function(e,t,r,n){if(e)return ts(e,t);if(!1!==n){let e=eV.BETTER_AUTH_URL||eV.NEXT_PUBLIC_BETTER_AUTH_URL||eV.PUBLIC_BETTER_AUTH_URL||eV.NUXT_PUBLIC_BETTER_AUTH_URL||eV.NUXT_PUBLIC_AUTH_URL||("/"!==eV.BASE_URL?eV.BASE_URL:void 0);if(e)return ts(e,t)}let i=r?.headers.get("x-forwarded-host"),a=r?.headers.get("x-forwarded-proto");if(i&&a)return ts(`${a}://${i}`,t);if(r){let e=function(e){try{return new URL(e).origin}catch(e){return null}}(r.url);if(!e)throw new ez("Could not get origin from request. Please provide a valid base URL.");return ts(e,t)}if("undefined"!=typeof window&&window.location)return ts(window.location.origin,t)}(e?.baseURL,e?.basePath,void 0,t)??"/api/auth",o=e?.plugins?.flatMap(e=>e.fetchPlugins).filter(e=>void 0!==e)||[],s={id:"lifecycle-hooks",name:"lifecycle-hooks",hooks:{onSuccess:e?.fetchOptions?.onSuccess,onError:e?.fetchOptions?.onError,onRequest:e?.fetchOptions?.onRequest,onResponse:e?.fetchOptions?.onResponse}},{onSuccess:l,onError:c,onRequest:d,onResponse:u,...p}=e?.fetchOptions||{},m=(r={baseURL:a,...i?{credentials:"include"}:{},method:"GET",jsonParser:e=>e?function(e,t={strict:!0}){return function(e,t={}){let{strict:r=!1,warnings:n=!1,reviver:i,parseDates:a=!0}=t;if("string"!=typeof e)return e;let o=e.trim();if(o.length>0&&'"'===o[0]&&o.endsWith('"')&&!o.slice(1,-1).includes('"'))return o.slice(1,-1);let s=o.toLowerCase();if(s.length<=9&&s in td)return td[s];if(!tc.test(o)){if(r)throw SyntaxError("[better-json] Invalid JSON");return e}if(Object.entries(tl).some(([e,t])=>{let r=t.test(o);return r&&n&&console.warn(`[better-json] Detected potential prototype pollution attempt using ${e} pattern`),r})&&r)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(o,(e,t)=>{if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){n&&console.warn(`[better-json] Dropping "${e}" key to prevent prototype pollution`);return}if(a&&"string"==typeof t){let e=function(e){let t=tu.exec(e);if(!t)return null;let[,r,n,i,a,o,s,l,c,d,u]=t,p=new Date(Date.UTC(parseInt(r,10),parseInt(n,10)-1,parseInt(i,10),parseInt(a,10),parseInt(o,10),parseInt(s,10),l?parseInt(l.padEnd(3,"0"),10):0));if(c){let e=(60*parseInt(d,10)+parseInt(u,10))*("+"===c?-1:1);p.setUTCMinutes(p.getUTCMinutes()+e)}return p instanceof Date&&!isNaN(p.getTime())?p:null}(t);if(e)return e}return i?i(e,t):t})}catch(t){if(r)throw t;return e}}(e,t)}(e,{strict:!1}):null,customFetchImpl:fetch,...p,plugins:[s,...p.plugins||[],...e?.disableDefaultFetchPlugins?[]:[tp],...o]},async function(e,t){let n,i=ev(eR(eR({},r),t),{plugins:[...(null==r?void 0:r.plugins)||[],(n=r||{},{id:"apply-schema",name:"Apply Schema",version:"1.0.0",async init(e,t){var r,i,a,o;let s=(null==(i=null==(r=n.plugins)?void 0:r.find(t=>{var r;return null!=(r=t.schema)&&!!r.config&&(e.startsWith(t.schema.config.baseURL||"")||e.startsWith(t.schema.config.prefix||""))}))?void 0:i.schema)||n.schema;if(s){let r=e;(null==(a=s.config)?void 0:a.prefix)&&r.startsWith(s.config.prefix)&&(r=r.replace(s.config.prefix,""),s.config.baseURL&&(e=e.replace(s.config.prefix,s.config.baseURL))),(null==(o=s.config)?void 0:o.baseURL)&&r.startsWith(s.config.baseURL)&&(r=r.replace(s.config.baseURL,""));let n=s.schema[r];if(n){let r=ev(eR({},t),{method:n.method,output:n.output});return(null==t?void 0:t.disableValidation)||(r=ev(eR({},r),{body:n.input?await e$(n.input,null==t?void 0:t.body):null==t?void 0:t.body,params:n.params?await e$(n.params,null==t?void 0:t.params):null==t?void 0:t.params,query:n.query?await e$(n.query,null==t?void 0:t.query):null==t?void 0:t.query})),{url:e,options:r}}}return{url:e,options:t}}})]});if(null==r?void 0:r.catchAllError)try{return await eq(e,i)}catch(e){return{data:null,error:{status:500,statusText:"Fetch Error",message:"Fetch related error. Captured by catchAllError option. See error property for more details.",error:e}}}return await eq(e,i)}),{$sessionSignal:f,session:h}={session:eH(n=ef(!1),"/get-session",m,{method:"GET"}),$sessionSignal:n},g=e?.plugins||[],y={},S={$sessionSignal:f,session:h},b={"/sign-out":"POST","/revoke-sessions":"POST","/revoke-other-sessions":"POST","/delete-user":"POST"},E=[{signal:"$sessionSignal",matcher:e=>"/sign-out"===e||"/update-user"===e||e.startsWith("/sign-in")||e.startsWith("/sign-up")||"/delete-user"===e||"/verify-email"===e}];for(let e of g)e.getAtoms&&Object.assign(S,e.getAtoms?.(m)),e.pathMethods&&Object.assign(b,e.pathMethods),e.atomListeners&&E.push(...e.atomListeners);let w={notify:e=>{S[e].set(!S[e].get())},listen:(e,t)=>{S[e].subscribe(t)},atoms:S};for(let t of g)t.getActions&&Object.assign(y,t.getActions?.(m,w,e));return{get baseURL(){return a},pluginsActions:y,pluginsAtoms:S,pluginPathMethods:b,atomListeners:E,$fetch:m,$store:w}})(e),c={};for(let[e,t]of Object.entries(a)){c[`use${(r=e).charAt(0).toUpperCase()+r.slice(1)}`]=()=>(function(e,t={}){let r=(0,tm.useRef)(e.get()),{keys:n,deps:i=[e,n]}=t,a=(0,tm.useCallback)(t=>{let i=e=>{r.current!==e&&(r.current=e,t())};if(i(e.value),n?.length){let t;return t=new Set(n).add(void 0),e.listen((e,r,n)=>{t.has(n)&&i(e,r,n)})}return e.listen(i)},i),o=()=>r.current;return(0,tm.useSyncExternalStore)(a,o,o)})(t)}return t={...i,...c,$fetch:o,$store:s},function e(r=[]){return new Proxy(function(){},{get(n,i){var a;if("string"!=typeof i||"then"===i||"catch"===i||"finally"===i)return;let o=[...r,i],s=t;for(let e of o)if(s&&"object"==typeof s&&e in s)s=s[e];else{s=void 0;break}return"function"==typeof s?s:"object"==typeof(a=s)&&null!==a&&"get"in a&&"function"==typeof a.get&&"lc"in a&&"number"==typeof a.lc?s:e(o)},apply:async(e,t,i)=>{let s="/"+r.map(e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)).join("/"),c=i[0]||{},d=i[1]||{},{query:u,fetchOptions:p,...m}=c,f={...d,...p},h=function(e,t,r){let n=t[e],{fetchOptions:i,query:a,...o}=r||{};return n||(i?.method?i.method:o&&Object.keys(o).length>0?"POST":"GET")}(s,n,c);return await o(s,{...f,body:"GET"===h?void 0:{...m,...f?.body||{}},query:u||f?.query,method:h,async onSuccess(e){await f?.onSuccess?.(e);let t=l?.find(e=>e.matcher(s));if(!t)return;let r=a[t.signal];if(!r)return;let n=r.get();setTimeout(()=>{r.set(!n)},10)}})}})}()}({baseURL:ec.clientEnv.authUrl,basePath:ec.clientEnv.authPath,plugins:[(t={admin:tr,user:tn,...d?.roles},{id:"admin-client",$InferServerPlugin:{},getActions:()=>({admin:{checkRolePermission:e=>(e=>{if(e.userId&&e.options?.adminUserIds?.includes(e.userId))return!0;if(!e.permissions&&!e.permission)return!1;let t=(e.role||e.options?.defaultRole||"user").split(","),r=e.options?.roles||ti;for(let n of t){let t=r[n],i=t?.authorize(e.permission??e.permissions);if(i?.success)return!0}return!1})({role:e.role,options:{ac:d?.ac,roles:t},permissions:e.permissions??e.permission})}}),pathMethods:{"/admin/list-users":"GET","/admin/stop-impersonating":"POST"}}),{id:"anonymous",$InferServerPlugin:{},pathMethods:{"/sign-in/anonymous":"POST"}},{id:"api-key",$InferServerPlugin:{},pathMethods:{"/api-key/create":"POST","/api-key/delete":"POST","/api-key/delete-all-expired-api-keys":"POST"}},{id:"infer-server-plugin",$InferServerPlugin:{}},{id:"generic-oauth-client",$InferServerPlugin:{}},{id:"better-auth-client",$InferServerPlugin:{}},{id:"multi-session",$InferServerPlugin:{},atomListeners:[{matcher:e=>"/multi-session/set-active"===e,signal:"$sessionSignal"}]},{id:"oidc-client",$InferServerPlugin:{}},(r={clientId:ec.clientEnv.googleClientId,promptOptions:{maxAttempts:1}},{id:"one-tap",getActions:(e,t)=>({oneTap:async(t,n)=>{if(ta)return void console.warn("A Google One Tap request is already in progress. Please wait.");ta=!0;try{if("undefined"==typeof window||!window.document)return void console.warn("Google One Tap is only available in browser environments");let{autoSelect:i,cancelOnTapOutside:a,context:o}=t??{},s=o??r.context??"signin";await new Promise(e=>{if(window.googleScriptInitialized)return void e();let t=document.createElement("script");t.src="https://accounts.google.com/gsi/client",t.async=!0,t.defer=!0,t.onload=()=>{window.googleScriptInitialized=!0,e()},document.head.appendChild(t)}),await new Promise((o,l)=>{let c=!1,d=r.promptOptions?.baseDelay??1e3,u=r.promptOptions?.maxAttempts??5;window.google?.accounts.id.initialize({client_id:r.clientId,callback:async r=>{c=!0;try{await e("/one-tap/callback",{method:"POST",body:{idToken:r.credential},...t?.fetchOptions,...n}),(!t?.fetchOptions&&!n||t?.callbackURL)&&(window.location.href=t?.callbackURL??"/"),o()}catch(e){console.error("Error during One Tap callback:",e),l(e)}},auto_select:i,cancel_on_tap_outside:a,context:s,...r.additionalOptions});let p=e=>{c||window.google?.accounts.id.prompt(r=>{if(!c){if(r.isDismissedMoment&&r.isDismissedMoment())if(e<u){let t=Math.pow(2,e)*d;setTimeout(()=>p(e+1),t)}else t?.onPromptNotification?.(r);else if(r.isSkippedMoment&&r.isSkippedMoment())if(e<u){let t=Math.pow(2,e)*d;setTimeout(()=>p(e+1),t)}else t?.onPromptNotification?.(r)}})};p(0)})}catch(e){throw console.error("Error during Google One Tap flow:",e),e}finally{ta=!1}}}),getAtoms:e=>({})}),{id:"one-time-token",$InferServerPlugin:{}},(u={teams:{enabled:!0},dynamicAccessControl:{enabled:!0}},n=ef(!1),i=ef(!1),a=ef(!1),o=ef(!1),s={admin:eW,member:eJ,owner:eK,...u?.roles},{id:"organization",$InferServerPlugin:{},getActions:(e,t,r)=>({$Infer:{ActiveOrganization:{},Organization:{},Invitation:{},Member:{},Team:{}},organization:{checkRolePermission:e=>{var t;let r;return r=(t={role:e.role,options:{ac:u?.ac,roles:s},permissions:e.permissions??e.permission}).options.roles||eY,((e,t)=>{if(!e.permissions&&!e.permission)return!1;let r=e.role.split(","),n=e.options.creatorRole||"owner",i=r.includes(n),a=e.allowCreatorAllPermissions||!1;if(i&&a)return!0;for(let n of r){let r=t[n],i=r?.authorize(e.permissions??e.permission);if(i?.success)return!0}return!1})(t,r)}}}),getAtoms:e=>{let t=eH(n,"/organization/list",e,{method:"GET"}),r=eH([i],"/organization/get-full-organization",e,()=>({method:"GET"})),s=eH([a],"/organization/get-active-member",e,{method:"GET"}),l=eH([o],"/organization/get-active-member-role",e,{method:"GET"});return{$listOrg:n,$activeOrgSignal:i,$activeMemberSignal:a,$activeMemberRoleSignal:o,activeOrganization:r,listOrganizations:t,activeMember:s,activeMemberRole:l}},pathMethods:{"/organization/get-full-organization":"GET","/organization/list-user-teams":"GET"},atomListeners:[{matcher:e=>"/organization/create"===e||"/organization/delete"===e||"/organization/update"===e,signal:"$listOrg"},{matcher:e=>e.startsWith("/organization"),signal:"$activeOrgSignal"},{matcher:e=>e.startsWith("/organization/set-active"),signal:"$sessionSignal"},{matcher:e=>e.includes("/organization/update-member-role"),signal:"$activeMemberSignal"},{matcher:e=>e.includes("/organization/update-member-role"),signal:"$activeMemberRoleSignal"}]}),(l=ef(),{id:"passkey",$InferServerPlugin:{},getActions:e=>((e,{$listPasskeys:t})=>({signIn:{passkey:async(t,r)=>{let n=await e("/passkey/generate-authenticate-options",{method:"POST"});if(!n.data)return n;try{let i=await te({optionsJSON:n.data,useBrowserAutofill:t?.autoFill});return await e("/passkey/verify-authentication",{body:{response:i},...t?.fetchOptions,...r,method:"POST"})}catch(e){return{data:null,error:{code:"AUTH_CANCELLED",message:"auth cancelled",status:400,statusText:"BAD_REQUEST"}}}}},passkey:{addPasskey:async(r,n)=>{let i=await e("/passkey/generate-register-options",{method:"GET",query:{...r?.authenticatorAttachment&&{authenticatorAttachment:r.authenticatorAttachment},...r?.name&&{name:r.name}}});if(!i.data)return i;try{let a=await e5({optionsJSON:i.data,useAutoRegister:r?.useAutoRegister}),o=await e("/passkey/verify-registration",{...r?.fetchOptions,...n,body:{response:a,name:r?.name},method:"POST"});if(!o.data)return o;t.set(Math.random())}catch(e){if(e instanceof e6){if("ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED"===e.code)return{data:null,error:{code:e.code,message:"previously registered",status:400,statusText:"BAD_REQUEST"}};if("ERROR_CEREMONY_ABORTED"===e.code)return{data:null,error:{code:e.code,message:"registration cancelled",status:400,statusText:"BAD_REQUEST"}};return{data:null,error:{code:e.code,message:e.message,status:400,statusText:"BAD_REQUEST"}}}return{data:null,error:{code:"UNKNOWN_ERROR",message:e instanceof Error?e.message:"unknown error",status:500,statusText:"INTERNAL_SERVER_ERROR"}}}}},$Infer:{}}))(e,{$listPasskeys:l}),getAtoms:e=>({listPasskeys:eH(l,"/passkey/list-user-passkeys",e,{method:"GET"}),$listPasskeys:l}),pathMethods:{"/passkey/register":"POST","/passkey/authenticate":"POST"},atomListeners:[{matcher:e=>"/passkey/verify-registration"===e||"/passkey/delete-passkey"===e||"/passkey/update-passkey"===e,signal:"_listPasskeys"}]}),{id:"phoneNumber",$InferServerPlugin:{},atomListeners:[{matcher:e=>"/phone-number/update"===e||"/phone-number/verify"===e,signal:"$sessionSignal"}]},{id:"siwe",$InferServerPlugin:{}},{id:"sso-client",$InferServerPlugin:{}},{id:"two-factor",$InferServerPlugin:{},atomListeners:[{matcher:e=>e.startsWith("/two-factor/"),signal:"$sessionSignal"}],pathMethods:{"/two-factor/disable":"POST","/two-factor/enable":"POST","/two-factor/send-otp":"POST","/two-factor/generate-backup-codes":"POST"},fetchPlugins:[{id:"two-factor",name:"two-factor",hooks:{async onSuccess(e){e.data?.twoFactorRedirect&&c?.onTwoFactorRedirect&&await c.onTwoFactorRedirect()}}}]},{id:"username",$InferServerPlugin:{}},{id:"stripe-client",$InferServerPlugin:{},pathMethods:{"/subscription/restore":"POST","/subscription/billing-portal":"POST"}},{id:"device-authorization",$InferServerPlugin:{},pathMethods:{"/device/code":"POST","/device/token":"POST","/device":"GET","/device/approve":"POST","/device/deny":"POST"}},((e={})=>{let t=e.cookieName||"better-auth.last_used_login_method";return{id:"last-login-method-client",getActions:()=>({getLastUsedLoginMethod:()=>to(t),clearLastUsedLoginMethod:()=>{"undefined"!=typeof document&&(document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`)},isLastUsedLoginMethod:e=>to(t)===e})}})()]}),{$store:th,signIn:tg}=tf;th.listen("$sessionSignal",async()=>{}),e.s(["client",0,tf],176478);var ty=el;class tS extends ty.TaggedError("BetterAuthError"){message;constructor(e){super({message:e}),this.message=e}}class tb extends el.TaggedError("IamError"){cause;customMessage;metadata;code;status;statusText;plugin;method;authCause;constructor(e,t,r={}){super({customMessage:t??"Unknown Error has occurred",cause:e,...r}),this.cause=e,this.customMessage=t,this.metadata=r,this.code=r.code,this.status=r.status,this.statusText=r.statusText,this.plugin=r.plugin,this.method=r.method,this.authCause=r.authCause}static match=(e,t={})=>{if(e instanceof tS)return new tb(e.cause,e.message,t);let r=y.hasProperty("message")(e)&&y.isString(e.message)?e.message:"Unknown Error has occurred";return new tb(new es.BeepError.UnknownError({cause:e,customMessage:r}),r,t)};get message(){return this.customMessage??"Unknown Error has occurred"}}let tE=(e,t={})=>{let r=t.supportsAbort??!1,n=()=>{let t=e.metadata();return{plugin:t.plugin,method:t.method}},i=e=>tb.match(e,n());return{run:t=>{let a,o=n();return a=q.async(e=>{let n=r?new AbortController:void 0,a=!1,o=t=>{a||(a=!0,r&&n&&!n.signal.aborted&&n.abort(),e(t))},s=n?{signal:n.signal,onError:({error:e})=>{o(q.fail(i(e)))}}:{onError:({error:e})=>{o(q.fail(i(e)))}};try{t(s).then(e=>{o(q.succeed(e))},e=>{o(q.fail(i(e)))})}catch(e){o(q.fail(i(e)))}if(r)return q.sync(()=>{n&&!n.signal.aborted&&n.abort()})}),a.pipe(q.annotateLogs({contract:e.contract,plugin:o.plugin,method:o.method}))},raiseResult:e=>null==e.error?q.void:q.fail(i(e.error))}};var tw=e.i(815140),tw=tw,tR=e.i(901809),tR=tR,tv=j,tP=S;class tT extends tv.BS.Class("OAuthRegisterPayload")({client_name:tP.NonEmptyTrimmedString,redirect_uris:tP.mutable(tP.Array(tv.BS.Url))},{schemaId:Symbol.for("@beep/iam-sdk/clients/OAuthRegisterPayload"),identifier:"OAuthRegisterPayload",description:"Payload for registering a new OAuth2 client."}){}let tO=tw.make("OAuthRegisterContract",{description:"Registers a new OAuth2 application.",parameters:tT.fields,failure:tP.instanceOf(tb),success:tP.Void}),tI=tR.make(tO),tk=q.fn("OAuthRegisterHandler")(function*(e){let t=tE({contract:"OAuthRegisterContract",metadata:()=>({plugin:"oauth2",method:"register"})}),r=yield*S.encode(tT)(e).pipe(q.catchTag("ParseError",e=>q.dieMessage(e.message))),n=yield*t.run(()=>tf.oauth2.register(r));yield*t.raiseResult(n)});tI.of({OAuthRegisterContract:tk});var tw=tw,tR=tR,tU=j;e.i(530479);var tA=e.i(8675);class tC extends tU.BS.Class("AcceptInvitationPayload")({invitationId:tA.IamEntityIds.InvitationId},{schemaId:Symbol.for("@beep/iam-sdk/clients/AcceptInvitationPayload"),identifier:"AcceptInvitationPayload",description:"Payload for accepting an organization invitation."}){}let tx=tw.make("AcceptInvitationContract",{description:"Accepts an organization invitation.",parameters:tC.fields,failure:S.instanceOf(tb),success:S.Void}),t_=tR.make(tx),tN=q.fn("AcceptInvitationHandler")(function*(e){let t=tE({contract:"AcceptInvitationContract",metadata:()=>({plugin:"organization",method:"acceptInvitation"})}),r=yield*t.run(()=>tf.organization.acceptInvitation(e));yield*t.raiseResult(r)});t_.of({AcceptInvitationContract:tN});var tw=tw,tR=tR,t$=j,tD=e.i(950868),tq=e.i(615446),tM=e.i(404292);let tB={newPassword:t$.BS.Password,passwordConfirm:t$.BS.Password},tV=S.Struct(tB).pipe(S.filter(({newPassword:e,passwordConfirm:t})=>tq.equals(tM.value(e),tM.value(t))||"Passwords do not match"),S.annotations({identifier:"ResetPasswordPayload",description:"Payload containing the data required to reset a password.",schemaId:Symbol.for("@beep/iam-sdk/clients/ResetPasswordPayload")}));class tL extends t$.BS.Class("RequestResetPasswordPayload")({email:t$.BS.Email,redirectTo:t$.BS.StringWithDefault(tD.paths.auth.requestResetPassword)},{schemaId:Symbol.for("@beep/iam-sdk/clients/RequestResetPasswordPayload"),identifier:"RequestResetPasswordPayload",description:"Payload for requesting a password reset email."}){}let tj=tw.make("ResetPasswordContract",{description:"Resets a user's password using the provided token.",parameters:tB,failure:S.instanceOf(tb),success:S.Void}),tH=tw.make("RequestResetPasswordContract",{description:"Requests a password reset email for a user.",parameters:tL.fields,failure:S.instanceOf(tb),success:S.Void}),tz=tR.make(tj,tH);e.s(["RecoverContractSet",0,tz,"RequestResetPasswordPayload",()=>tL,"ResetPasswordPayload",0,tV],94061);let tG=q.fn("ResetPasswordHandler")(function*(e){let t=tE({contract:"ResetPasswordContract",metadata:()=>({plugin:"reset-password",method:"submit"})}),r=new URLSearchParams(window.location.search).get("token"),n=h.fromNullable(r);if(h.isNone(n))return yield*q.fail(new tb({id:"reset-password-token",resource:"reset-password-token"},"No token found",{plugin:"reset-password",method:"submit"}));let i=yield*S.encode(tV)(e).pipe(q.catchTag("ParseError",e=>q.dieMessage(e.message))),a=yield*t.run(()=>tf.resetPassword({newPassword:i.newPassword,token:n.value}));yield*t.raiseResult(a)}),tF=q.fn("RequestPasswordResetHandler")(function*(e){let t=tE({contract:"RequestResetPasswordContract",metadata:()=>({plugin:"reset-password",method:"request"})}),r=yield*S.encode(tL)(e).pipe(q.catchTag("ParseError",e=>q.dieMessage(e.message))),n=yield*t.run(()=>tf.requestPasswordReset(r));yield*t.raiseResult(n)}),tW=tz.of({ResetPasswordContract:tG,RequestResetPasswordContract:tF});e.s(["RecoverImplementations",0,tW],323349),e.i(299333);var tK=e.i(100060),tw=tw,tR=tR,tJ=j,tY=S;class tQ extends tJ.BS.Class("SignInEmailPayload")({email:tJ.BS.Email,password:tJ.BS.Password,rememberMe:tJ.BS.BoolWithDefault(!1),captchaResponse:tY.Redacted(tY.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInEmailPayload"),identifier:"SignInEmailPayload",description:"Payload for signing in with email and password"}){}let tX=tw.make("SignInEmail",{description:"Signs the user in using email",parameters:tQ.fields,failure:tY.instanceOf(tb),success:tY.Void});class tZ extends tJ.BS.Class("SignInSocialPayload")({provider:tK.AuthProviderNameValue,callbackURL:tY.optional(tJ.BS.URLString)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInSocialPayload"),identifier:"SignInSocialPayload",description:"Payload for signing in with a supported social provider"}){}let t0=tw.make("SignInSocial",{description:"Contract for signing in a user with a social auth provider.",parameters:tZ.fields,failure:tY.instanceOf(tb),success:tY.Void});class t1 extends tJ.BS.Class("SignInUsernamePayload")({username:tY.NonEmptyTrimmedString,password:tJ.BS.Password,rememberMe:tJ.BS.BoolWithDefault(!1),captchaResponse:tY.Redacted(tY.String),callbackURL:tY.optional(tJ.BS.URLString)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInUsernamePayload"),identifier:"SignInUsernamePayload",description:"Payload for signing in with username and password"}){}let t2=tw.make("SignInUsername",{description:"Signs the user in using their username.",parameters:t1.fields,failure:tY.instanceOf(tb),success:tY.Void});class t6 extends tJ.BS.Class("SignInPhoneNumberPayload")({phoneNumber:tJ.BS.Phone,password:tJ.BS.Password,rememberMe:tJ.BS.BoolWithDefault(!1),captchaResponse:tY.Redacted(tY.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInPhoneNumberPayload"),identifier:"SignInPhoneNumberPayload",description:"Payload for signing in with a phone number and password"}){}let t4=tw.make("SignInPhoneNumber",{description:"Signs the user in using their phone number.",parameters:t6.fields,failure:tY.instanceOf(tb),success:tY.Void});class t7 extends tJ.BS.Class("SignInPasskeyPayload")({},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignInPasskeyPayload"),identifier:"SignInPasskeyPayload",description:"Payload for signing in with a passkey",title:"Sign in with passkey"}){}let t3=tw.make("SignInPasskey",{description:"Signs the user in using a passkey.",parameters:t7.fields,failure:tY.instanceOf(tb),success:tY.Void}),t5=tY.Struct({}),t8=tw.make("SignInOneTap",{description:"Signs the user in using a one tap.",parameters:t5.fields,failure:tY.instanceOf(tb),success:tY.Void}),t9=tR.make(tX,t0,t2,t4,t3,t8);e.s(["SignInContractSet",0,t9,"SignInEmailPayload",()=>tQ],663875);let re=q.fn("SignInSocialHandler")(function*(e){let t=tE({contract:"SignInSocial",metadata:()=>({plugin:"signIn",method:"social"})});yield*q.flatMap(t.run(t=>tf.signIn.social({provider:e.provider,callbackURL:e.callbackURL},t.signal?{onError:t.onError,signal:t.signal}:{onError:t.onError})),t.raiseResult)}),rt=q.fn("SignInEmailHandler")(function*(e){let t=tE({contract:"SignInEmail",metadata:()=>({plugin:"signIn",method:"email"})}),r=yield*t.run(t=>tf.signIn.email({email:tM.value(e.email),password:tM.value(e.password),rememberMe:e.rememberMe,fetchOptions:t.signal?{headers:{"x-captcha-response":tM.value(e.captchaResponse)},onError:t.onError,signal:t.signal}:{headers:{"x-captcha-response":tM.value(e.captchaResponse)},onError:t.onError}}));yield*t.raiseResult(r),null==r.error&&tf.$store.notify("$sessionSignal")}),rr=q.fn("SignInUsernameHandler")(function*(e){let{username:t,password:r,rememberMe:n,captchaResponse:i,callbackURL:a}=e,o=tE({contract:"SignInUsername",metadata:()=>({plugin:"signIn",method:"username"})});yield*q.flatMap(o.run(e=>tf.signIn.username({username:t,password:tM.value(r),rememberMe:n,callbackURL:a,fetchOptions:e.signal?{headers:{"x-captcha-response":tM.value(i)},onError:e.onError,signal:e.signal}:{headers:{"x-captcha-response":tM.value(i)},onError:e.onError}})),e=>(null==e.error&&tf.$store.notify("$sessionSignal"),o.raiseResult(e)))}),rn=q.fn("SignInPhoneNumberHandler")(function*(e){let t=tE({contract:"SignInUsername",metadata:()=>({plugin:"signIn",method:"phoneNumber"})});yield*q.flatMap(t.run(t=>tf.signIn.phoneNumber({phoneNumber:tM.value(e.phoneNumber),password:tM.value(e.password),rememberMe:e.rememberMe,fetchOptions:t.signal?{headers:{"x-captcha-response":tM.value(e.captchaResponse)},onError:t.onError,signal:t.signal}:{headers:{"x-captcha-response":tM.value(e.captchaResponse)},onError:t.onError}})),e=>(null==e.error&&tf.$store.notify("$sessionSignal"),t.raiseResult(e)))}),ri=q.fn("SignInOneTapHandler")(function*(){let e=tE({contract:"SignInOneTap",metadata:()=>({plugin:"oneTap",method:"signIn"})});yield*e.run(e=>tf.oneTap({fetchOptions:e.signal?{onError:e.onError,signal:e.signal}:{onError:e.onError}}))}),ra=q.fn("SignInPasskey")(function*(){let e=tE({contract:"SignInPasskey",metadata:()=>({plugin:"signIn",method:"passkey"})});yield*q.flatMap(e.run(e=>tf.signIn.passkey({fetchOptions:e.signal?{onError:e.onError,signal:e.signal}:{onError:e.onError}})),t=>(null==t.error&&tf.$store.notify("$sessionSignal"),e.raiseResult(t)))}),ro=t9.of({SignInEmail:rt,SignInSocial:re,SignInPhoneNumber:rn,SignInUsername:rr,SignInPasskey:ra,SignInOneTap:ri});e.s(["SignInImplementations",0,ro],183020);var tw=tw,tR=tR,rs=j,rl=S;class rc extends rs.BS.Class("SignOutPayload")({onSuccess:new rs.BS.Fn({input:rl.Undefined,output:rl.Void}).Schema},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignOutPayload"),identifier:"SignOutPayload",description:"Payload for signing out the current user."}){}let rd=tw.make("SignOutContract",{description:"Signs the current user out of their active session.",parameters:rc.fields,failure:rl.instanceOf(tb),success:rl.Void}),ru=tR.make(rd),rp=q.fn("SignOutHandler")(function*(e){let t=tE({contract:"SignOutContract",metadata:()=>({plugin:"core",method:"signOut"})}),r=yield*t.run(t=>tf.signOut({fetchOptions:t.signal?{signal:t.signal,onSuccess:()=>e.onSuccess(void 0),onError:t.onError}:{onSuccess:()=>e.onSuccess(void 0),onError:t.onError}}));yield*t.raiseResult(r),null==r.error&&tf.$store.notify("$sessionSignal")}),rm=ru.of({SignOutContract:rp});e.s(["SignOutImplementations",0,rm],161231);var tw=tw,tR=tR,rf=j;e.i(485177),e.i(639337),e.i(852694);var rh=e.i(876107);e.s(["Model",()=>rh.Model],374123),e.i(374123),e.i(325866);var rg=e.i(311746);e.i(355949);var ry=e.i(583080);e.s(["ShardPrefix",()=>ry.ShardPrefix,"ShardPrefixDecoded",()=>ry.ShardPrefixDecoded,"ShardPrefixEncoded",()=>ry.ShardPrefixEncoded,"UploadPath",()=>ry.UploadPath,"UploadPathDecoded",()=>ry.UploadPathDecoded,"UploadPathEncoded",()=>ry.UploadPathEncoded,"UploadPathParser",()=>ry.UploadPathParser],264017),e.i(264017),e.s(["Model",()=>rg.Model,"ShardPrefix",()=>ry.ShardPrefix,"ShardPrefixDecoded",()=>ry.ShardPrefixDecoded,"ShardPrefixEncoded",()=>ry.ShardPrefixEncoded,"UploadPath",()=>ry.UploadPath,"UploadPathDecoded",()=>ry.UploadPathDecoded,"UploadPathEncoded",()=>ry.UploadPathEncoded,"UploadPathParser",()=>ry.UploadPathParser],123433),e.i(123433),e.i(62684);var rS=e.i(731278);e.i(415660);var rb=e.i(114076),rE=e.i(662260),rw=e.i(881528);e.s(["OrganizationType",()=>rb.OrganizationType,"OrganizationTypeEnum",()=>rb.OrganizationTypeEnum,"OrganizationTypeOptions",()=>rb.OrganizationTypeOptions,"SubscriptionStatus",()=>rE.SubscriptionStatus,"SubscriptionStatusEnum",()=>rE.SubscriptionStatusEnum,"SubscriptionStatusOptions",()=>rE.SubscriptionStatusOptions,"SubscriptionTier",()=>rw.SubscriptionTier,"SubscriptionTierEnum",()=>rw.SubscriptionTierEnum,"SubscriptionTierOptions",()=>rw.SubscriptionTierOptions,"makeOrganizationTypePgEnum",()=>rb.makeOrganizationTypePgEnum,"makeSubscriptionStatusPgEnum",()=>rE.makeSubscriptionStatusPgEnum,"makeSubscriptionTierPgEnum",()=>rw.makeSubscriptionTierPgEnum,"organizationTypeKit",()=>rb.organizationTypeKit],691726),e.i(691726),e.s(["Model",()=>rS.Model,"OrganizationModelSchemaId",()=>rS.OrganizationModelSchemaId,"OrganizationType",()=>rb.OrganizationType,"OrganizationTypeEnum",()=>rb.OrganizationTypeEnum,"OrganizationTypeOptions",()=>rb.OrganizationTypeOptions,"SubscriptionStatus",()=>rE.SubscriptionStatus,"SubscriptionStatusEnum",()=>rE.SubscriptionStatusEnum,"SubscriptionStatusOptions",()=>rE.SubscriptionStatusOptions,"SubscriptionTier",()=>rw.SubscriptionTier,"SubscriptionTierEnum",()=>rw.SubscriptionTierEnum,"SubscriptionTierOptions",()=>rw.SubscriptionTierOptions,"makeOrganizationTypePgEnum",()=>rb.makeOrganizationTypePgEnum,"makeSubscriptionStatusPgEnum",()=>rE.makeSubscriptionStatusPgEnum,"makeSubscriptionTierPgEnum",()=>rw.makeSubscriptionTierPgEnum,"organizationTypeKit",()=>rb.organizationTypeKit],204009),e.i(204009),e.i(975053);var rR=e.i(539810);e.s(["Model",()=>rR.Model,"TeamModelSchemaId",()=>rR.TeamModelSchemaId],990742),e.i(990742),e.i(315882),e.i(789897);var rv=e.i(689822),rP=e.i(662447);e.s(["UserGender",()=>rv.UserGender,"UserGenderEnum",()=>rv.UserGenderEnum,"UserGenderKit",()=>rv.UserGenderKit,"UserGenderOptions",()=>rv.UserGenderOptions,"UserRole",()=>rP.UserRole,"UserRoleEnum",()=>rP.UserRoleEnum,"UserRoleKit",()=>rP.UserRoleKit,"UserRoleOptions",()=>rP.UserRoleOptions,"makeUserGenderPgEnum",()=>rv.makeUserGenderPgEnum,"makeUserRolePgEnum",()=>rP.makeUserRolePgEnum],840632),e.i(840632);var rT=e.i(193748),rO=e.i(855682);e.s(["Model",()=>rT.Model,"NewUser",()=>rO.NewUser,"UserGender",()=>rv.UserGender,"UserGenderEnum",()=>rv.UserGenderEnum,"UserGenderKit",()=>rv.UserGenderKit,"UserGenderOptions",()=>rv.UserGenderOptions,"UserRole",()=>rP.UserRole,"UserRoleEnum",()=>rP.UserRoleEnum,"UserRoleKit",()=>rP.UserRoleKit,"UserRoleOptions",()=>rP.UserRoleOptions,"makeUserGenderPgEnum",()=>rv.makeUserGenderPgEnum,"makeUserRolePgEnum",()=>rP.makeUserRolePgEnum],907306);var rI=e.i(907306);e.s(["User",0,rI],237214);var rI=rI,rk=m,rU=L,rA=tM,rC=S,rx=e.i(539686),r_=e.i(668485);let rN=rC.Struct({email:rf.BS.Email,rememberMe:rf.BS.BoolWithDefault(!1),redirectTo:rf.BS.StringWithDefault(tD.paths.dashboard.root),gender:rI.Model.insert.fields.gender,password:rf.BS.Password,passwordConfirm:rf.BS.Password,firstName:rC.NonEmptyTrimmedString,lastName:rC.NonEmptyTrimmedString,captchaResponse:rC.Redacted(rC.String)}),r$=rC.Struct({email:rC.encodedSchema(rf.BS.Email),rememberMe:rf.BS.BoolWithDefault(!1),callbackURL:rf.BS.StringWithDefault(tD.paths.dashboard.root),gender:rI.Model.insert.fields.gender,password:rC.encodedSchema(rf.BS.Password),passwordConfirm:rC.encodedSchema(rf.BS.Password),firstName:rC.NonEmptyTrimmedString,lastName:rC.NonEmptyTrimmedString,name:rC.NonEmptyTrimmedString,captchaResponse:rC.Redacted(rC.String)});class rD extends rC.transformOrFail(rN,r$,{strict:!0,decode:({rememberMe:e=!1,...t},r,n)=>rU.try({try:()=>{let r=rk.pipe(t.firstName,rx.concat(" "),rx.concat(t.lastName));return{firstName:t.firstName,lastName:t.lastName,gender:t.gender,email:rA.value(t.email),password:rA.value(t.password),passwordConfirm:rA.value(t.passwordConfirm),redirectTo:t.redirectTo,rememberMe:e,captchaResponse:rA.value(t.captchaResponse),name:r}},catch:()=>new rU.Type(n,t,"could not decode signup")}),encode:(e,t,r)=>rU.try({try:()=>rU.decodeSync(rN)(r_.omit(e,"name")),catch:()=>new rU.Type(r,e,"could not encode signup")})}){}class rq extends rf.BS.Class("SignUpEmailPayload")({value:rD,onSuccess:new rf.BS.Fn({input:rf.BS.URLPath,output:rC.Void}).Schema},{schemaId:Symbol.for("@beep/iam-sdk/clients/SignUpEmailPayload"),identifier:"SignUpEmailPayload",description:"Payload for signing up a new user via email."}){}let rM=tw.make("SignUpEmail",{description:"Signs up a new user using email credentials.",parameters:rq.fields,failure:rC.instanceOf(tb),success:rC.Union(rC.TaggedStruct("Success",{}),rC.TaggedStruct("Failure",{}))}),rB=tR.make(rM);e.s(["SignUpContractSet",0,rB,"SignUpValue",()=>rD],729177);let rV=q.fn("SignUpEmailHandler")(function*(e){let t=tE({contract:"SignUpEmail",metadata:()=>({plugin:"signUp",method:"email"})}),{value:r,onSuccess:n}=e,{captchaResponse:i,...a}=r,o=yield*t.run(e=>tf.signUp.email({...a,fetchOptions:e.signal?{headers:{"x-captcha-response":tM.value(i)},onSuccess:()=>n(tD.paths.dashboard.root),onError:e.onError,signal:e.signal}:{headers:{"x-captcha-response":tM.value(i)},onSuccess:()=>n(tD.paths.dashboard.root),onError:e.onError}}));return yield*t.raiseResult(o),null==o.error&&tf.$store.notify("$sessionSignal"),o.error?{_tag:"Failure"}:{_tag:"Success"}}),rL=rB.of({SignUpEmail:rV});e.s(["SignUpImplementations",0,rL],953279);var tw=tw,tR=tR,rj=j,rH=S;let rz=rH.Struct({}).annotations({schemaId:Symbol.for("@beep/iam-sdk/clients/SendOtpPayload"),identifier:"SendOtpPayload",description:"Payload for sending a one-time password via the two-factor adapter."});class rG extends rj.BS.Class("VerifyOtpPayload")({code:rH.Redacted(rH.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/VerifyOtpPayload"),identifier:"VerifyOtpPayload",description:"Payload containing the OTP verification code."}){}class rF extends rj.BS.Class("VerifyTotpPayload")({code:rH.Redacted(rH.String)},{schemaId:Symbol.for("@beep/iam-sdk/clients/VerifyTotpPayload"),identifier:"VerifyTotpPayload",description:"Payload containing the TOTP verification code."}){}let rW=tw.make("SendOtpContract",{description:"Sends a one-time password to the user.",parameters:rz.fields,failure:rH.instanceOf(tb),success:rH.Void}),rK=tw.make("VerifyOtpContract",{description:"Verifies an OTP provided by the user.",parameters:rG.fields,failure:rH.instanceOf(tb),success:rH.Void}),rJ=tw.make("VerifyTotpContract",{description:"Verifies a TOTP provided by the user.",parameters:rF.fields,failure:rH.instanceOf(tb),success:rH.Void}),rY=tR.make(rW,rK,rJ),rQ=q.fn("SendOtpContract")(function*(){let e=tE({contract:"SendOtpContract",metadata:()=>({plugin:"two-factor",method:"sendOtp"})}),t=yield*e.run(()=>tf.twoFactor.sendOtp());yield*e.raiseResult(t)}),rX=q.fn("VerifyOtpHandler")(function*(e){let t=tE({contract:"VerifyOtpContract",metadata:()=>({plugin:"two-factor",method:"verifyOtp"})}),r=yield*t.run(()=>tf.twoFactor.verifyOtp({code:tM.value(e.code)}));yield*t.raiseResult(r)}),rZ=q.fn("VerifyTotpHandler")(function*(e){let t=tE({contract:"VerifyTotpContract",metadata:()=>({plugin:"two-factor",method:"verifyTotp"})}),r=yield*t.run(()=>tf.twoFactor.verifyTotp({code:tM.value(e.code)}));yield*t.raiseResult(r)});rY.of({SendOtpContract:rQ,VerifyOtpContract:rX,VerifyTotpContract:rZ});var tw=tw,tR=tR,r0=j,r1=S;class r2 extends r0.BS.Class("SendVerifyPhonePayload")({phoneNumber:r0.BS.Phone,code:r1.Redacted(r1.NonEmptyTrimmedString),updatePhoneNumber:r0.BS.BoolWithDefault(!0)},{schemaId:Symbol.for("@beep/iam-sdk/clients/SendVerifyPhonePayload"),identifier:"SendVerifyPhonePayload",description:"Payload for verifying a user's phone number."}){}class r6 extends r1.Class("SendEmailVerificationPayload")({email:r0.BS.Email},{schemaId:Symbol.for("@beep/iam-sdk/clients/SendEmailVerificationPayload"),identifier:"SendEmailVerificationPayload",description:"Payload for sending an email verification link."}){}class r4 extends r1.Class("VerifyEmailPayload")({token:r1.Redacted(r1.String),onFailure:new r0.BS.Fn({input:r1.Undefined,output:r1.Void}).Schema,onSuccess:new r0.BS.Fn({input:r1.Undefined,output:r1.Void}).Schema},{schemaId:Symbol.for("@beep/iam-sdk/clients/VerifyEmailPayload"),identifier:"VerifyEmailPayload",description:"Payload for verifying an email address via a token."}){}let r7=tw.make("SendVerifyPhoneContract",{description:"Sends a phone verification request.",parameters:r2.fields,failure:r1.instanceOf(tb),success:r1.Void}),r3=tw.make("SendEmailVerificationContract",{description:"Sends an email verification link to the user.",parameters:r6.fields,failure:r1.instanceOf(tb),success:r1.Void}),r5=tw.make("VerifyEmailContract",{description:"Verifies a user's email via a token.",parameters:r4.fields,failure:r1.instanceOf(tb),success:r1.Void}),r8=tR.make(r7,r3,r5);e.s(["SendVerifyPhonePayload",()=>r2,"VerifyContractSet",0,r8],757971);let r9=q.fn("SendEmailVerificationHandler")(function*(e){let t=tE({contract:"SendEmailVerificationContract",metadata:()=>({plugin:"verification",method:"sendVerificationEmail"})}),r=yield*t.run(t=>tf.sendVerificationEmail({email:tM.value(e.email),fetchOptions:t.signal?{onError:t.onError,signal:t.signal}:{onError:t.onError}}));yield*t.raiseResult(r)}),ne=q.fn("VerifyEmailHandler")(function*(e){let t=tE({contract:"VerifyEmailContract",metadata:()=>({plugin:"verification",method:"verifyEmail"})}),r=yield*t.run(t=>tf.verifyEmail({query:{token:tM.value(e.token)}},t.signal?{signal:t.signal,onSuccess:()=>{e.onSuccess(void 0)},onError:r=>{e.onFailure(void 0),t.onError(r)}}:{onSuccess:()=>{e.onSuccess(void 0)},onError:r=>{e.onFailure(void 0),t.onError(r)}}));yield*t.raiseResult(r)}),nt=q.fn("SendVerifyPhoneHandler")(function*(e){let{phoneNumber:t,code:r,updatePhoneNumber:n}=e,i=tE({contract:"SendVerifyPhoneContract",metadata:()=>({plugin:"verification",method:"phone"})}),a=yield*i.run(()=>tf.phoneNumber.verify({phoneNumber:tM.value(t),code:tM.value(r),updatePhoneNumber:n}));yield*i.raiseResult(a)}),nr=r8.of({SendVerifyPhoneContract:nt,SendEmailVerificationContract:r9,VerifyEmailContract:ne});e.s(["VerifyImplementations",0,nr],165527),e.s([],567602)},215647,732506,294381,e=>{"use strict";e.i(567602),e.i(530479);var t=e.i(950868),r=e.i(266417),n=e.i(915838),i=e.i(886999),a=e.i(539686);let o=[t.paths.dashboard.root,t.paths.settings.root,t.paths.admin.root,t.paths.organizations.root,t.paths.auth.device.root,"/account",t.paths.fileManager.root],s=e=>n.pipe(a.split("#")(e),r.head,i.getOrElse(()=>e)),l=e=>n.pipe(a.split("?")(e),r.head,i.getOrElse(()=>e)),c="callbackURL",d=`${t.paths.dashboard.root}`,u=e=>{let t;return!e||!a.startsWith("/")(e)||a.startsWith("//")(e)?d:(t=n.pipe(e,s,l),r.some(o,e=>a.startsWith(e)(t)))?e:d};e.s(["defaultTarget",0,d,"getURL",0,e=>u(e.get(c)),"paramName",0,c,"sanitizePath",0,u],732506),e.s([],294381),e.s([],215647)}]);